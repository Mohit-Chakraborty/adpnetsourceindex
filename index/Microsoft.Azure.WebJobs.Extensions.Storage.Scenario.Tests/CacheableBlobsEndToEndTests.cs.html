<!DOCTYPE html>
<html><head><title>CacheableBlobsEndToEndTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(358);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.Storage.Scenario.Tests/CacheableBlobsEndToEndTests.cs" target="_top">CacheableBlobsEndToEndTests.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/storage/Microsoft.Azure.WebJobs.Extensions.Storage.Scenario.Tests/tests/CacheableBlobsEndToEndTests.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.Storage.Scenario.Tests" target="_top">Microsoft.Azure.WebJobs.Extensions.Storage.Scenario.Tests.csproj</a> (Microsoft.Azure.WebJobs.Extensions.Storage.Scenario.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>.<span class="i n">Specialized</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Extensions</span>.<span class="i n">Storage</span>.<span class="i n">Common</span>.<span class="i n">Tests</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Host</span>.<span class="i n">Executors</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">DependencyInjection</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">Hosting</span>;
<b>using</b> <span class="i n">Moq</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Extensions</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>.<span class="i n">Bindings</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Extensions</span>.<span class="i n">Storage</span>.<span class="i n">ScenarioTests</span>
{
    <b>public class</b>  <a id="862df3fff27f50ff" href="R/862df3fff27f50ff.html" target="n" data-glyph="0,0" class="t t"><span id="aa2bca306a94b0e4">CacheableBlobsEndToEndTests</span></a> : <a href="/Azure.Core.TestFramework/A.html#f9e2d2f7614dcccf" class="t t">LiveTestBase</a>&lt;<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#288f73a0244d6c9d" class="t t">WebJobsTestEnvironment</a>&gt;
    {
        <b>private const string</b> <a id="e8ccc1917d08390b" href="R/e8ccc1917d08390b.html" target="n" data-glyph="10,1" class="i field">TestArtifactPrefix</a> = <span class="s">&quot;e2etestcache&quot;</span>;
        <b>private const string</b> <a id="0ab855da1733762a" href="R/0ab855da1733762a.html" target="n" data-glyph="10,1" class="i field">ContainerName</a> = <a href="#e8ccc1917d08390b" class="i field">TestArtifactPrefix</a> + <span class="s">&quot;-%rnd%&quot;</span>;
        <b>private const string</b> <a id="0cf28097f6b76a98" href="R/0cf28097f6b76a98.html" target="n" data-glyph="10,1" class="i field">OutputContainerName</a> = <a href="#e8ccc1917d08390b" class="i field">TestArtifactPrefix</a> + <span class="s">&quot;-out%rnd%&quot;</span>;
        <b>private const string</b> <a id="bc182e69ce40ddfc" href="R/bc182e69ce40ddfc.html" target="n" data-glyph="10,1" class="i field">InputBlobName</a> = <span class="s">&quot;inputblob1&quot;</span>;
        <b>private const string</b> <a id="2b846d865c38fbfc" href="R/2b846d865c38fbfc.html" target="n" data-glyph="10,1" class="i field">OutputBlobName</a> = <span class="s">&quot;outputblob1&quot;</span>;
        <b>private const string</b> <a id="5b7fd0d00d9cf219" href="R/5b7fd0d00d9cf219.html" target="n" data-glyph="10,1" class="i field">TestData</a> = <span class="s">&quot;TestData&quot;</span>;
        <b>private static</b> <a href="#bb5fca658baac57c" class="t t">TestFixture</a> <a id="ba312a3e9dde68f3" href="R/ba312a3e9dde68f3.html" target="n" data-glyph="46,1" class="i field">_fixture</a>;
        <b>private static int</b> <a id="9768bde0ef35a3df" href="R/9768bde0ef35a3df.html" target="n" data-glyph="46,1" class="i field">_numCacheHits</a>;
        <b>private static int</b> <a id="b6b7cbccab55f3ad" href="R/b6b7cbccab55f3ad.html" target="n" data-glyph="46,1" class="i field">_numCacheMisses</a>;
        <b>private static</b> <span class="t t">FunctionDataCacheKey</span> <a id="75269cf73851b565" href="R/75269cf73851b565.html" target="n" data-glyph="46,1" class="i field">_expectedBlobCacheKey</a>;
 
        [<span class="t constructor">OneTimeSetUp</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f120e6961e31db45" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OneTimeSetUp</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">connectionString</span> = <a href="/Azure.Core.TestFramework/A.html#26a1e2ab3c3c535e" class="i property">TestEnvironment</a>.<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#0f55788eb27fcd2b" class="i property">PrimaryStorageAccountConnectionString</a>;
            <span class="t t">Assert</span>.<span class="i method">IsNotEmpty</span>(<span class="r0 r">connectionString</span>);
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a> = <b>new</b> <a href="#bb5fca658baac57c" class="t constructor">TestFixture</a>();
            <b>await</b> <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#967ae6416d363229" class="i method">InitializeAsync</a>(<a href="/Azure.Core.TestFramework/A.html#26a1e2ab3c3c535e" class="i property">TestEnvironment</a>);
        }
 
        [<span class="t constructor">OneTimeTearDown</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="b721a234d8f52169" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OneTimeTearDown</a>()
        {
            <b>await</b> <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#34b77ad9d07c58b3" class="i method">DisposeAsync</a>();
        }
 
        [<span class="t constructor">SetUp</span>]
        <b>public void</b> <a id="ac2ebfea3ec7d3a7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetUp</a>()
        {
            <a href="#9768bde0ef35a3df" class="i field">_numCacheHits</a> = 0;
            <a href="#b6b7cbccab55f3ad" class="i field">_numCacheMisses</a> = 0;
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>.<span class="i method">Reset</span>();
        }
 
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="30e85ea69173a118" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BindToCacheableReadBlob_VerifyCacheMiss</a>()
        {
            <b>bool</b> <span id="r1 rd" class="r1 r">isIncrementActiveReference</span> = <b>true</b>;
            <span class="t t">SharedMemoryMetadata</span> <span id="r2 rd" class="r2 r">outVal</span> = <b>null</b>;
 
            <span class="c">// Enable the cache</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r3 rd" class="r3 r">c</span> =&gt; <span class="r3 r">c</span>.<span class="i property">IsEnabled</span>)
                .<span class="i method">Returns</span>(<b>true</b>);
 
            <span class="c">// Mock a cache miss</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r4 rd" class="r4 r">c</span> =&gt; <span class="r4 r">c</span>.<span class="i method">TryGet</span>(<span class="t t">It</span>.<span class="i method">IsAny</span>&lt;<span class="t t">FunctionDataCacheKey</span>&gt;(), <span class="r1 r">isIncrementActiveReference</span>, <b>out</b> <span class="r2 r">outVal</span>))
                .<span class="i method">Returns</span>(<b>false</b>)
                .<span class="i method">Verifiable</span>();
 
            <span class="c">// Invoke the function which will verify that it was a cache miss</span>
            <b>await</b> <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#c235842ae9c3b0b1" class="i property">JobHost</a>.<span class="i method">CallAsync</span>(<b>typeof</b>(<a href="#862df3fff27f50ff" class="t t">CacheableBlobsEndToEndTests</a>).<a href="@0@mscorlib/A.html#aa0028890b299af1" class="i method">GetMethod</a>(<span class="s">&quot;ByteArrayBindingCacheMissAsync&quot;</span>));
 
            <span class="c">// Verify that it was a cache miss</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <a href="#b6b7cbccab55f3ad" class="i field">_numCacheMisses</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(0, <a href="#9768bde0ef35a3df" class="i field">_numCacheHits</a>);
            <span class="c">// Verify that TryGet was called on the cache</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>.<span class="i method">Verify</span>();
        }
 
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="8241fc3c067511d0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BindToCacheableReadBlob_VerifyCacheHit</a>()
        {
            <b>bool</b> <span id="r5 rd" class="r5 r">isIncrementActiveReference</span> = <b>true</b>;
 
            <span class="c">// Enable the cache</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r6 rd" class="r6 r">c</span> =&gt; <span class="r6 r">c</span>.<span class="i property">IsEnabled</span>)
                .<span class="i method">Returns</span>(<b>true</b>);
 
            <span class="c">// Mock the cache hit scenario</span>
            <span class="t t">Mock</span>&lt;<span class="t t">SharedMemoryMetadata</span>&gt; <span id="r7 rd" class="r7 r">cacheObjMock</span> = <a href="#bfe5b38f5c30266f" class="i method">CreateMockSharedMemoryMetadata</a>();
            <span class="t t">SharedMemoryMetadata</span> <span id="r8 rd" class="r8 r">cacheObj</span> = <span class="r7 r">cacheObjMock</span>.<span class="i property">Object</span>;
 
            <span class="c">// This access to the cache should be a cache hit (mocking the case where the first access would</span>
            <span class="c">// have inserted the object into the cache)</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r9 rd" class="r9 r">c</span> =&gt; <span class="r9 r">c</span>.<span class="i method">TryGet</span>(<span class="t t">It</span>.<span class="i method">IsAny</span>&lt;<span class="t t">FunctionDataCacheKey</span>&gt;(), <span class="r5 r">isIncrementActiveReference</span>, <b>out</b> <span class="r8 r">cacheObj</span>))
                .<span class="i method">Returns</span>(<b>true</b>)
                .<span class="i method">Verifiable</span>();
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r10 rd" class="r10 r">c</span> =&gt; <span class="r10 r">c</span>.<span class="i method">DecrementActiveReference</span>(<span class="t t">It</span>.<span class="i method">IsAny</span>&lt;<span class="t t">FunctionDataCacheKey</span>&gt;()))
                .<span class="i method">Verifiable</span>();
 
            <span class="c">// Invoke the function which will verify that it was a cache hit</span>
            <b>await</b> <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#c235842ae9c3b0b1" class="i property">JobHost</a>.<span class="i method">CallAsync</span>(<b>typeof</b>(<a href="#862df3fff27f50ff" class="t t">CacheableBlobsEndToEndTests</a>).<a href="@0@mscorlib/A.html#aa0028890b299af1" class="i method">GetMethod</a>(<span class="s">&quot;ByteArrayBindingCacheHit&quot;</span>));
 
            <span class="c">// Verify that it was a cache hit</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <a href="#9768bde0ef35a3df" class="i field">_numCacheHits</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(0, <a href="#b6b7cbccab55f3ad" class="i field">_numCacheMisses</a>);
            <span class="c">// Verify that TryGet was called on the cache</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>.<span class="i method">Verify</span>();
        }
 
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3ee5df5b9cb9fa4d" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BindToCacheableWriteBlob_VerifyBlobStream</a>()
        {
            <span class="c">// Invoke the function which will verify that the input object has a BlobStream bound to it</span>
            <b>await</b> <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#c235842ae9c3b0b1" class="i property">JobHost</a>.<span class="i method">CallAsync</span>(<b>typeof</b>(<a href="#862df3fff27f50ff" class="t t">CacheableBlobsEndToEndTests</a>).<a href="@0@mscorlib/A.html#aa0028890b299af1" class="i method">GetMethod</a>(<span class="s">&quot;ByteArrayBindingWriteToCacheAsync&quot;</span>));
        }
 
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="0343bfebc2837938" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BindToCacheableReadBlob_VerifyFunctionDataCacheKey</a>()
        {
            <b>bool</b> <span id="r11 rd" class="r11 r">isIncrementActiveReference</span> = <b>true</b>;
 
            <span class="c">// Enable the cache</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r12 rd" class="r12 r">c</span> =&gt; <span class="r12 r">c</span>.<span class="i property">IsEnabled</span>)
                .<span class="i method">Returns</span>(<b>true</b>);
 
            <span class="c">// Mock the cache hit scenario</span>
            <span class="t t">Mock</span>&lt;<span class="t t">SharedMemoryMetadata</span>&gt; <span id="r13 rd" class="r13 r">cacheObjMock</span> = <a href="#bfe5b38f5c30266f" class="i method">CreateMockSharedMemoryMetadata</a>();
            <span class="t t">SharedMemoryMetadata</span> <span id="r14 rd" class="r14 r">cacheObj</span> = <span class="r13 r">cacheObjMock</span>.<span class="i property">Object</span>;
 
            <span class="c">// This access to the cache should be a cache hit (mocking the case where the first access would</span>
            <span class="c">// have inserted the object into the cache)</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r15 rd" class="r15 r">c</span> =&gt; <span class="r15 r">c</span>.<span class="i method">TryGet</span>(<a href="#75269cf73851b565" class="i field">_expectedBlobCacheKey</a>, <span class="r11 r">isIncrementActiveReference</span>, <b>out</b> <span class="r14 r">cacheObj</span>))
                .<span class="i method">Returns</span>(<b>true</b>)
                .<span class="i method">Verifiable</span>();
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                .<span class="i method">Setup</span>(<span id="r16 rd" class="r16 r">c</span> =&gt; <span class="r16 r">c</span>.<span class="i method">DecrementActiveReference</span>(<a href="#75269cf73851b565" class="i field">_expectedBlobCacheKey</a>))
                .<span class="i method">Verifiable</span>();
 
            <span class="c">// Invoke the function which will verify that it was a cache hit</span>
            <b>await</b> <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#c235842ae9c3b0b1" class="i property">JobHost</a>.<span class="i method">CallAsync</span>(<b>typeof</b>(<a href="#862df3fff27f50ff" class="t t">CacheableBlobsEndToEndTests</a>).<a href="@0@mscorlib/A.html#aa0028890b299af1" class="i method">GetMethod</a>(<span class="s">&quot;ByteArrayBindingCacheHitVerifyFunctionDataCacheKey&quot;</span>));
 
            <span class="c">// Verify that TryGet was called on the cache</span>
            <a href="#ba312a3e9dde68f3" class="i field">_fixture</a>.<a href="#dd96b16cc9a21add" class="i property">CacheMock</a>.<span class="i method">Verify</span>();
 
            <span class="c">// The function call would raise an exception if the FunctionDataCacheKey does not match</span>
            <span class="c">// match the key generated for the blob.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is mocking the case where there was a cache miss.</span>
        <span class="c">///</span><span class="c"> This function will read the input from remote storage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">NoAutomaticTrigger</span>]
        <b>public static async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="623ed5cca70a57b8" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ByteArrayBindingCacheMissAsync</a>(
            [<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Blobs/A.html#4d963f16a01a06f0" class="t constructor">Blob</a>(<a href="#0ab855da1733762a" class="i field">ContainerName</a> + <span class="s">&quot;/&quot;</span> + <a href="#bc182e69ce40ddfc" class="i field">InputBlobName</a>, <a href="@0@mscorlib/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@0@mscorlib/A.html#0f1c68c756d0636b" class="i field">Read</a>)] <span class="t t">ICacheAwareReadObject</span> <span id="r17 rd" class="r17 r">blob</span>)
        {
            <span class="t t">Assert</span>.<span class="i method">IsFalse</span>(<span class="r17 r">blob</span>.<span class="i property">IsCacheHit</span>);
 
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r18 rd" class="r18 r">blobStream</span> = <span class="r17 r">blob</span>.<span class="i property">BlobStream</span>)
            <b>using</b> (<a href="@0@mscorlib/A.html#b5fe1efcec14de32" class="t t">StreamReader</a> <span id="r19 rd" class="r19 r">reader</span> = <b>new</b> <a href="@0@mscorlib/A.html#72447927169f6b77" class="t constructor">StreamReader</a>(<span class="r18 r">blobStream</span>))
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">result</span> = <b>await</b> <span class="r19 r">reader</span>.<a href="@0@mscorlib/A.html#670e67dfb6e4b237" class="i method">ReadToEndAsync</a>();
                <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="#5b7fd0d00d9cf219" class="i field">TestData</a>, <span class="r20 r">result</span>);
                <a href="#b6b7cbccab55f3ad" class="i field">_numCacheMisses</a> = 1;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is mocking the case where the function produces an output blob that is stored in the cache.</span>
        <span class="c">///</span><span class="c"> We verify if the output object has a valid </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">BlobStream</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">NoAutomaticTrigger</span>]
        <b>public static void</b> <a id="c40552672ed4e125" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ByteArrayBindingWriteToCacheAsync</a>(
            [<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Blobs/A.html#4d963f16a01a06f0" class="t constructor">Blob</a>(<a href="#0ab855da1733762a" class="i field">ContainerName</a> + <span class="s">&quot;/&quot;</span> + <a href="#2b846d865c38fbfc" class="i field">OutputBlobName</a>, <a href="@0@mscorlib/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@0@mscorlib/A.html#4715fa16da583c25" class="i field">Write</a>)] <span class="t t">ICacheAwareWriteObject</span> <span id="r21 rd" class="r21 r">blob</span>)
        {
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r21 r">blob</span>.<span class="i property">BlobStream</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is mocking the case where there was a cache hit.</span>
        <span class="c">///</span><span class="c"> Note: Here the actual input is not read from the shared memory region</span>
        <span class="c">///</span><span class="c"> as no implementation of that is available in this package.</span>
        <span class="c">///</span><span class="c"> We just verify if the object was a cache hit and that the input</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">ICacheAwareReadObject</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> has the proper fields populated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">NoAutomaticTrigger</span>]
        <b>public static void</b> <a id="9f652c87fcb176b9" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ByteArrayBindingCacheHit</a>(
            [<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Blobs/A.html#4d963f16a01a06f0" class="t constructor">Blob</a>(<a href="#0ab855da1733762a" class="i field">ContainerName</a> + <span class="s">&quot;/&quot;</span> + <a href="#bc182e69ce40ddfc" class="i field">InputBlobName</a>, <a href="@0@mscorlib/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@0@mscorlib/A.html#0f1c68c756d0636b" class="i field">Read</a>)] <span class="t t">ICacheAwareReadObject</span> <span id="r22 rd" class="r22 r">blob</span>)
        {
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r22 r">blob</span>.<span class="i property">IsCacheHit</span>);
 
            <span class="t t">SharedMemoryMetadata</span> <span id="r23 rd" class="r23 r">cacheObj</span> = <span class="r22 r">blob</span>.<span class="i property">CacheObject</span>;
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r23 r">cacheObj</span>);
 
            <a href="#9768bde0ef35a3df" class="i field">_numCacheHits</a> = 1;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is mocking the case where there was a cache hit.</span>
        <span class="c">///</span><span class="c"> Note: Here the actual input is not read from the shared memory region</span>
        <span class="c">///</span><span class="c"> as no implementation of that is available in this package.</span>
        <span class="c">///</span><span class="c"> We just verify if the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">FunctionDataCacheKey</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">ICacheAwareReadObject</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> matches the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#75269cf73851b565" class="i field">_expectedBlobCacheKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that was generated for the blob when it was written.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">NoAutomaticTrigger</span>]
        <b>public static void</b> <a id="2a462d22b3a8f2bc" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ByteArrayBindingCacheHitVerifyFunctionDataCacheKey</a>(
            [<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Blobs/A.html#4d963f16a01a06f0" class="t constructor">Blob</a>(<a href="#0ab855da1733762a" class="i field">ContainerName</a> + <span class="s">&quot;/&quot;</span> + <a href="#bc182e69ce40ddfc" class="i field">InputBlobName</a>, <a href="@0@mscorlib/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@0@mscorlib/A.html#0f1c68c756d0636b" class="i field">Read</a>)] <span class="t t">ICacheAwareReadObject</span> <span id="r24 rd" class="r24 r">blob</span>)
        {
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="#75269cf73851b565" class="i field">_expectedBlobCacheKey</a>, <span class="r24 r">blob</span>.<span class="i property">CacheKey</span>);
        }
 
        <b>public class</b> <a id="bb5fca658baac57c" href="R/bb5fca658baac57c.html" target="n" data-glyph="0,1" class="t t"><span id="90aa353da444aa6e">TestFixture</span></a>
        {
            <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="967ae6416d363229" href="R/967ae6416d363229.html" target="n" data-glyph="72,2" class="i method">InitializeAsync</a>(<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#288f73a0244d6c9d" class="t t">WebJobsTestEnvironment</a> <span id="r25 rd" class="r25 r">testEnvironment</span>)
            {
                <a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#f107bd899291b5d4" class="t t">RandomNameResolver</a> <span id="r26 rd" class="r26 r">nameResolver</span> = <b>new</b> <a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#1e1e22aac421ca23" class="t constructor">RandomNameResolver</a>();
 
                <a href="#dd96b16cc9a21add" class="i property">CacheMock</a> = <a href="#da79cdca1e513a8c" class="i method">CreateMockFunctionDataCache</a>();
                <a href="#dd96b16cc9a21add" class="i property">CacheMock</a>
                    .<span class="i method">Setup</span>(<span id="r27 rd" class="r27 r">c</span> =&gt; <span class="r27 r">c</span>.<span class="i property">IsEnabled</span>)
                    .<span class="i method">Returns</span>(<b>true</b>);
                <span class="t t">IFunctionDataCache</span> <span id="r28 rd" class="r28 r">cache</span> = <a href="#dd96b16cc9a21add" class="i property">CacheMock</a>.<span class="i property">Object</span>;
 
                <a href="#48d884c2ba2b3b7b" class="i property">Host</a> = <b>new</b> <span class="t constructor">HostBuilder</span>()
                    .<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#8e7ac0e678c7c7a5" class="i method">ConfigureDefaultTestHost</a>&lt;<a href="#862df3fff27f50ff" class="t t">CacheableBlobsEndToEndTests</a>&gt;(<span id="r29 rd" class="r29 r">b</span> =&gt;
                    {
                        <span class="r29 r">b</span>.<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Blobs/A.html#a4ba870e12f90f4a" class="i method">AddAzureStorageBlobs</a>().<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Queues/A.html#88bea00a76ab1f62" class="i method">AddAzureStorageQueues</a>();
                        <span class="r29 r">b</span>.<span class="i method">AddAzureStorageCoreServices</span>();
                    })
                    .<span class="i method">ConfigureServices</span>(<span id="r30 rd" class="r30 r">services</span> =&gt;
                    {
                        <span class="r30 r">services</span>.<span class="i method">AddSingleton</span>&lt;<span class="t t">INameResolver</span>&gt;(<span class="r26 r">nameResolver</span>)
                                .<span class="i method">AddSingleton</span>(<span class="r28 r">cache</span>);
                    })
                    .<span class="i method">Build</span>();
 
                <a href="#c235842ae9c3b0b1" class="i property">JobHost</a> = <a href="#48d884c2ba2b3b7b" class="i property">Host</a>.<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#26d1a094302aee44" class="i method">GetJobHost</a>();
 
                <a href="#946244853aa0aee6" class="i property">BlobServiceClient</a> = <b>new</b> <a href="/Azure.Storage.Blobs/A.html#66aac072e757eda3" class="t constructor">BlobServiceClient</a>(<span class="r25 r">testEnvironment</span>.<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#0f55788eb27fcd2b" class="i property">PrimaryStorageAccountConnectionString</a>);
 
                <a href="#17f296a627231447" class="i property">BlobContainer</a> = <a href="#946244853aa0aee6" class="i property">BlobServiceClient</a>.<a href="/Azure.Storage.Blobs/A.html#e3b6b5726874c210" class="i method">GetBlobContainerClient</a>(<span class="r26 r">nameResolver</span>.<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#454ee046bb695881" class="i method">ResolveInString</a>(<a href="#0ab855da1733762a" class="i field">ContainerName</a>));
                <span class="t t">Assert</span>.<span class="i method">False</span>(<b>await</b> <a href="#17f296a627231447" class="i property">BlobContainer</a>.<a href="/Azure.Storage.Blobs/A.html#3a094ee87deb9190" class="i method">ExistsAsync</a>());
                <b>await</b> <a href="#17f296a627231447" class="i property">BlobContainer</a>.<a href="/Azure.Storage.Blobs/A.html#47f53d489abf3bfe" class="i method">CreateAsync</a>();
 
                <a href="#20f5b369fbc09447" class="i property">OutputBlobContainer</a> = <a href="#946244853aa0aee6" class="i property">BlobServiceClient</a>.<a href="/Azure.Storage.Blobs/A.html#e3b6b5726874c210" class="i method">GetBlobContainerClient</a>(<span class="r26 r">nameResolver</span>.<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#454ee046bb695881" class="i method">ResolveInString</a>(<a href="#0cf28097f6b76a98" class="i field">OutputContainerName</a>));
 
                <b>await</b> <a href="#48d884c2ba2b3b7b" class="i property">Host</a>.<span class="i method">StartAsync</span>();
 
                <span class="c">// Upload some test blobs</span>
                <a href="/Azure.Storage.Blobs/A.html#a021487ec216e15d" class="t t">BlockBlobClient</a> <span id="r31 rd" class="r31 r">blob</span> = <a href="#17f296a627231447" class="i property">BlobContainer</a>.<a href="/Azure.Storage.Blobs/A.html#9212d86e1f5d0a57" class="i method">GetBlockBlobClient</a>(<a href="#bc182e69ce40ddfc" class="i field">InputBlobName</a>);
                <b>await</b> <span class="r31 r">blob</span>.<a href="/Microsoft.Azure.WebJobs.Extensions.Storage.Common.Tests/A.html#7c345baacd43f10d" class="i method">UploadTextAsync</a>(<a href="#5b7fd0d00d9cf219" class="i field">TestData</a>);
 
                <span class="c">// Get information about the uploaded blob</span>
                <a href="/Azure.Storage.Blobs/A.html#5eac1727e6cdaafb" class="t t">BlobProperties</a> <span id="r32 rd" class="r32 r">blobProperties</span> = <b>await</b> <span class="r31 r">blob</span>.<a href="/Azure.Storage.Blobs/A.html#f0505a8f6a46fa3e" class="i method">GetPropertiesAsync</a>();
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r33 rd" class="r33 r">blobId</span> = <span class="r31 r">blob</span>.<a href="/Azure.Storage.Blobs/A.html#ae31d23a19240d50" class="i property">Uri</a>.<a href="@0@System/A.html#bf3caa11ab73e433" class="i method">ToString</a>();
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r34 rd" class="r34 r">blobVersion</span> = <span class="r32 r">blobProperties</span>.<a href="/Azure.Storage.Blobs/A.html#8491b5521f600f18" class="i property">ETag</a>.<a href="/Azure.Core/A.html#c02596ded366f933" class="i method">ToString</a>();
                <a href="#75269cf73851b565" class="i field">_expectedBlobCacheKey</a> = <b>new</b> <span class="t constructor">FunctionDataCacheKey</span>(<span class="r33 r">blobId</span>, <span class="r34 r">blobVersion</span>);
            }
 
            <b>public</b> <span class="t t">IHost</span> <a id="48d884c2ba2b3b7b" href="R/48d884c2ba2b3b7b.html" target="n" data-glyph="102,2" class="i property">Host</a>
            {
                <b>get</b>;
                <b>private set</b>;
            }
 
            <b>public</b> <span class="t t">JobHost</span> <a id="c235842ae9c3b0b1" href="R/c235842ae9c3b0b1.html" target="n" data-glyph="102,2" class="i property">JobHost</a>
            {
                <b>get</b>;
                <b>private set</b>;
            }
 
            <b>public</b> <span class="t t">INameResolver</span> <a id="76f8739ed72782ba" href="R/../../0000000000.html" target="n" data-glyph="102,2" class="i property">NameResolver</a> =&gt; <a href="#48d884c2ba2b3b7b" class="i property">Host</a>.<span class="i property">Services</span>.<span class="i method">GetService</span>&lt;<span class="t t">INameResolver</span>&gt;();
 
            <b>public string</b> <a id="8bbd2cb7da6bd0bc" href="R/8bbd2cb7da6bd0bc.html" target="n" data-glyph="102,2" class="i property">HostId</a> =&gt; <a href="#48d884c2ba2b3b7b" class="i property">Host</a>.<span class="i property">Services</span>.<span class="i method">GetService</span>&lt;<span class="t t">IHostIdProvider</span>&gt;().<span class="i method">GetHostIdAsync</span>(<a href="@0@mscorlib/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>.<a href="@0@mscorlib/A.html#ec32c41597007382" class="i property">None</a>).<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>;
 
            <b>public</b> <a href="/Azure.Storage.Blobs/A.html#5c3c4fe54cdb5868" class="t t">BlobServiceClient</a> <a id="946244853aa0aee6" href="R/946244853aa0aee6.html" target="n" data-glyph="102,2" class="i property">BlobServiceClient</a>
            {
                <b>get</b>;
                <b>private set</b>;
            }
 
            <b>public</b> <a href="/Azure.Storage.Blobs/A.html#6bb2c165ee95c7d4" class="t t">BlobContainerClient</a> <a id="17f296a627231447" href="R/17f296a627231447.html" target="n" data-glyph="102,2" class="i property">BlobContainer</a>
            {
                <b>get</b>;
                <b>private set</b>;
            }
 
            <b>public</b> <a href="/Azure.Storage.Blobs/A.html#6bb2c165ee95c7d4" class="t t">BlobContainerClient</a> <a id="20f5b369fbc09447" href="R/20f5b369fbc09447.html" target="n" data-glyph="102,2" class="i property">OutputBlobContainer</a>
            {
                <b>get</b>;
                <b>private set</b>;
            }
 
            <b>public</b> <span class="t t">Mock</span>&lt;<span class="t t">IFunctionDataCache</span>&gt; <a id="dd96b16cc9a21add" href="R/dd96b16cc9a21add.html" target="n" data-glyph="102,2" class="i property">CacheMock</a>
            {
                <b>get</b>;
                <b>private set</b>;
            }
 
            <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="4bb231da5a0ae52b" href="R/4bb231da5a0ae52b.html" target="n" data-glyph="72,2" class="i method">VerifyLockState</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r35 rd" class="r35 r">lockId</span>, <a href="/Azure.Storage.Blobs/A.html#774c843d1f085d80" class="t t">LeaseState</a> <span id="r36 rd" class="r36 r">state</span>, <a href="/Azure.Storage.Blobs/A.html#ab11c19c91d77efa" class="t t">LeaseStatus</a> <span id="r37 rd" class="r37 r">status</span>)
            {
                <a href="/Azure.Storage.Blobs/A.html#6bb2c165ee95c7d4" class="k">var</a> <span id="r38 rd" class="r38 r">container</span> = <a href="#946244853aa0aee6" class="i property">BlobServiceClient</a>.<a href="/Azure.Storage.Blobs/A.html#e3b6b5726874c210" class="i method">GetBlobContainerClient</a>(<span class="s">&quot;azure-webjobs-hosts&quot;</span>);
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r39 rd" class="r39 r">blobName</span> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;locks/{0}/{1}&quot;</span>, <a href="#8bbd2cb7da6bd0bc" class="i property">HostId</a>, <span class="r35 r">lockId</span>);
                <a href="/Azure.Storage.Blobs/A.html#a021487ec216e15d" class="k">var</a> <span id="r40 rd" class="r40 r">lockBlob</span> = <span class="r38 r">container</span>.<a href="/Azure.Storage.Blobs/A.html#9212d86e1f5d0a57" class="i method">GetBlockBlobClient</a>(<span class="r39 r">blobName</span>);
 
                <span class="t t">Assert</span>.<span class="i method">True</span>(<b>await</b> <span class="r40 r">lockBlob</span>.<a href="/Azure.Storage.Blobs/A.html#9018aed3946a06b2" class="i method">ExistsAsync</a>());
                <a href="/Azure.Storage.Blobs/A.html#5eac1727e6cdaafb" class="t t">BlobProperties</a> <span id="r41 rd" class="r41 r">blobProperties</span> = <b>await</b> <span class="r40 r">lockBlob</span>.<a href="/Azure.Storage.Blobs/A.html#f0505a8f6a46fa3e" class="i method">GetPropertiesAsync</a>();
 
                <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r36 r">state</span>, <span class="r41 r">blobProperties</span>.<a href="/Azure.Storage.Blobs/A.html#d926548459cf49c0" class="i property">LeaseState</a>);
                <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r37 r">status</span>, <span class="r41 r">blobProperties</span>.<a href="/Azure.Storage.Blobs/A.html#0051f784de8e9e27" class="i property">LeaseStatus</a>);
            }
 
            <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="34b77ad9d07c58b3" href="R/34b77ad9d07c58b3.html" target="n" data-glyph="72,2" class="i method">DisposeAsync</a>()
            {
                <b>if</b> (<a href="#48d884c2ba2b3b7b" class="i property">Host</a> != <b>null</b>)
                {
                    <b>await</b> <a href="#48d884c2ba2b3b7b" class="i property">Host</a>.<span class="i method">StopAsync</span>();
 
                    <a href="#4bb231da5a0ae52b" class="i method">VerifyLockState</a>(<span class="s">&quot;WebJobs.Internal.Blobs.Listener&quot;</span>, <a href="/Azure.Storage.Blobs/A.html#774c843d1f085d80" class="t t">LeaseState</a>.<a href="/Azure.Storage.Blobs/A.html#9a8735890416d5dd" class="i field">Available</a>, <a href="/Azure.Storage.Blobs/A.html#ab11c19c91d77efa" class="t t">LeaseStatus</a>.<a href="/Azure.Storage.Blobs/A.html#4676199349264a63" class="i field">Unlocked</a>).<a href="@0@mscorlib/A.html#1bfe9e19e44f4cfa" class="i method">Wait</a>();
 
                    <b>await</b> <b>foreach</b> (<a href="/Azure.Storage.Blobs/A.html#51495ef18796e708" class="k">var</a> <span id="r42 rd" class="r42 r">testContainer</span> <b>in</b> <a href="#946244853aa0aee6" class="i property">BlobServiceClient</a>.<a href="/Azure.Storage.Blobs/A.html#410908aac5c5c65b" class="i method">GetBlobContainersAsync</a>(<span class="r43 r">prefix</span>: <a href="#e8ccc1917d08390b" class="i field">TestArtifactPrefix</a>))
                    {
                        <b>await</b> <a href="#946244853aa0aee6" class="i property">BlobServiceClient</a>.<a href="/Azure.Storage.Blobs/A.html#e3b6b5726874c210" class="i method">GetBlobContainerClient</a>(<span class="r42 r">testContainer</span>.<a href="/Azure.Storage.Blobs/A.html#93185e6245e64b03" class="i property">Name</a>).<a href="/Azure.Storage.Blobs/A.html#b11d61d501b05e52" class="i method">DeleteAsync</a>();
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a mock </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">IFunctionDataCache</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Mock </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">IFunctionDataCache</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="t t">Mock</span>&lt;<span class="t t">IFunctionDataCache</span>&gt; <a id="da79cdca1e513a8c" href="R/da79cdca1e513a8c.html" target="n" data-glyph="76,1" class="i method">CreateMockFunctionDataCache</a>()
        {
            <b>return</b> <b>new</b> <span class="t constructor">Mock</span>&lt;<span class="t t">IFunctionDataCache</span>&gt;(<span class="t t">MockBehavior</span>.<span class="i field">Strict</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a mock </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">SharedMemoryMetadata</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> describing a fake shared memory region.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Mock </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">SharedMemoryMetadata</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="t t">Mock</span>&lt;<span class="t t">SharedMemoryMetadata</span>&gt; <a id="bfe5b38f5c30266f" href="R/bfe5b38f5c30266f.html" target="n" data-glyph="76,1" class="i method">CreateMockSharedMemoryMetadata</a>()
        {
            <b>return</b> <b>new</b> <span class="t constructor">Mock</span>&lt;<span class="t t">SharedMemoryMetadata</span>&gt;(<span class="t t">MockBehavior</span>.<span class="i field">Strict</span>, <span class="s">&quot;mockname&quot;</span>, 10);
        }
    }
}
</pre></td></tr></table></div></body></html>
