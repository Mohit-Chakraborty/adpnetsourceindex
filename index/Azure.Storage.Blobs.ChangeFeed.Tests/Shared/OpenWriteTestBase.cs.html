<!DOCTYPE html>
<html><head><title>OpenWriteTestBase.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(619);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Storage.Blobs.ChangeFeed.Tests/Shared/OpenWriteTestBase.cs" target="_top">Shared\OpenWriteTestBase.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/storage/Azure.Storage.Common/tests/Shared/OpenWriteTestBase.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Storage.Blobs.ChangeFeed.Tests" target="_top">Azure.Storage.Blobs.ChangeFeed.Tests.csproj</a> (Azure.Storage.Blobs.ChangeFeed.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Test</span>.<span class="i n">Shared</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines service-agnostic tests for OpenRead() methods.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="64a5d24df323d927" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">OpenWriteTestBase</a>&lt;<span id="r0 rd t" class="r0 r t">TServiceClient</span>, <span id="r1 rd t" class="r1 r t">TContainerClient</span>, <span id="r2 rd t" class="r2 r t">TResourceClient</span>, <span id="r3 rd t" class="r3 r t">TClientOptions</span>, <span id="r4 rd t" class="r4 r t">TRequestConditions</span>, <span id="r5 rd t" class="r5 r t">TEnvironment</span>&gt; : <a href="../P/e65052d4973b0f19.html#e65052d4973b0f19" class="t t">StorageTestBase</a>&lt;<span class="r5 r t">TEnvironment</span>&gt;
        <b>where</b> <span class="r0 r t">TServiceClient</span> : <b>class
        where</b> <span class="r1 r t">TContainerClient</span> : <b>class
        where</b> <span class="r2 r t">TResourceClient</span> : <b>class
        where</b> <span class="r3 r t">TClientOptions</span> : <a href="/Azure.Core/A.html#8780afb4f9ef31a0" class="t t">ClientOptions</a>
        <b>where</b> <span class="r5 r t">TEnvironment</span> : <a href="StorageTestEnvironment.cs.html#44c664d475d08f1e" class="t t">StorageTestEnvironment</a>, <b>new</b>()
    {
        <b>public delegate</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="9072e201b89e598c" href="../R/9072e201b89e598c.html" target="n" data-glyph="12,1" class="t t"><span id="dd9e1c5c98ceec28">AdditionalTestAssertions</span></a>(<span class="r2 r t">TResourceClient</span> <span id="r6 rd" class="r6 r">client</span>);
 
        <b>public enum</b> <a id="f3e2dbb157fe8a56" href="../R/../../0000000000.html" target="n" data-glyph="18,1" class="t t"><span id="5ae2d5430f39eec0">ModifyDataMode</span></a>
        {
            <a id="8efe654b0485be24" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">None</a> = 0,
            <a id="2ada6302ab59ede2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Replace</a> = 1,
            <a id="5e682e6ff3fb2065" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Append</a> = 2
        };
 
        <b>private readonly string</b> <a id="adb2b90096e188e4" href="../R/adb2b90096e188e4.html" target="n" data-glyph="46,1" class="i field">_generatedResourceNamePrefix</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional assertions to be applied at the end of each test</span>
        <span class="c">///</span><span class="c"> to a client that has been written to through an OpenWrite call.</span>
        <span class="c">///</span><span class="c"> Not applicable to some tests.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a href="#9072e201b89e598c" class="t t">AdditionalTestAssertions</a> <a id="9ea477ed2fe33f4b" href="../R/9ea477ed2fe33f4b.html" target="n" data-glyph="45,1" class="i field">AdditionalAssertions</a>;
 
        <b>public</b> <a href="ClientBuilder.cs.html#9ac28a0da2719e0c" class="t t">ClientBuilder</a>&lt;<span class="r0 r t">TServiceClient</span>, <span class="r3 r t">TClientOptions</span>&gt; <a id="81808124cb6be542" href="../R/81808124cb6be542.html" target="n" data-glyph="102,1" class="i property">ClientBuilder</a> { <b>get</b>; <b>protected set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Supplies service-agnostic access conditions for tests.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="AccessConditionConfigs.cs.html#af4092fd714a6a20" class="t t">AccessConditionConfigs</a> <a id="e63200a78c3c0ff3" href="../R/e63200a78c3c0ff3.html" target="n" data-glyph="102,1" class="i property">Conditions</a> { <b>get</b>; }
 
        <b>public abstract string</b> <a id="59ae143c52db9242" href="../R/59ae143c52db9242.html" target="n" data-glyph="102,1" class="i property">ConditionNotMetErrorCode</a> { <b>get</b>; }
        <b>public abstract string</b> <a id="09587389bd4c35a8" href="../R/09587389bd4c35a8.html" target="n" data-glyph="102,1" class="i property">ContainerNotFoundErrorCode</a> { <b>get</b>; }
 
        <b>public</b> <a id="e553c82e0ab8b6da" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">OpenWriteTestBase</a>(
            <b>bool</b> <span id="r7 rd" class="r7 r">async</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r8 rd" class="r8 r">generatedResourceNamePrefix</span> = <b>default</b>,
            <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>? <span id="r9 rd" class="r9 r">mode</span> = <b>null</b>)
            : <a href="StorageTestBase.cs.html#f33f981e45c28ef0" class="k">base</a>(<span class="r7 r">async</span>, <span class="r9 r">mode</span>)
        {
            <a href="#adb2b90096e188e4" class="i field">_generatedResourceNamePrefix</a> = <span class="r8 r">generatedResourceNamePrefix</span> ?? <span class="s">&quot;test-resource-&quot;</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Service-Specific Methods
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a service-specific container client for use with tests in this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">service</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optionally specified service client to get container from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">containerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional container name specification.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected abstract</b> <span class="r1 r t">TContainerClient</span> <a id="e029226fdb117fd1" href="../R/e029226fdb117fd1.html" target="n" data-glyph="75,1" class="i method">GetUninitializedContainerClient</a>(
            <span class="r0 r t">TServiceClient</span> <span id="r10 rd" class="r10 r">service</span> = <b>default</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r11 rd" class="r11 r">containerName</span> = <b>default</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a service-specific disposing container for use with tests in this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">service</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optionally specified service client to get container from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">containerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional container name specification.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt;&gt; <a id="c9f06d37a106be1f" href="../R/c9f06d37a106be1f.html" target="n" data-glyph="75,1" class="i method">GetDisposingContainerAsync</a>(
            <span class="r0 r t">TServiceClient</span> <span id="r12 rd" class="r12 r">service</span> = <b>default</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r13 rd" class="r13 r">containerName</span> = <b>default</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a new service-specific resource client from a given container, e.g. a BlobClient from a</span>
        <span class="c">///</span><span class="c"> BlobContainerClient or a DataLakeFileClient from a DataLakeFileSystemClient.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">container</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Container to get resource from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">resourceLength</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sets the resource size in bytes, for resources that require this upfront.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">createResource</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Whether to call CreateAsync on the resource, if necessary.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">resourceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional name for the resource.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ClientOptions for the resource client.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected abstract</b> <span class="r2 r t">TResourceClient</span> <a id="8c4dd4a83f2819dd" href="../R/8c4dd4a83f2819dd.html" target="n" data-glyph="75,1" class="i method">GetResourceClient</a>(
            <span class="r1 r t">TContainerClient</span> <span id="r14 rd" class="r14 r">container</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r15 rd" class="r15 r">resourceName</span> = <b>default</b>,
            <span class="r3 r t">TClientOptions</span> <span id="r16 rd" class="r16 r">options</span> = <b>default</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calls the client&#39;s OpenWrite method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">client</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Client to call method on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">overwrite</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overwrite parameter of open write method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">maxDataSize</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional. Sets the total size of the resource on OpenWrite</span>
        <span class="c">///</span><span class="c"> if the resource type requires such a parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">bufferSize</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional. Internal buffer size of the write stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">conditions</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional. Request conditions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">metadata</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional. Metadata to set on resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">httpHeaders</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional. HTTP headers to set on resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">progressHandler</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional. Progress handler.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Task containing a write stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a>&gt; <a id="dc8db0f540eb29e4" href="../R/dc8db0f540eb29e4.html" target="n" data-glyph="75,1" class="i method">OpenWriteAsync</a>(
            <span class="r2 r t">TResourceClient</span> <span id="r17 rd" class="r17 r">client</span>,
            <b>bool</b> <span id="r18 rd" class="r18 r">overwrite</span>,
            <b>long</b>? <span id="r19 rd" class="r19 r">maxDataSize</span>,
            <b>int</b>? <span id="r20 rd" class="r20 r">bufferSize</span> = <b>default</b>,
            <span class="r4 r t">TRequestConditions</span> <span id="r21 rd" class="r21 r">conditions</span> = <b>default</b>,
            <a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r22 rd" class="r22 r">metadata</span> = <b>default</b>,
            <a href="HttpHeaderParameters.cs.html#894e0ca4ccf8bbf9" class="t t">HttpHeaderParameters</a> <span id="r23 rd" class="r23 r">httpHeaders</span> = <b>default</b>,
            <a href="@0@mscorlib/A.html#766adb700a2972f5" class="t t">IProgress</a>&lt;<b>long</b>&gt; <span id="r24 rd" class="r24 r">progressHandler</span> = <b>default</b>);
 
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="/System.Memory.Data/A.html#b41210c71e293f88" class="t t">BinaryData</a>&gt; <a id="d741da2ab6b57075" href="../R/d741da2ab6b57075.html" target="n" data-glyph="75,1" class="i method">DownloadAsync</a>(<span class="r2 r t">TResourceClient</span> <span id="r25 rd" class="r25 r">client</span>);
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5e36b8f456932581" href="../R/5e36b8f456932581.html" target="n" data-glyph="75,1" class="i method">ModifyAsync</a>(<span class="r2 r t">TResourceClient</span> <span id="r26 rd" class="r26 r">client</span>, <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r27 rd" class="r27 r">data</span>);
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a>&gt; <a id="de760f1dbd6ad114" href="../R/de760f1dbd6ad114.html" target="n" data-glyph="75,1" class="i method">GetPropertiesAsync</a>(<span class="r2 r t">TResourceClient</span> <span id="r28 rd" class="r28 r">client</span>);
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;&gt; <a id="a4c8b2803ca615b3" href="../R/a4c8b2803ca615b3.html" target="n" data-glyph="75,1" class="i method">GetMetadataAsync</a>(<span class="r2 r t">TResourceClient</span> <span id="r29 rd" class="r29 r">client</span>);
 
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="5f2b311a73d2ee13" href="../R/5f2b311a73d2ee13.html" target="n" data-glyph="75,1" class="i method">SetupLeaseAsync</a>(<span class="r2 r t">TResourceClient</span> <span id="r30 rd" class="r30 r">client</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r31 rd" class="r31 r">leaseId</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r32 rd" class="r32 r">garbageLeaseId</span>);
        <b>protected abstract</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="9831ac825aa98662" href="../R/9831ac825aa98662.html" target="n" data-glyph="75,1" class="i method">GetMatchConditionAsync</a>(<span class="r2 r t">TResourceClient</span> <span id="r33 rd" class="r33 r">client</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r34 rd" class="r34 r">match</span>);
        <b>protected abstract</b> <span class="r4 r t">TRequestConditions</span> <a id="ad35860b7182d66f" href="../R/ad35860b7182d66f.html" target="n" data-glyph="75,1" class="i method">BuildRequestConditions</a>(<a href="AccessConditionParameters.cs.html#892df7d423a148bc" class="t t">AccessConditionParameters</a> <span id="r35 rd" class="r35 r">parameters</span>, <b>bool</b> <span id="r36 rd" class="r36 r">lease</span> = <b>true</b>);
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>protected string</b> <a id="c5515762cf519098" href="../R/c5515762cf519098.html" target="n" data-glyph="75,1" class="i method">GetNewResourceName</a>()
            =&gt; <a href="#adb2b90096e188e4" class="i field">_generatedResourceNamePrefix</a> + <a href="#81808124cb6be542" class="i property">ClientBuilder</a>.<a href="ClientBuilder.cs.html#4244406d54b6540c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#b9828ff8817e7824" class="i property">Random</a>.<a href="/Azure.Core.TestFramework/A.html#d4b1f5d1badb844e" class="i method">NewGuid</a>();
 
        <b>private string</b> <a id="24e3ad10428975b0" href="../R/24e3ad10428975b0.html" target="n" data-glyph="76,1" class="i method">GetGarbageLeaseId</a>()
            =&gt; <a href="#81808124cb6be542" class="i property">ClientBuilder</a>.<a href="ClientBuilder.cs.html#4244406d54b6540c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#b9828ff8817e7824" class="i property">Random</a>.<a href="/Azure.Core.TestFramework/A.html#d4b1f5d1badb844e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Tests
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="abbfe7f54da1c762" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_NewBlob</a>()
        {
            <b>const int</b> <span id="r37 rd" class="r37 r">size</span> = 16 * <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
            <b>const int</b> <span id="r38 rd" class="r38 r">bufferSize</span> = <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
 
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r39 rd" class="r39 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r40 rd" class="r40 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r39 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <b>byte</b>[] <span id="r41 rd" class="r41 r">data</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<span class="r37 r">size</span>);
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r42 rd" class="r42 r">stream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(<span class="r40 r">client</span>, <span class="r18 r">overwrite</span>: <b>true</b>, <span class="r19 r">maxDataSize</span>: <span class="r37 r">size</span>, <span class="r20 r">bufferSize</span>: <span class="r38 r">bufferSize</span>))
            {
                <span class="c">// Act</span>
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r41 r">data</span>, 0, 512);
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r41 r">data</span>, 512, 1024);
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r41 r">data</span>, 1536, 2048);
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r41 r">data</span>, 3584, 77);
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r41 r">data</span>, 3661, 2066);
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r41 r">data</span>, 5727, 4096);
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r41 r">data</span>, 9823, 6561);
                <b>await</b> <span class="r42 r">stream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
            }
 
            <span class="c">// Assert</span>
            <b>byte</b>[] <span id="r43 rd" class="r43 r">dataResult</span> = (<b>await</b> <a href="#d741da2ab6b57075" class="i method">DownloadAsync</a>(<span class="r40 r">client</span>)).<a href="/System.Memory.Data/A.html#288a77b70eac3839" class="i method">ToArray</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r41 r">data</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r43 r">dataResult</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
            <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#59794893533f4fba" class="i method">AssertSequenceEqual</a>(<span class="r41 r">data</span>, <span class="r43 r">dataResult</span>);
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r40 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public virtual async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="8fe33b700d1a6772" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_WithIntermediateFlushes</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r44 rd" class="r44 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r45 rd" class="r45 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r44 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <span class="c">// Act</span>
            <b>const int</b> <span id="r46 rd" class="r46 r">a</span> = 100;
            <b>const int</b> <span id="r47 rd" class="r47 r">b</span> = 50;
            <b>const int</b> <span id="r48 rd" class="r48 r">c</span> = 25;
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r49 rd" class="r49 r">stream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(<span class="r45 r">client</span>, <span class="r19 r">maxDataSize</span>: <span class="r46 r">a</span> + <span class="r47 r">b</span> + <span class="r48 r">c</span>, <span class="r18 r">overwrite</span>: <b>true</b>))
            {
                <b>using</b> (<a href="@0@mscorlib/A.html#9e38cb1c84769eba" class="k">var</a> <span id="r50 rd" class="r50 r">writer</span> = <b>new</b> <a href="@0@mscorlib/A.html#09b3248bc80dc79b" class="t constructor">StreamWriter</a>(<span class="r49 r">stream</span>, <a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#65768102b7ace585" class="i property">ASCII</a>))
                {
                    <span class="r50 r">writer</span>.<a href="@0@mscorlib/A.html#715bd5de78456219" class="i method">Write</a>(<b>new</b> <a href="@0@mscorlib/A.html#a9c0ed613ffbd8ee" class="k">string</a>(<span class="s">&#39;A&#39;</span>, <span class="r46 r">a</span>));
                    <span class="r50 r">writer</span>.<a href="@0@mscorlib/A.html#4d8cd91791f0d47c" class="i method">Flush</a>();
 
                    <span class="r50 r">writer</span>.<a href="@0@mscorlib/A.html#715bd5de78456219" class="i method">Write</a>(<b>new</b> <a href="@0@mscorlib/A.html#a9c0ed613ffbd8ee" class="k">string</a>(<span class="s">&#39;B&#39;</span>, <span class="r47 r">b</span>));
                    <span class="r50 r">writer</span>.<a href="@0@mscorlib/A.html#4d8cd91791f0d47c" class="i method">Flush</a>();
 
                    <span class="r50 r">writer</span>.<a href="@0@mscorlib/A.html#715bd5de78456219" class="i method">Write</a>(<b>new</b> <a href="@0@mscorlib/A.html#a9c0ed613ffbd8ee" class="k">string</a>(<span class="s">&#39;C&#39;</span>, <span class="r48 r">c</span>));
                    <span class="r50 r">writer</span>.<a href="@0@mscorlib/A.html#4d8cd91791f0d47c" class="i method">Flush</a>();
                }
            }
 
            <span class="c">// Assert</span>
            <b>byte</b>[] <span id="r51 rd" class="r51 r">dataResult</span> = (<b>await</b> <a href="#d741da2ab6b57075" class="i method">DownloadAsync</a>(<span class="r45 r">client</span>)).<a href="/System.Memory.Data/A.html#288a77b70eac3839" class="i method">ToArray</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<b>new</b> <a href="@0@mscorlib/A.html#a9c0ed613ffbd8ee" class="k">string</a>(<span class="s">&#39;A&#39;</span>, 100) + <b>new</b> <a href="@0@mscorlib/A.html#a9c0ed613ffbd8ee" class="k">string</a>(<span class="s">&#39;B&#39;</span>, 50) + <b>new</b> <a href="@0@mscorlib/A.html#a9c0ed613ffbd8ee" class="k">string</a>(<span class="s">&#39;C&#39;</span>, 25), <a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#65768102b7ace585" class="i property">ASCII</a>.<a href="@0@mscorlib/A.html#7310c9cccfaecd17" class="i method">GetString</a>(<span class="r51 r">dataResult</span>));
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r45 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public virtual async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="69d720d2975fcc22" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_NewBlob_WithMetadata</a>()
        {
            <b>const int</b> <span id="r52 rd" class="r52 r">bufferSize</span> = <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
 
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r53 rd" class="r53 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r54 rd" class="r54 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r53 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r55 rd" class="r55 r">metadata</span> = <b>new</b> <a href="@0@mscorlib/A.html#bf6849e410b43c4c" class="t constructor">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;() { { <span class="s">&quot;testkey&quot;</span>, <span class="s">&quot;testvalue&quot;</span> } };
 
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r56 rd" class="r56 r">stream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r54 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>,
                <span class="r20 r">bufferSize</span>: <span class="r52 r">bufferSize</span>,
                <span class="r22 r">metadata</span>: <span class="r55 r">metadata</span>))
            {
                <span class="c">// Act</span>
                <b>await</b> <span class="r56 r">stream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
            }
 
            <span class="c">// Assert</span>
            <span class="t t">CollectionAssert</span>.<span class="i method">AreEqual</span>(<span class="r55 r">metadata</span>, <b>await</b> <a href="#a4c8b2803ca615b3" class="i method">GetMetadataAsync</a>(<span class="r54 r">client</span>));
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r54 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public virtual async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="2e6bafe4a10cd386" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_CreateEmptyBlob_WithMetadata</a>()
        {
            <b>const int</b> <span id="r57 rd" class="r57 r">bufferSize</span> = <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
 
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r58 rd" class="r58 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r59 rd" class="r59 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r58 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r60 rd" class="r60 r">metadata</span> = <b>new</b> <a href="@0@mscorlib/A.html#bf6849e410b43c4c" class="t constructor">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;() { { <span class="s">&quot;testkey&quot;</span>, <span class="s">&quot;testvalue&quot;</span> } };
 
            <span class="c">// Act</span>
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r61 rd" class="r61 r">stream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r59 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>,
                <span class="r20 r">bufferSize</span>: <span class="r57 r">bufferSize</span>,
                <span class="r22 r">metadata</span>: <span class="r60 r">metadata</span>))
            {
            }
 
            <span class="c">// Assert</span>
            <span class="t t">CollectionAssert</span>.<span class="i method">AreEqual</span>(<span class="r60 r">metadata</span>, <b>await</b> <a href="#a4c8b2803ca615b3" class="i method">GetMetadataAsync</a>(<span class="r59 r">client</span>));
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r59 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="ff04f5186fb2a10a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_NewBlob_WithHeaders</a>()
        {
            <b>const int</b> <span id="r62 rd" class="r62 r">bufferSize</span> = <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
 
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r63 rd" class="r63 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r64 rd" class="r64 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r63 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <span class="c">// don&#39;t have a service-agnostic type</span>
            <a href="HttpHeaderParameters.cs.html#894e0ca4ccf8bbf9" class="t t">HttpHeaderParameters</a> <span id="r65 rd" class="r65 r">headers</span> = <b>new</b> <a href="HttpHeaderParameters.cs.html#894e0ca4ccf8bbf9" class="t constructor">HttpHeaderParameters</a>
            {
                <a href="HttpHeaderParameters.cs.html#e5f18e5f3ad5012b" class="i property">ContentType</a> = <span class="s">&quot;application/json&quot;</span>,
                <a href="HttpHeaderParameters.cs.html#d71819cec68d42e7" class="i property">ContentLanguage</a> = <span class="s">&quot;en&quot;</span>,
            };
 
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r66 rd" class="r66 r">stream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r64 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>,
                <span class="r20 r">bufferSize</span>: <span class="r62 r">bufferSize</span>,
                <span class="r23 r">httpHeaders</span>: <span class="r65 r">headers</span>))
            {
                <span class="c">// Act</span>
                <b>await</b> <span class="r66 r">stream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
            }
 
            <span class="c">// Assert</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r67 rd" class="r67 r">response</span> = <b>await</b> <a href="#de760f1dbd6ad114" class="i method">GetPropertiesAsync</a>(<span class="r64 r">client</span>);
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r67 r">response</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#b9e2782d1af92ede" class="i method">TryGetValue</a>(<span class="s">&quot;Content-Type&quot;</span>, <b>out string</b> <span id="r68 rd" class="r68 r">downloadedContentType</span>));
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r65 r">headers</span>.<a href="HttpHeaderParameters.cs.html#e5f18e5f3ad5012b" class="i property">ContentType</a>, <span class="r68 r">downloadedContentType</span>);
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r67 r">response</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#b9e2782d1af92ede" class="i method">TryGetValue</a>(<span class="s">&quot;Content-Language&quot;</span>, <b>out string</b> <span id="r69 rd" class="r69 r">downloadedContentLanguage</span>));
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r65 r">headers</span>.<a href="HttpHeaderParameters.cs.html#d71819cec68d42e7" class="i property">ContentLanguage</a>, <span class="r69 r">downloadedContentLanguage</span>);
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r64 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d72a31e2d346e66d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_CreateEmptyBlob_WithHeaders</a>()
        {
            <b>const int</b> <span id="r70 rd" class="r70 r">bufferSize</span> = <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
 
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r71 rd" class="r71 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r72 rd" class="r72 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r71 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <a href="HttpHeaderParameters.cs.html#894e0ca4ccf8bbf9" class="t t">HttpHeaderParameters</a> <span id="r73 rd" class="r73 r">headers</span> = <b>new</b> <a href="HttpHeaderParameters.cs.html#894e0ca4ccf8bbf9" class="t constructor">HttpHeaderParameters</a>
            {
                <a href="HttpHeaderParameters.cs.html#e5f18e5f3ad5012b" class="i property">ContentType</a> = <span class="s">&quot;application/json&quot;</span>,
                <a href="HttpHeaderParameters.cs.html#d71819cec68d42e7" class="i property">ContentLanguage</a> = <span class="s">&quot;en&quot;</span>,
            };
 
            <span class="c">// Act</span>
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r74 rd" class="r74 r">stream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r72 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>,
                <span class="r20 r">bufferSize</span>: <span class="r70 r">bufferSize</span>,
                <span class="r23 r">httpHeaders</span>: <span class="r73 r">headers</span>))
            {
            }
 
            <span class="c">// Assert</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r75 rd" class="r75 r">response</span> = <b>await</b> <a href="#de760f1dbd6ad114" class="i method">GetPropertiesAsync</a>(<span class="r72 r">client</span>);
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r75 r">response</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#b9e2782d1af92ede" class="i method">TryGetValue</a>(<span class="s">&quot;Content-Type&quot;</span>, <b>out string</b> <span id="r76 rd" class="r76 r">downloadedContentType</span>));
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r73 r">headers</span>.<a href="HttpHeaderParameters.cs.html#e5f18e5f3ad5012b" class="i property">ContentType</a>, <span class="r76 r">downloadedContentType</span>);
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r75 r">response</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#b9e2782d1af92ede" class="i method">TryGetValue</a>(<span class="s">&quot;Content-Language&quot;</span>, <b>out string</b> <span id="r77 rd" class="r77 r">downloadedContentLanguage</span>));
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r73 r">headers</span>.<a href="HttpHeaderParameters.cs.html#d71819cec68d42e7" class="i property">ContentLanguage</a>, <span class="r77 r">downloadedContentLanguage</span>);
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r72 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="ba44c28408d82804" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_NewBlob_WithUsing</a>()
        {
            <b>const int</b> <span id="r78 rd" class="r78 r">bufferSize</span> = <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
 
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r79 rd" class="r79 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r80 rd" class="r80 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r79 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <b>byte</b>[] <span id="r81 rd" class="r81 r">data</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(16 * <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>);
 
            <span class="c">// Act</span>
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r82 rd" class="r82 r">stream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r80 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <span class="r81 r">data</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>,
                <span class="r20 r">bufferSize</span>: <span class="r78 r">bufferSize</span>))
            {
                <b>await</b> <span class="r82 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r81 r">data</span>, 0, 512);
                <b>await</b> <span class="r82 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r81 r">data</span>, 512, 1024);
                <b>await</b> <span class="r82 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r81 r">data</span>, 1536, 2048);
                <b>await</b> <span class="r82 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r81 r">data</span>, 3584, 77);
                <b>await</b> <span class="r82 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r81 r">data</span>, 3661, 2066);
                <b>await</b> <span class="r82 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r81 r">data</span>, 5727, 4096);
                <b>await</b> <span class="r82 r">stream</span>.<a href="@0@mscorlib/A.html#da66045de943643c" class="i method">WriteAsync</a>(<span class="r81 r">data</span>, 9823, 6561);
            }
 
            <span class="c">// Assert</span>
            <b>byte</b>[] <span id="r83 rd" class="r83 r">dataResult</span> = (<b>await</b> <a href="#d741da2ab6b57075" class="i method">DownloadAsync</a>(<span class="r80 r">client</span>)).<a href="/System.Memory.Data/A.html#288a77b70eac3839" class="i method">ToArray</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r81 r">data</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r83 r">dataResult</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
            <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#59794893533f4fba" class="i method">AssertSequenceEqual</a>(<span class="r81 r">data</span>, <span class="r83 r">dataResult</span>);
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r80 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c20419e19f4814f2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_Overwrite</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r84 rd" class="r84 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r85 rd" class="r85 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r84 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <b>byte</b>[] <span id="r86 rd" class="r86 r">originalData</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>);
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r87 rd" class="r87 r">originalStream</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r86 r">originalData</span>))
            {
                <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r88 rd" class="r88 r">openWriteStream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                    <span class="r85 r">client</span>,
                    <span class="r18 r">overwrite</span>: <b>true</b>,
                    <span class="r19 r">maxDataSize</span>: <span class="r86 r">originalData</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>))
                {
                    <b>await</b> <span class="r87 r">originalStream</span>.<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r88 r">openWriteStream</span>);
                }
            }
 
            <b>byte</b>[] <span id="r89 rd" class="r89 r">newData</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>);
            <b>using</b> <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r90 rd" class="r90 r">newStream</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r89 r">newData</span>);
 
            <span class="c">// Act</span>
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r91 rd" class="r91 r">openWriteStream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r85 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <span class="r89 r">newData</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>))
            {
                <b>await</b> <span class="r90 r">newStream</span>.<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r91 r">openWriteStream</span>);
                <b>await</b> <span class="r91 r">openWriteStream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
            }
 
            <span class="c">// Assert</span>
            <b>byte</b>[] <span id="r92 rd" class="r92 r">dataResult</span> = (<b>await</b> <a href="#d741da2ab6b57075" class="i method">DownloadAsync</a>(<span class="r85 r">client</span>)).<a href="/System.Memory.Data/A.html#288a77b70eac3839" class="i method">ToArray</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r89 r">newData</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r92 r">dataResult</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
            <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#59794893533f4fba" class="i method">AssertSequenceEqual</a>(<span class="r89 r">newData</span>, <span class="r92 r">dataResult</span>);
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r85 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="9ec573c57bf517d2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_AlternatingWriteAndFlush</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r93 rd" class="r93 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r94 rd" class="r94 r">name</span> = <a href="#c5515762cf519098" class="i method">GetNewResourceName</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r95 rd" class="r95 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r93 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>, <span class="r15 r">resourceName</span>: <span class="r94 r">name</span>);
 
            <b>byte</b>[] <span id="r96 rd" class="r96 r">data0</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(512);
            <b>byte</b>[] <span id="r97 rd" class="r97 r">data1</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(512);
            <b>using</b> <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r98 rd" class="r98 r">dataStream0</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r96 r">data0</span>);
            <b>using</b> <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r99 rd" class="r99 r">dataStream1</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r97 r">data1</span>);
            <b>byte</b>[] <span id="r100 rd" class="r100 r">expectedData</span> = <b>new</b> <b>byte</b>[<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>];
            <a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#1a86a6b8b02d0948" class="i method">Copy</a>(<span class="r96 r">data0</span>, <span class="r100 r">expectedData</span>, 512);
            <a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r97 r">data1</span>, 0, <span class="r100 r">expectedData</span>, 512, 512);
 
            <span class="c">// Act</span>
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r101 rd" class="r101 r">writeStream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r95 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <span class="r96 r">data0</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> + <span class="r97 r">data1</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>))
            {
                <b>await</b> <span class="r98 r">dataStream0</span>.<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r101 r">writeStream</span>);
                <b>await</b> <span class="r101 r">writeStream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
                <b>await</b> <span class="r99 r">dataStream1</span>.<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r101 r">writeStream</span>);
                <b>await</b> <span class="r101 r">writeStream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
            }
 
            <span class="c">// Assert</span>
            <b>byte</b>[] <span id="r102 rd" class="r102 r">dataResult</span> = (<b>await</b> <a href="#d741da2ab6b57075" class="i method">DownloadAsync</a>(<span class="r95 r">client</span>)).<a href="/System.Memory.Data/A.html#288a77b70eac3839" class="i method">ToArray</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r100 r">expectedData</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r102 r">dataResult</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
            <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#59794893533f4fba" class="i method">AssertSequenceEqual</a>(<span class="r100 r">expectedData</span>, <span class="r102 r">dataResult</span>);
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r95 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f400a55aefdc6700" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <span class="r2 r t">TResourceClient</span> <span id="r103 rd" class="r103 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<a href="#e029226fdb117fd1" class="i method">GetUninitializedContainerClient</a>());
 
            <span class="c">// Act</span>
            <b>await</b> <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(<span class="r103 r">client</span>, <span class="r18 r">overwrite</span>: <b>true</b>, <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>),
                <span id="r104 rd" class="r104 r">e</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="#09587389bd4c35a8" class="i property">ContainerNotFoundErrorCode</a>, <span class="r104 r">e</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public virtual async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7f67ed7c2e8fbfc7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_ModifiedDuringWrite</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r105 rd" class="r105 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r106 rd" class="r106 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r105 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <b>byte</b>[] <span id="r107 rd" class="r107 r">data</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>);
            <b>using</b> <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r108 rd" class="r108 r">stream</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r107 r">data</span>);
 
            <span class="c">// Act</span>
            <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r109 rd" class="r109 r">openWriteStream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(<span class="r106 r">client</span>, <span class="r18 r">overwrite</span>: <b>true</b>, <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>);
 
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r110 rd" class="r110 r">update</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>)))
            {
                <b>await</b> <a href="#5e36b8f456932581" class="i method">ModifyAsync</a>(<span class="r106 r">client</span>, <span class="r110 r">update</span>);
            }
 
            <b>await</b> <span class="r108 r">stream</span>.<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r109 r">openWriteStream</span>);
 
            <b>async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="98ec82fe3eac3add" href="../R/98ec82fe3eac3add.html" target="n" data-glyph="76,2" class="i method">CloseStream</a>()
            {
                <b>await</b> <span class="r109 r">openWriteStream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
                <span class="c">// dispose necessary for some stream implementations</span>
                <span class="r109 r">openWriteStream</span>.<a href="@0@mscorlib/A.html#f1b4285950a82354" class="i method">Dispose</a>();
            }
 
            <b>await</b> <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <a href="#98ec82fe3eac3add" class="i method">CloseStream</a>(),
                <span id="r111 rd" class="r111 r">e</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="#59ae143c52db9242" class="i property">ConditionNotMetErrorCode</a>, <span class="r111 r">e</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public virtual async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="216f11529d96a674" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_ProgressReporting</a>()
        {
            <b>const int</b> <span id="r112 rd" class="r112 r">bufferSize</span> = 512;
            <b>const int</b> <span id="r113 rd" class="r113 r">dataSize</span> = 2 * <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>;
 
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r114 rd" class="r114 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
            <span class="r2 r t">TResourceClient</span> <span id="r115 rd" class="r115 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r114 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
            <b>byte</b>[] <span id="r116 rd" class="r116 r">data</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<span class="r113 r">dataSize</span>);
            <b>using</b> <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r117 rd" class="r117 r">stream</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r116 r">data</span>);
 
            <a href="TestProgress.cs.html#22bc8eda4751212e" class="t t">TestProgress</a> <span id="r118 rd" class="r118 r">progress</span> = <b>new</b> <a href="TestProgress.cs.html#22bc8eda4751212e" class="t constructor">TestProgress</a>();
 
            <span class="c">// Act</span>
            <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r119 rd" class="r119 r">openWriteStream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                <span class="r115 r">client</span>,
                <span class="r18 r">overwrite</span>: <b>true</b>,
                <span class="r19 r">maxDataSize</span>: <span class="r116 r">data</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>,
                <span class="r20 r">bufferSize</span>: <span class="r112 r">bufferSize</span>,
                <span class="r24 r">progressHandler</span>: <span class="r118 r">progress</span>))
            {
                <b>await</b> <span class="r117 r">stream</span>.<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r119 r">openWriteStream</span>);
                <b>await</b> <span class="r119 r">openWriteStream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
            }
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r118 r">progress</span>.<a href="TestProgress.cs.html#71f6d39fbdbbbf36" class="i field">List</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r113 r">dataSize</span>, <span class="r118 r">progress</span>.<a href="TestProgress.cs.html#71f6d39fbdbbbf36" class="i field">List</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r118 r">progress</span>.<a href="TestProgress.cs.html#71f6d39fbdbbbf36" class="i field">List</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1]);
 
            <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r115 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3249b4c66872642b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_AccessConditions</a>()
        {
            <b>foreach</b> (<a href="AccessConditionParameters.cs.html#892df7d423a148bc" class="t t">AccessConditionParameters</a> <span id="r120 rd" class="r120 r">parameters</span> <b>in</b> <a href="#e63200a78c3c0ff3" class="i property">Conditions</a>.<a href="AccessConditionConfigs.cs.html#d2b01faad0355028" class="i property">AccessConditions_Data</a>)
            {
                <span class="c">// Arrange</span>
                <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r121 rd" class="r121 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
                <span class="r2 r t">TResourceClient</span> <span id="r122 rd" class="r122 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r121 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
                <span class="c">// initialize client with starter data</span>
                <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r123 rd" class="r123 r">dest</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                    <span class="r122 r">client</span>,
                    <span class="r18 r">overwrite</span>: <b>true</b>,
                    <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>))
                {
                    <b>await</b> <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>)).<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r123 r">dest</span>);
                    <b>await</b> <span class="r123 r">dest</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
                }
 
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r124 rd" class="r124 r">garbageLeaseId</span> = <a href="#24e3ad10428975b0" class="i method">GetGarbageLeaseId</a>();
                <span class="r120 r">parameters</span>.<a href="AccessConditionParameters.cs.html#97e54c519678e441" class="i property">Match</a> = <b>await</b> <a href="#9831ac825aa98662" class="i method">GetMatchConditionAsync</a>(<span class="r122 r">client</span>, <span class="r120 r">parameters</span>.<a href="AccessConditionParameters.cs.html#97e54c519678e441" class="i property">Match</a>);
                <span class="r120 r">parameters</span>.<a href="AccessConditionParameters.cs.html#af0faf1b7c1c85bd" class="i property">LeaseId</a> = <b>await</b> <a href="#5f2b311a73d2ee13" class="i method">SetupLeaseAsync</a>(<span class="r122 r">client</span>, <span class="r120 r">parameters</span>.<a href="AccessConditionParameters.cs.html#af0faf1b7c1c85bd" class="i property">LeaseId</a>, <span class="r124 r">garbageLeaseId</span>);
                <span class="r4 r t">TRequestConditions</span> <span id="r125 rd" class="r125 r">accessConditions</span> = <a href="#ad35860b7182d66f" class="i method">BuildRequestConditions</a>(<span class="r120 r">parameters</span>);
 
                <b>byte</b>[] <span id="r126 rd" class="r126 r">data</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>);
                <b>using</b> <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r127 rd" class="r127 r">stream</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r126 r">data</span>);
 
                <span class="c">// Act</span>
                <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r128 rd" class="r128 r">openWriteStream</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                    <span class="r122 r">client</span>,
                    <span class="r18 r">overwrite</span>: <b>true</b>,
                    <span class="r19 r">maxDataSize</span>: <span class="r126 r">data</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>,
                    <span class="r21 r">conditions</span>: <span class="r125 r">accessConditions</span>))
                {
                    <b>await</b> <span class="r127 r">stream</span>.<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r128 r">openWriteStream</span>);
                    <b>await</b> <span class="r128 r">openWriteStream</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
                }
 
                <span class="c">// Assert</span>
                <b>byte</b>[] <span id="r129 rd" class="r129 r">dataResult</span> = (<b>await</b> <a href="#d741da2ab6b57075" class="i method">DownloadAsync</a>(<span class="r122 r">client</span>)).<a href="/System.Memory.Data/A.html#288a77b70eac3839" class="i method">ToArray</a>();
                <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r126 r">data</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r129 r">dataResult</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
                <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#59794893533f4fba" class="i method">AssertSequenceEqual</a>(<span class="r126 r">data</span>, <span class="r129 r">dataResult</span>);
 
                <b>await</b> (<a href="#9ea477ed2fe33f4b" class="i field">AdditionalAssertions</a>?.<a href="#f01e0a861de2ec43" class="i method">Invoke</a>(<span class="r122 r">client</span>) ?? <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>);
            }
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public virtual async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="0e3e32fadaa57178" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OpenWriteAsync_AccessConditionsFail</a>()
        {
            <b>foreach</b> (<a href="AccessConditionParameters.cs.html#892df7d423a148bc" class="t t">AccessConditionParameters</a> <span id="r130 rd" class="r130 r">parameters</span> <b>in</b> <a href="#e63200a78c3c0ff3" class="i property">Conditions</a>.<a href="AccessConditionConfigs.cs.html#ca6240c905a04ea4" class="i property">AccessConditionsFail_Data</a>)
            {
                <span class="c">// Arrange</span>
                <b>await using</b> <a href="IDisposingContainer.cs.html#405e5034ec2c24c2" class="t t">IDisposingContainer</a>&lt;<span class="r1 r t">TContainerClient</span>&gt; <span id="r131 rd" class="r131 r">disposingContainer</span> = <b>await</b> <a href="#c9f06d37a106be1f" class="i method">GetDisposingContainerAsync</a>();
                <span class="r2 r t">TResourceClient</span> <span id="r132 rd" class="r132 r">client</span> = <a href="#8c4dd4a83f2819dd" class="i method">GetResourceClient</a>(<span class="r131 r">disposingContainer</span>.<a href="IDisposingContainer.cs.html#b28253e02da00ff5" class="i property">Container</a>);
 
                <span class="c">// initialize client with starter data</span>
                <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r133 rd" class="r133 r">dest</span> = <b>await</b> <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                    <span class="r132 r">client</span>,
                    <span class="r18 r">overwrite</span>: <b>true</b>,
                    <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>))
                {
                    <b>await</b> <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>)).<a href="@0@mscorlib/A.html#1ed7a6d41a19abf9" class="i method">CopyToAsync</a>(<span class="r133 r">dest</span>);
                    <b>await</b> <span class="r133 r">dest</span>.<a href="@0@mscorlib/A.html#cee1514a2782d81a" class="i method">FlushAsync</a>();
                }
 
                <span class="r130 r">parameters</span>.<a href="AccessConditionParameters.cs.html#146a11fcf54e2877" class="i property">NoneMatch</a> = <b>await</b> <a href="#9831ac825aa98662" class="i method">GetMatchConditionAsync</a>(<span class="r132 r">client</span>, <span class="r130 r">parameters</span>.<a href="AccessConditionParameters.cs.html#146a11fcf54e2877" class="i property">NoneMatch</a>);
                <span class="r4 r t">TRequestConditions</span> <span id="r134 rd" class="r134 r">accessConditions</span> = <a href="#ad35860b7182d66f" class="i method">BuildRequestConditions</a>(<span class="r130 r">parameters</span>);
 
                <b>byte</b>[] <span id="r135 rd" class="r135 r">data</span> = <a href="StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>);
                <b>using</b> <a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r136 rd" class="r136 r">stream</span> = <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>(<span class="r135 r">data</span>);
 
                <b>await</b> <a href="TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                    <a href="#dc8db0f540eb29e4" class="i method">OpenWriteAsync</a>(
                        <span class="r132 r">client</span>,
                        <span class="r18 r">overwrite</span>: <b>true</b>,
                        <span class="r19 r">maxDataSize</span>: <a href="/Azure.Storage.Blobs.ChangeFeed/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Blobs.ChangeFeed/A.html#4240fd6a2382c38e" class="i field">KB</a>,
                        <span class="r21 r">conditions</span>: <span class="r134 r">accessConditions</span>),
                    <span id="r137 rd" class="r137 r">e</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="#59ae143c52db9242" class="i property">ConditionNotMetErrorCode</a>, <span class="r137 r">e</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
