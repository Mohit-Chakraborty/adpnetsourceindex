<!DOCTYPE html>
<html><head><title>AuthToken.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(192);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.ContainerRegistry/Customizations/AuthToken.cs" target="_top">Customizations\AuthToken.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.ContainerRegistry" target="_top">src\Microsoft.Azure.ContainerRegistry.csproj</a> (Microsoft.Azure.ContainerRegistry)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>;
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IdentityModel</span>.<span class="i">Tokens</span>.<span class="i">Jwt</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>.<span class="i n">Http</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>.<span class="i n">Http</span>.<span class="i n">Headers</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">ContainerRegistry</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Simple authentication credentials class for use by local clients within Token classes.</span>
    <span class="c">///</span><span class="c"> i.e </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#bf7bab1327bc1769" class="t t">ContainerRegistryRefreshToken</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5cb89ef7a3af923b" class="t t">ContainerRegistryAccessToken</a><span class="c">&quot;</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="2923069fc4a191d8" href="../R/2923069fc4a191d8.html" target="n" data-glyph="2,0" class="t t">TokenCredentials</a> : <span class="i">ServiceClientCredentials</span>
    {
        <b>private string</b> <a id="6c3854cdebc3635f" href="../R/6c3854cdebc3635f.html" target="n" data-glyph="106,1" class="i property">_authHeader</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">/*To be used for General Login Scheme*/</span>
        <b>public</b> <a id="d849fdc64b9d0b0f" href="../R/d849fdc64b9d0b0f.html" target="n" data-glyph="72,1" class="t constructor">TokenCredentials</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">username</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">password</span>)
        {
            <a href="#6c3854cdebc3635f" class="i property">_authHeader</a> = <a href="Helpers.cs.html#18cb96c62256da5a" class="t t">Helpers</a>.<a href="Helpers.cs.html#707192a9415b4477" class="i method">EncodeTo64</a>(<span class="s">$&quot;</span>{<span class="r0 r">username</span>}<span class="s">:</span>{<span class="r1 r">password</span>}<span class="s">&quot;</span>);
        }
 
        <span class="c">/*To be used for exchanging AAD Tokens for ACR Tokens*/</span>
        <b>public</b> <a id="d8c1b06641aaef54" href="../R/d8c1b06641aaef54.html" target="n" data-glyph="72,1" class="t constructor">TokenCredentials</a>()
        {
            <a href="#6c3854cdebc3635f" class="i property">_authHeader</a> = <b>null</b>;
        }
 
        <b>public override async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="0f4f1278bd17ee28" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ProcessHttpRequestAsync</a>(<span class="t t">HttpRequestMessage</span> <span id="r2 rd" class="r2 r">request</span>, <a href="@0@mscorlib/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r3 rd" class="r3 r">cancellationToken</span>)
        {
            <b>if</b> (<span class="r2 r">request</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">request</span>));
            }
            <b>if</b> (<a href="#6c3854cdebc3635f" class="i property">_authHeader</a> != <b>null</b>)
            {
                <span class="r2 r">request</span>.<span class="i property">Headers</span>.<span class="i property">Authorization</span> = <b>new</b> <span class="t constructor">AuthenticationHeaderValue</span>(<span class="s">&quot;Basic&quot;</span>, <a href="#6c3854cdebc3635f" class="i property">_authHeader</a>);
            }
            <b>await</b> <b>base</b>.<span class="i">ProcessHttpRequestAsync</span>(<span class="r2 r">request</span>, <span class="r3 r">cancellationToken</span>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> AuthToken class for chaining token refreshes. It abstracts checking and refresh logic and allows for chained token refreshing.</span>
    <span class="c">///</span><span class="c"> See subclasses </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#bf7bab1327bc1769" class="t t">ContainerRegistryRefreshToken</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5cb89ef7a3af923b" class="t t">ContainerRegistryAccessToken</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> for more information</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="2788d4039e9785e1" href="../R/2788d4039e9785e1.html" target="n" data-glyph="0,0" class="t t">AuthToken</a>
    {
        <b>public delegate string</b> <a id="37075fcb67a8d5cf" href="../R/37075fcb67a8d5cf.html" target="n" data-glyph="12,1" class="t t"><span id="c212acdf3d187107">AcquireCallback</span></a>();
        <b>protected static readonly</b> <span class="i">JwtSecurityTokenHandler</span> <a id="e679cc0daafe237f" href="../R/e679cc0daafe237f.html" target="n" data-glyph="45,1" class="i field">JwtSecurityClient</a> = <b>new</b> <span class="i">JwtSecurityTokenHandler</span>();
 
        <span class="c">// Constant to refresh tokens slightly before they are to expire guarding against possible latency related crashes</span>
        <b>private readonly</b> <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="498deba4a29ebc12" href="../R/498deba4a29ebc12.html" target="n" data-glyph="46,1" class="i field">LatencySafety</a> = <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(2);
 
        <b>public string</b> <a id="afd904096931671a" href="../R/afd904096931671a.html" target="n" data-glyph="102,1" class="i property">Value</a> { <b>get</b>; <b>set</b>; }
        <b>public</b> <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a> <a id="a5f279b397dd920f" href="../R/a5f279b397dd920f.html" target="n" data-glyph="102,1" class="i property">Expiration</a> { <b>get</b>; <b>set</b>; }
        <b>protected</b> <a href="#37075fcb67a8d5cf" class="t t">AcquireCallback</a> <a id="2ce44e2393c3d192" href="../R/2ce44e2393c3d192.html" target="n" data-glyph="45,1" class="i field">RefreshFunction</a>;
 
        <b>public</b> <a id="a07d7680ee11da50" href="../R/a07d7680ee11da50.html" target="n" data-glyph="72,1" class="t constructor">AuthToken</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">token</span>)
        {
            <a href="#afd904096931671a" class="i property">Value</a> = <span class="r4 r">token</span>;
            <a href="#a5f279b397dd920f" class="i property">Expiration</a> = <a href="#e679cc0daafe237f" class="i field">JwtSecurityClient</a>.<span class="i">ReadToken</span>(<a href="#afd904096931671a" class="i property">Value</a>).<span class="i">ValidTo</span>;
        }
 
        <b>public</b> <a id="6c8ac7786fabb5c3" href="../R/6c8ac7786fabb5c3.html" target="n" data-glyph="72,1" class="t constructor">AuthToken</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r5 rd" class="r5 r">token</span>, <a href="#37075fcb67a8d5cf" class="t t">AcquireCallback</a> <span id="r6 rd" class="r6 r">refreshFunction</span>) : <a href="#a07d7680ee11da50" class="k">this</a>(<span class="r5 r">token</span>)
        {
            <a href="#2ce44e2393c3d192" class="i field">RefreshFunction</a> = <span class="r6 r">refreshFunction</span>;
        }
 
        <span class="c">//Extensibility purposes</span>
        <b>protected</b> <a id="4afbde8aa28283cb" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">AuthToken</a>() { }
 
 
        <span class="c">/* Returns true if refresh was successful. */</span>
        <b>public bool</b> <a id="928733b639800b9f" href="../R/928733b639800b9f.html" target="n" data-glyph="72,1" class="i method">Refresh</a>()
        {
            <b>if</b> (<a href="#2ce44e2393c3d192" class="i field">RefreshFunction</a> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
            <a href="#afd904096931671a" class="i property">Value</a> = <a href="#2ce44e2393c3d192" class="i field">RefreshFunction</a>();
            <a href="#a5f279b397dd920f" class="i property">Expiration</a> = <a href="#e679cc0daafe237f" class="i field">JwtSecurityClient</a>.<span class="i">ReadToken</span>(<a href="#afd904096931671a" class="i property">Value</a>).<span class="i">ValidTo</span>;
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public bool</b> <a id="ec8d1c1c3c2510ba" href="../R/ec8d1c1c3c2510ba.html" target="n" data-glyph="72,1" class="i method">NeedsRefresh</a>()
        {
            <b>return</b> <a href="#a5f279b397dd920f" class="i property">Expiration</a> &lt; <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#b0d5e4c9a8d4ddac" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#206dc137be8fee4b" class="i method">Add</a>(<a href="#498deba4a29ebc12" class="i field">LatencySafety</a>);
        }
 
        <span class="c">// Returns true if token is ready for use or false if token was expired and unable to refresh</span>
        <b>public bool</b> <a id="edaa91e1f136865f" href="../R/edaa91e1f136865f.html" target="n" data-glyph="72,1" class="i method">CheckAndRefresh</a>()
        {
            <b>if</b> (<a href="#ec8d1c1c3c2510ba" class="i method">NeedsRefresh</a>())
                <b>return</b> <a href="#928733b639800b9f" class="i method">Refresh</a>();
            <b>return</b> <b>true</b>;
        }
 
        <b>protected void</b> <a id="1a63469838fbbeb2" href="../R/1a63469838fbbeb2.html" target="n" data-glyph="75,1" class="i method">InitializeToken</a>(<a href="#37075fcb67a8d5cf" class="t t">AcquireCallback</a> <span id="r7 rd" class="r7 r">refreshFunction</span>)
        {
            <a href="#afd904096931671a" class="i property">Value</a> = <span class="r7 r">refreshFunction</span>();
            <a href="#a5f279b397dd920f" class="i property">Expiration</a> = <a href="#e679cc0daafe237f" class="i field">JwtSecurityClient</a>.<span class="i">ReadToken</span>(<a href="#afd904096931671a" class="i property">Value</a>).<span class="i">ValidTo</span>;
            <a href="#2ce44e2393c3d192" class="i field">RefreshFunction</a> = <span class="r7 r">refreshFunction</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An ACR refresh token that refreshes from an AAD access token. Provides built in token exchange functionality.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="bf7bab1327bc1769" href="../R/bf7bab1327bc1769.html" target="n" data-glyph="0,0" class="t t">ContainerRegistryRefreshToken</a> : <a href="#2788d4039e9785e1" class="t t">AuthToken</a>
    {
        <b>private</b> <a href="../P/452c83a914f45528.html#452c83a914f45528" class="t t">AzureContainerRegistryClient</a> <a id="1d207f9f8e991f3a" href="../R/1d207f9f8e991f3a.html" target="n" data-glyph="46,1" class="i field">authClient</a>;
        <b>public</b> <a id="0d08c74c7e71ce9f" href="../R/0d08c74c7e71ce9f.html" target="n" data-glyph="72,1" class="t constructor">ContainerRegistryRefreshToken</a>(<a href="#2788d4039e9785e1" class="t t">AuthToken</a> <span id="r8 rd" class="r8 r">aadToken</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">loginUrl</span>)
        {
            <span class="c">// setup refresh function to retrieve acrtoken with aadtoken</span>
            <a href="#1d207f9f8e991f3a" class="i field">authClient</a> = <b>new</b> <span class="t">AzureContainerRegistryClient</span>(<b>new</b> <a href="#d8c1b06641aaef54" class="t constructor">TokenCredentials</a>())
            {
                <a href="../Generated/AzureContainerRegistryClient.cs.html#bb08d848f9ecf348" class="i property">LoginUri</a> = <span class="s">$&quot;</span><span class="s">https://</span>{<span class="r9 r">loginUrl</span>}<span class="s">&quot;</span>
            };
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <a id="4c0cf8ebdbd17933" href="../R/4c0cf8ebdbd17933.html" target="n" data-glyph="76,2" class="i method">tempRefreshFunction</a>()
            {
                <span class="c">// Note: should be using real new access token</span>
                <span class="r8 r">aadToken</span>.<a href="#edaa91e1f136865f" class="i method">CheckAndRefresh</a>();
                <b>return</b> <a href="#1d207f9f8e991f3a" class="i field">authClient</a>.<a href="../Generated/AzureContainerRegistryClient.cs.html#e4f7d0d51386763c" class="i property">RefreshTokens</a>.<a href="../Generated/RefreshTokensOperationsExtensions.cs.html#e128659e760b9792" class="i method">GetFromExchangeAsync</a>(<span class="s">&quot;access_token&quot;</span>, <span class="r9 r">loginUrl</span>, <span class="s">&quot;&quot;</span>, <b>null</b>, <span class="r8 r">aadToken</span>.<a href="#afd904096931671a" class="i property">Value</a>).<a href="@0@mscorlib/A.html#e1d639f68b66715a" class="i method">GetAwaiter</a>().<a href="@0@mscorlib/A.html#c2597ba59f71d619" class="i method">GetResult</a>().<a href="../Generated/Models/RefreshToken.cs.html#ef9b0cb579681176" class="i property">RefreshTokenProperty</a>;
            }
 
            <span class="c">// initialize token and refresh function</span>
            <a href="#1a63469838fbbeb2" class="i method">InitializeToken</a>(<a href="#4c0cf8ebdbd17933" class="i method">tempRefreshFunction</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An ACR access token that refreshes from an ACR refresh token or username and password.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="5cb89ef7a3af923b" href="../R/5cb89ef7a3af923b.html" target="n" data-glyph="0,0" class="t t">ContainerRegistryAccessToken</a> : <a href="#2788d4039e9785e1" class="t t">AuthToken</a>
    {
        <b>private</b> <a href="../P/452c83a914f45528.html#452c83a914f45528" class="t t">AzureContainerRegistryClient</a> <a id="7e796837f051c07a" href="../R/7e796837f051c07a.html" target="n" data-glyph="46,1" class="i field">authClient</a>;
        <b>public string</b> <a id="e4e905edea459259" href="../R/e4e905edea459259.html" target="n" data-glyph="102,1" class="i property">Scope</a> { <b>get</b>; <b>set</b>; }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an ACR access token that refreshes from an ACR refresh token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">acrRefresh</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">loginUrl</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="20c787e8f75da9bd" href="../R/20c787e8f75da9bd.html" target="n" data-glyph="72,1" class="t constructor">ContainerRegistryAccessToken</a>(<a href="#bf7bab1327bc1769" class="t t">ContainerRegistryRefreshToken</a> <span id="r12 rd" class="r12 r">refreshToken</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">scope</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r11 rd" class="r11 r">loginUrl</span>)
        {
            <a href="#e4e905edea459259" class="i property">Scope</a> = <span class="r10 r">scope</span>;
            <a href="#7e796837f051c07a" class="i field">authClient</a> = <b>new</b> <span class="t">AzureContainerRegistryClient</span>(<b>new</b> <a href="#d8c1b06641aaef54" class="t constructor">TokenCredentials</a>())
            {
                <a href="../Generated/AzureContainerRegistryClient.cs.html#bb08d848f9ecf348" class="i property">LoginUri</a> = <span class="s">$&quot;</span><span class="s">https://</span>{<span class="r11 r">loginUrl</span>}<span class="s">&quot;</span>
            };
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <a id="b768b21c16333ad5" href="../R/b768b21c16333ad5.html" target="n" data-glyph="76,2" class="i method">tempRefreshFunction</a>()
            {
                <span class="r12 r">refreshToken</span>.<a href="#edaa91e1f136865f" class="i method">CheckAndRefresh</a>();
                <b>return</b> <a href="#7e796837f051c07a" class="i field">authClient</a>.<a href="../Generated/AzureContainerRegistryClient.cs.html#b643b394696fc356" class="i property">AccessTokens</a>.<a href="../Generated/AccessTokensOperationsExtensions.cs.html#bea8e15440728256" class="i method">GetAsync</a>(<span class="r11 r">loginUrl</span>, <span class="r10 r">scope</span>, <span class="r12 r">refreshToken</span>.<a href="#afd904096931671a" class="i property">Value</a>).<a href="@0@mscorlib/A.html#e1d639f68b66715a" class="i method">GetAwaiter</a>().<a href="@0@mscorlib/A.html#c2597ba59f71d619" class="i method">GetResult</a>().<a href="../Generated/Models/AccessToken.cs.html#b85f437b218207af" class="i property">AccessTokenProperty</a>;
            };
 
            <span class="c">// initialize token and refresh function</span>
            <a href="#1a63469838fbbeb2" class="i method">InitializeToken</a>(<a href="#b768b21c16333ad5" class="i method">tempRefreshFunction</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an ACR access token that refreshes from an ACR refresh token. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">username</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">password</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">loginUrl</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="681cee5755d29791" href="../R/681cee5755d29791.html" target="n" data-glyph="72,1" class="t constructor">ContainerRegistryAccessToken</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r13 rd" class="r13 r">username</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">password</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r15 rd" class="r15 r">scope</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r16 rd" class="r16 r">loginUrl</span>)
        {
            <a href="#e4e905edea459259" class="i property">Scope</a> = <span class="r15 r">scope</span>;
            <a href="#7e796837f051c07a" class="i field">authClient</a> = <b>new</b> <span class="t">AzureContainerRegistryClient</span>(<b>new</b> <a href="#d849fdc64b9d0b0f" class="t constructor">TokenCredentials</a>(<span class="r13 r">username</span>, <span class="r14 r">password</span>))
            {
                <a href="../Generated/AzureContainerRegistryClient.cs.html#bb08d848f9ecf348" class="i property">LoginUri</a> = <span class="s">$&quot;</span><span class="s">https://</span>{<span class="r16 r">loginUrl</span>}<span class="s">&quot;</span>
            };
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <a id="b768b21c16333ad5" href="../R/b768b21c16333ad5.html" target="n" data-glyph="76,2" class="i method">tempRefreshFunction</a>()
            {
                <b>return</b> <a href="#7e796837f051c07a" class="i field">authClient</a>.<a href="../Generated/AzureContainerRegistryClient.cs.html#b643b394696fc356" class="i property">AccessTokens</a>.<a href="../Generated/AccessTokensOperationsExtensions.cs.html#d7015f3881562566" class="i method">GetFromLoginAsync</a>(<span class="r16 r">loginUrl</span>, <span class="r15 r">scope</span>).<a href="@0@mscorlib/A.html#e1d639f68b66715a" class="i method">GetAwaiter</a>().<a href="@0@mscorlib/A.html#c2597ba59f71d619" class="i method">GetResult</a>().<a href="../Generated/Models/AccessToken.cs.html#b85f437b218207af" class="i property">AccessTokenProperty</a>;
            };
 
            <span class="c">// initialize token and refresh function</span>
            <a href="#1a63469838fbbeb2" class="i method">InitializeToken</a>(<a href="#b768b21c16333ad5" class="i method">tempRefreshFunction</a>);
        }
    }
}
 
 
</pre></td></tr></table></div></body></html>
