<!DOCTYPE html>
<html><head><title>AttestationToken.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(212);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Security.Attestation/AttestationToken.cs" target="_top">AttestationToken.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/attestation/Azure.Security.Attestation/src/AttestationToken.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Security.Attestation" target="_top">Azure.Security.Attestation.csproj</a> (Azure.Security.Attestation)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">Json</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Security</span>.<span class="i n">Cryptography</span>.<span class="i n">X509Certificates</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Security</span>.<span class="i n">Attestation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents an Attestation Token object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="fe59844e2c351bcf" href="R/fe59844e2c351bcf.html" target="n" data-glyph="0,0" class="t t">AttestationToken</a>
    {
        <b>protected private string</b> <a id="6470bbe9ad3e1a22" href="R/6470bbe9ad3e1a22.html" target="n" data-glyph="45,1" class="i field">_token</a>;
        <b>private</b> <span class="t t">JsonSerializerOptions</span> <a id="78b0f76cb0f27d49" href="R/78b0f76cb0f27d49.html" target="n" data-glyph="46,1" class="i field">_options</a> = <b>new</b> <span class="t constructor">JsonSerializerOptions</span>();
 
        <b>private object</b> <a id="b3276bbea4ab52a1" href="R/b3276bbea4ab52a1.html" target="n" data-glyph="46,1" class="i field">_deserializedBody</a>;
        <b>private object</b> <a id="ef4dd56a81bb8ac4" href="R/ef4dd56a81bb8ac4.html" target="n" data-glyph="46,1" class="i field">_statelock</a> = <b>new</b> <b>object</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#fe59844e2c351bcf" class="t t">AttestationToken</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">token</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">string JWT to initialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="23e0c37f55381f64" href="R/23e0c37f55381f64.html" target="n" data-glyph="74,1" class="t constructor">AttestationToken</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">token</span>)
        {
            <a href="#6470bbe9ad3e1a22" class="i field">_token</a> = <span class="r0 r">token</span>;
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>[] <span id="r1 rd" class="r1 r">decomposedToken</span> = <span class="r0 r">token</span>.<a href="@1@netstandard/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<span class="s">&#39;.&#39;</span>);
            <b>if</b> (<span class="r1 r">decomposedToken</span>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a> != 3)
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>(<span class="s">&quot;JSON Web Tokens must have 3 components delimited by &#39;.&#39; characters.&quot;</span>);
            }
            <a href="#120bea08946b4e17" class="i property">TokenHeaderBytes</a> = <a href="Shared/Base64Url.cs.html#d513fc35e4933439" class="t t">Base64Url</a>.<a href="Shared/Base64Url.cs.html#e4d686f215244ecd" class="i method">Decode</a>(<span class="r1 r">decomposedToken</span>[0]);
            <a href="#fc7c2e7cbc755662" class="i property">TokenBodyBytes</a> = <a href="Shared/Base64Url.cs.html#d513fc35e4933439" class="t t">Base64Url</a>.<a href="Shared/Base64Url.cs.html#e4d686f215244ecd" class="i method">Decode</a>(<span class="r1 r">decomposedToken</span>[1]);
            <a href="#f9bba601c50664cd" class="i property">TokenSignatureBytes</a> = <a href="Shared/Base64Url.cs.html#d513fc35e4933439" class="t t">Base64Url</a>.<a href="Shared/Base64Url.cs.html#e4d686f215244ecd" class="i method">Decode</a>(<span class="r1 r">decomposedToken</span>[2]);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Protected token for mocking.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="ad815cd78ff21e44" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">AttestationToken</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the thumbprint of the X.509 certificate which was used to verify the attestation token.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Null until the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#fe59844e2c351bcf" class="t t">AttestationToken</a>.<a href="#53037132946307cb" class="i method">ValidateToken</a>(<a href="@1@netstandard/A.html#b040fb780bdd59f4" class="t t">IReadOnlyList</a>{<a href="Models/AttestationSigner.cs.html#52699b74934bdfd6" class="t t">AttestationSigner</a>}, <a href="@1@netstandard/A.html#8adbe0476ca899db" class="t t">Func</a>{<a href="#fe59844e2c351bcf" class="t t">AttestationToken</a>, <a href="Models/AttestationSigner.cs.html#52699b74934bdfd6" class="t t">AttestationSigner</a>, <b>bool</b>})<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method has been called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="52a17ae5ad4c7be4" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decoded header for the attestation token. See https://tools.ietf.org/html/rfc7515 for more details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">ReadOnlyMemory</span>&lt;<b>byte</b>&gt; <a id="120bea08946b4e17" href="R/120bea08946b4e17.html" target="n" data-glyph="102,1" class="i property">TokenHeaderBytes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decoded body for the attestation token. See https://tools.ietf.org/html/rfc7515 for more details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">ReadOnlyMemory</span>&lt;<b>byte</b>&gt; <a id="fc7c2e7cbc755662" href="R/fc7c2e7cbc755662.html" target="n" data-glyph="102,1" class="i property">TokenBodyBytes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decoded signature for the attestation token. See https://tools.ietf.org/html/rfc7515 for more details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">ReadOnlyMemory</span>&lt;<b>byte</b>&gt; <a id="f9bba601c50664cd" href="R/f9bba601c50664cd.html" target="n" data-glyph="102,1" class="i property">TokenSignatureBytes</a> { <b>get</b>; }
 
        <span class="c">// Standard JSON Web Signature/Json Web Token header values.</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Json Web Token Header &quot;algorithm&quot;. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.1 for details.</span>
        <span class="c">///</span><span class="c"> If the value of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0fe01640a0be3c8d" class="i property">Algorithm</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is &quot;none&quot; it indicates that the token is unsecured.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="0fe01640a0be3c8d" href="R/0fe01640a0be3c8d.html" target="n" data-glyph="102,1" class="i property">Algorithm</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#57407bff8c7bfa69" class="i property">Algorithm</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Json Web Token Header &quot;type&quot;. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.9 for details.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If present, the value for this field is normally &quot;JWT&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="9dfab956f6e7f701" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Type</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#f166a2b0fa3627be" class="i property">Type</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Json Web Token Header &quot;content type&quot;. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.10 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="5d9570fdd7311519" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ContentType</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#05f6571f6ea5085f" class="i property">ContentType</a>; }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Json Web Token Header &quot;Key URL&quot;. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.2 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#991565dd25f47c90" class="t t">Uri</a> <a id="b1ca5bdc3ab0797c" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">KeyUrl</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#1b35b11aa8830887" class="i property">JWKUri</a>; }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Json Web Token Header &quot;Key ID&quot;. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.4 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="51b2ce3616333f48" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">KeyId</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#ad1ae2dc843aa5b6" class="i property">KeyId</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Json Web Token Header &quot;X509 URL&quot;. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.5 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#991565dd25f47c90" class="t t">Uri</a> <a id="93e86089184f641b" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">X509Url</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#0e719113097d4460" class="i property">X509Uri</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An array of X.509Certificates which represent a certificate chain used to sign the token. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.6 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#2e8ad9e6007798e5" class="t t">X509Certificate2</a>[] <a id="5a33da1f285f1c55" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">X509CertificateChain</a> {
            <b>get</b>
            {
                <a href="@1@netstandard/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@1@netstandard/A.html#2e8ad9e6007798e5" class="t t">X509Certificate2</a>&gt; <span id="r2 rd" class="r2 r">certificates</span> = <b>new</b> <a href="@1@netstandard/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="@1@netstandard/A.html#2e8ad9e6007798e5" class="t t">X509Certificate2</a>&gt;();
                <b>foreach</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r3 rd" class="r3 r">certificate</span> <b>in</b> <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#07b0edc1572a30de" class="i property">X509CertificateChain</a>)
                {
                    <span class="r2 r">certificates</span>.<a href="@1@netstandard/A.html#9cc11588bffd57c1" class="i method">Add</a>(<b>new</b> <a href="@1@netstandard/A.html#7f3801655ba19b82" class="t constructor">X509Certificate2</a>(<span class="r3 r">certificate</span>));
                }
                <b>return</b> <span class="r2 r">certificates</span>.<a href="@1@netstandard/A.html#d4409b7542728cec" class="i method">ToArray</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The &quot;thumbprint&quot; of the certificate used to sign the request. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.7 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="d1f8a9ea641c572c" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">X509CertificateThumbprint</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#9708173b562ed80e" class="i property">X509CertificateThumbprint</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The &quot;thumbprint&quot; of the certificate used to sign the request generated using the SHA256 algorithm. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.8 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="13f84d8bfe9e8ddf" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">X509CertificateSha256Thumbprint</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#b977263becdae2ec" class="i property">X509CertificateSha256Thumbprint</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Json Web TOken Header &quot;Critical&quot;. See https://www.rfc-editor.org/rfc/rfc7515.html#section-4.1.11 for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b>? <a id="732fa5fcd476c6ae" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Critical</a> { <b>get</b> =&gt; <a href="#102f81f6bca7e1dc" class="i property">Header</a>.<a href="Models/JsonWebTokenHeader.cs.html#e0db0434235ef220" class="i property">Critical</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the standard properties in the JSON Web Token header. See https://tools.ietf.org/html/rfc7515 for more details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Models/JsonWebTokenHeader.cs.html#dfb1ccc3e77ca1b3" class="t t">JsonWebTokenHeader</a> <a id="102f81f6bca7e1dc" href="R/102f81f6bca7e1dc.html" target="n" data-glyph="104,1" class="i property">Header</a> { <b>get</b> =&gt; <span class="t t">JsonSerializer</span>.<span class="i method">Deserialize</span>&lt;<a href="Models/JsonWebTokenHeader.cs.html#dfb1ccc3e77ca1b3" class="t t">JsonWebTokenHeader</a>&gt;(<a href="#120bea08946b4e17" class="i property">TokenHeaderBytes</a>.<span class="i method">ToArray</span>()); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the standard properties in the JSON Web Token header. See https://tools.ietf.org/html/rfc7515 for more details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="Models/JsonWebTokenBody.cs.html#4dc10a394805d88f" class="t t">JsonWebTokenBody</a> <a id="75f090098da859d4" href="R/75f090098da859d4.html" target="n" data-glyph="106,1" class="i property">Payload</a> { <b>get</b> =&gt; <span class="t t">JsonSerializer</span>.<span class="i method">Deserialize</span>&lt;<a href="Models/JsonWebTokenBody.cs.html#4dc10a394805d88f" class="t t">JsonWebTokenBody</a>&gt;(<a href="#fc7c2e7cbc755662" class="i property">TokenBodyBytes</a>.<span class="i method">ToArray</span>()); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Expiration time for the token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <a id="4794edf81fd0cd80" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ExpirationTime</a> { <b>get</b> =&gt; <a href="@1@netstandard/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>.<a href="@1@netstandard/A.html#cecc3d3dbb191a54" class="i method">FromUnixTimeSeconds</a>(<a href="#75f090098da859d4" class="i property">Payload</a>.<a href="Models/JsonWebTokenBody.cs.html#1de5046d20d125b6" class="i property">ExpirationTime</a>); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Time before which this token is not valid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <a id="b152cf38b91fc04e" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NotBeforeTime</a> { <b>get</b> =&gt; <a href="@1@netstandard/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>.<a href="@1@netstandard/A.html#cecc3d3dbb191a54" class="i method">FromUnixTimeSeconds</a>(<a href="#75f090098da859d4" class="i property">Payload</a>.<a href="Models/JsonWebTokenBody.cs.html#d137e1a93707af5f" class="i property">NotBeforeTime</a>); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Time at which this token was issued.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <a id="ff10f40733375384" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IssuedAtTime</a> { <b>get</b> =&gt; <a href="@1@netstandard/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>.<a href="@1@netstandard/A.html#cecc3d3dbb191a54" class="i method">FromUnixTimeSeconds</a>(<a href="#75f090098da859d4" class="i property">Payload</a>.<a href="Models/JsonWebTokenBody.cs.html#b02dc8c059e82fb8" class="i property">IssuedAtTime</a>); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents the body of the token encoded as a string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="66a76bf06b2e2675" href="R/66a76bf06b2e2675.html" target="n" data-glyph="102,1" class="i property">TokenBody</a>  { <b>get</b> =&gt; <a href="@1@netstandard/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@netstandard/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@1@netstandard/A.html#7310c9cccfaecd17" class="i method">GetString</a>(<a href="#fc7c2e7cbc755662" class="i property">TokenBodyBytes</a>.<span class="i method">ToArray</span>()); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents the body of the token encoded as a string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="11f0681b2ace6882" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">TokenHeader</a> { <b>get</b> =&gt; <a href="@1@netstandard/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@netstandard/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@1@netstandard/A.html#7310c9cccfaecd17" class="i method">GetString</a>(<a href="#120bea08946b4e17" class="i property">TokenHeaderBytes</a>.<span class="i method">ToArray</span>()); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate a JSON Web Token returned by the MAA.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">attestationSigningCertificates</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Signing Certificates used to validate the token.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">validationCallback</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">User provided callback which allows the customer to validate the token.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="53037132946307cb" href="R/53037132946307cb.html" target="n" data-glyph="72,1" class="i method">ValidateToken</a>(<a href="@1@netstandard/A.html#b040fb780bdd59f4" class="t t">IReadOnlyList</a>&lt;<a href="Models/AttestationSigner.cs.html#52699b74934bdfd6" class="t t">AttestationSigner</a>&gt; <span id="r4 rd" class="r4 r">attestationSigningCertificates</span>, <a href="@1@netstandard/A.html#8adbe0476ca899db" class="t t">Func</a>&lt;<a href="#fe59844e2c351bcf" class="t t">AttestationToken</a>, <a href="Models/AttestationSigner.cs.html#52699b74934bdfd6" class="t t">AttestationSigner</a>, <b>bool</b>&gt; <span id="r5 rd" class="r5 r">validationCallback</span> = <b>default</b>)
        {
            <a href="Shared/Argument.cs.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="Shared/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r4 r">attestationSigningCertificates</span>, <b>nameof</b>(<span class="r4 r">attestationSigningCertificates</span>));
            <a href="Shared/Argument.cs.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="Shared/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r4 r">attestationSigningCertificates</span>[0], <b>nameof</b>(<span class="r4 r">attestationSigningCertificates</span>));
            <a href="Shared/Argument.cs.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="Shared/Argument.cs.html#408b501e5063a00a" class="i method">AssertNotNullOrEmpty</a>(<span class="r4 r">attestationSigningCertificates</span>, <b>nameof</b>(<span class="r4 r">attestationSigningCertificates</span>));
 
            <b>if</b> (<span class="r5 r">validationCallback</span> != <b>null</b>)
            {
                <b>return</b> <span class="r5 r">validationCallback</span>(<a href="#fe59844e2c351bcf" class="k">this</a>, <span class="r4 r">attestationSigningCertificates</span>[0]);
            }
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the body of the AttestationToken as the specified type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Underlying type for the token body.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="r6 r t">T</span> <a id="8cd93a322ee575d5" href="R/8cd93a322ee575d5.html" target="n" data-glyph="72,1" class="i method">GetBody</a>&lt;<span id="r6 rd t" class="r6 r t">T</span>&gt;()
            <b>where</b> <span class="r6 r t">T</span>: <b>class</b>
        {
            <b>lock</b> (<a href="#ef4dd56a81bb8ac4" class="i field">_statelock</a>)
            {
                <b>if</b> (<a href="#b3276bbea4ab52a1" class="i field">_deserializedBody</a> == <b>null</b> || <a href="#b3276bbea4ab52a1" class="i field">_deserializedBody</a>.<a href="@1@netstandard/A.html#4d73eb225aef8a61" class="i method">GetType</a>() != <b>typeof</b>(<span class="r6 r t">T</span>))
                {
                    <a href="#b3276bbea4ab52a1" class="i field">_deserializedBody</a> = <span class="t t">JsonSerializer</span>.<span class="i method">Deserialize</span>&lt;<span class="r6 r t">T</span>&gt;(<a href="#fc7c2e7cbc755662" class="i property">TokenBodyBytes</a>.<span class="i method">ToArray</span>(), <a href="#78b0f76cb0f27d49" class="i field">_options</a>);
                }
                <b>return</b> (<span class="r6 r t">T</span>)<a href="#b3276bbea4ab52a1" class="i field">_deserializedBody</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">inheritdoc</span><span class="c">/&gt;</span>
        <b>public override string</b> <a id="60b26ef333128ae4" href="R/60b26ef333128ae4.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#6470bbe9ad3e1a22" class="i field">_token</a> ??  <a href="@1@netstandard/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@1@netstandard/A.html#aa4f112f79364b6e" class="i property">Name</a>;
        }
    }
}
</pre></td></tr></table></div></body></html>
