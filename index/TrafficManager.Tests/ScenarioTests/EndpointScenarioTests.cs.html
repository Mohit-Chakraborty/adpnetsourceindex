<!DOCTYPE html>
<html><head><title>EndpointScenarioTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(74);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#TrafficManager.Tests/ScenarioTests/EndpointScenarioTests.cs" target="_top">ScenarioTests\EndpointScenarioTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#TrafficManager.Tests" target="_top">tests\Microsoft.Azure.Management.TrafficManager.Tests.csproj</a> (TrafficManager.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">TrafficManager</span>.<span class="i n">Testing</span>.<span class="i n">ScenarioTests</span>
{
    <b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
    <b>using global</b>::<span class="i n">TrafficManager</span>.<span class="i n">Tests</span>.<span class="i n">Helpers</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i">Resources</span>.<span class="i">Models</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">TrafficManager</span>.<span class="i n">Models</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">TrafficManager</span>.<span class="i n">Testing</span>.<span class="i n">Helpers</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>.<span class="i">ClientRuntime</span>.<span class="i">Azure</span>.<span class="i">TestFramework</span>;
    <b>using</b> <span class="i">Xunit</span>;
 
    <b>public class</b> <a id="c4dc7d9f776afceb" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="024ebdcc02433668">EndpointScenarioTests</span></a> : <span class="i">TestBase</span>
    {
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="63e49465836dbf9b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CrudEndpointGeographicProfile</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r0 rd" class="r0 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#c4dc7d9f776afceb" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="/Microsoft.Azure.Management.TrafficManager/A.html#979b63941839ef92" class="t t">TrafficManagerManagementClient</a> <span id="r1 rd" class="r1 r">trafficManagerClient</span> = <a href="#c4dc7d9f776afceb" class="k">this</a>.<span class="i">GetTrafficManagerManagementClient</span>(<span class="r0 r">context</span>);
 
                <b>string</b> <span id="r2 rd" class="r2 r">resourceGroupName</span> = <a href="../Helpers/TrafficManagerHelper.cs.html#3b229d01a867d8b5" class="t t">TrafficManagerHelper</a>.<a href="../Helpers/TrafficManagerHelper.cs.html#8a288bf4c1c85e10" class="i method">GenerateName</a>();
                <b>string</b> <span id="r3 rd" class="r3 r">profileName</span> = <a href="../Helpers/TrafficManagerHelper.cs.html#3b229d01a867d8b5" class="t t">TrafficManagerHelper</a>.<a href="../Helpers/TrafficManagerHelper.cs.html#8a288bf4c1c85e10" class="i method">GenerateName</a>();
                <span class="i">ResourceGroup</span> <span id="r4 rd" class="r4 r">resourceGroup</span> = <a href="#c4dc7d9f776afceb" class="k">this</a>.<span class="i">CreateResourceGroup</span>(<span class="r0 r">context</span>, <span class="r2 r">resourceGroupName</span>);
 
                <span class="c">// Create the profile</span>
                <a href="/Microsoft.Azure.Management.TrafficManager/A.html#8def0b6c2bea21cd" class="t t">Profile</a> <span id="r5 rd" class="r5 r">profile</span> = <span class="r1 r">trafficManagerClient</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#54f3d9ae1e93fb56" class="i property">Profiles</a>.<span class="i">CreateOrUpdate</span>(
                    <span class="r4 r">resourceGroup</span>.<span class="i">Name</span>,
                    <span class="r3 r">profileName</span>,
                    <a href="../Helpers/TrafficManagerHelper.cs.html#3b229d01a867d8b5" class="t t">TrafficManagerHelper</a>.<a href="../Helpers/TrafficManagerHelper.cs.html#6b96a99d6a6fa273" class="i method">GenerateDefaultEmptyProfile</a>(<span class="r3 r">profileName</span>, <span class="s">&quot;Geographic&quot;</span>));
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Geographic&quot;</span>, <span class="r5 r">profile</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#20766f90bfba3ad1" class="i property">TrafficRoutingMethod</a>);
 
                <a href="/Microsoft.Azure.Management.TrafficManager/A.html#96117c95c3c70da2" class="t t">Endpoint</a> <span id="r6 rd" class="r6 r">endpoint</span> = <b>new</b> <span class="t">Endpoint</span>(
                    <b>null</b>,
                    <span class="s">&quot;My external endpoint&quot;</span>,
                    <span class="s">&quot;Microsoft.Network/trafficManagerProfiles/ExternalEndpoints&quot;</span>);
                <span class="r6 r">endpoint</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#9cb39419972229af" class="i property">TargetResourceId</a> = <b>null</b>;
                <span class="r6 r">endpoint</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#cb762a8d453bed84" class="i property">Target</a> = <span class="s">&quot;foobar.contoso.com&quot;</span>;
                <span class="r6 r">endpoint</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#c535c31ae02f6387" class="i property">EndpointStatus</a> = <span class="s">&quot;Enabled&quot;</span>;
                <span class="r6 r">endpoint</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#2ddc0dd46217a5e0" class="i property">GeoMapping</a> = <b>new</b>[] { <span class="s">&quot;GEO-AS&quot;</span>, <span class="s">&quot;GEO-AF&quot;</span> };
 
                <span class="c">// Create the endpoint</span>
                <a href="/Microsoft.Azure.Management.TrafficManager/A.html#96117c95c3c70da2" class="t t">Endpoint</a> <span id="r7 rd" class="r7 r">createEndpointResponse</span> = <span class="r1 r">trafficManagerClient</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#1472b7bb3c06d831" class="i property">Endpoints</a>.<span class="i">CreateOrUpdate</span>(
                    <span class="r4 r">resourceGroup</span>.<span class="i">Name</span>,
                    <span class="r3 r">profileName</span>,
                    <span class="s">&quot;ExternalEndpoints&quot;</span>,
                    <span class="r6 r">endpoint</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#73ce3fa3562e8c85" class="i property">Name</a>,
                    <span class="r6 r">endpoint</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;GEO-AS&quot;</span>, <span class="r7 r">createEndpointResponse</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#2ddc0dd46217a5e0" class="i property">GeoMapping</a>[0]);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;GEO-AF&quot;</span>, <span class="r7 r">createEndpointResponse</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#2ddc0dd46217a5e0" class="i property">GeoMapping</a>[1]);
 
                <span class="c">// Get the endpoint</span>
                <a href="/Microsoft.Azure.Management.TrafficManager/A.html#96117c95c3c70da2" class="t t">Endpoint</a> <span id="r8 rd" class="r8 r">endpointGetResponse</span> = <span class="r1 r">trafficManagerClient</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#1472b7bb3c06d831" class="i property">Endpoints</a>.<span class="i">Get</span>(
                    <span class="r4 r">resourceGroup</span>.<span class="i">Name</span>,
                    <span class="r3 r">profileName</span>,
                    <span class="s">&quot;ExternalEndpoints&quot;</span>,
                    <span class="r6 r">endpoint</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#73ce3fa3562e8c85" class="i property">Name</a>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;GEO-AS&quot;</span>, <span class="r8 r">endpointGetResponse</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#2ddc0dd46217a5e0" class="i property">GeoMapping</a>[0]);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;GEO-AF&quot;</span>, <span class="r8 r">endpointGetResponse</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#2ddc0dd46217a5e0" class="i property">GeoMapping</a>[1]);
 
                <span class="c">// Delete the profile</span>
                <span class="r1 r">trafficManagerClient</span>.<a href="/Microsoft.Azure.Management.TrafficManager/A.html#54f3d9ae1e93fb56" class="i property">Profiles</a>.<span class="i">Delete</span>(<span class="r4 r">resourceGroup</span>.<span class="i">Name</span>, <span class="r3 r">profileName</span>);
                <a href="#c4dc7d9f776afceb" class="k">this</a>.<span class="i">DeleteResourceGroup</span>(<span class="r0 r">context</span>, <span class="r2 r">resourceGroupName</span>);
            }
        }
    }
}
 
</pre></td></tr></table></div></body></html>
