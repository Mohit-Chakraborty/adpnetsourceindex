<!DOCTYPE html>
<html><head><title>Program.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(50);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#GarbageCollector/Program.cs" target="_top">Program.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master//samples/CloudClipboard/GarbageCollector/Program.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#GarbageCollector" target="_top">GarbageCollector.csproj</a> (GarbageCollector)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">Pipeline</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Identity</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>.<span class="i n">Models</span>;
 
<b>namespace</b> <span class="i n">GarbageCollector</span>
{
    <b>public static class</b> <a id="fb69c9cf50c8397b" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">Program</a>
    {
        <b>private static readonly</b> <a href="@1@System.Runtime/A.html#991565dd25f47c90" class="t t">Uri</a> <a id="fdb5c3221331653f" href="R/fdb5c3221331653f.html" target="n" data-glyph="46,1" class="i field">BlobServiceUri</a> = <b>new</b> <a href="@1@System.Runtime/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;https://cloudclips.blob.core.windows.net/&quot;</span>);
 
        <b>public static async</b> <a href="@1@System.Runtime/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="374f3e82224f8294" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Main</a>()
        {
            <a href="/Azure.Storage.Blobs/A.html#2a694af9228b837c" class="t t">BlobClientOptions</a> <span id="r0 rd" class="r0 r">options</span> = <b>new</b> <a href="/Azure.Storage.Blobs/A.html#5d4c62c639f0fccb" class="t constructor">BlobClientOptions</a>();
            <span class="r0 r">options</span>.<a href="/Azure.Core/A.html#4e89db28e0273a49" class="i property">Retry</a>.<a href="/Azure.Core/A.html#d425589fdc59b38b" class="i property">MaxRetries</a> = 10;
            <span class="r0 r">options</span>.<a href="/Azure.Core/A.html#4e89db28e0273a49" class="i property">Retry</a>.<a href="/Azure.Core/A.html#9015c66ddc06fc12" class="i property">Delay</a> = <a href="@1@System.Runtime/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@1@System.Runtime/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(3);
            <span class="r0 r">options</span>.<a href="/Azure.Core/A.html#474c2d6954521438" class="i property">Diagnostics</a>.<a href="/Azure.Core/A.html#05e65f43ee77d43b" class="i property">IsLoggingEnabled</a> = <b>true</b>;
 
            <span class="r0 r">options</span>.<a href="/Azure.Core/A.html#9f0a7ff3a06072c8" class="i method">AddPolicy</a>(<b>new</b> <a href="#00db0b7d60549f0a" class="t constructor">SimpleTracingPolicy</a>(), <a href="/Azure.Core/A.html#94ec96b92b26ad43" class="t t">HttpPipelinePosition</a>.<a href="/Azure.Core/A.html#e88e4f922d2a2ed8" class="i field">PerCall</a>);
 
            <a href="/Azure.Storage.Blobs/A.html#5c3c4fe54cdb5868" class="t t">BlobServiceClient</a> <span id="r1 rd" class="r1 r">serviceClient</span> = <b>new</b> <a href="/Azure.Storage.Blobs/A.html#7b70b07883e557d3" class="t constructor">BlobServiceClient</a>(<a href="#fdb5c3221331653f" class="i field">BlobServiceUri</a>, <b>new</b> <a href="/Azure.Identity/A.html#ebe3cac3c2be1903" class="t constructor">DefaultAzureCredential</a>(), <span class="r0 r">options</span>);
            <b>await</b> <b>foreach</b> (<a href="/Azure.Storage.Blobs/A.html#51495ef18796e708" class="t t">BlobContainerItem</a> <span id="r2 rd" class="r2 r">container</span> <b>in</b> <span class="r1 r">serviceClient</span>.<a href="/Azure.Storage.Blobs/A.html#410908aac5c5c65b" class="i method">GetBlobContainersAsync</a>())
            {
                <a href="/Azure.Storage.Blobs/A.html#6bb2c165ee95c7d4" class="t t">BlobContainerClient</a> <span id="r3 rd" class="r3 r">containerClient</span> = <span class="r1 r">serviceClient</span>.<a href="/Azure.Storage.Blobs/A.html#e3b6b5726874c210" class="i method">GetBlobContainerClient</a>(<span class="r2 r">container</span>.<a href="/Azure.Storage.Blobs/A.html#93185e6245e64b03" class="i property">Name</a>);
                <b>await</b> <span class="r3 r">containerClient</span>.<a href="/Azure.Storage.Blobs/A.html#b11d61d501b05e52" class="i method">DeleteAsync</a>();
            }
        }
    }
 
    <b>public class</b> <a id="00db0b7d60549f0a" href="R/00db0b7d60549f0a.html" target="n" data-glyph="0,0" class="t t"><span id="06f3b9035decc073">SimpleTracingPolicy</span></a> : <a href="/Azure.Core/A.html#afce2b8855e35f1f" class="t t">HttpPipelinePolicy</a>
    {
        <b>public override async</b> <a href="@1@System.Runtime/A.html#001d610aba2df461" class="t t">ValueTask</a> <a id="a2497c61f3c82fb5" href="R/a2497c61f3c82fb5.html" target="n" data-glyph="72,1" class="i method">ProcessAsync</a>(<a href="/Azure.Core/A.html#0d3a69186ac45549" class="t t">HttpMessage</a> <span id="r4 rd" class="r4 r">message</span>, <a href="@1@System.Runtime/A.html#439b47ca0dfb4b1c" class="t t">ReadOnlyMemory</a>&lt;<a href="/Azure.Core/A.html#afce2b8855e35f1f" class="t t">HttpPipelinePolicy</a>&gt; <span id="r5 rd" class="r5 r">pipeline</span>)
        {
            <span class="t t">Console</span>.<span class="i method">WriteLine</span>(<span class="s">$&quot;</span><span class="s">&gt;&gt; Request: </span>{<span class="r4 r">message</span>.<a href="/Azure.Core/A.html#34fe7bc5cf4f67d5" class="i property">Request</a>.<a href="/Azure.Core/A.html#38781a2f20c88339" class="i property">Method</a>}<span class="s"> </span>{<span class="r4 r">message</span>.<a href="/Azure.Core/A.html#34fe7bc5cf4f67d5" class="i property">Request</a>.<a href="/Azure.Core/A.html#a3954f29cb1a883c" class="i property">Uri</a>}<span class="s">&quot;</span>);
            <b>await</b> <a href="/Azure.Core/A.html#7c63499783985c7e" class="i method">ProcessNextAsync</a>(<span class="r4 r">message</span>, <span class="r5 r">pipeline</span>);
            <span class="t t">Console</span>.<span class="i method">WriteLine</span>(<span class="s">$&quot;</span><span class="s">&gt;&gt; Response: </span>{<span class="r4 r">message</span>.<a href="/Azure.Core/A.html#0bc18a223263c879" class="i property">Response</a>.<a href="/Azure.Core/A.html#53e6401c580f9719" class="i property">Status</a>}<span class="s"> from </span>{<span class="r4 r">message</span>.<a href="/Azure.Core/A.html#34fe7bc5cf4f67d5" class="i property">Request</a>.<a href="/Azure.Core/A.html#38781a2f20c88339" class="i property">Method</a>}<span class="s"> </span>{<span class="r4 r">message</span>.<a href="/Azure.Core/A.html#34fe7bc5cf4f67d5" class="i property">Request</a>.<a href="/Azure.Core/A.html#a3954f29cb1a883c" class="i property">Uri</a>}\n<span class="s">&quot;</span>);
        }
 
        <b>public override void</b> <a id="79306532333f21b0" href="R/79306532333f21b0.html" target="n" data-glyph="72,1" class="i method">Process</a>(<a href="/Azure.Core/A.html#0d3a69186ac45549" class="t t">HttpMessage</a> <span id="r6 rd" class="r6 r">message</span>, <a href="@1@System.Runtime/A.html#439b47ca0dfb4b1c" class="t t">ReadOnlyMemory</a>&lt;<a href="/Azure.Core/A.html#afce2b8855e35f1f" class="t t">HttpPipelinePolicy</a>&gt; <span id="r7 rd" class="r7 r">pipeline</span>)
        {
            <span class="t t">Console</span>.<span class="i method">WriteLine</span>(<span class="s">$&quot;</span><span class="s">&gt;&gt; Request: </span>{<span class="r6 r">message</span>.<a href="/Azure.Core/A.html#34fe7bc5cf4f67d5" class="i property">Request</a>.<a href="/Azure.Core/A.html#a3954f29cb1a883c" class="i property">Uri</a>}<span class="s">&quot;</span>);
            <a href="/Azure.Core/A.html#ed2e35356f769a1b" class="i method">ProcessNext</a>(<span class="r6 r">message</span>, <span class="r7 r">pipeline</span>);
            <span class="t t">Console</span>.<span class="i method">WriteLine</span>(<span class="s">$&quot;</span><span class="s">&gt;&gt; Response: </span>{<span class="r6 r">message</span>.<a href="/Azure.Core/A.html#0bc18a223263c879" class="i property">Response</a>.<a href="/Azure.Core/A.html#53e6401c580f9719" class="i property">Status</a>}<span class="s"> </span>{<span class="r6 r">message</span>.<a href="/Azure.Core/A.html#34fe7bc5cf4f67d5" class="i property">Request</a>.<a href="/Azure.Core/A.html#38781a2f20c88339" class="i property">Method</a>}<span class="s"> </span>{<span class="r6 r">message</span>.<a href="/Azure.Core/A.html#34fe7bc5cf4f67d5" class="i property">Request</a>.<a href="/Azure.Core/A.html#a3954f29cb1a883c" class="i property">Uri</a>}<span class="s">&quot;</span>);
        }
    }
}
</pre></td></tr></table></div></body></html>
