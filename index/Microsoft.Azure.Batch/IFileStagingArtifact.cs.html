<!DOCTYPE html>
<html><head><title>IFileStagingArtifact.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(74);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Batch/IFileStagingArtifact.cs" target="_top">IFileStagingArtifact.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Batch" target="_top">Microsoft.Azure.Batch.csproj</a> (Microsoft.Azure.Batch)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
﻿<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>
{
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Contains information about a file staging process.  File staging is typically performed for</span>
    <span class="c">///</span><span class="c"> a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="P/eeca8189f6dd1bc1.html#eeca8189f6dd1bc1" class="t t">CloudTask</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> (see </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="P/eeca8189f6dd1bc1.html#eeca8189f6dd1bc1" class="t t">CloudTask</a>.<a href="Generated/CloudTask.cs.html#d624cff35ee00815" class="i property">FilesToStage</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">).</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> IFileStagingArtifact allows an application to customize and to obtain information about the process of uploading</span>
    <span class="c">///</span><span class="c"> files to the cloud, for example as part of a task-related operation such as</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JobOperations.cs.html#dd44f2346717d078" class="t t">JobOperations</a>.<a href="JobOperations.cs.html#2f8054ac5d7e1b2c" class="i method">AddTaskAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>,<a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>{<a href="P/eeca8189f6dd1bc1.html#eeca8189f6dd1bc1" class="t t">CloudTask</a>},<a href="BatchClientParallelOptions.cs.html#f03abc8c46c2be74" class="t t">BatchClientParallelOptions</a>,<a href="@0@System/A.html#2b70243adbcbdb40" class="t t">ConcurrentBag</a>{<a href="@0@mscorlib/A.html#2e5ef5704344a309" class="t t">ConcurrentDictionary</a>{<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a>, <a href="#e009380314179236" class="t t">IFileStagingArtifact</a>}},<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>?,<a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>{<a href="BatchClientBehaviors.cs.html#f6f05bb3f3db0258" class="t t">BatchClientBehavior</a>})<span class="c">&quot;</span><span class="c">&gt;</span><span class="c">JobOperations.AddTaskAsync</span><span class="c">&lt;/</span><span class="c">see</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="P/f7086b8696d5b14e.html#f7086b8696d5b14e" class="t t">CloudJob</a>.<a href="CloudJob.cs.html#11a6effe1a7e0c05" class="i method">AddTaskAsync</a>(<a href="P/eeca8189f6dd1bc1.html#eeca8189f6dd1bc1" class="t t">CloudTask</a>, <a href="@0@mscorlib/A.html#2e5ef5704344a309" class="t t">ConcurrentDictionary</a>{<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a>, <a href="#e009380314179236" class="t t">IFileStagingArtifact</a>}, <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>{<a href="BatchClientBehaviors.cs.html#f6f05bb3f3db0258" class="t t">BatchClientBehavior</a>}, <a href="@0@mscorlib/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span><span class="c">&gt;</span><span class="c">CloudJob.AddTaskAsync</span><span class="c">&lt;/</span><span class="c">see</span><span class="c">&gt;</span><span class="c">.  Applications may use this</span>
    <span class="c">///</span><span class="c"> information to, for example, find out about containers that were created in Azure Storage as</span>
    <span class="c">///</span><span class="c"> part of the upload process.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> When </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JobOperations.cs.html#dd44f2346717d078" class="t t">JobOperations</a>.<a href="JobOperations.cs.html#2f8054ac5d7e1b2c" class="i method">AddTaskAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>,<a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>{<a href="P/eeca8189f6dd1bc1.html#eeca8189f6dd1bc1" class="t t">CloudTask</a>},<a href="BatchClientParallelOptions.cs.html#f03abc8c46c2be74" class="t t">BatchClientParallelOptions</a>,<a href="@0@System/A.html#2b70243adbcbdb40" class="t t">ConcurrentBag</a>{<a href="@0@mscorlib/A.html#2e5ef5704344a309" class="t t">ConcurrentDictionary</a>{<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a>, <a href="#e009380314179236" class="t t">IFileStagingArtifact</a>}},<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>?,<a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>{<a href="BatchClientBehaviors.cs.html#f6f05bb3f3db0258" class="t t">BatchClientBehavior</a>})<span class="c">&quot;</span><span class="c">&gt;</span><span class="c">JobOperations.AddTaskAsync</span><span class="c">&lt;/</span><span class="c">see</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> is called, the Batch client sends the tasks to the Batch service in collections.  As each collection is</span>
    <span class="c">///</span><span class="c"> processed, the Batch client performs file staging for that collection: it examines the tasks to see if</span>
    <span class="c">///</span><span class="c"> any of them specify any </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="P/eeca8189f6dd1bc1.html#eeca8189f6dd1bc1" class="t t">CloudTask</a>.<a href="Generated/CloudTask.cs.html#d624cff35ee00815" class="i property">FilesToStage</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, and if so creates a dictionary entry for</span>
    <span class="c">///</span><span class="c"> each type of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">FileStaging</span>.<a href="FileStaging/IFileStagingProvider.cs.html#a1e33437d516696b" class="t t">IFileStagingProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in the FilesToStage collection. The key of</span>
    <span class="c">///</span><span class="c"> the dictionary entry is the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of the IFileStagingProvider and the value is an instance</span>
    <span class="c">///</span><span class="c"> of the corresponding implementation of IFileStagingArtifact.  For example, if FilesToStage includes one or more</span>
    <span class="c">///</span><span class="c"> FileToStage objects (from the Microsoft.Azure.Batch.FileStaging library), then the dictionary contains an entry whose key is</span>
    <span class="c">///</span><span class="c"> typeof(FileToStage) and whose value is an instance of SequentialFileStagingArtifact.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> When the Add Task operation completes, or during the Add Task operation if the application is multi-threaded,</span>
    <span class="c">///</span><span class="c"> you can examine the dictionary and convert each IFileStagingArtifact to the appropriate type to retrieve</span>
    <span class="c">///</span><span class="c"> the type-specific information.  For example, if your Add Task operation specified one or more FileToStage objects,</span>
    <span class="c">///</span><span class="c"> you can locate the dictionary entry keyed by typeof(FileToStage), cast the value to SequentialFileStagingArtifact,</span>
    <span class="c">///</span><span class="c"> and examine the SequentialFileStagingArtifact.BlobContainerCreated property to</span>
    <span class="c">///</span><span class="c"> determine if the upload process created a blob container in Azure Storage and if so the name of that container.</span>
    <span class="c">///</span><span class="c"> This example could be useful for cleaning up automatically created containers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> (Single-task Add Task operations work similarly, except that in a multi-task Add Task operation, there is</span>
    <span class="c">///</span><span class="c"> a dictionary for each collection of tasks, and the dictionaries are collected in a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@System/A.html#2b70243adbcbdb40" class="t t">ConcurrentBag</a>{<span class="r0 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> whereas in a single-task Add Task operation there is only a single dictionary.)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> In a single-task Add Task operation, you can also use the dictionary to customize the file staging process, by pre-populating it with appropriate</span>
    <span class="c">///</span><span class="c"> entries.  For example, suppose you wish to control the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5ed3f677930226c2" class="i property">NamingFragment</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for a group of FileToStage</span>
    <span class="c">///</span><span class="c"> objects.  Then you could initialize the dictionary with </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{ typeof(FileToStage), new SequentialFileStagingArtifact { NamingFragment = &quot;myname&quot; } }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> before passing it to AddTaskAsync.  The FileToStage implementation of IFileStagingProvider would then use your</span>
    <span class="c">///</span><span class="c"> SequentialFileStagingArtifact instead of creating its own.  (This feature is not available in multi-task</span>
    <span class="c">///</span><span class="c"> Add Task operations.)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> You may also encounter IFileStagingArtifact if you are developing a custom </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">FileStaging</span>.<a href="FileStaging/IFileStagingProvider.cs.html#a1e33437d516696b" class="t t">IFileStagingProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> In this case you will typically create a custom implementation of IFileStagingArtifact to report</span>
    <span class="c">///</span><span class="c"> implementation-specific information about your file staging process.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>public interface</b> <a id="e009380314179236" href="R/e009380314179236.html" target="n" data-glyph="48,0" class="t t">IFileStagingArtifact</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a name fragment that can be used when constructing default names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Although a caller may set this property, the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">FileStaging</span>.<a href="FileStaging/IFileStagingProvider.cs.html#a1e33437d516696b" class="t t">IFileStagingProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> implementation</span>
        <span class="c">///</span><span class="c"> is not required to respect it.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <a id="5ed3f677930226c2" href="R/5ed3f677930226c2.html" target="n" data-glyph="102,1" class="i property">NamingFragment</a> { <b>get</b>; <b>set</b>;}
    }
}
</pre></td></tr></table></div></body></html>
