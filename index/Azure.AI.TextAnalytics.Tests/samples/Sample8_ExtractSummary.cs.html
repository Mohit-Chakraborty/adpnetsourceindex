<!DOCTYPE html>
<html><head><title>Sample8_ExtractSummary.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(128);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.AI.TextAnalytics.Tests/samples/Sample8_ExtractSummary.cs" target="_top">samples\Sample8_ExtractSummary.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/textanalytics/Azure.AI.TextAnalytics/tests/samples/Sample8_ExtractSummary.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.AI.TextAnalytics.Tests" target="_top">Azure.AI.TextAnalytics.Tests.csproj</a> (Azure.AI.TextAnalytics.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">AI</span>.<span class="i n">TextAnalytics</span>.<span class="i n">Tests</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">AI</span>.<span class="i n">TextAnalytics</span>.<span class="i n">Samples</span>
{
    [<a href="/Azure.Core.TestFramework/A.html#9ce10179a72216c9" class="t constructor">LiveOnly</a>]
    <b>public</b> <a href="../P/ce563162c2857d13.html" target="s" class="k">partial</a> <b>class</b> <a id="ce563162c2857d13" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="24986e464f023370">TextAnalyticsSamples</span></a> : <a href="/Azure.Core.TestFramework/A.html#9be648b978998634" class="t t">SamplesBase</a>&lt;<a href="../Infrastructure/TextAnalyticsTestEnvironment.cs.html#08b3d01ab44f987b" class="t t">TextAnalyticsTestEnvironment</a>&gt;
    {
        [<span class="t constructor">Test</span>]
        <b>public void</b> <a id="1ed9c3b484175899" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ExtractSummary</a>()
        {
            <span class="c">// Create a text analytics client.</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">endpoint</span> = <a href="/Azure.Core.TestFramework/A.html#26a1e2ab3c3c535e" class="i property">TestEnvironment</a>.<a href="../Infrastructure/TextAnalyticsTestEnvironment.cs.html#32fd23349ec12fa5" class="i property">Endpoint</a>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">apiKey</span> = <a href="/Azure.Core.TestFramework/A.html#26a1e2ab3c3c535e" class="i property">TestEnvironment</a>.<a href="../Infrastructure/TextAnalyticsTestEnvironment.cs.html#07fc2cdb3e8610f7" class="i property">ApiKey</a>;
            <a href="/Azure.AI.TextAnalytics/A.html#765df30d60d4da95" class="k">var</a> <span id="r2 rd" class="r2 r">client</span> = <b>new</b> <a href="/Azure.AI.TextAnalytics/A.html#89a24b38873082dc" class="t constructor">TextAnalyticsClient</a>(<b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="r0 r">endpoint</span>), <b>new</b> <a href="/Azure.Core/A.html#015df0c4993644fe" class="t constructor">AzureKeyCredential</a>(<span class="r1 r">apiKey</span>));
 
            <span class="c">// Get input document.</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">document</span> = <span class="s">@&quot;Windows 365 was in the works before COVID-19 sent companies around the world on a scramble to secure solutions to support employees suddenly forced to work from home, but “what really put the firecracker behind it was the pandemic, it accelerated everything,” McKelvey said. She explained that customers were asking, “’How do we create an experience for people that makes them still feel connected to the company without the physical presence of being there?”
                                In this new world of Windows 365, remote workers flip the lid on their laptop, bootup the family workstation or clip a keyboard onto a tablet, launch a native app or modern web browser and login to their Windows 365 account.From there, their Cloud PC appears with their background, apps, settings and content just as they left it when they last were last there – in the office, at home or a coffee shop.
                                And then, when you’re done, you’re done.You won’t have any issues around security because you’re not saving anything on your device,” McKelvey said, noting that all the data is stored in the cloud.
                                The ability to login to a Cloud PC from anywhere on any device is part of Microsoft’s larger strategy around tailoring products such as Microsoft Teams and Microsoft 365 for the post-pandemic hybrid workforce of the future, she added. It enables employees accustomed to working from home to continue working from home; it enables companies to hire interns from halfway around the world; it allows startups to scale without requiring IT expertise.
                                “I think this will be interesting for those organizations who, for whatever reason, have shied away from virtualization.This is giving them an opportunity to try it in a way that their regular, everyday endpoint admin could manage,” McKelvey said.
                                The simplicity of Windows 365 won over Dean Wells, the corporate chief information officer for the Government of Nunavut. His team previously attempted to deploy a traditional virtual desktop infrastructure and found it inefficient and unsustainable given the limitations of low-bandwidth satellite internet and the constant need for IT staff to manage the network and infrastructure.
                                We didn’t run it for very long,” he said. “It didn’t turn out the way we had hoped.So, we actually had terminated the project and rolled back out to just regular PCs.”
                                He re-evaluated this decision after the Government of Nunavut was hit by a ransomware attack in November 2019 that took down everything from the phone system to the government’s servers. Microsoft helped rebuild the system, moving the government to Teams, SharePoint, OneDrive and Microsoft 365. Manchester’s team recruited the Government of Nunavut to pilot Windows 365. Wells was intrigued, especially by the ability to manage the elastic workforce securely and seamlessly.
                                “The impact that I believe we are finding, and the impact that we’re going to find going forward, is being able to access specialists from outside the territory and organizations outside the territory to come in and help us with our projects, being able to get people on staff with us to help us deliver the day-to-day expertise that we need to run the government,” he said.
                                “Being able to improve healthcare, being able to improve education, economic development is going to improve the quality of life in the communities.”&quot;</span>;
 
            <span class="c">// Prepare analyze operation input. You can add multiple documents to this list and perform the same</span>
            <span class="c">// operation to all of them.</span>
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r4 rd" class="r4 r">batchDocuments</span> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Azure.AI.TextAnalytics/A.html#90fb35e1d2b85d3d" class="t t">TextDocumentInput</a>&gt;
            {
                <b>new</b> <a href="/Azure.AI.TextAnalytics/A.html#256decdbe4b0603c" class="t constructor">TextDocumentInput</a>(<span class="s">&quot;1&quot;</span>, <span class="r3 r">document</span>)
                {
                     <a href="/Azure.AI.TextAnalytics/A.html#7ddfb96731fa3b5d" class="i property">Language</a> = <span class="s">&quot;en&quot;</span>,
                }
            };
 
            <a href="/Azure.AI.TextAnalytics/A.html#e64de1a87d387e38" class="k">var</a> <span id="r5 rd" class="r5 r">summaryAction</span> = <b>new</b> <a href="/Azure.AI.TextAnalytics/A.html#108097abd925d515" class="t constructor">ExtractSummaryAction</a>()
            {
                <a href="/Azure.AI.TextAnalytics/A.html#a21ec2c51048e03d" class="i property">MaxSentenceCount</a> = 5,
                <a href="/Azure.AI.TextAnalytics/A.html#4b99d9b7980bad57" class="i property">OrderBy</a> = <a href="/Azure.AI.TextAnalytics/A.html#f945c71543937345" class="t t">SummarySentencesOrder</a>.<a href="/Azure.AI.TextAnalytics/A.html#82b922add2133765" class="i field">Rank</a>
            };
 
            <a href="/Azure.AI.TextAnalytics/A.html#e9e175319283987f" class="t t">TextAnalyticsActions</a> <span id="r6 rd" class="r6 r">actions</span> = <b>new</b> <a href="/Azure.AI.TextAnalytics/A.html#68039f462d6e57d1" class="t constructor">TextAnalyticsActions</a>()
            {
                <a href="/Azure.AI.TextAnalytics/A.html#d885873283fe775e" class="i property">ExtractSummaryActions</a> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Azure.AI.TextAnalytics/A.html#e64de1a87d387e38" class="t t">ExtractSummaryAction</a>&gt;() { <span class="r5 r">summaryAction</span> }
            };
 
            <span class="c">// Start analysis process.</span>
            <a href="/Azure.AI.TextAnalytics/A.html#7e5da4a029f41b0c" class="t t">AnalyzeActionsOperation</a> <span id="r7 rd" class="r7 r">operation</span> = <span class="r2 r">client</span>.<a href="/Azure.AI.TextAnalytics/A.html#9b86efc4dc7c56f5" class="i method">StartAnalyzeActions</a>(<span class="r4 r">batchDocuments</span>, <span class="r6 r">actions</span>);
 
            <span class="c">// Wait for completion with manual polling.</span>
            <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <span id="r8 rd" class="r8 r">pollingInterval</span> = <b>new</b> <a href="@0@mscorlib/A.html#9cf98f5e237ce8fb" class="t constructor">TimeSpan</a>(1000);
 
            <b>while</b> (<b>true</b>)
            {
                <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Status: </span>{<span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#1f46c4fac991f0a3" class="i property">Status</a>}<span class="s">&quot;</span>);
                <span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#4fbbe2cc9996f9de" class="i method">UpdateStatus</a>();
                <b>if</b> (<span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#593671992b1769c3" class="i property">HasCompleted</a>)
                {
                    <b>break</b>;
                }
 
                <a href="@0@mscorlib/A.html#3980e012bae82e96" class="t t">Thread</a>.<a href="@0@mscorlib/A.html#82aedb56cecde82c" class="i method">Sleep</a>(<span class="r8 r">pollingInterval</span>);
            }
 
            <span class="c">// View operation status.</span>
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">AnalyzeActions operation has completed</span><span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#748bde83a8b838d8" class="i method">WriteLine</a>();
 
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Created On   : </span>{<span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#5c95cc4e8e2710ec" class="i property">CreatedOn</a>}<span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Expires On   : </span>{<span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#1b420599b150ee7c" class="i property">ExpiresOn</a>}<span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Id           : </span>{<span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#52469d6f5613e367" class="i property">Id</a>}<span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Status       : </span>{<span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#1f46c4fac991f0a3" class="i property">Status</a>}<span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Last Modified: </span>{<span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#877169eaf7eb751a" class="i property">LastModified</a>}<span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#748bde83a8b838d8" class="i method">WriteLine</a>();
 
            <span class="c">// View operation results.</span>
            <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#f5fa5d596b5fe266" class="t t">AnalyzeActionsResult</a> <span id="r9 rd" class="r9 r">documentsInPage</span> <b>in</b> <span class="r7 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#f80c829c8ad14831" class="i method">GetValues</a>())
            {
                <a href="@0@mscorlib/A.html#7103bd3a82c9f352" class="t t">IReadOnlyCollection</a>&lt;<a href="/Azure.AI.TextAnalytics/A.html#6e60c9ac648a08d8" class="t t">ExtractSummaryActionResult</a>&gt; <span id="r10 rd" class="r10 r">summaryResults</span> = <span class="r9 r">documentsInPage</span>.<a href="/Azure.AI.TextAnalytics/A.html#4232d470388f9378" class="i property">ExtractSummaryResults</a>;
 
                <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#6e60c9ac648a08d8" class="t t">ExtractSummaryActionResult</a> <span id="r11 rd" class="r11 r">summaryActionResults</span> <b>in</b> <span class="r10 r">summaryResults</span>)
                {
                    <b>if</b> (<span class="r11 r">summaryActionResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#0bcdd65be5ddb55c" class="i property">HasError</a>)
                    {
                        <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Error!</span><span class="s">&quot;</span>);
                        <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Action error code: </span>{<span class="r11 r">summaryActionResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#b77c3e50e14607a0" class="i property">Error</a>.<a href="/Azure.AI.TextAnalytics/A.html#a70d1beb0fafce6c" class="i property">ErrorCode</a>}<span class="s">.</span><span class="s">&quot;</span>);
                        <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Message: </span>{<span class="r11 r">summaryActionResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#b77c3e50e14607a0" class="i property">Error</a>.<a href="/Azure.AI.TextAnalytics/A.html#d35dea3b50436a03" class="i property">Message</a>}<span class="s">&quot;</span>);
                        <b>continue</b>;
                    }
 
                    <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#075f4db191260516" class="t t">ExtractSummaryResult</a> <span id="r12 rd" class="r12 r">documentResults</span> <b>in</b> <span class="r11 r">summaryActionResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#5f7cd665767e03fc" class="i property">DocumentsResults</a>)
                    {
                        <b>if</b> (<span class="r12 r">documentResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#d043dcdfc425e682" class="i property">HasError</a>)
                        {
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Error!</span><span class="s">&quot;</span>);
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Document error code: </span>{<span class="r12 r">documentResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#fb43802ef150b250" class="i property">Error</a>.<a href="/Azure.AI.TextAnalytics/A.html#a70d1beb0fafce6c" class="i property">ErrorCode</a>}<span class="s">.</span><span class="s">&quot;</span>);
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Message: </span>{<span class="r12 r">documentResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#fb43802ef150b250" class="i property">Error</a>.<a href="/Azure.AI.TextAnalytics/A.html#d35dea3b50436a03" class="i property">Message</a>}<span class="s">&quot;</span>);
                            <b>continue</b>;
                        }
 
                        <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Extracted the following </span>{<span class="r12 r">documentResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#82b763c8f0bf4718" class="i property">Sentences</a>.<a href="@0@mscorlib/A.html#7e2071514968aca1" class="i property">Count</a>}<span class="s"> sentence(s):</span><span class="s">&quot;</span>);
                        <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#748bde83a8b838d8" class="i method">WriteLine</a>();
 
                        <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#bb169ec688a67b56" class="t t">SummarySentence</a> <span id="r13 rd" class="r13 r">sentence</span> <b>in</b> <span class="r12 r">documentResults</span>.<a href="/Azure.AI.TextAnalytics/A.html#82b763c8f0bf4718" class="i property">Sentences</a>)
                        {
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Sentence: </span>{<span class="r13 r">sentence</span>.<a href="/Azure.AI.TextAnalytics/A.html#b385d0cfaac538b9" class="i property">Text</a>}<span class="s">&quot;</span>);
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Rank Score: </span>{<span class="r13 r">sentence</span>.<a href="/Azure.AI.TextAnalytics/A.html#33535c8d011085e1" class="i property">RankScore</a>}<span class="s">&quot;</span>);
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Offset: </span>{<span class="r13 r">sentence</span>.<a href="/Azure.AI.TextAnalytics/A.html#abe9e3e43b476948" class="i property">Offset</a>}<span class="s">&quot;</span>);
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">  Length: </span>{<span class="r13 r">sentence</span>.<a href="/Azure.AI.TextAnalytics/A.html#d0f6310ef5df2a4b" class="i property">Length</a>}<span class="s">&quot;</span>);
                            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#748bde83a8b838d8" class="i method">WriteLine</a>();
                        }
                    }
                }
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
