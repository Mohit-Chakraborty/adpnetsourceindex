<!DOCTYPE html>
<html><head><title>Sample_AnalyzeOperationAsync_ManualPolling.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(126);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.AI.TextAnalytics.Tests/samples/Sample_AnalyzeOperationAsync_ManualPolling.cs" target="_top">samples\Sample_AnalyzeOperationAsync_ManualPolling.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.AI.TextAnalytics.Tests" target="_top">tests\Azure.AI.TextAnalytics.Tests.csproj</a> (Azure.AI.TextAnalytics.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">AI</span>.<span class="i n">TextAnalytics</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">AI</span>.<span class="i n">TextAnalytics</span>.<span class="i n">Tests</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i">NUnit</span>.<span class="i">Framework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">AI</span>.<span class="i n">TextAnalytics</span>.<span class="i n">Samples</span>
{
    [<span class="i">LiveOnly</span>]
    <b>public</b> <a href="../P/ce563162c2857d13.html" target="s" class="k">partial</a> <b>class</b> <a id="ce563162c2857d13" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="24986e464f023370">TextAnalyticsSamples</span></a>: <a href="/Azure.Core.TestFramework/A.html#9be648b978998634" class="t t">SamplesBase</a>&lt;<a href="../Infrastructure/TextAnalyticsTestEnvironment.cs.html#08b3d01ab44f987b" class="t t">TextAnalyticsTestEnvironment</a>&gt;
    {
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="0fa6b95e2453456f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AnalyzeOperationAsync_ManualPolling</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">endpoint</span> = <a href="/Azure.Core.TestFramework/A.html#26a1e2ab3c3c535e" class="i property">TestEnvironment</a>.<a href="../Infrastructure/TextAnalyticsTestEnvironment.cs.html#32fd23349ec12fa5" class="i property">Endpoint</a>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">apiKey</span> = <a href="/Azure.Core.TestFramework/A.html#26a1e2ab3c3c535e" class="i property">TestEnvironment</a>.<a href="../Infrastructure/TextAnalyticsTestEnvironment.cs.html#07fc2cdb3e8610f7" class="i property">ApiKey</a>;
 
            <a href="/Azure.AI.TextAnalytics/A.html#765df30d60d4da95" class="k">var</a> <span id="r2 rd" class="r2 r">client</span> = <b>new</b> <span class="t">TextAnalyticsClient</span>(<b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="r0 r">endpoint</span>), <b>new</b> <span class="i">AzureKeyCredential</span>(<span class="r1 r">apiKey</span>));
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Snippet:AnalyzeOperationBatchAsyncManualPolling
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">document</span> = <span class="s">@&quot;We went to Contoso Steakhouse located at midtown NYC last week for a dinner party, 
                                and we adore the spot! They provide marvelous food and they have a great menu. The
                                chief cook happens to be the owner (I think his name is John Doe) and he is super 
                                nice, coming out of the kitchen and greeted us all. We enjoyed very much dining in 
                                the place! The Sirloin steak I ordered was tender and juicy, and the place was impeccably
                                clean. You can even pre-order from their online menu at www.contososteakhouse.com, 
                                call 312-555-0176 or send email to order@contososteakhouse.com! The only complaint 
                                I have is the food didn&#39;t come fast enough. Overall I highly recommend it!&quot;</span>;
 
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r4 rd" class="r4 r">batchDocuments</span> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Azure.AI.TextAnalytics/A.html#90fb35e1d2b85d3d" class="t t">TextDocumentInput</a>&gt;
            {
                <b>new</b> <span class="t">TextDocumentInput</span>(<span class="s">&quot;1&quot;</span>, <span class="r3 r">document</span>)
                {
                     <a href="/Azure.AI.TextAnalytics/A.html#7ddfb96731fa3b5d" class="i property">Language</a> = <span class="s">&quot;en&quot;</span>,
                }
            };
 
            <a href="/Azure.AI.TextAnalytics/A.html#8676b7a185f3bb26" class="t t">AnalyzeOperationOptions</a> <span id="r5 rd" class="r5 r">operationOptions</span> = <b>new</b> <span class="t">AnalyzeOperationOptions</span>()
            {
                <span class="i">KeyPhrasesTaskParameters</span> = <b>new</b> <span class="t">KeyPhrasesTaskParameters</span>(),
                <span class="i">EntitiesTaskParameters</span> = <b>new</b> <span class="t">EntitiesTaskParameters</span>(),
                <span class="i">PiiTaskParameters</span> = <b>new</b> <span class="t">PiiTaskParameters</span>(),
                <a href="/Azure.AI.TextAnalytics/A.html#b4cc4f86b3df03cd" class="i property">DisplayName</a> = <span class="s">&quot;AnalyzeOperationSample&quot;</span>
            };
 
            <a href="/Azure.AI.TextAnalytics/A.html#a158ddec10562c4a" class="t t">AnalyzeOperation</a> <span id="r6 rd" class="r6 r">operation</span> = <b>await</b> <span class="r2 r">client</span>.<span class="i">StartAnalyzeOperationBatchAsync</span>(<span class="r4 r">batchDocuments</span>, <span class="r5 r">operationOptions</span>);
 
            <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <span id="r7 rd" class="r7 r">pollingInterval</span> = <b>new</b> <a href="@0@mscorlib/A.html#9cf98f5e237ce8fb" class="t constructor">TimeSpan</a>(1000);
 
            <b>while</b> (<b>true</b>)
            {
                <b>await</b> <span class="r6 r">operation</span>.<span class="i">UpdateStatusAsync</span>();
                <b>if</b> (<span class="r6 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#86ee7d563d9a7acd" class="i property">HasCompleted</a>)
                {
                    <b>break</b>;
                }
 
                <b>await</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#87a671fb5b9b4384" class="i method">Delay</a>(<span class="r7 r">pollingInterval</span>);
            }
 
            <a href="/Azure.AI.TextAnalytics/A.html#5f2f805a637c032d" class="t t">AnalyzeOperationResult</a> <span id="r8 rd" class="r8 r">resultCollection</span> = <span class="r6 r">operation</span>.<a href="/Azure.AI.TextAnalytics/A.html#a09dec1f59a77a12" class="i property">Value</a>;
 
            <a href="/Azure.AI.TextAnalytics/A.html#514919bf48b8d933" class="t t">RecognizeEntitiesResultCollection</a> <span id="r9 rd" class="r9 r">entitiesResult</span> = <span class="r8 r">resultCollection</span>.<a href="/Azure.AI.TextAnalytics/A.html#49bb0c72167859ee" class="i property">Tasks</a>.<a href="/Azure.AI.TextAnalytics/A.html#df0ecb2ab17fe85b" class="i property">EntityRecognitionTasks</a>[0].<span class="i">Results</span>;
 
            <a href="/Azure.AI.TextAnalytics/A.html#cce5462a5d1fe317" class="t t">ExtractKeyPhrasesResultCollection</a> <span id="r10 rd" class="r10 r">keyPhrasesResult</span> = <span class="r8 r">resultCollection</span>.<a href="/Azure.AI.TextAnalytics/A.html#49bb0c72167859ee" class="i property">Tasks</a>.<a href="/Azure.AI.TextAnalytics/A.html#aa56f50ff6102e82" class="i property">KeyPhraseExtractionTasks</a>[0].<span class="i">Results</span>;
 
            <a href="/Azure.AI.TextAnalytics/A.html#82d7264f7cd42304" class="t t">RecognizePiiEntitiesResultCollection</a> <span id="r11 rd" class="r11 r">piiResult</span> = <span class="r8 r">resultCollection</span>.<a href="/Azure.AI.TextAnalytics/A.html#49bb0c72167859ee" class="i property">Tasks</a>.<a href="/Azure.AI.TextAnalytics/A.html#05e4ea524b04cd94" class="i property">EntityRecognitionPiiTasks</a>[0].<span class="i">Results</span>;
 
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;Recognized Entities&quot;</span>);
 
            <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#6ce219f91d99b9c4" class="t t">RecognizeEntitiesResult</a> <span id="r12 rd" class="r12 r">result</span> <b>in</b> <span class="r9 r">entitiesResult</span>)
            {
                <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Recognized the following </span>{<span class="r12 r">result</span>.<a href="/Azure.AI.TextAnalytics/A.html#16c8f394a429e3f8" class="i property">Entities</a>.<span class="i">Count</span>}<span class="s"> entities:</span><span class="s">&quot;</span>);
 
                <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#b41f9522bd19b60c" class="t t">CategorizedEntity</a> <span id="r13 rd" class="r13 r">entity</span> <b>in</b> <span class="r12 r">result</span>.<a href="/Azure.AI.TextAnalytics/A.html#16c8f394a429e3f8" class="i property">Entities</a>)
                {
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Entity: </span>{<span class="r13 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#2e4ae1110b2cf7ce" class="i property">Text</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Category: </span>{<span class="r13 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#2a7231784c66c462" class="i property">Category</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Offset: </span>{<span class="r13 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#83dc815b244a1235" class="i property">Offset</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    ConfidenceScore: </span>{<span class="r13 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#2572bae6ecba9db2" class="i property">ConfidenceScore</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    SubCategory: </span>{<span class="r13 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#d0901657e905e8e7" class="i property">SubCategory</a>}<span class="s">&quot;</span>);
                }
                <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;&quot;</span>);
            }
 
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;Recognized PII Entities&quot;</span>);
 
            <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#14c86c8b4991b813" class="t t">RecognizePiiEntitiesResult</a> <span id="r14 rd" class="r14 r">result</span> <b>in</b> <span class="r11 r">piiResult</span>)
            {
                <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Recognized the following </span>{<span class="r14 r">result</span>.<a href="/Azure.AI.TextAnalytics/A.html#aaf8a9617f74d9a1" class="i property">Entities</a>.<span class="i">Count</span>}<span class="s"> PII entities:</span><span class="s">&quot;</span>);
 
                <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#1ffebe4eb5807154" class="t t">PiiEntity</a> <span id="r15 rd" class="r15 r">entity</span> <b>in</b> <span class="r14 r">result</span>.<a href="/Azure.AI.TextAnalytics/A.html#aaf8a9617f74d9a1" class="i property">Entities</a>)
                {
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Entity: </span>{<span class="r15 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#3ca31999ead5b41b" class="i property">Text</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Category: </span>{<span class="r15 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#aac28e7a5ce1c9fc" class="i property">Category</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Offset: </span>{<span class="r15 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#bb655d4188064754" class="i property">Offset</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    ConfidenceScore: </span>{<span class="r15 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#515aea055673f01d" class="i property">ConfidenceScore</a>}<span class="s">&quot;</span>);
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    SubCategory: </span>{<span class="r15 r">entity</span>.<a href="/Azure.AI.TextAnalytics/A.html#020ae2f9ee19e144" class="i property">SubCategory</a>}<span class="s">&quot;</span>);
                }
                <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;&quot;</span>);
            }
 
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;Key Phrases&quot;</span>);
 
            <b>foreach</b> (<a href="/Azure.AI.TextAnalytics/A.html#2bbece7523cc7812" class="t t">ExtractKeyPhrasesResult</a> <span id="r16 rd" class="r16 r">result</span> <b>in</b> <span class="r10 r">keyPhrasesResult</span>)
            {
                <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    Recognized the following </span>{<span class="r16 r">result</span>.<a href="/Azure.AI.TextAnalytics/A.html#342db3b9a1451e46" class="i property">KeyPhrases</a>.<span class="i">Count</span>}<span class="s"> Keyphrases:</span><span class="s">&quot;</span>);
 
                <b>foreach</b> (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">keyphrase</span> <b>in</b> <span class="r16 r">result</span>.<a href="/Azure.AI.TextAnalytics/A.html#342db3b9a1451e46" class="i property">KeyPhrases</a>)
                {
                    <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">    </span>{<span class="r17 r">keyphrase</span>}<span class="s">&quot;</span>);
                }
                <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;&quot;</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
