<!DOCTYPE html>
<html><head><title>TestRecording.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(371);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Core.TestFramework/TestRecording.cs" target="_top">TestRecording.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/core/Azure.Core.TestFramework/src/TestRecording.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Core.TestFramework" target="_top">Azure.Core.TestFramework.csproj</a> (Azure.Core.TestFramework)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Security</span>.<span class="i n">Cryptography</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">Json</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">Pipeline</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">Tests</span>.<span class="i n">TestFramework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>
{
    <b>public class</b> <a id="cde92997ae8f348d" href="R/cde92997ae8f348d.html" target="n" data-glyph="0,0" class="t t">TestRecording</a> : <span class="t t">IAsyncDisposable</span>
    {
        <b>private const string</b> <a id="6160c00500d39ae3" href="R/6160c00500d39ae3.html" target="n" data-glyph="10,1" class="i field">RandomSeedVariableKey</a> = <span class="s">&quot;RandomSeed&quot;</span>;
        <b>private const string</b> <a id="e079d115a156221c" href="R/e079d115a156221c.html" target="n" data-glyph="10,1" class="i field">chars</a> = <span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;
        <span class="c">// cspell: disable-next-line</span>
        <b>private const string</b> <a id="4c037c1d7eef774f" href="R/4c037c1d7eef774f.html" target="n" data-glyph="10,1" class="i field">charsLower</a> = <span class="s">&quot;abcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;
        <b>private const string</b> <a id="69b31193c1ec702c" href="R/69b31193c1ec702c.html" target="n" data-glyph="10,1" class="i field">Sanitized</a> = <span class="s">&quot;Sanitized&quot;</span>;
        <b>internal const string</b> <a id="bd655e3c22cf5c82" href="R/bd655e3c22cf5c82.html" target="n" data-glyph="8,1" class="i field">DateTimeOffsetNowVariableKey</a> = <span class="s">&quot;DateTimeOffsetNow&quot;</span>;
 
        <b>public</b> <a href="@0@System/A.html#1a01ea5555bded49" class="t t">SortedDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="e35a368de0a12de9" href="R/e35a368de0a12de9.html" target="n" data-glyph="102,1" class="i property">Variables</a> =&gt; <a href="#4df58adc78da315e" class="i field">_variables</a>;
        <b>private</b> <a href="@0@System/A.html#1a01ea5555bded49" class="t t">SortedDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="4df58adc78da315e" href="R/4df58adc78da315e.html" target="n" data-glyph="46,1" class="i field">_variables</a> = <b>new</b>();
 
        <b>private</b> <a id="5b0072231516fb14" href="R/5b0072231516fb14.html" target="n" data-glyph="76,1" class="t constructor">TestRecording</a>(<a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a> <span id="r0 rd" class="r0 r">mode</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">sessionFile</span>, <a href="TestProxy.cs.html#8aca39759c068821" class="t t">TestProxy</a> <span id="r2 rd" class="r2 r">proxy</span>, <a href="RecordedTestBase.cs.html#37d56504090a0d7b" class="t t">RecordedTestBase</a> <span id="r3 rd" class="r3 r">recordedTestBase</span>)
        {
            <a href="#f12245cbae0b56da" class="i property">Mode</a> = <span class="r0 r">mode</span>;
            <a href="#b5f7344db22d717a" class="i field">_sessionFile</a> = <span class="r1 r">sessionFile</span>;
            <a href="#e23b8168cb4af41c" class="i field">_proxy</a> = <span class="r2 r">proxy</span>;
            <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a> = <span class="r3 r">recordedTestBase</span>;
        }
 
        <b>public static async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="#cde92997ae8f348d" class="t t">TestRecording</a>&gt; <a id="fda08c4b5efe2d06" href="R/fda08c4b5efe2d06.html" target="n" data-glyph="72,1" class="i method">CreateAsync</a>(<a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a> <span id="r4 rd" class="r4 r">mode</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r5 rd" class="r5 r">sessionFile</span>, <a href="TestProxy.cs.html#8aca39759c068821" class="t t">TestProxy</a> <span id="r6 rd" class="r6 r">proxy</span>, <a href="RecordedTestBase.cs.html#37d56504090a0d7b" class="t t">RecordedTestBase</a> <span id="r7 rd" class="r7 r">recordedTestBase</span>)
        {
            <a href="#cde92997ae8f348d" class="k">var</a> <span id="r8 rd" class="r8 r">recording</span> = <b>new</b> <a href="#5b0072231516fb14" class="t constructor">TestRecording</a>(<span class="r4 r">mode</span>, <span class="r5 r">sessionFile</span>, <span class="r6 r">proxy</span>, <span class="r7 r">recordedTestBase</span>);
            <b>await</b> <span class="r8 r">recording</span>.<a href="#f02d4eb951753377" class="i method">InitializeProxySettingsAsync</a>();
            <b>return</b> <span class="r8 r">recording</span>;
        }
 
        <b>internal async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f02d4eb951753377" href="R/f02d4eb951753377.html" target="n" data-glyph="74,1" class="i method">InitializeProxySettingsAsync</a>()
        {
            <b>switch</b> (<a href="#f12245cbae0b56da" class="i property">Mode</a>)
            {
                <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#62f98a4a2b1d56c3" class="i field">Record</a>:
                    <a href="Shared/AutoRest/ResponseWithHeadersOfTHeaders.cs.html#eacf9fd454a47915" class="k">var</a> <span id="r9 rd" class="r9 r">recordResponse</span> = <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#1f93346aa81216b6" class="i method">StartRecordAsync</a>(<b>new</b> <a href="Generated/Models/StartInformation.cs.html#1cd98838cd4985e3" class="t constructor">StartInformation</a>(<a href="#b5f7344db22d717a" class="i field">_sessionFile</a>));
                    <a href="#67752a6c1277ad78" class="i property">RecordingId</a> = <span class="r9 r">recordResponse</span>.<a href="Shared/AutoRest/ResponseWithHeadersOfTHeaders.cs.html#f80c322d29b25f8e" class="i property">Headers</a>.<a href="Generated/TestProxyStartRecordHeaders.cs.html#c3dbe0567a46643c" class="i property">XRecordingId</a>;
                    <b>await</b> <a href="#550ae31f064d79b6" class="i method">AddProxySanitizersAsync</a>();
 
                    <b>break</b>;
                <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#bde4663b03b59b85" class="i field">Playback</a>:
                    <a href="Shared/AutoRest/ResponseWithHeadersOfTOfTHeaders.cs.html#a1e5ab326d1647cb" class="t t">ResponseWithHeaders</a>&lt;<a href="@0@mscorlib/A.html#f786bcc5e7b69c7d" class="t t">IReadOnlyDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;, <a href="Generated/TestProxyStartPlaybackHeaders.cs.html#6243238672c1317a" class="t t">TestProxyStartPlaybackHeaders</a>&gt; <span id="r10 rd" class="r10 r">playbackResponse</span> = <b>null</b>;
                    <b>try</b>
                    {
                        <span class="r10 r">playbackResponse</span> = <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#3c3ef09d96c13196" class="i method">StartPlaybackAsync</a>(<b>new</b> <a href="Generated/Models/StartInformation.cs.html#1cd98838cd4985e3" class="t constructor">StartInformation</a>(<a href="#b5f7344db22d717a" class="i field">_sessionFile</a>));
                    }
                    <b>catch</b> (<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a> <span id="r11 rd" class="r11 r">ex</span>)
                        <b>when</b> (<span class="r11 r">ex</span>.<a href="/Azure.Core/A.html#2e95914e1b156417" class="i property">Status</a> == 404)
                    {
                        <a href="#50f1f21377f4211f" class="i field">MismatchException</a> = <b>new</b> <a href="TestRecordingMismatchException.cs.html#989d60034a019012" class="t constructor">TestRecordingMismatchException</a>(<span class="r11 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>, <span class="r11 r">ex</span>);
                        <b>return</b>;
                    }
 
                    <a href="#4df58adc78da315e" class="i field">_variables</a> = <b>new</b> <a href="@0@System/A.html#a14cd848bc1eb180" class="t constructor">SortedDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;((<a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;)<span class="r10 r">playbackResponse</span>.<a href="Shared/AutoRest/ResponseWithHeadersOfTOfTHeaders.cs.html#47084b1e69426e4a" class="i property">Value</a>);
                    <a href="#67752a6c1277ad78" class="i property">RecordingId</a> = <span class="r10 r">playbackResponse</span>.<a href="Shared/AutoRest/ResponseWithHeadersOfTOfTHeaders.cs.html#fc205777ecb93566" class="i property">Headers</a>.<a href="Generated/TestProxyStartPlaybackHeaders.cs.html#ff058a874f1d870b" class="i property">XRecordingId</a>;
                    <b>await</b> <a href="#550ae31f064d79b6" class="i method">AddProxySanitizersAsync</a>();
 
                    <span class="c">// temporary until Azure.Core fix is shipped that makes HttpWebRequestTransport consistent with HttpClientTransport</span>
                    <span class="c">// if (!_matcher.CompareBodies)</span>
                    <span class="c">// {</span>
                    <span class="c">//     _proxy.Client.AddBodilessMatcher(RecordingId);</span>
                    <span class="c">// }</span>
                    <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r12 rd" class="r12 r">excludedHeaders</span> = <b>new</b> <a href="@0@mscorlib/A.html#d2ac2c19c9cf1d44" class="t constructor">List</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;(<a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#3e3ebd46b54abbee" class="i field">LegacyExcludedHeaders</a>)
                    {
                        <span class="s">&quot;Content-Type&quot;</span>,
                        <span class="s">&quot;Content-Length&quot;</span>,
                        <span class="s">&quot;Connection&quot;</span>
                    };
 
                    <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#c6a769504be93898" class="i method">AddCustomMatcherAsync</a>(<b>new</b> <a href="Generated/Models/CustomDefaultMatcher.cs.html#fb8585370f36b388" class="t constructor">CustomDefaultMatcher</a>
                    {
                        <a href="Generated/Models/CustomDefaultMatcher.cs.html#5cf4c65d05a6a4f2" class="i property">ExcludedHeaders</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#fa961ce440526a4d" class="i method">Join</a>(<span class="s">&quot;,&quot;</span>, <span class="r12 r">excludedHeaders</span>),
                        <a href="Generated/Models/CustomDefaultMatcher.cs.html#8fb32e6b58510cef" class="i property">IgnoredHeaders</a> = <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#3f2511dd7edda23c" class="i field">IgnoredHeaders</a>.<a href="@0@System.Core/A.html#905bec8c22644c82" class="i property">Count</a> &gt; 0 ? <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#fa961ce440526a4d" class="i method">Join</a>(<span class="s">&quot;,&quot;</span>, <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#3f2511dd7edda23c" class="i field">IgnoredHeaders</a>) : <b>null</b>,
                        <a href="Generated/Models/CustomDefaultMatcher.cs.html#48eeb2db5d3859ca" class="i property">IgnoredQueryParameters</a> = <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#299f044660a43947" class="i field">IgnoredQueryParameters</a>.<a href="@0@System.Core/A.html#905bec8c22644c82" class="i property">Count</a> &gt; 0 ? <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#fa961ce440526a4d" class="i method">Join</a>(<span class="s">&quot;,&quot;</span>, <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#299f044660a43947" class="i field">IgnoredQueryParameters</a>): <b>null</b>,
                        <a href="Generated/Models/CustomDefaultMatcher.cs.html#78fbc312be073de0" class="i property">CompareBodies</a> = <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#a00ba87909919506" class="i property">CompareBodies</a>
                    });
 
                    <b>foreach</b> (<a href="P/57d09ae9060488ce.html#57d09ae9060488ce" class="t t">HeaderTransform</a> <span id="r13 rd" class="r13 r">transform</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#d402d336b41c2be6" class="i field">HeaderTransforms</a>)
                    {
                        <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#d6c89aebfdf700ad" class="i method">AddHeaderTransformAsync</a>(<span class="r13 r">transform</span>, <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
                    }
                    <b>break</b>;
            }
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="550ae31f064d79b6" href="R/550ae31f064d79b6.html" target="n" data-glyph="76,1" class="i method">AddProxySanitizersAsync</a>()
        {
            <b>foreach</b> (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">header</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#863d1eec35620785" class="i property">SanitizedHeaders</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#81cb78b84d01f089" class="i method">AddHeaderSanitizerAsync</a>(<b>new</b> <a href="Generated/Models/HeaderRegexSanitizer.cs.html#4d00968619946989" class="t constructor">HeaderRegexSanitizer</a>(<span class="r14 r">header</span>, <a href="#69b31193c1ec702c" class="i field">Sanitized</a>), <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
 
            <b>foreach</b> (<a href="P/4fc41945c5a5f316.html#4fc41945c5a5f316" class="k">var</a> <span id="r15 rd" class="r15 r">header</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#87a1e18f8c28bda7" class="i property">HeaderRegexSanitizers</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#81cb78b84d01f089" class="i method">AddHeaderSanitizerAsync</a>(<span class="r15 r">header</span>, <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
 
            <b>foreach</b> (<b>var</b> (<span id="r16 rd" class="r16 r">header</span>, <span id="r17 rd" class="r17 r">queryParameter</span>) <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#65f47024810f3e01" class="i property">SanitizedQueryParametersInHeaders</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#81cb78b84d01f089" class="i method">AddHeaderSanitizerAsync</a>(
                    <a href="P/4fc41945c5a5f316.html#4fc41945c5a5f316" class="t t">HeaderRegexSanitizer</a>.<a href="HeaderRegexSanitizer.cs.html#1d83187902d59255" class="i method">CreateWithQueryParameter</a>(<span class="r16 r">header</span>, <span class="r17 r">queryParameter</span>, <a href="#69b31193c1ec702c" class="i field">Sanitized</a>),
                    <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
 
            <b>foreach</b> (<a href="P/111cdb57f84c73ee.html#111cdb57f84c73ee" class="t t">UriRegexSanitizer</a> <span id="r18 rd" class="r18 r">sanitizer</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#44e64ebda0e4c6a1" class="i property">UriRegexSanitizers</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#430a8e5809d7cfcc" class="i method">AddUriSanitizerAsync</a>(<span class="r18 r">sanitizer</span>, <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
 
            <b>foreach</b> (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r19 rd" class="r19 r">queryParameter</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#631d0a4459d3dc46" class="i property">SanitizedQueryParameters</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#430a8e5809d7cfcc" class="i method">AddUriSanitizerAsync</a>(
                    <a href="P/111cdb57f84c73ee.html#111cdb57f84c73ee" class="t t">UriRegexSanitizer</a>.<a href="UriRegexSanitizer.cs.html#5b3001c5f0c453ee" class="i method">CreateWithQueryParameter</a>(<span class="r19 r">queryParameter</span>, <a href="#69b31193c1ec702c" class="i field">Sanitized</a>),
                    <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
 
            <b>foreach</b> (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">path</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#82e91cb0ac269f5d" class="i property">JsonPathSanitizers</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#92ad3e2bf3f04aef" class="i method">AddBodyKeySanitizerAsync</a>(<b>new</b> <a href="Generated/Models/BodyKeySanitizer.cs.html#1b4f96382810eaef" class="t constructor">BodyKeySanitizer</a>(<a href="#69b31193c1ec702c" class="i field">Sanitized</a>) { <a href="Generated/Models/BodyKeySanitizer.cs.html#3f8c33aedfb4a4da" class="i property">JsonPath</a> = <span class="r20 r">path</span> }, <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
 
            <b>foreach</b> (<a href="P/4b13531174b28343.html#4b13531174b28343" class="t t">BodyKeySanitizer</a> <span id="r21 rd" class="r21 r">sanitizer</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#7020c7cb35cddf84" class="i property">BodyKeySanitizers</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#92ad3e2bf3f04aef" class="i method">AddBodyKeySanitizerAsync</a>(<span class="r21 r">sanitizer</span>, <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
 
            <b>foreach</b> (<a href="P/0f9e948d508d9dc3.html#0f9e948d508d9dc3" class="t t">BodyRegexSanitizer</a> <span id="r22 rd" class="r22 r">sanitizer</span> <b>in</b> <a href="#70b290ac136c5dbd" class="i field">_recordedTestBase</a>.<a href="RecordedTestBase.cs.html#7224c5fa54f6716b" class="i property">BodyRegexSanitizers</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#011fa535fcab072d" class="i method">AddBodyRegexSanitizerAsync</a>(<span class="r22 r">sanitizer</span>, <a href="#67752a6c1277ad78" class="i property">RecordingId</a>);
            }
        }
 
        <b>public</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a> <a id="f12245cbae0b56da" href="R/f12245cbae0b56da.html" target="n" data-glyph="102,1" class="i property">Mode</a> { <b>get</b>; }
 
        <b>private readonly</b> <a href="@0@mscorlib/A.html#ef9ce034697240ba" class="t t">AsyncLocal</a>&lt;<a href="EntryRecordModel.cs.html#7d8a1000d2861333" class="t t">EntryRecordModel</a>&gt; <a id="a8f95633279689e2" href="R/a8f95633279689e2.html" target="n" data-glyph="46,1" class="i field">_disableRecording</a> = <b>new</b> <a href="@0@mscorlib/A.html#97dbf1216ebac5eb" class="t constructor">AsyncLocal</a>&lt;<a href="EntryRecordModel.cs.html#7d8a1000d2861333" class="t t">EntryRecordModel</a>&gt;();
 
        <b>private readonly string</b> <a id="b5f7344db22d717a" href="R/b5f7344db22d717a.html" target="n" data-glyph="46,1" class="i field">_sessionFile</a>;
 
        <b>internal</b> <a href="TestRecordingMismatchException.cs.html#e379a1bf77dadd49" class="t t">TestRecordingMismatchException</a> <a id="50f1f21377f4211f" href="R/50f1f21377f4211f.html" target="n" data-glyph="44,1" class="i field">MismatchException</a>;
 
        <b>private</b> <a href="TestRandom.cs.html#475a6fdc1e007b74" class="t t">TestRandom</a> <a id="974fd3d7c942e8fb" href="R/974fd3d7c942e8fb.html" target="n" data-glyph="46,1" class="i field">_random</a>;
 
        <b>public</b> <a href="TestRandom.cs.html#475a6fdc1e007b74" class="t t">TestRandom</a> <a id="b9828ff8817e7824" href="R/b9828ff8817e7824.html" target="n" data-glyph="102,1" class="i property">Random</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#974fd3d7c942e8fb" class="i field">_random</a> == <b>null</b>)
                {
                    <b>switch</b> (<a href="#f12245cbae0b56da" class="i property">Mode</a>)
                    {
                        <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#6de2da8c848daf8b" class="i field">Live</a>:
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">NET6_0_OR_GREATER</span>
<span class="e">                            var liveSeed = RandomNumberGenerator.GetInt32(int.MaxValue);
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                            <a href="@0@mscorlib/A.html#d525bf7d9ca1d38a" class="k">var</a> <span id="r23 rd" class="r23 r">csp</span> = <b>new</b> <a href="@0@mscorlib/A.html#8186166d61ad1fc0" class="t constructor">RNGCryptoServiceProvider</a>();
                            <b>var</b> <span id="r24 rd" class="r24 r">bytes</span> = <b>new</b> <b>byte</b>[4];
                            <span class="r23 r">csp</span>.<a href="@0@mscorlib/A.html#9ec39b46fdc081c7" class="i method">GetBytes</a>(<span class="r24 r">bytes</span>);
                            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r25 rd" class="r25 r">liveSeed</span> = <a href="@0@mscorlib/A.html#8640d8adfffb155b" class="t t">BitConverter</a>.<a href="@0@mscorlib/A.html#1618fc20415532f2" class="i method">ToInt32</a>(<span class="r24 r">bytes</span>, 0);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                            <a href="#974fd3d7c942e8fb" class="i field">_random</a> = <b>new</b> <a href="TestRandom.cs.html#69125d60841eab3f" class="t constructor">TestRandom</a>(<a href="#f12245cbae0b56da" class="i property">Mode</a>, <span class="r25 r">liveSeed</span>);
                            <b>break</b>;
                        <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#62f98a4a2b1d56c3" class="i field">Record</a>:
                                <a href="#974fd3d7c942e8fb" class="i field">_random</a> = <b>new</b> <a href="TestRandom.cs.html#ac49b3dff82d0624" class="t constructor">TestRandom</a>(<a href="#f12245cbae0b56da" class="i property">Mode</a>);
                                <b>int</b> <span id="r26 rd" class="r26 r">seed</span> = <a href="#974fd3d7c942e8fb" class="i field">_random</a>.<a href="@0@mscorlib/A.html#7ca0970ea731a8d4" class="i method">Next</a>();
                                <a href="#e35a368de0a12de9" class="i property">Variables</a><a href="@0@System/A.html#02e38f48f2b3cbb0">[</a><a href="#6160c00500d39ae3" class="i field">RandomSeedVariableKey</a>] = <span class="r26 r">seed</span>.<a href="@0@mscorlib/A.html#8d6f2d8bc0589463" class="i method">ToString</a>();
                            <a href="#974fd3d7c942e8fb" class="i field">_random</a> = <b>new</b> <a href="TestRandom.cs.html#69125d60841eab3f" class="t constructor">TestRandom</a>(<a href="#f12245cbae0b56da" class="i property">Mode</a>, <span class="r26 r">seed</span>);
                            <b>break</b>;
                        <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#bde4663b03b59b85" class="i field">Playback</a>:
                            <a href="#974fd3d7c942e8fb" class="i field">_random</a> = <b>new</b> <a href="TestRandom.cs.html#69125d60841eab3f" class="t constructor">TestRandom</a>(<a href="#f12245cbae0b56da" class="i property">Mode</a>, <b>int</b>.<a href="@0@mscorlib/A.html#a438016f815a35c3" class="i method">Parse</a>(<a href="#e35a368de0a12de9" class="i property">Variables</a><a href="@0@System/A.html#02e38f48f2b3cbb0">[</a><a href="#6160c00500d39ae3" class="i field">RandomSeedVariableKey</a>]));
                            <b>break</b>;
                        <b>default</b>:
                            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#337b690f0704f510" class="t constructor">ArgumentOutOfRangeException</a>();
                    }
                }
                <b>return</b> <a href="#974fd3d7c942e8fb" class="i field">_random</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The moment in time that this test is being run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>? <a id="a4ba46816b6b21c3" href="R/a4ba46816b6b21c3.html" target="n" data-glyph="46,1" class="i field">_now</a>;
 
        <b>private readonly</b> <a href="TestProxy.cs.html#8aca39759c068821" class="t t">TestProxy</a> <a id="e23b8168cb4af41c" href="R/e23b8168cb4af41c.html" target="n" data-glyph="46,1" class="i field">_proxy</a>;
        <b>private readonly</b> <a href="RecordedTestBase.cs.html#37d56504090a0d7b" class="t t">RecordedTestBase</a> <a id="70b290ac136c5dbd" href="R/70b290ac136c5dbd.html" target="n" data-glyph="46,1" class="i field">_recordedTestBase</a>;
 
        <b>public string</b> <a id="67752a6c1277ad78" href="R/67752a6c1277ad78.html" target="n" data-glyph="102,1" class="i property">RecordingId</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the moment in time that this test is being run.  This is useful</span>
        <span class="c">///</span><span class="c"> for any test recordings that capture the current time.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <a id="e6b56eb0cd3db64f" href="R/e6b56eb0cd3db64f.html" target="n" data-glyph="102,1" class="i property">Now</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#a4ba46816b6b21c3" class="i field">_now</a> == <b>null</b>)
                {
                    <b>switch</b> (<a href="#f12245cbae0b56da" class="i property">Mode</a>)
                    {
                        <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#6de2da8c848daf8b" class="i field">Live</a>:
                            <a href="#a4ba46816b6b21c3" class="i field">_now</a> = <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>.<a href="@0@mscorlib/A.html#c6573f48ac6bd630" class="i property">Now</a>;
                            <b>break</b>;
                        <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#62f98a4a2b1d56c3" class="i field">Record</a>:
                            <span class="c">// While we can cache DateTimeOffset.Now for playing back tests,</span>
                            <span class="c">// a number of auth mechanisms are time sensitive and will require</span>
                            <span class="c">// values in the present when re-recording</span>
                            <a href="#a4ba46816b6b21c3" class="i field">_now</a> = <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>.<a href="@0@mscorlib/A.html#c6573f48ac6bd630" class="i property">Now</a>;
                            <a href="#e35a368de0a12de9" class="i property">Variables</a><a href="@0@System/A.html#02e38f48f2b3cbb0">[</a><a href="#bd655e3c22cf5c82" class="i field">DateTimeOffsetNowVariableKey</a>] = <a href="#a4ba46816b6b21c3" class="i field">_now</a>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>.<a href="@0@mscorlib/A.html#85b407cde54cb34e" class="i method">ToString</a>(<span class="s">&quot;O&quot;</span>); <span class="c">// Use the &quot;Round-Trip Format&quot;</span>
                            <b>break</b>;
                        <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#bde4663b03b59b85" class="i field">Playback</a>:
                            <a href="#a4ba46816b6b21c3" class="i field">_now</a> = <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>.<a href="@0@mscorlib/A.html#355516336bba15ac" class="i method">Parse</a>(<a href="#e35a368de0a12de9" class="i property">Variables</a><a href="@0@System/A.html#02e38f48f2b3cbb0">[</a><a href="#bd655e3c22cf5c82" class="i field">DateTimeOffsetNowVariableKey</a>]);
                            <b>break</b>;
                        <b>default</b>:
                            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#337b690f0704f510" class="t constructor">ArgumentOutOfRangeException</a>();
                    }
                }
                <b>return</b> <a href="#a4ba46816b6b21c3" class="i field">_now</a>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the moment in time that this test is being run in UTC format.</span>
        <span class="c">///</span><span class="c"> This is useful for any test recordings that capture the current time.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <a id="121ddf7990f13459" href="R/121ddf7990f13459.html" target="n" data-glyph="102,1" class="i property">UtcNow</a> =&gt; <a href="#e6b56eb0cd3db64f" class="i property">Now</a>.<a href="@0@mscorlib/A.html#40089ed9a791899a" class="i method">ToUniversalTime</a>();
 
        <b>public async</b> <span class="t t">ValueTask</span> <a id="20a3845efd7849e8" href="R/20a3845efd7849e8.html" target="n" data-glyph="72,1" class="i method">DisposeAsync</a>()
        {
            <b>if</b> (<a href="#f12245cbae0b56da" class="i property">Mode</a> == <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#62f98a4a2b1d56c3" class="i field">Record</a>)
            {
                <b>await</b> <a href="#e23b8168cb4af41c" class="i field">_proxy</a>.<a href="TestProxy.cs.html#453332a7dffa47e1" class="i property">Client</a>.<a href="Generated/TestProxyRestClient.cs.html#36ed993d36ccdd77" class="i method">StopRecordAsync</a>(<a href="#67752a6c1277ad78" class="i property">RecordingId</a>, <a href="#e35a368de0a12de9" class="i property">Variables</a>);
            }
        }
 
        <b>public</b> <a href="/Azure.Core/A.html#744d0090cb2d4e15" class="t t">HttpPipelineTransport</a> <a id="baa75f0c5edf5f42" href="R/baa75f0c5edf5f42.html" target="n" data-glyph="72,1" class="i method">CreateTransport</a>(<a href="/Azure.Core/A.html#744d0090cb2d4e15" class="t t">HttpPipelineTransport</a> <span id="r27 rd" class="r27 r">currentTransport</span>)
        {
            <b>if</b> (<a href="#f12245cbae0b56da" class="i property">Mode</a> != <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#6de2da8c848daf8b" class="i field">Live</a>)
            {
                <b>if</b> (<span class="r27 r">currentTransport</span> <b>is</b> <a href="ProxyTransport.cs.html#47398149a68bc02f" class="t t">ProxyTransport</a>)
                {
                    <b>return</b> <span class="r27 r">currentTransport</span>;
                }
                <b>return</b> <b>new</b> <a href="ProxyTransport.cs.html#db86140d29cd1b03" class="t constructor">ProxyTransport</a>(<a href="#e23b8168cb4af41c" class="i field">_proxy</a>, <span class="r27 r">currentTransport</span>, <a href="#cde92997ae8f348d" class="k">this</a>, () =&gt; <a href="#a8f95633279689e2" class="i field">_disableRecording</a>.<a href="@0@mscorlib/A.html#abbd6d7874f04d2e" class="i property">Value</a>);
            }
 
            <b>return</b> <span class="r27 r">currentTransport</span>;
        }
 
        <b>public string</b> <a id="14299882c0b67341" href="R/14299882c0b67341.html" target="n" data-glyph="72,1" class="i method">GenerateId</a>()
        {
            <b>return</b> <a href="#b9828ff8817e7824" class="i property">Random</a>.<a href="@0@mscorlib/A.html#7ca0970ea731a8d4" class="i method">Next</a>().<a href="@0@mscorlib/A.html#8d6f2d8bc0589463" class="i method">ToString</a>();
        }
 
        <b>public string</b> <a id="54bb468a714ee2e5" href="R/54bb468a714ee2e5.html" target="n" data-glyph="72,1" class="i method">GenerateAlphaNumericId</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r28 rd" class="r28 r">prefix</span>, <b>int</b>? <span id="r29 rd" class="r29 r">maxLength</span> = <b>null</b>, <b>bool</b> <span id="r30 rd" class="r30 r">useOnlyLowercase</span> = <b>false</b>)
        {
            <b>var</b> <span id="r31 rd" class="r31 r">stringChars</span> = <b>new</b> <b>char</b>[8];
 
            <b>for</b> (<b>int</b> <span id="r32 rd" class="r32 r">i</span> = 0; <span class="r32 r">i</span> &lt; <span class="r31 r">stringChars</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r32 r">i</span>++)
            {
                <b>if</b> (<span class="r30 r">useOnlyLowercase</span>)
                {
                    <span class="r31 r">stringChars</span>[<span class="r32 r">i</span>] = <a href="#4c037c1d7eef774f" class="i field">charsLower</a><a href="@0@mscorlib/A.html#8307d03426b56fe1">[</a><a href="#b9828ff8817e7824" class="i property">Random</a>.<a href="@0@mscorlib/A.html#8aeb183c03bdcdcf" class="i method">Next</a>(<a href="#4c037c1d7eef774f" class="i field">charsLower</a>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a>)];
                }
                <b>else</b>
                {
                    <span class="r31 r">stringChars</span>[<span class="r32 r">i</span>] = <a href="#e079d115a156221c" class="i field">chars</a><a href="@0@mscorlib/A.html#8307d03426b56fe1">[</a><a href="#b9828ff8817e7824" class="i property">Random</a>.<a href="@0@mscorlib/A.html#8aeb183c03bdcdcf" class="i method">Next</a>(<a href="#e079d115a156221c" class="i field">chars</a>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a>)];
                }
            }
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r33 rd" class="r33 r">finalString</span> = <b>new</b> <a href="@0@mscorlib/A.html#ec408439366007e6" class="k">string</a>(<span class="r31 r">stringChars</span>);
            <b>if</b> (<span class="r29 r">maxLength</span>.<a href="@0@mscorlib/A.html#7bbe60e33e857298" class="i property">HasValue</a>)
            {
                <b>return</b> <span class="s">$&quot;</span>{<span class="r28 r">prefix</span>}{<span class="r33 r">finalString</span>}<span class="s">&quot;</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(0, <span class="r29 r">maxLength</span>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>);
            }
            <b>else</b>
            {
                <b>return</b> <span class="s">$&quot;</span>{<span class="r28 r">prefix</span>}{<span class="r33 r">finalString</span>}<span class="s">&quot;</span>;
            }
        }
 
        <b>public string</b> <a id="6a3d0eb04147c634" href="R/6a3d0eb04147c634.html" target="n" data-glyph="72,1" class="i method">GenerateId</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r34 rd" class="r34 r">prefix</span>, <b>int</b> <span id="r35 rd" class="r35 r">maxLength</span>)
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r36 rd" class="r36 r">id</span> = <span class="s">$&quot;</span>{<span class="r34 r">prefix</span>}{<a href="#b9828ff8817e7824" class="i property">Random</a>.<a href="@0@mscorlib/A.html#7ca0970ea731a8d4" class="i method">Next</a>()}<span class="s">&quot;</span>;
            <b>return</b> <span class="r36 r">id</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> &gt; <span class="r35 r">maxLength</span> ? <span class="r36 r">id</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(0, <span class="r35 r">maxLength</span>) : <span class="r36 r">id</span>;
        }
 
        <b>public string</b> <a id="ebd53467ba4df734" href="R/ebd53467ba4df734.html" target="n" data-glyph="72,1" class="i method">GenerateAssetName</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r37 rd" class="r37 r">prefix</span>, [<a href="@0@mscorlib/A.html#3b59f8cb5102fd8b" class="t constructor">CallerMemberName</a>] <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r38 rd" class="r38 r">callerMethodName</span> = <span class="s">&quot;testframework_failed&quot;</span>)
        {
            <b>return</b> <span class="r37 r">prefix</span> + <a href="#b9828ff8817e7824" class="i property">Random</a>.<a href="@0@mscorlib/A.html#8aeb183c03bdcdcf" class="i method">Next</a>(9999);
        }
 
        <b>public string</b> <a id="89ed8eba7a7ce6c2" href="R/89ed8eba7a7ce6c2.html" target="n" data-glyph="72,1" class="i method">GetVariable</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r39 rd" class="r39 r">variableName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r40 rd" class="r40 r">defaultValue</span>, <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r41 rd" class="r41 r">sanitizer</span> = <b>default</b>)
        {
            <b>switch</b> (<a href="#f12245cbae0b56da" class="i property">Mode</a>)
            {
                <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#62f98a4a2b1d56c3" class="i field">Record</a>:
                    <a href="#e35a368de0a12de9" class="i property">Variables</a><a href="@0@System/A.html#02e38f48f2b3cbb0">[</a><span class="r39 r">variableName</span>] = <span class="r41 r">sanitizer</span> == <b>default</b> ? <span class="r40 r">defaultValue</span> : <span class="r41 r">sanitizer</span>.<a href="@0@mscorlib/A.html#3c17e52b9e2c8f81" class="i method">Invoke</a>(<span class="r40 r">defaultValue</span>);
                    <b>return</b> <span class="r40 r">defaultValue</span>;
                <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#6de2da8c848daf8b" class="i field">Live</a>:
                    <b>return</b> <span class="r40 r">defaultValue</span>;
                <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#bde4663b03b59b85" class="i field">Playback</a>:
                    <b>if</b> (<a href="#e35a368de0a12de9" class="i property">Variables</a>.<a href="@0@System/A.html#27a90489d6c378c5" class="i property">Count</a> == 0)
                    {
                        <b>throw</b> <b>new</b> <a href="TestRecordingMismatchException.cs.html#378daceef8bc33dc" class="t constructor">TestRecordingMismatchException</a>(<span class="s">&quot;The recording contains no variables.&quot;</span>);
                    }
                    <a href="#e35a368de0a12de9" class="i property">Variables</a>.<a href="@0@System/A.html#df02b190dd5d9feb" class="i method">TryGetValue</a>(<span class="r39 r">variableName</span>, <b>out string</b> <span id="r42 rd" class="r42 r">value</span>);
                    <b>return</b> <span class="r42 r">value</span>;
                <b>default</b>:
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#337b690f0704f510" class="t constructor">ArgumentOutOfRangeException</a>();
            }
        }
 
        <b>public void</b> <a id="9ee432907b11d245" href="R/9ee432907b11d245.html" target="n" data-glyph="72,1" class="i method">SetVariable</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r43 rd" class="r43 r">variableName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r44 rd" class="r44 r">value</span>, <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r45 rd" class="r45 r">sanitizer</span> = <b>default</b>)
        {
            <b>switch</b> (<a href="#f12245cbae0b56da" class="i property">Mode</a>)
            {
                <b>case</b> <a href="RecordedTestMode.cs.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="RecordedTestMode.cs.html#62f98a4a2b1d56c3" class="i field">Record</a>:
                    <a href="#e35a368de0a12de9" class="i property">Variables</a><a href="@0@System/A.html#02e38f48f2b3cbb0">[</a><span class="r43 r">variableName</span>] = <span class="r45 r">sanitizer</span> == <b>default</b> ? <span class="r44 r">value</span> : <span class="r45 r">sanitizer</span>.<a href="@0@mscorlib/A.html#3c17e52b9e2c8f81" class="i method">Invoke</a>(<span class="r44 r">value</span>);
                    <b>break</b>;
                <b>default</b>:
                    <b>break</b>;
            }
        }
 
        <b>public bool</b> <a id="7cdc94e9c3b7ae1a" href="R/7cdc94e9c3b7ae1a.html" target="n" data-glyph="102,1" class="i property">HasRequests</a> { <b>get</b>; <b>internal set</b>; }
 
        <b>public</b> <a href="#b93b643c2f845be6" class="t t">DisableRecordingScope</a> <a id="200d2998c7a3c313" href="R/200d2998c7a3c313.html" target="n" data-glyph="72,1" class="i method">DisableRecording</a>()
        {
            <b>return</b> <b>new</b> <a href="#c6b201045980733b" class="t constructor">DisableRecordingScope</a>(<a href="#cde92997ae8f348d" class="k">this</a>, <a href="EntryRecordModel.cs.html#7d8a1000d2861333" class="t t">EntryRecordModel</a>.<a href="EntryRecordModel.cs.html#1391ff2e02d933d8" class="i field">DoNotRecord</a>);
        }
 
        <b>public</b> <a href="#b93b643c2f845be6" class="t t">DisableRecordingScope</a> <a id="3af3aa7a0ecaa9b4" href="R/3af3aa7a0ecaa9b4.html" target="n" data-glyph="72,1" class="i method">DisableRequestBodyRecording</a>()
        {
            <b>return</b> <b>new</b> <a href="#c6b201045980733b" class="t constructor">DisableRecordingScope</a>(<a href="#cde92997ae8f348d" class="k">this</a>, <a href="EntryRecordModel.cs.html#7d8a1000d2861333" class="t t">EntryRecordModel</a>.<a href="EntryRecordModel.cs.html#68c924bb4c3e9ff8" class="i field">RecordWithoutRequestBody</a>);
        }
 
        <b>public struct</b> <a id="b93b643c2f845be6" href="R/b93b643c2f845be6.html" target="n" data-glyph="108,1" class="t t"><span id="2f2c66d6a34aa364">DisableRecordingScope</span></a> : <a href="@0@mscorlib/A.html#1f55292c3174123d" class="t t">IDisposable</a>
        {
            <b>private readonly</b> <a href="#cde92997ae8f348d" class="t t">TestRecording</a> <a id="ad198141d1953b58" href="R/ad198141d1953b58.html" target="n" data-glyph="46,2" class="i field">_testRecording</a>;
 
            <b>public</b> <a id="c6b201045980733b" href="R/c6b201045980733b.html" target="n" data-glyph="72,2" class="t constructor">DisableRecordingScope</a>(<a href="#cde92997ae8f348d" class="t t">TestRecording</a> <span id="r46 rd" class="r46 r">testRecording</span>, <a href="EntryRecordModel.cs.html#7d8a1000d2861333" class="t t">EntryRecordModel</a> <span id="r47 rd" class="r47 r">entryRecordModel</span>)
            {
                <a href="#ad198141d1953b58" class="i field">_testRecording</a> = <span class="r46 r">testRecording</span>;
                <a href="#ad198141d1953b58" class="i field">_testRecording</a>.<a href="#a8f95633279689e2" class="i field">_disableRecording</a>.<a href="@0@mscorlib/A.html#abbd6d7874f04d2e" class="i property">Value</a> = <span class="r47 r">entryRecordModel</span>;
            }
 
            <b>public void</b> <a id="992ca1e8924791b8" href="R/992ca1e8924791b8.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#ad198141d1953b58" class="i field">_testRecording</a>.<a href="#a8f95633279689e2" class="i field">_disableRecording</a>.<a href="@0@mscorlib/A.html#abbd6d7874f04d2e" class="i property">Value</a> = <a href="EntryRecordModel.cs.html#7d8a1000d2861333" class="t t">EntryRecordModel</a>.<a href="EntryRecordModel.cs.html#45ae519388b1a769" class="i field">Record</a>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
