<!DOCTYPE html>
<html><head><title>ManagedInstanceHybridLinkTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(231);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Sql.Tests/ManagedInstanceHybridLinkTests.cs" target="_top">ManagedInstanceHybridLinkTests.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/sqlmanagement/Microsoft.Azure.Management.Sql/tests/ManagedInstanceHybridLinkTests.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Sql.Tests" target="_top">Microsoft.Azure.Management.Sql.Tests.csproj</a> (Sql.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">ResourceManager</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">ResourceManager</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Sql</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Sql</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Rest</span>.<span class="i n">Azure</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Rest</span>.<span class="i n">ClientRuntime</span>.<span class="i n">Azure</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">Xunit</span>;
 
<b>namespace</b> <span class="i n">Sql</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="e58783a7a7a51b85" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="dc4aeef63869c65a">ManagedInstanceHybridLinkTests</span></a>
    {
        <b>private const string</b> <a id="b48d251c004adbac" href="R/b48d251c004adbac.html" target="n" data-glyph="10,1" class="i field">certificateName1</a> = <span class="s">&quot;test_cert1&quot;</span>;
        <b>private const string</b> <a id="615a42cd3f521026" href="R/615a42cd3f521026.html" target="n" data-glyph="10,1" class="i field">thumbprint1</a> = <span class="s">&quot;0x5E1C40529126487B5B20C0E7E299FFF7190E94D7&quot;</span>;
        <b>private const string</b> <a id="5f096d12f4e8e2fe" href="R/5f096d12f4e8e2fe.html" target="n" data-glyph="10,1" class="i field">publicBlob1</a> =
            <span class="s">&quot;0x3082031E30820206A00302010202107339C358890D88B04D584E95AD40EFA0300D06092A864886F70D01010B0500304B3149304706035504031E40004D0053005F0053006D006F0045007800740065&quot;</span> +
            <span class="s">&quot;006E006400650064005300690067006E0069006E006700430065007200740069006600690063006100740065301E170D3231303332333031343733385A170D3232303332333031343733385A304B3149&quot;</span> +
            <span class="s">&quot;304706035504031E40004D0053005F0053006D006F0045007800740065006E006400650064005300690067006E0069006E00670043006500720074006900660069006300610074006530820122300D06&quot;</span> +
            <span class="s">&quot;092A864886F70D01010105000382010F003082010A0282010100B796616200301A3E8E06A594CD45EB665676E23368222D7F7F70E6474B602978A7A3D45381B293D6FE5C4EB47298496CDA2599DBC264&quot;</span> +
            <span class="s">&quot;5B2A1CEB311FC4D5AD5AE162E337776D90B8D1E30BF2BB1D19783B22AA261EBA70FBF6896FFE356ED7A7E09EA71F67B6E2213ACE95E8DA12038B6D2D2C986D56CA0859D6A1BDA7DA08DCFFE11FF1E59E&quot;</span> +
            <span class="s">&quot;DA4225BC0A252405025E49F5C34B65E9614DF8BBD78AFE33CD14E32F2043D833EE7EF6CE3E663BF437A72DE2933D6FC62FB5E87F6B443A0257135C09B8308B231358594EE2FD3A384B3AD5B7D22B1B35&quot;</span> +
            <span class="s">&quot;E1682F28CC5F7F27A233D704E7DE46126B811E5CF4D2835C316DBD9A4288DA02B2481FF8FCEF754F957D0203010001300D06092A864886F70D01010B0500038201010029577117B09612B085B6AE4741&quot;</span> +
            <span class="s">&quot;7C556013DEF38F61E726E1DEE908332BDD50F830CE43B7D61F20E300E50E23305C94D19DB5FF0F66D0E7B6DAB6510680A10B346653359C1B20F219BF1EB4217B6AEC4CD01BB96F0E84CC9C5DC6DA325E&quot;</span> +
            <span class="s">&quot;B8979DCA9E9F61AF1C2BB3E3DAB4DE7D118588184FF98FE8E803F3374392464A64563D097AB878DB01115CD443EAF58B0705E13A1E27021F6C0E0104CF5307DCCA79D4CA70F26A3FD2CE89AAE0AD1C08&quot;</span> +
            <span class="s">&quot;E884AB1BD8FAF3983A0667820BB122688E30C873932FB25BF85EA0B23E651D4DBA5436EC6F17D770832E7041ED44952883470E1B599FDB0E518E663CBD6FED7983849101A89497CF4D0C9FE2DF7F9C2B&quot;</span> +
            <span class="s">&quot;E3C21A&quot;</span>;
        <b>private const string</b> <a id="2afee53e3c4873ca" href="R/2afee53e3c4873ca.html" target="n" data-glyph="10,1" class="i field">certificateName2</a> = <span class="s">&quot;test_cert2&quot;</span>;
        <b>private const string</b> <a id="37efcbc4580890d6" href="R/37efcbc4580890d6.html" target="n" data-glyph="10,1" class="i field">publicBlob2</a> = <span class="s">&quot;0x3082&quot;</span> +
            <span class="s">&quot;031E30820206A003020102021015ECCB530A52D0874A9B4DFB69FFCAA0300D06092A864886F70D01010B0500304B3149304706035504031E40004D0053005F00530051004C005200650073006F007500&quot;</span> +
            <span class="s">&quot;7200630065005300690067006E0069006E006700430065007200740069006600690063006100740065301E170D3231303332333031343733385A170D3232303332333031343733385A304B3149304706&quot;</span> +
            <span class="s">&quot;035504031E40004D0053005F00530051004C005200650073006F0075007200630065005300690067006E0069006E00670043006500720074006900660069006300610074006530820122300D06092A86&quot;</span> +
            <span class="s">&quot;4886F70D01010105000382010F003082010A0282010100C3BC903BD030D2EE904E941B603040F7DF38262BBA86AD3B9AD4BFE361D910378C5459DE540398E43124272BAE97AE502490F5140393A66EC4&quot;</span> +
            <span class="s">&quot;9667D1B64449EAECC0DCB7FCA5BBF2E214F0AF8A697CBAF790B0FCD086C69C06A363849D7481468894E40F0B6466591775FFA6B3E387F5C56126078EBB69CB7EA9FD842233A29C9D92EE0ED2D9D09C96&quot;</span> +
            <span class="s">&quot;EBE2B4089EBE9A2D2276F75F506FD09CB3DF312C2B737E8E20AB4C7F48EF5D730D8AB4BB7234315ABD4CB2568896801CECB2B6452EADAEE2DFC7E8B03B01B0F8742BF9DA941E5449F14ABA8BAA58189D&quot;</span> +
            <span class="s">&quot;4F7558068E782580181038EB3DBAC7FD53D200357298258F3AC9ACCA4845F83C8539E35FC36B750203010001300D06092A864886F70D01010B0500038201010072200767AE16B164DCC9A7439F96CA3E&quot;</span> +
            <span class="s">&quot;BFDEEF8440B2BD9356E0257520FB8A2763E90BB6D727F7CE63CC40B40872A7C77B451EFD5CB022D349303C75956CA372D3FF513516EEA0F545240D451FC98EA743008EFDE63ABC003AEE3FA80CA05425&quot;</span> +
            <span class="s">&quot;CA3FD9C0EC8123BD6F1E9DAFE5AC33AF3A1DE89E6F28349DE7A5EE5AE39F0E6AD87B3D03037FDB9F1B1A7BB1B55A51A70C9E0604BC9EDDFA4BF1582C039826E89F960720FC6B6AB398DFFC4B38A2F7C5&quot;</span> +
            <span class="s">&quot;26C9AC31D96BA40D9B02FC58FFAA37BE5B3DC0DCCF9F1ED1358A23E4E7D0E3A397B841BCFB7AE8405DE8A42511C2C3B14DFB13F467F16ED63EEB0E22127E281EEDCBD9A3D3C957AC51D5D75FBB713018&quot;</span>;
        <b>private const string</b> <a id="c6f203a9cbfffaaf" href="R/c6f203a9cbfffaaf.html" target="n" data-glyph="10,1" class="i field">thumbprint2</a> = <span class="s">&quot;0x3B3209B3F06A633946AB89FA5E18D7A7E81A066E&quot;</span>;
        <b>private const string</b> <a id="0d1b313f5ba0b70c" href="R/0d1b313f5ba0b70c.html" target="n" data-glyph="10,1" class="i field">invalidCertName1</a> = <span class="s">&quot;invalid_cert1&quot;</span>;
        <b>private const string</b> <a id="cc14fc15ebc26656" href="R/cc14fc15ebc26656.html" target="n" data-glyph="10,1" class="i field">invalidCertName2</a> = <span class="s">&quot;invalid_cert2&quot;</span>;
        <b>private const string</b> <a id="a18453799b3f352e" href="R/a18453799b3f352e.html" target="n" data-glyph="10,1" class="i field">invalidCertName3</a> = <span class="s">&quot;invalid_cert3&quot;</span>;
        <b>private const string</b> <a id="02a4f44891693e72" href="R/02a4f44891693e72.html" target="n" data-glyph="10,1" class="i field">invalidPublicBlob</a> = <span class="s">&quot;0x3082031E30820206A00302010202107339C358890D88B04D584E95AD40EFA0300D06092A864886F70D01010B0500304B3149304706035504031E40004D0053005F0053006D006F0045007800740065&quot;</span>;
        <b>private const string</b> <a id="0253e1da8dcf8c7b" href="R/0253e1da8dcf8c7b.html" target="n" data-glyph="10,1" class="i field">publicBlob3</a> =
            <span class="s">&quot;0x30820316308201FEA003020102021072F30C6F228A33B64405E7EA8BB1C949300D06092A864886F70D01010B050030473145304306035504031E3C004D0053005F00530051004C0041007500740068&quot;</span> +
            <span class="s">&quot;0065006E00740069006300610074006F007200430065007200740069006600690063006100740065301E170D3231303332333031343733385A170D3232303332333031343733385A3047314530430603&quot;</span> +
            <span class="s">&quot;5504031E3C004D0053005F00530051004C00410075007400680065006E00740069006300610074006F00720043006500720074006900660069006300610074006530820122300D06092A864886F70D01&quot;</span> +
            <span class="s">&quot;010105000382010F003082010A0282010100C6DB530E4E055B502D75A1E25EE65403B754A4079898027018E3032DDD42A67C243797DAA737C32E933E4582DC2BBADE16F35C41E55ED77B6AC640F7DE78&quot;</span> +
            <span class="s">&quot;8FCD617A594FD6A4A0BC4F2FCAC84D031F1D1F4DD82225E953918550DF657633C1FB1D5D227DCBF7A924122165E3C67F5E88AA68EA509BAB82966C377C1F3CF83A0AEAFFD18B3C24D631FE12DF7D1065&quot;</span> +
            <span class="s">&quot;9A6601ACD55CAA95CC57CD3E4B29B01271F0FA64725E288BEAEB7792B15FE2FD36EF8A86CEBF3AAEFCCAD3A84295EB01E0AD776617FB42A470A9F5956011C11BFFB881C97650647C734393A68AC379EB&quot;</span> +
            <span class="s">&quot;9187DEBAD9C61F26BB8AEFE5A1AD549010DA7DBF0478EEEBB4D55C5863DB336A7F7D0203010001300D06092A864886F70D01010B05000382010100C052781B299ECFB0B833B5DC3CC96E0C9DAB690070&quot;</span> +
            <span class="s">&quot;8F16059E13A8A5D07493A7BB551E7E2513284F11AA8D6F8AB85374B43A97388387FC8E0DB45650D68E61F634E1CD86D064F8831CD5E353FD6D304087A604CEB4388866BCB64CD95F3F45D76D4A97C4EC&quot;</span> +
            <span class="s">&quot;AA1512202F24001784C00243D63AFC402247A961FB48578B28BBC8496A4441A0A72BF12755F1C16810A53723510F498908C824340F0B18081615A2EF75B4B94F5A22D9D1B4A0AA483006B0A8B035F4D5&quot;</span> +
            <span class="s">&quot;D0E5FD247C7199874C3E0BD4E80DF013BA7636BE906146C888B1C4848A729797A971C74D67FFC6A926978F6F9A3A222AD534F27A1F7FEFB48E54C335050447BF41D8CCB71889D836BB6AC6&quot;</span>;
        <b>private const string</b> <a id="89f134192bb97273" href="R/89f134192bb97273.html" target="n" data-glyph="10,1" class="i field">thumbprint3</a> = <span class="s">&quot;0xC8002E47F5BC5A3D3692B57D6987C7D9D79863DA&quot;</span>;
        <b>private const string</b> <a id="6c35bb52957f19ba" href="R/6c35bb52957f19ba.html" target="n" data-glyph="10,1" class="i field">certType</a> = <span class="s">&quot;Microsoft.Sql/managedInstances/serverTrustCertificates&quot;</span>;
 
        <b>private static readonly</b> <a href="@1@System.Runtime/A.html#8adbe0476ca899db" class="t t">Func</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="a5f83232d0c14409" href="R/a5f83232d0c14409.html" target="n" data-glyph="46,1" class="i field">makeId</a> = (<span id="r0 rd" class="r0 r">managedInstanceId</span>, <span id="r1 rd" class="r1 r">certificateName</span>) =&gt;
        {
            <b>return</b> <span class="r0 r">managedInstanceId</span> + <span class="s">&quot;/serverTrustCertificates/&quot;</span> + <span class="r1 r">certificateName</span>;
        };
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="ca92d2f545b37bce" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestServerTrustCertificates</a>()
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r2 rd" class="r2 r">suiteName</span> = <a href="#e58783a7a7a51b85" class="k">this</a>.<a href="@1@System.Runtime/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@1@System.Runtime/A.html#aa4f112f79364b6e" class="i property">Name</a>;
            <b>using</b> (<a href="Utilities/SqlManagementTestContext.cs.html#b7501aa20cfde2f6" class="t t">SqlManagementTestContext</a> <span id="r3 rd" class="r3 r">context</span> = <b>new</b> <a href="Utilities/SqlManagementTestContext.cs.html#f13fb934ef910196" class="t constructor">SqlManagementTestContext</a>(<a href="#e58783a7a7a51b85" class="k">this</a>))
            {
                <span class="c">// Test setup (rg, mi):</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#f22e402720791608" class="t t">SqlManagementClient</a> <span id="r4 rd" class="r4 r">sqlClient</span> = <span class="r3 r">context</span>.<a href="Utilities/SqlManagementTestContext.cs.html#221475a46aa645f5" class="i method">GetClient</a>&lt;<a href="/Microsoft.Azure.Management.Sql/A.html#f22e402720791608" class="t t">SqlManagementClient</a>&gt;();
                <span class="c">//ResourceGroup rg = new ResourceGroup(location: &quot;eastus2euap&quot;, id: &quot;/subscriptions/8313371e-0879-428e-b1da-6353575a9192/resourceGroups/CustomerExperienceTeam_RG&quot;, name: &quot;CustomerExperienceTeam_RG&quot;);</span>
                <span class="c">//ManagedInstance managedInstance = sqlClient.ManagedInstances.Get(rg.Name, &quot;chimera-ps-cli-v2&quot;);</span>
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#02976872e1e92fca" class="t t">ResourceGroup</a> <span id="r5 rd" class="r5 r">rg</span> = <span class="r3 r">context</span>.<a href="Utilities/SqlManagementTestContext.cs.html#883a64161f5187ee" class="i method">CreateResourceGroup</a>(<a href="Utilities/ManagedInstanceTestUtilities.cs.html#76e6d767bb829821" class="t t">ManagedInstanceTestUtilities</a>.<a href="Utilities/ManagedInstanceTestUtilities.cs.html#078a02b6da04de1c" class="i field">Region</a>);
                <a href="/Microsoft.Azure.Management.Sql/A.html#990449042ecfe1b7" class="t t">ManagedInstance</a> <span id="r6 rd" class="r6 r">managedInstance</span> = <span class="r3 r">context</span>.<a href="Utilities/SqlManagementTestContext.cs.html#1f3aec4116a6c2ff" class="i method">CreateManagedInstance</a>(<span class="r5 r">rg</span>);
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r6 r">managedInstance</span>);
 
                <span class="c">// Test data:</span>
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r7 rd" class="r7 r">resourceGroupName</span> = <span class="r5 r">rg</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#8b9cad64c5dcd7b1" class="i property">Name</a>;
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r8 rd" class="r8 r">managedInstanceName</span> = <span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#b3cbf98820cbdac0" class="i property">Name</a>;
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r9 rd" class="r9 r">expectedCert1</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>), <a href="#b48d251c004adbac" class="i field">certificateName1</a>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <a href="#5f096d12f4e8e2fe" class="i field">publicBlob1</a>, <a href="#615a42cd3f521026" class="i field">thumbprint1</a>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>);
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r10 rd" class="r10 r">expectedCert2</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <a href="#2afee53e3c4873ca" class="i field">certificateName2</a>), <a href="#2afee53e3c4873ca" class="i field">certificateName2</a>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <a href="#37efcbc4580890d6" class="i field">publicBlob2</a>, <a href="#c6f203a9cbfffaaf" class="i field">thumbprint2</a>, <a href="#2afee53e3c4873ca" class="i field">certificateName2</a>);
 
                <span class="c">// Make API calls</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r11 rd" class="r11 r">upsertResp1</span> = <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>, <span class="r9 r">expectedCert1</span>);
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r12 rd" class="r12 r">upsertResp2</span> = <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#2afee53e3c4873ca" class="i field">certificateName2</a>, <span class="r10 r">expectedCert2</span>);
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r13 rd" class="r13 r">getResp1</span> = <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#75c40320292b7506" class="i method">Get</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>);
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r14 rd" class="r14 r">getResp2</span> = <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#75c40320292b7506" class="i method">Get</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#2afee53e3c4873ca" class="i field">certificateName2</a>);
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#8125b18f5d7ee303" class="k">var</a> <span id="r15 rd" class="r15 r">listResp</span> = <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#e3c8ddc18f9ef643" class="i method">ListByInstance</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>);
 
                <span class="c">// Test all result fields</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r16 rd" class="r16 r">listRespCert1</span> = <span class="r15 r">listResp</span>.<span class="i method">Where</span>(<span id="r17 rd" class="r17 r">cert</span> =&gt; <span class="r17 r">cert</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#b3cbf98820cbdac0" class="i property">Name</a>.<a href="@1@System.Runtime/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<a href="#b48d251c004adbac" class="i field">certificateName1</a>)).<span class="i method">FirstOrDefault</span>();
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r18 rd" class="r18 r">listRespCert2</span> = <span class="r15 r">listResp</span>.<span class="i method">Where</span>(<span id="r19 rd" class="r19 r">cert</span> =&gt; <span class="r19 r">cert</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#b3cbf98820cbdac0" class="i property">Name</a>.<a href="@1@System.Runtime/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<a href="#2afee53e3c4873ca" class="i field">certificateName2</a>)).<span class="i method">FirstOrDefault</span>();
                <b>var</b> <span id="r20 rd" class="r20 r">expected</span> = <b>new</b>[] { <span class="r9 r">expectedCert1</span>, <span class="r10 r">expectedCert2</span>, <span class="r9 r">expectedCert1</span>, <span class="r10 r">expectedCert2</span>, <span class="r9 r">expectedCert1</span>, <span class="r10 r">expectedCert2</span> };
                <b>var</b> <span id="r21 rd" class="r21 r">actual</span> = <b>new</b>[] { <span class="r11 r">upsertResp1</span>, <span class="r12 r">upsertResp2</span>, <span class="r13 r">getResp1</span>, <span class="r14 r">getResp2</span>, <span class="r16 r">listRespCert1</span>, <span class="r18 r">listRespCert2</span> };
                <a href="@1@System.Runtime/A.html#3acf01620172c7f0" class="k">var</a> <span id="r22 rd" class="r22 r">exp_act</span> = <span class="r20 r">expected</span>.<span class="i method">Zip</span>(<span class="r21 r">actual</span>, (<span id="r23 rd" class="r23 r">e</span>, <span id="r24 rd" class="r24 r">a</span>) =&gt; <b>new</b> { <a href="#d967ca56a58fc511" class="i property">Expected</a> = <span class="r23 r">e</span>, <a href="#6c558044867850c9" class="i property">Actual</a> = <span class="r24 r">a</span> });
                <b>foreach</b> (<a href="#dfe3b8f435c41279" class="k">var</a> <span id="r25 rd" class="r25 r">ea</span> <b>in</b> <span class="r22 r">exp_act</span>)
                {
                    <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r25 r">ea</span>.<a href="#6c558044867850c9" class="i property">Actual</a>);
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r25 r">ea</span>.<a href="#d967ca56a58fc511" class="i property">Expected</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#fc89de508bc55984" class="i property">CertificateName</a>, <span class="r25 r">ea</span>.<a href="#6c558044867850c9" class="i property">Actual</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#fc89de508bc55984" class="i property">CertificateName</a>);
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r25 r">ea</span>.<a href="#d967ca56a58fc511" class="i property">Expected</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <span class="r25 r">ea</span>.<a href="#6c558044867850c9" class="i property">Actual</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>);
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r25 r">ea</span>.<a href="#d967ca56a58fc511" class="i property">Expected</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#b3cbf98820cbdac0" class="i property">Name</a>, <span class="r25 r">ea</span>.<a href="#6c558044867850c9" class="i property">Actual</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#b3cbf98820cbdac0" class="i property">Name</a>);
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r25 r">ea</span>.<a href="#d967ca56a58fc511" class="i property">Expected</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#17a5243554bd618c" class="i property">PublicBlob</a>, <span class="s">&quot;0x&quot;</span> + <span class="r25 r">ea</span>.<a href="#6c558044867850c9" class="i property">Actual</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#17a5243554bd618c" class="i property">PublicBlob</a>);
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r25 r">ea</span>.<a href="#d967ca56a58fc511" class="i property">Expected</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#317b48397cbdb05c" class="i property">Thumbprint</a>, <span class="s">&quot;0x&quot;</span> + <span class="r25 r">ea</span>.<a href="#6c558044867850c9" class="i property">Actual</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#317b48397cbdb05c" class="i property">Thumbprint</a>);
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r25 r">ea</span>.<a href="#d967ca56a58fc511" class="i property">Expected</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#dbd069c9927b5ee1" class="i property">Type</a>, <span class="r25 r">ea</span>.<a href="#6c558044867850c9" class="i property">Actual</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#dbd069c9927b5ee1" class="i property">Type</a>);
                }
 
                <span class="c">// cert with invalid public key blob</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r26 rd" class="r26 r">invalidCert1</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <a href="#0d1b313f5ba0b70c" class="i field">invalidCertName1</a>), <a href="#0d1b313f5ba0b70c" class="i field">invalidCertName1</a>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <a href="#02a4f44891693e72" class="i field">invalidPublicBlob</a>, <a href="#615a42cd3f521026" class="i field">thumbprint1</a>, <a href="#0d1b313f5ba0b70c" class="i field">invalidCertName1</a>);
                <span class="c">// cert without public key blob</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r27 rd" class="r27 r">invalidCert2</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <a href="#cc14fc15ebc26656" class="i field">invalidCertName2</a>), <a href="#cc14fc15ebc26656" class="i field">invalidCertName2</a>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <b>null</b>, <a href="#c6f203a9cbfffaaf" class="i field">thumbprint2</a>, <a href="#cc14fc15ebc26656" class="i field">invalidCertName2</a>);
                <span class="c">// cert with a public blob that already exist on the instance under a different name</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r28 rd" class="r28 r">invalidCert3</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>), <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <a href="#5f096d12f4e8e2fe" class="i field">publicBlob1</a>, <a href="#615a42cd3f521026" class="i field">thumbprint1</a>, <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>);
                <span class="c">// cert blob empty</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r29 rd" class="r29 r">invalidCert4</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>), <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <span class="s">&quot;&quot;</span>, <a href="#615a42cd3f521026" class="i field">thumbprint1</a>, <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>);
                <span class="c">// cert name exists, different blob</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r30 rd" class="r30 r">invalidCert5</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>), <a href="#b48d251c004adbac" class="i field">certificateName1</a>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <a href="#0253e1da8dcf8c7b" class="i field">publicBlob3</a>, <a href="#89f134192bb97273" class="i field">thumbprint3</a>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>);
                <span class="c">// cert name empty</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#163b84e2888ca3ee" class="k">var</a> <span id="r31 rd" class="r31 r">invalidCert6</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#fa8f93ef23cf48cc" class="t constructor">ServerTrustCertificate</a>(<a href="#a5f83232d0c14409" class="i field">makeId</a>(<span class="r6 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8bfd2e4500e6f9f0" class="i property">Id</a>, <span class="s">&quot;&quot;</span>), <span class="s">&quot;&quot;</span>, <a href="#6c35bb52957f19ba" class="i field">certType</a>, <a href="#5f096d12f4e8e2fe" class="i field">publicBlob1</a>, <a href="#615a42cd3f521026" class="i field">thumbprint1</a>, <span class="s">&quot;&quot;</span>);
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r32 rd" class="r32 r">exception1</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#0d1b313f5ba0b70c" class="i field">invalidCertName1</a>, <span class="r26 r">invalidCert1</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r33 rd" class="r33 r">exception2</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#cc14fc15ebc26656" class="i field">invalidCertName2</a>, <span class="r27 r">invalidCert2</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r34 rd" class="r34 r">exception3</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>, <span class="r28 r">invalidCert3</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r35 rd" class="r35 r">exception4</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#a18453799b3f352e" class="i field">invalidCertName3</a>, <span class="r29 r">invalidCert4</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r36 rd" class="r36 r">exception5</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>, <span class="r30 r">invalidCert5</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r37 rd" class="r37 r">exception6</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#52d9397fcd07756b" class="i method">CreateOrUpdate</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <span class="s">&quot;&quot;</span>, <span class="r31 r">invalidCert6</span>));
                <span class="t t">Assert</span>.<span class="i method">Contains</span>(<span class="s">&quot;InvalidPublicBlob&quot;</span>, <span class="r32 r">exception1</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
                <span class="t t">Assert</span>.<span class="i method">Contains</span>(<span class="s">&quot;MissingPublicBlob&quot;</span>, <span class="r35 r">exception4</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
                <span class="t t">Assert</span>.<span class="i method">Contains</span>(<span class="s">&quot;MethodNotAllowed&quot;</span>, <span class="r37 r">exception6</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
 
                <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#70820b55f062afac" class="i method">BeginDelete</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#b48d251c004adbac" class="i field">certificateName1</a>);
                <span class="r4 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#9a48e51fca541e67" class="i property">ServerTrustCertificates</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#70820b55f062afac" class="i method">BeginDelete</a>(<span class="r7 r">resourceGroupName</span>, <span class="r8 r">managedInstanceName</span>, <a href="#2afee53e3c4873ca" class="i field">certificateName2</a>);
            }
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="fe127b84dc2056e1" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestDistributedAvailabilityGroup</a>()
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r38 rd" class="r38 r">suiteName</span> = <a href="#e58783a7a7a51b85" class="k">this</a>.<a href="@1@System.Runtime/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@1@System.Runtime/A.html#aa4f112f79364b6e" class="i property">Name</a>;
            <b>using</b> (<a href="Utilities/SqlManagementTestContext.cs.html#b7501aa20cfde2f6" class="t t">SqlManagementTestContext</a> <span id="r39 rd" class="r39 r">context</span> = <b>new</b> <a href="Utilities/SqlManagementTestContext.cs.html#f13fb934ef910196" class="t constructor">SqlManagementTestContext</a>(<a href="#e58783a7a7a51b85" class="k">this</a>))
            {
 
                <span class="c">// Test setup (rg, mi):</span>
                <a href="/Microsoft.Azure.Management.Sql/A.html#f22e402720791608" class="t t">SqlManagementClient</a> <span id="r40 rd" class="r40 r">sqlClient</span> = <span class="r39 r">context</span>.<a href="Utilities/SqlManagementTestContext.cs.html#221475a46aa645f5" class="i method">GetClient</a>&lt;<a href="/Microsoft.Azure.Management.Sql/A.html#f22e402720791608" class="t t">SqlManagementClient</a>&gt;();
                <span class="c">//ResourceGroup rg = new ResourceGroup(location: &quot;eastus2euap&quot;, id: &quot;/subscriptions/8313371e-0879-428e-b1da-6353575a9192/resourceGroups/CustomerExperienceTeam_RG&quot;, name: &quot;CustomerExperienceTeam_RG&quot;);</span>
                <span class="c">//ManagedInstance managedInstance = sqlClient.ManagedInstances.Get(rg.Name, &quot;chimera-ps-cli-v2&quot;);</span>
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#02976872e1e92fca" class="t t">ResourceGroup</a> <span id="r41 rd" class="r41 r">rg</span> = <span class="r39 r">context</span>.<a href="Utilities/SqlManagementTestContext.cs.html#883a64161f5187ee" class="i method">CreateResourceGroup</a>(<a href="Utilities/ManagedInstanceTestUtilities.cs.html#76e6d767bb829821" class="t t">ManagedInstanceTestUtilities</a>.<a href="Utilities/ManagedInstanceTestUtilities.cs.html#078a02b6da04de1c" class="i field">Region</a>);
                <a href="/Microsoft.Azure.Management.Sql/A.html#990449042ecfe1b7" class="t t">ManagedInstance</a> <span id="r42 rd" class="r42 r">managedInstance</span> = <span class="r39 r">context</span>.<a href="Utilities/SqlManagementTestContext.cs.html#1f3aec4116a6c2ff" class="i method">CreateManagedInstance</a>(<span class="r41 r">rg</span>);
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r42 r">managedInstance</span>);
 
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r43 rd" class="r43 r">resourceGroupName</span> = <span class="r41 r">rg</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#8b9cad64c5dcd7b1" class="i property">Name</a>;
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r44 rd" class="r44 r">managedInstanceName</span> = <span class="r42 r">managedInstance</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#b3cbf98820cbdac0" class="i property">Name</a>;
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r45 rd" class="r45 r">dagName</span> = <span class="s">&quot;TestDAG&quot;</span>;
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r46 rd" class="r46 r">dagParams</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#1481d79da0e0a1b3" class="t constructor">DistributedAvailabilityGroup</a>()
                {
                    <a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a> = <span class="s">&quot;testdb&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a> = <span class="s">&quot;TCP://SERVER:7022&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#f94a48f5489c78df" class="i property">PrimaryAvailabilityGroupName</a> = <span class="s">&quot;BoxLocalAg1&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#056e997ca29b05e0" class="i property">SecondaryAvailabilityGroupName</a> = <span class="s">&quot;testcl&quot;</span>,
                };
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r47 rd" class="r47 r">invalidDAG1</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#1481d79da0e0a1b3" class="t constructor">DistributedAvailabilityGroup</a>()
                {
                    <span class="c">//TargetDatabase = &quot;testdb&quot;,</span>
                    <a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a> = <span class="s">&quot;TCP://SERVER:7022&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#f94a48f5489c78df" class="i property">PrimaryAvailabilityGroupName</a> = <span class="s">&quot;BoxLocalAg1&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#056e997ca29b05e0" class="i property">SecondaryAvailabilityGroupName</a> = <span class="s">&quot;testcl&quot;</span>,
                };
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r48 rd" class="r48 r">invalidDAG2</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#1481d79da0e0a1b3" class="t constructor">DistributedAvailabilityGroup</a>()
                {
                    <a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a> = <span class="s">&quot;testdb&quot;</span>,
                    <span class="c">//SourceEndpoint = &quot;TCP://SERVER:7022&quot;,</span>
                    <a href="/Microsoft.Azure.Management.Sql/A.html#f94a48f5489c78df" class="i property">PrimaryAvailabilityGroupName</a> = <span class="s">&quot;BoxLocalAg1&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#056e997ca29b05e0" class="i property">SecondaryAvailabilityGroupName</a> = <span class="s">&quot;testcl&quot;</span>,
                };
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r49 rd" class="r49 r">invalidDAG3</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#1481d79da0e0a1b3" class="t constructor">DistributedAvailabilityGroup</a>()
                {
                    <a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a> = <span class="s">&quot;testdb&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a> = <span class="s">&quot;TCP://SERVER:7022&quot;</span>,
                    <span class="c">//PrimaryAvailabilityGroupName = &quot;BoxLocalAg1&quot;,</span>
                    <a href="/Microsoft.Azure.Management.Sql/A.html#056e997ca29b05e0" class="i property">SecondaryAvailabilityGroupName</a> = <span class="s">&quot;testcl&quot;</span>,
                };
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r50 rd" class="r50 r">invalidDAG4</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#1481d79da0e0a1b3" class="t constructor">DistributedAvailabilityGroup</a>()
                {
                    <a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a> = <span class="s">&quot;testdb&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a> = <span class="s">&quot;TCP://SERVER:7022&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Sql/A.html#f94a48f5489c78df" class="i property">PrimaryAvailabilityGroupName</a> = <span class="s">&quot;BoxLocalAg1&quot;</span>,
                    <span class="c">//SecondaryAvailabilityGroupName = &quot;testcl&quot;,</span>
                };
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r51 rd" class="r51 r">invalidDAG5</span> = <b>new</b> <a href="/Microsoft.Azure.Management.Sql/A.html#1481d79da0e0a1b3" class="t constructor">DistributedAvailabilityGroup</a>();
 
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r52 rd" class="r52 r">exCreate1</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#3a649436f51dc62b" class="i method">CreateOrUpdate</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="s">&quot;invalid_dag1&quot;</span>, <span class="r47 r">invalidDAG1</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r53 rd" class="r53 r">exCreate2</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#3a649436f51dc62b" class="i method">CreateOrUpdate</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="s">&quot;invalid_dag2&quot;</span>, <span class="r48 r">invalidDAG2</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r54 rd" class="r54 r">exCreate3</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#3a649436f51dc62b" class="i method">CreateOrUpdate</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="s">&quot;invalid_dag3&quot;</span>, <span class="r49 r">invalidDAG3</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r55 rd" class="r55 r">exCreate4</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#3a649436f51dc62b" class="i method">CreateOrUpdate</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="s">&quot;invalid_dag4&quot;</span>, <span class="r50 r">invalidDAG4</span>));
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r56 rd" class="r56 r">exCreate5</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#3a649436f51dc62b" class="i method">CreateOrUpdate</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="s">&quot;invalid_dag5&quot;</span>, <span class="r51 r">invalidDAG5</span>));
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;InvalidParameterValue&quot;</span>, <span class="r52 r">exCreate1</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;InvalidParameterValue&quot;</span>, <span class="r53 r">exCreate2</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;InvalidParameterValue&quot;</span>, <span class="r54 r">exCreate3</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;InvalidParameterValue&quot;</span>, <span class="r55 r">exCreate4</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
 
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r57 rd" class="r57 r">upsertResp</span> = <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#bd619e38bfb997f8" class="i method">BeginCreateOrUpdate</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="r45 r">dagName</span>, <span class="r46 r">dagParams</span>);
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#8125b18f5d7ee303" class="k">var</a> <span id="r58 rd" class="r58 r">listResp</span> = <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#46940fa6343c3716" class="i method">ListByInstance</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>);
 
                <a href="@1@System.Runtime/A.html#225942ed7b7a3252" class="k">var</a> <span id="r59 rd" class="r59 r">tries</span> = 0;
                <b>while</b> (<span class="r58 r">listResp</span>.<span class="i method">Count</span>() == 0 &amp;&amp; ++<span class="r59 r">tries</span> &lt;= 3)
                {
                    <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#22c7c2c5a736288d" class="i method">Wait</a>(<a href="@1@System.Runtime/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@1@System.Runtime/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(30));
                    <span class="r58 r">listResp</span> = <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#46940fa6343c3716" class="i method">ListByInstance</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>);
                }
 
                <a href="/Microsoft.Azure.Management.Sql/A.html#20ef446bc81e76e8" class="k">var</a> <span id="r60 rd" class="r60 r">getResp</span> = <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#7e8e453b76001798" class="i method">Get</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="r45 r">dagName</span>);
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r60 r">getResp</span>);
                <span class="t t">Assert</span>.<span class="i method">Single</span>(<span class="r58 r">listResp</span>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r46 r">dagParams</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a>, <span class="r60 r">getResp</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r46 r">dagParams</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a>, <span class="r60 r">getResp</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r46 r">dagParams</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a>, <span class="r58 r">listResp</span>.<span class="i method">First</span>().<a href="/Microsoft.Azure.Management.Sql/A.html#614de74201d751ce" class="i property">TargetDatabase</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="r46 r">dagParams</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a>, <span class="r58 r">listResp</span>.<span class="i method">First</span>().<a href="/Microsoft.Azure.Management.Sql/A.html#8e8be593f49d4051" class="i property">SourceEndpoint</a>);
 
                <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#abc47c9b0030d09f" class="i method">Delete</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="r45 r">dagName</span>);
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#8125b18f5d7ee303" class="k">var</a> <span id="r61 rd" class="r61 r">listRespEmpty</span> = <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#46940fa6343c3716" class="i method">ListByInstance</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>);
                <span class="t t">Assert</span>.<span class="i method">Empty</span>(<span class="r61 r">listRespEmpty</span>);
                <a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="k">var</a> <span id="r62 rd" class="r62 r">exceptionGet</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#7e20c5a8d8f75583" class="t t">CloudException</a>&gt;(() =&gt; <span class="r40 r">sqlClient</span>.<a href="/Microsoft.Azure.Management.Sql/A.html#19d53c1d5ba214e6" class="i property">DistributedAvailabilityGroups</a>.<a href="/Microsoft.Azure.Management.Sql/A.html#7e8e453b76001798" class="i method">Get</a>(<span class="r43 r">resourceGroupName</span>, <span class="r44 r">managedInstanceName</span>, <span class="r45 r">dagName</span>));
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;ResourceNotFound&quot;</span>, <span class="r62 r">exceptionGet</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#db181b8df210bf29" class="i property">Body</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure/A.html#d2a78e7d93ae0620" class="i property">Code</a>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
