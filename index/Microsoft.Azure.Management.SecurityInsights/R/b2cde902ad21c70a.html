<!DOCTYPE html>
<html><head><title>Query</title><link rel="stylesheet" href="../../styles.css"/><script src="../../scripts.js"></script></head><body onload="ro();">
<div class="rH">5 writes to Query</div><div class="rA">Microsoft.Azure.Management.SecurityInsights (1)</div><div class="rG" id="Microsoft.Azure.Management.SecurityInsights"><div class="rF"><div class="rN">Generated\Models\ActivityEntityQueriesPropertiesQueryDefinitions.cs (1)</div>
<a href="../Generated/Models/ActivityEntityQueriesPropertiesQueryDefinitions.cs.html#38"><b>38</b><i>Query</i> = query;</a>
</div>
</div>
<div class="rA">SecurityInsights.Tests (4)</div><div class="rG" id="SecurityInsights.Tests"><div class="rF"><div class="rN">EntityQueries\EntityQueriesTests.cs (4)</div>
<a href="../../SecurityInsights.Tests/EntityQueries/EntityQueriesTests.cs.html#40"><b>40</b><i>Query</i> = &quot;let UserConsentToApplication = (Account_Name:string, Account_UPNSuffix:string, Account_AadUserId:string){\nlet account_upn = iff(Account_Name != \&quot;\&quot; and Account_UPNSuffix != \&quot;\&quot;\n, strcat(Account_Name,\&quot;@\&quot;,Account_UPNSuffix)\n,\&quot;\&quot; );\nAuditLogs\n| where OperationName == \&quot;Consent to application\&quot;\n| extend Source_Account_UPNSuffix = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;userPrincipalName\&quot;]), Source_Account_AadUserId = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;id\&quot;])\n| where (account_upn != \&quot;\&quot; and account_upn =~ Source_Account_UPNSuffix) \nor (Account_AadUserId != \&quot;\&quot; and Account_AadUserId =~ Source_Account_AadUserId)\n| extend Target_CloudApplication_Name = tostring(todynamic(TargetResources)[0][\&quot;displayName\&quot;]), Target_CloudApplication_AppId = tostring(todynamic(TargetResources)[0][\&quot;id\&quot;])\n};\nUserConsentToApplication(&#39;{{Account_Name}}&#39;, &#39;{{Account_UPNSuffix}}&#39;, &#39;{{Account_AadUserId}}&#39;)  \n| project Target_CloudApplication_AppId, Target_CloudApplication_Name, TimeGenerated&quot;</a>
<a href="../../SecurityInsights.Tests/EntityQueries/EntityQueriesTests.cs.html#80"><b>80</b><i>Query</i> = &quot;let UserConsentToApplication = (Account_Name:string, Account_UPNSuffix:string, Account_AadUserId:string){\nlet account_upn = iff(Account_Name != \&quot;\&quot; and Account_UPNSuffix != \&quot;\&quot;\n, strcat(Account_Name,\&quot;@\&quot;,Account_UPNSuffix)\n,\&quot;\&quot; );\nAuditLogs\n| where OperationName == \&quot;Consent to application\&quot;\n| extend Source_Account_UPNSuffix = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;userPrincipalName\&quot;]), Source_Account_AadUserId = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;id\&quot;])\n| where (account_upn != \&quot;\&quot; and account_upn =~ Source_Account_UPNSuffix) \nor (Account_AadUserId != \&quot;\&quot; and Account_AadUserId =~ Source_Account_AadUserId)\n| extend Target_CloudApplication_Name = tostring(todynamic(TargetResources)[0][\&quot;displayName\&quot;]), Target_CloudApplication_AppId = tostring(todynamic(TargetResources)[0][\&quot;id\&quot;])\n};\nUserConsentToApplication(&#39;{{Account_Name}}&#39;, &#39;{{Account_UPNSuffix}}&#39;, &#39;{{Account_AadUserId}}&#39;)  \n| project Target_CloudApplication_AppId, Target_CloudApplication_Name, TimeGenerated&quot;</a>
<a href="../../SecurityInsights.Tests/EntityQueries/EntityQueriesTests.cs.html#117"><b>117</b><i>Query</i> = &quot;let UserConsentToApplication = (Account_Name:string, Account_UPNSuffix:string, Account_AadUserId:string){\nlet account_upn = iff(Account_Name != \&quot;\&quot; and Account_UPNSuffix != \&quot;\&quot;\n, strcat(Account_Name,\&quot;@\&quot;,Account_UPNSuffix)\n,\&quot;\&quot; );\nAuditLogs\n| where OperationName == \&quot;Consent to application\&quot;\n| extend Source_Account_UPNSuffix = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;userPrincipalName\&quot;]), Source_Account_AadUserId = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;id\&quot;])\n| where (account_upn != \&quot;\&quot; and account_upn =~ Source_Account_UPNSuffix) \nor (Account_AadUserId != \&quot;\&quot; and Account_AadUserId =~ Source_Account_AadUserId)\n| extend Target_CloudApplication_Name = tostring(todynamic(TargetResources)[0][\&quot;displayName\&quot;]), Target_CloudApplication_AppId = tostring(todynamic(TargetResources)[0][\&quot;id\&quot;])\n};\nUserConsentToApplication(&#39;{{Account_Name}}&#39;, &#39;{{Account_UPNSuffix}}&#39;, &#39;{{Account_AadUserId}}&#39;)  \n| project Target_CloudApplication_AppId, Target_CloudApplication_Name, TimeGenerated&quot;</a>
<a href="../../SecurityInsights.Tests/EntityQueries/EntityQueriesTests.cs.html#157"><b>157</b><i>Query</i> = &quot;let UserConsentToApplication = (Account_Name:string, Account_UPNSuffix:string, Account_AadUserId:string){\nlet account_upn = iff(Account_Name != \&quot;\&quot; and Account_UPNSuffix != \&quot;\&quot;\n, strcat(Account_Name,\&quot;@\&quot;,Account_UPNSuffix)\n,\&quot;\&quot; );\nAuditLogs\n| where OperationName == \&quot;Consent to application\&quot;\n| extend Source_Account_UPNSuffix = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;userPrincipalName\&quot;]), Source_Account_AadUserId = tostring(todynamic(InitiatedBy) [\&quot;user\&quot;][\&quot;id\&quot;])\n| where (account_upn != \&quot;\&quot; and account_upn =~ Source_Account_UPNSuffix) \nor (Account_AadUserId != \&quot;\&quot; and Account_AadUserId =~ Source_Account_AadUserId)\n| extend Target_CloudApplication_Name = tostring(todynamic(TargetResources)[0][\&quot;displayName\&quot;]), Target_CloudApplication_AppId = tostring(todynamic(TargetResources)[0][\&quot;id\&quot;])\n};\nUserConsentToApplication(&#39;{{Account_Name}}&#39;, &#39;{{Account_UPNSuffix}}&#39;, &#39;{{Account_AadUserId}}&#39;)  \n| project Target_CloudApplication_AppId, Target_CloudApplication_Name, TimeGenerated&quot;</a>
</div>
</div>
</body></html>