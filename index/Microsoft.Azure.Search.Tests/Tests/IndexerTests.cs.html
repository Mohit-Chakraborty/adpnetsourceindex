<!DOCTYPE html>
<html><head><title>IndexerTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(491);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Search.Tests/Tests/IndexerTests.cs" target="_top">Tests\IndexerTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Search.Tests" target="_top">Microsoft.Azure.Search\tests\Microsoft.Azure.Search.Tests.csproj</a> (Microsoft.Azure.Search.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for</span>
<span class="c">// license information.</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i n">Tests</span>
{
    <b>using</b> <span class="i n">System</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>.<span class="i">Http</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i">Models</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i n">Tests</span>.<span class="i n">Utilities</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Rest</span>.<span class="i">Azure</span>;
    <b>using</b> <span class="i n">Xunit</span>;
    <b>using</b> <span class="i">Index</span> = <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i">Models</span>.<span class="i">Index</span>;
 
    <b>public sealed class</b> <a id="ce5ee5d309c8f58e" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="b9007e3ba313167d">IndexerTests</span></a> : <a href="/Search.Management.Tests/A.html#47a970d62ba7b427" class="t t">SearchTestBase</a>&lt;<a href="../Utilities/IndexerFixture.cs.html#7ff5a9e473cda099" class="t t">IndexerFixture</a>&gt;
    {
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="61d12f35906f59d9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateIndexerReturnsCorrectDefinition</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r0 rd" class="r0 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
                <span class="i">Indexer</span> <span id="r1 rd" class="r1 r">expectedIndexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
                <span class="r1 r">expectedIndexer</span>.<span class="i">IsDisabled</span> = <b>true</b>;
                <span class="r1 r">expectedIndexer</span>.<span class="i">Parameters</span> =
                    <b>new</b> <span class="i">IndexingParameters</span>()
                    {
                        <span class="i">BatchSize</span> = 50,
                        <span class="i">MaxFailedItems</span> = 10,
                        <span class="i">MaxFailedItemsPerBatch</span> = 10
                    };
 
                <span class="i">Indexer</span> <span id="r2 rd" class="r2 r">actualIndexer</span> = <span class="r0 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r1 r">expectedIndexer</span>);
 
                <span class="r1 r">expectedIndexer</span>.<span class="i">Parameters</span>.<span class="i">Configuration</span> = <b>new</b> <a href="@0@mscorlib/A.html#bf6849e410b43c4c" class="t constructor">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;();    <span class="c">// Get returns empty dictionary.</span>
                <a href="#1bfb7e8d4f2ed61f" class="i method">ExpectSameStartTime</a>(<span class="r1 r">expectedIndexer</span>, <span class="r2 r">actualIndexer</span>);
 
                <a href="#4b82285c5ccc1600" class="i method">AssertIndexersEqual</a>(<span class="r1 r">expectedIndexer</span>, <span class="r2 r">actualIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="8ba3fb3a2b9c6f5b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateIndexerFailsWithUsefulMessageOnUserError</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r3 rd" class="r3 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r4 rd" class="r4 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
                <span class="r4 r">indexer</span>.<span class="i">DataSourceName</span> = <span class="s">&quot;thisdatasourcedoesnotexist&quot;</span>;
 
                <a href="../Utilities/SearchAssert.cs.html#166eadd17fbab75c" class="t t">SearchAssert</a>.<a href="../Utilities/SearchAssert.cs.html#82d140c2bb9fa155" class="i method">ThrowsCloudException</a>(
                    () =&gt; <span class="r3 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r4 r">indexer</span>),
                    <a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#813537f308d3a0ef" class="i field">BadRequest</a>,
                    <span class="s">&quot;This indexer refers to a data source &#39;thisdatasourcedoesnotexist&#39; that doesn&#39;t exist&quot;</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="8de8ba819c389046" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetIndexerThrowsOnNotFound</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r5 rd" class="r5 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
                <a href="../Utilities/SearchAssert.cs.html#166eadd17fbab75c" class="t t">SearchAssert</a>.<a href="../Utilities/SearchAssert.cs.html#82d140c2bb9fa155" class="i method">ThrowsCloudException</a>(() =&gt; <span class="r5 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Get</span>(<span class="s">&quot;thisindexerdoesnotexist&quot;</span>), <a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#35e0ca1b70dbcf0d" class="i field">NotFound</a>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="528a82a4fb56895f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanUpdateIndexer</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r6 rd" class="r6 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r7 rd" class="r7 r">initial</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
                <span class="r6 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r7 r">initial</span>);
 
                <span class="i">Indexer</span> <span id="r8 rd" class="r8 r">updatedExpected</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
                <span class="r8 r">updatedExpected</span>.<span class="i">Name</span> = <span class="r7 r">initial</span>.<span class="i">Name</span>;
                <span class="r8 r">updatedExpected</span>.<span class="i">Description</span> = <span class="s">&quot;somethingdifferent&quot;</span>;
 
                <span class="i">Indexer</span> <span id="r9 rd" class="r9 r">updateResponse</span> = <span class="r6 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>(<span class="r8 r">updatedExpected</span>);
                <a href="#1bfb7e8d4f2ed61f" class="i method">ExpectSameStartTime</a>(<span class="r8 r">updatedExpected</span>, <span class="r9 r">updateResponse</span>);
 
                <a href="#4b82285c5ccc1600" class="i method">AssertIndexersEqual</a>(<span class="r8 r">updatedExpected</span>, <span class="r9 r">updateResponse</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="314a1920a2520f64" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateOrUpdateCreatesWhenIndexerDoesNotExist</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r10 rd" class="r10 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r11 rd" class="r11 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
 
                <span class="i">AzureOperationResponse</span>&lt;<span class="i">Indexer</span>&gt; <span id="r12 rd" class="r12 r">response</span> =
                    <span class="r10 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">CreateOrUpdateWithHttpMessagesAsync</span>(<span class="r11 r">indexer</span>).<span class="i">Result</span>;
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#f7afac2697e5c882" class="i field">Created</a>, <span class="r12 r">response</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9bdb8c9087d405e0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateOrUpdateCreatesWhenIndexerWithSkillsetDoesNotExist</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r13 rd" class="r13 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Skillset</span> <span id="r14 rd" class="r14 r">skillset</span> = <a href="SkillsetsTests.cs.html#cce95ea2c23fe779" class="t t">SkillsetsTests</a>.<a href="SkillsetsTests.cs.html#7a7adb598d7d4841" class="i method">CreateTestSkillsetOcrEntity</a>(<b>null</b>, <b>null</b>);
 
                <span class="i">AzureOperationResponse</span>&lt;<span class="i">Skillset</span>&gt; <span id="r15 rd" class="r15 r">response</span> =
                        <span class="r13 r">searchClient</span>.<span class="i">Skillsets</span>.<span class="i">CreateOrUpdateWithHttpMessagesAsync</span>(<span class="r14 r">skillset</span>.<span class="i">Name</span>, <span class="r14 r">skillset</span>).<span class="i">Result</span>;
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#f7afac2697e5c882" class="i field">Created</a>, <span class="r15 r">response</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
 
                <span class="i">Indexer</span> <span id="r16 rd" class="r16 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">CreateTestIndexerWithSkillset</span>(<span class="r14 r">skillset</span>.<span class="i">Name</span>, <b>new</b>[]
                {
                    <b>new</b> <span class="i">FieldMapping</span>(<span class="i">sourceFieldName</span>: <span class="s">&quot;/document/myEntities&quot;</span>, <span class="i">targetFieldName</span>: <span class="s">&quot;myEntities&quot;</span>),
                    <b>new</b> <span class="i">FieldMapping</span>(<span class="i">sourceFieldName</span>: <span class="s">&quot;/document/myText&quot;</span>, <span class="i">targetFieldName</span>: <span class="s">&quot;myText&quot;</span>)
                });
 
                <span class="i">AzureOperationResponse</span>&lt;<span class="i">Indexer</span>&gt; <span id="r17 rd" class="r17 r">response1</span> =
                    <span class="r13 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">CreateOrUpdateWithHttpMessagesAsync</span>(<span class="r16 r">indexer</span>).<span class="i">Result</span>;
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#f7afac2697e5c882" class="i field">Created</a>, <span class="r17 r">response1</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="134be0c9755e96ee" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateOrUpdateIndexerIfNotExistsFailsOnExistingResource</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">CreateOrUpdateIfNotExistsFailsOnExistingResource</span>(
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>().<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">CreateTestIndexer</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">MutateIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="97ebc806bedb6bfa" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateOrUpdateIndexerIfNotExistsSucceedsOnNoResource</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">CreateOrUpdateIfNotExistsSucceedsOnNoResource</span>(
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>().<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">CreateTestIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="a972ccc544bdd1b2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateIndexerIfExistsSucceedsOnExistingResource</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">UpdateIfExistsSucceedsOnExistingResource</span>(
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>().<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">CreateTestIndexer</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">MutateIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="694e70f12bc65501" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateIndexerIfExistsFailsOnNoResource</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">UpdateIfExistsFailsOnNoResource</span>(
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>().<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">CreateTestIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="4994cc491e7ab56b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateIndexerIfNotChangedSucceedsWhenResourceUnchanged</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">UpdateIfNotChangedSucceedsWhenResourceUnchanged</span>(
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>().<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">CreateTestIndexer</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">MutateIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9d32e2b18e4a83c9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateIndexerIfNotChangedFailsWhenResourceChanged</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">UpdateIfNotChangedFailsWhenResourceChanged</span>(
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>().<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">CreateTestIndexer</span>,
                    <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">MutateIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="f89f80037870f7c6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteIndexerIfNotChangedWorksOnlyOnCurrentResource</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r18 rd" class="r18 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r19 rd" class="r19 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
 
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">DeleteIfNotChangedWorksOnlyOnCurrentResource</span>(
                    <span class="r18 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Delete</span>,
                    () =&gt; <span class="r18 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>(<span class="r19 r">indexer</span>),
                    <span id="r20 rd" class="r20 r">x</span> =&gt; <span class="r18 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>(<a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">MutateIndexer</span>(<span class="r20 r">x</span>)),
                    <span class="r19 r">indexer</span>.<span class="i">Name</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="c35bcb213bba36e0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteIndexerIfExistsWorksOnlyWhenResourceExists</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r21 rd" class="r21 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r22 rd" class="r22 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
 
                <a href="AccessConditionTests.cs.html#6d3d284bea707bc0" class="t t">AccessConditionTests</a>.<span class="i">DeleteIfExistsWorksOnlyWhenResourceExists</span>(
                    <span class="r21 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Delete</span>,
                    () =&gt; <span class="r21 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">CreateOrUpdate</span>(<span class="r22 r">indexer</span>),
                    <span class="r22 r">indexer</span>.<span class="i">Name</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="a5028a90208158ff" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteIndexerIsIdempotent</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r23 rd" class="r23 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r24 rd" class="r24 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
 
                <span class="c">// Try delete before the indexer even exists.</span>
                <span class="i">AzureOperationResponse</span> <span id="r25 rd" class="r25 r">deleteResponse</span> =
                    <span class="r23 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">DeleteWithHttpMessagesAsync</span>(<span class="r24 r">indexer</span>.<span class="i">Name</span>).<span class="i">Result</span>;
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#35e0ca1b70dbcf0d" class="i field">NotFound</a>, <span class="r25 r">deleteResponse</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
 
                <span class="r23 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r24 r">indexer</span>);
 
                <span class="c">// Now delete twice.</span>
                <span class="r25 r">deleteResponse</span> = <span class="r23 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">DeleteWithHttpMessagesAsync</span>(<span class="r24 r">indexer</span>.<span class="i">Name</span>).<span class="i">Result</span>;
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#848894cdd37c6925" class="i field">NoContent</a>, <span class="r25 r">deleteResponse</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
 
                <span class="r25 r">deleteResponse</span> = <span class="r23 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">DeleteWithHttpMessagesAsync</span>(<span class="r24 r">indexer</span>.<span class="i">Name</span>).<span class="i">Result</span>;
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#35e0ca1b70dbcf0d" class="i field">NotFound</a>, <span class="r25 r">deleteResponse</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="96808d7a44d4d04b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanCreateAndListIndexers</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r26 rd" class="r26 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r27 rd" class="r27 r">indexer1</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
                <span class="i">Indexer</span> <span id="r28 rd" class="r28 r">indexer2</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
 
                <span class="r26 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r27 r">indexer1</span>);
                <span class="r26 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r28 r">indexer2</span>);
 
                <span class="i">IndexerListResult</span> <span id="r29 rd" class="r29 r">listResponse</span> = <span class="r26 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">List</span>();
                <span class="i">Assert</span>.<span class="i">Equal</span>(2, <span class="r29 r">listResponse</span>.<span class="i">Indexers</span>.<span class="i">Count</span>);
 
                <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r30 rd" class="r30 r">indexerNames</span> = <span class="r29 r">listResponse</span>.<span class="i">Indexers</span>.<span class="i">Select</span>(<span id="r31 rd" class="r31 r">i</span> =&gt; <span class="r31 r">i</span>.<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="r27 r">indexer1</span>.<span class="i">Name</span>, <span class="r30 r">indexerNames</span>);
                <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="r28 r">indexer2</span>.<span class="i">Name</span>, <span class="r30 r">indexerNames</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="ba60d06b947aec72" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanRunIndexerAndGetIndexerStatus</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="c">// Set handler that injects mock_status query string, which results in service</span>
                <span class="c">// returning a well-known mock response</span>
                <span class="i">SearchServiceClient</span> <span id="r32 rd" class="r32 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<span class="i">GetSearchServiceClient</span>(<b>new</b> <a href="#f0d4e678efbab379" class="t constructor">MockStatusDelegatingHandler</a>());
 
                <span class="i">Indexer</span> <span id="r33 rd" class="r33 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
 
                <span class="r32 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r33 r">indexer</span>);
 
                <span class="i">IndexerExecutionInfo</span> <span id="r34 rd" class="r34 r">info</span> = <span class="r32 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">GetStatus</span>(<span class="r33 r">indexer</span>.<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerStatus</span>.<span class="i">Running</span>, <span class="r34 r">info</span>.<span class="i">Status</span>);
 
                <span class="i">AzureOperationResponse</span> <span id="r35 rd" class="r35 r">runResponse</span> =
                    <span class="r32 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">RunWithHttpMessagesAsync</span>(<span class="r33 r">indexer</span>.<span class="i">Name</span>).<span class="i">Result</span>;
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#1e4f1250e8e5ac5c" class="i field">Accepted</a>, <span class="r35 r">runResponse</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
 
                <span class="r34 r">info</span> = <span class="r32 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">GetStatus</span>(<span class="r33 r">indexer</span>.<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerStatus</span>.<span class="i">Running</span>, <span class="r34 r">info</span>.<span class="i">Status</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerExecutionStatus</span>.<span class="i">InProgress</span>, <span class="r34 r">info</span>.<span class="i">LastResult</span>.<span class="i">Status</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(3, <span class="r34 r">info</span>.<span class="i">ExecutionHistory</span>.<span class="i">Count</span>);
 
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r34 r">info</span>.<span class="i">Limits</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(100000, <span class="r34 r">info</span>.<span class="i">Limits</span>.<span class="i">MaxDocumentContentCharactersToExtract</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(1000, <span class="r34 r">info</span>.<span class="i">Limits</span>.<span class="i">MaxDocumentExtractionSize</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#e7c4baa19fa38e8e" class="i method">FromDays</a>(1), <span class="r34 r">info</span>.<span class="i">Limits</span>.<span class="i">MaxRunTime</span>);
 
                <span class="i">IndexerExecutionResult</span> <span id="r36 rd" class="r36 r">newestResult</span> = <span class="r34 r">info</span>.<span class="i">ExecutionHistory</span>[0];
                <span class="i">IndexerExecutionResult</span> <span id="r37 rd" class="r37 r">middleResult</span> = <span class="r34 r">info</span>.<span class="i">ExecutionHistory</span>[1];
                <span class="i">IndexerExecutionResult</span> <span id="r38 rd" class="r38 r">oldestResult</span> = <span class="r34 r">info</span>.<span class="i">ExecutionHistory</span>[2];
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerExecutionStatus</span>.<span class="i">TransientFailure</span>, <span class="r36 r">newestResult</span>.<span class="i">Status</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;The indexer could not connect to the data source&quot;</span>, <span class="r36 r">newestResult</span>.<span class="i">ErrorMessage</span>);
                <a href="#8391fd175fb18181" class="i method">AssertStartAndEndTimeValid</a>(<span class="r36 r">newestResult</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerExecutionStatus</span>.<span class="i">Reset</span>, <span class="r37 r">middleResult</span>.<span class="i">Status</span>);
                <a href="#8391fd175fb18181" class="i method">AssertStartAndEndTimeValid</a>(<span class="r37 r">middleResult</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerExecutionStatus</span>.<span class="i">Success</span>, <span class="r38 r">oldestResult</span>.<span class="i">Status</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(124876, <span class="r38 r">oldestResult</span>.<span class="i">ItemCount</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(2, <span class="r38 r">oldestResult</span>.<span class="i">FailedItemCount</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;100&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">InitialTrackingState</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;200&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">FinalTrackingState</span>);
                <a href="#8391fd175fb18181" class="i method">AssertStartAndEndTimeValid</a>(<span class="r38 r">oldestResult</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(2, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>.<span class="i">Count</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;1&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[0].<span class="i">Key</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Key field contains unsafe characters&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[0].<span class="i">ErrorMessage</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;DocumentExtraction.AzureBlob.MyDataSource&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[0].<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;The file could not be parsed.&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[0].<span class="i">Details</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;https://go.microsoft.com/fwlink/?linkid=2049388&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[0].<span class="i">DocumentationLink</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;121713&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[1].<span class="i">Key</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Item is too large&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[1].<span class="i">ErrorMessage</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;DocumentExtraction.AzureBlob.DataReader&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[1].<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Blob size cannot exceed 256 MB.&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[1].<span class="i">Details</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;https://go.microsoft.com/fwlink/?linkid=2049388&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Errors</span>[1].<span class="i">DocumentationLink</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(1, <span class="r38 r">oldestResult</span>.<span class="i">Warnings</span>.<span class="i">Count</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;2&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Warnings</span>[0].<span class="i">Key</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Document was truncated to 50000 characters.&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Warnings</span>[0].<span class="i">Message</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Enrichment.LanguageDetectionSkill.#4&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Warnings</span>[0].<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Try to split the input into smaller chunks using Split skill.&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Warnings</span>[0].<span class="i">Details</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;https://go.microsoft.com/fwlink/?linkid=2099692&quot;</span>, <span class="r38 r">oldestResult</span>.<span class="i">Warnings</span>[0].<span class="i">DocumentationLink</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9d9e569b20e24b7f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanResetIndexerAndGetIndexerStatus</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r39 rd" class="r39 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="i">Indexer</span> <span id="r40 rd" class="r40 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
 
                <span class="r39 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r40 r">indexer</span>);
                <span class="r39 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Reset</span>(<span class="r40 r">indexer</span>.<span class="i">Name</span>);
 
                <span class="i">IndexerExecutionInfo</span> <span id="r41 rd" class="r41 r">info</span> = <span class="r39 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">GetStatus</span>(<span class="r40 r">indexer</span>.<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerStatus</span>.<span class="i">Running</span>, <span class="r41 r">info</span>.<span class="i">Status</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">IndexerExecutionStatus</span>.<span class="i">Reset</span>, <span class="r41 r">info</span>.<span class="i">LastResult</span>.<span class="i">Status</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="0c1c9cbc9f272042" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ExistsReturnsTrueForExistingIndexer</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r42 rd" class="r42 r">client</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
                <span class="i">Indexer</span> <span id="r43 rd" class="r43 r">indexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
                <span class="r42 r">client</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r43 r">indexer</span>);
 
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r42 r">client</span>.<span class="i">Indexers</span>.<span class="i">Exists</span>(<span class="r43 r">indexer</span>.<span class="i">Name</span>));
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="baec618dcfb2d68e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ExistsReturnsFalseForNonExistingIndexer</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r44 rd" class="r44 r">client</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
                <span class="i">Assert</span>.<span class="i">False</span>(<span class="r44 r">client</span>.<span class="i">Indexers</span>.<span class="i">Exists</span>(<span class="s">&quot;invalidindexer&quot;</span>));
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="6da91027428ba187" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanCreateBlobIndexerWithConfigurationParameters</a>()
        {
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">SearchServiceClient</span> <span id="r45 rd" class="r45 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
                <span class="i">Indexer</span> <span id="r46 rd" class="r46 r">expectedIndexer</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#37cc7a6e1dd6f348" class="i method">CreateTestIndexer</a>();
                <span class="i">DataSource</span> <span id="r47 rd" class="r47 r">blobDataSource</span> =
                    <span class="i">DataSource</span>.<span class="i">AzureBlobStorage</span>(
                        <a href="/Search.Management.Tests/A.html#43c89287078aeb50" class="t t">SearchTestUtilities</a>.<span class="i">GenerateName</span>(),
                        <span class="i">storageConnectionString</span>: <span class="s">&quot;fake&quot;</span>,
                        <span class="i">containerName</span>: <span class="s">&quot;fake&quot;</span>);
 
                <span class="r46 r">expectedIndexer</span>.<span class="i">DataSourceName</span> = <span class="r47 r">blobDataSource</span>.<span class="i">Name</span>;
                <span class="r46 r">expectedIndexer</span>.<span class="i">IsDisabled</span> = <b>true</b>;
                <span class="r46 r">expectedIndexer</span>.<span class="i">Parameters</span> = <b>new</b> <span class="i">IndexingParameters</span>();
                <span class="r46 r">expectedIndexer</span>.<span class="i">Parameters</span>
                    .<span class="i">ExcludeFileNameExtensions</span>(<span class="s">&quot;.pdf&quot;</span>)
                    .<span class="i">IndexFileNameExtensions</span>(<span class="s">&quot;.docx&quot;</span>)
                    .<span class="i">SetBlobExtractionMode</span>(<span class="i">BlobExtractionMode</span>.<span class="i">StorageMetadata</span>);
 
                <span class="i">Indexer</span> <span id="r48 rd" class="r48 r">actualIndexer</span> = <span class="r45 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r46 r">expectedIndexer</span>);
                <a href="#1bfb7e8d4f2ed61f" class="i method">ExpectSameStartTime</a>(<span class="r46 r">expectedIndexer</span>, <span class="r48 r">actualIndexer</span>);
 
                <a href="#4b82285c5ccc1600" class="i method">AssertIndexersEqual</a>(<span class="r46 r">expectedIndexer</span>, <span class="r48 r">actualIndexer</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="69908ea360bf46a3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanRoundtripIndexerWithFieldMappingFunctions</a>() =&gt;
            <span class="i">Run</span>(() =&gt;
            {
                <span class="i">Indexer</span> <span id="r49 rd" class="r49 r">expectedIndexer</span> = <b>new</b> <span class="i">Indexer</span>(<a href="/Search.Management.Tests/A.html#43c89287078aeb50" class="t t">SearchTestUtilities</a>.<span class="i">GenerateName</span>(), <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#f4b85d6e2d96e419" class="i property">DataSourceName</a>, <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#087eea779e3c8a55" class="i property">TargetIndexName</a>)
                {
                    <span class="i">FieldMappings</span> = <b>new</b>[]
                    {
                        <span class="c">// Try all the field mapping functions and parameters (even if they don&#39;t make sense in the context of the test DB).</span>
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;a&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">Base64Encode</span>()),
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;b&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">Base64Encode</span>(<span class="i">useHttpServerUtilityUrlTokenEncode</span>: <b>true</b>)),
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;c&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">ExtractTokenAtPosition</span>(<span class="i">delimiter</span>: <span class="s">&quot; &quot;</span>, <span class="i">position</span>: 0)),
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;d&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">Base64Decode</span>()),
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;e&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">Base64Decode</span>(<span class="i">useHttpServerUtilityUrlTokenDecode</span>: <b>false</b>)),
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;f&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">JsonArrayToStringCollection</span>()),
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;g&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">UrlEncode</span>()),
                        <b>new</b> <span class="i">FieldMapping</span>(<span class="s">&quot;feature_id&quot;</span>, <span class="s">&quot;h&quot;</span>, <span class="i">FieldMappingFunction</span>.<span class="i">UrlDecode</span>()),
                    }
                };
 
                <span class="i">SearchServiceClient</span> <span id="r50 rd" class="r50 r">searchClient</span> = <a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/SearchServiceFixtureExtensions.cs.html#f4e5d5c8349136d3" class="i method">GetSearchServiceClient</a>();
 
                <span class="c">// We need to add desired fields to the index before those fields can be referenced by the field mappings</span>
                <span class="i">Index</span> <span id="r51 rd" class="r51 r">index</span> = <span class="r50 r">searchClient</span>.<span class="i">Indexes</span>.<span class="i">Get</span>(<a href="/Search.Management.Tests/A.html#879894590f9e382d" class="i property">Data</a>.<a href="../Utilities/IndexerFixture.cs.html#087eea779e3c8a55" class="i property">TargetIndexName</a>);
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>[] <span id="r52 rd" class="r52 r">fieldNames</span> = <b>new</b>[] { <span class="s">&quot;a&quot;</span>, <span class="s">&quot;b&quot;</span>, <span class="s">&quot;c&quot;</span>, <span class="s">&quot;d&quot;</span>, <span class="s">&quot;e&quot;</span>, <span class="s">&quot;f&quot;</span>, <span class="s">&quot;g&quot;</span>, <span class="s">&quot;h&quot;</span> };
                <span class="r51 r">index</span>.<span class="i">Fields</span> = <span class="r51 r">index</span>.<span class="i">Fields</span>.<span class="i">Concat</span>(<span class="r52 r">fieldNames</span>.<span class="i">Select</span>(<span id="r53 rd" class="r53 r">name</span> =&gt; <b>new</b> <span class="i">Field</span>(<span class="r53 r">name</span>, <span class="i">DataType</span>.<span class="i">String</span>))).<span class="i">ToList</span>();
                <span class="r50 r">searchClient</span>.<span class="i">Indexes</span>.<span class="i">CreateOrUpdate</span>(<span class="r51 r">index</span>);
 
                <span class="r50 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Create</span>(<span class="r49 r">expectedIndexer</span>);
 
                <span class="i">Indexer</span> <span id="r54 rd" class="r54 r">actualIndexer</span> = <span class="r50 r">searchClient</span>.<span class="i">Indexers</span>.<span class="i">Get</span>(<span class="r49 r">expectedIndexer</span>.<span class="i">Name</span>);
                <a href="#4b82285c5ccc1600" class="i method">AssertIndexersEqual</a>(<span class="r49 r">expectedIndexer</span>, <span class="r54 r">actualIndexer</span>);
            });
 
        <b>private static void</b> <a id="8391fd175fb18181" href="../R/8391fd175fb18181.html" target="n" data-glyph="76,1" class="i method">AssertStartAndEndTimeValid</a>(<span class="i">IndexerExecutionResult</span> <span id="r55 rd" class="r55 r">result</span>)
        {
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r55 r">result</span>.<span class="i">StartTime</span>.<span class="i">HasValue</span>);
            <span class="i">Assert</span>.<span class="i">NotEqual</span>(<b>new</b> <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t constructor">DateTimeOffset</a>(), <span class="r55 r">result</span>.<span class="i">StartTime</span>.<span class="i">Value</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r55 r">result</span>.<span class="i">EndTime</span>.<span class="i">HasValue</span>);
            <span class="i">Assert</span>.<span class="i">NotEqual</span>(<b>new</b> <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t constructor">DateTimeOffset</a>(), <span class="r55 r">result</span>.<span class="i">EndTime</span>.<span class="i">Value</span>);
        }
 
        <b>private static void</b> <a id="4b82285c5ccc1600" href="../R/4b82285c5ccc1600.html" target="n" data-glyph="76,1" class="i method">AssertIndexersEqual</a>(<span class="i">Indexer</span> <span id="r56 rd" class="r56 r">expected</span>, <span class="i">Indexer</span> <span id="r57 rd" class="r57 r">actual</span>)
        {
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r56 r">expected</span>, <span class="r57 r">actual</span>, <b>new</b> <a href="../ModelComparer/DataPlaneModelComparer.cs.html#e0d08ff069e1909f" class="t constructor">DataPlaneModelComparer</a>&lt;<span class="i">Indexer</span>&gt;());
        }
 
        <b>private static void</b> <a id="1bfb7e8d4f2ed61f" href="../R/1bfb7e8d4f2ed61f.html" target="n" data-glyph="76,1" class="i method">ExpectSameStartTime</a>(<span class="i">Indexer</span> <span id="r58 rd" class="r58 r">expected</span>, <span class="i">Indexer</span> <span id="r59 rd" class="r59 r">actual</span>)
        {
            <span class="c">// There ought to be a start time in the response; We just can&#39;t know what it is because it would</span>
            <span class="c">// make the test timing-dependent.</span>
            <span class="r58 r">expected</span>.<span class="i">Schedule</span>.<span class="i">StartTime</span> = <span class="r59 r">actual</span>.<span class="i">Schedule</span>.<span class="i">StartTime</span>;
        }
 
        <b>private class</b> <a id="f0d4e678efbab379" href="../R/f0d4e678efbab379.html" target="n" data-glyph="4,1" class="t t"><span id="a8346fc69107c782">MockStatusDelegatingHandler</span></a> : <span class="i">DelegatingHandler</span>
        {
            <b>protected override</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="i">HttpResponseMessage</span>&gt; <a id="2fd67768b5d58a86" href="../R/../../0000000000.html" target="n" data-glyph="75,2" class="i method">SendAsync</a>(<span class="i">HttpRequestMessage</span> <span id="r60 rd" class="r60 r">request</span>, <a href="@0@mscorlib/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r61 rd" class="r61 r">cancellationToken</span>)
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r62 rd" class="r62 r">uriWithMockStatusQuery</span> = <span class="r60 r">request</span>.<span class="i">RequestUri</span>.<span class="i">AbsoluteUri</span> + <span class="s">&quot;&amp;mock_status=inProgress&quot;</span>;
                <span class="r60 r">request</span>.<span class="i">RequestUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="r62 r">uriWithMockStatusQuery</span>);
                <b>return</b> <b>base</b>.<span class="i">SendAsync</span>(<span class="r60 r">request</span>, <span class="r61 r">cancellationToken</span>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
