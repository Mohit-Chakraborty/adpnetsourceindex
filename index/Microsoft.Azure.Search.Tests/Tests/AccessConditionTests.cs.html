<!DOCTYPE html>
<html><head><title>AccessConditionTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(255);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Search.Tests/Tests/AccessConditionTests.cs" target="_top">Tests\AccessConditionTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Search.Tests" target="_top">Microsoft.Azure.Search\tests\Microsoft.Azure.Search.Tests.csproj</a> (Microsoft.Azure.Search.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for</span>
<span class="c">// license information.</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i n">Tests</span>
{
    <b>using</b> <span class="i n">System</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i">Models</span>;
    <b>using</b> <span class="i n">Rest</span>.<span class="i">Azure</span>;
    <b>using</b> <span class="i n">Xunit</span>;
 
    <b>public sealed class</b> <a id="6d3d284bea707bc0" href="../R/6d3d284bea707bc0.html" target="n" data-glyph="0,0" class="t t"><span id="4fdf15ff08490710">AccessConditionTests</span></a>
    {
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="4842e7f6f5c9b579" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IfNotChangedThrowsOnNullResource</a>()
        {
            <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="@0@mscorlib/A.html#c742289497493bb8" class="t t">ArgumentNullException</a>&gt;(() =&gt; <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<b>null</b>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="a02d8e97f9c6f31b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IfNotChangedThrowsOnNullETag</a>()
        {
            <span class="i">IResourceWithETag</span> <span id="r0 rd" class="r0 r">aResourceWithETag</span> = <b>new</b> <a href="#104346db44bc9bb9" class="t constructor">AResourceWithETag</a>();
 
            <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="@0@mscorlib/A.html#c742289497493bb8" class="t t">ArgumentNullException</a>&gt;(() =&gt; <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<span class="r0 r">aResourceWithETag</span>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="55f99dbbb0f2db53" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IfNotChangedThrowsOnEmptyETag</a>()
        {
            <span class="i">IResourceWithETag</span> <span id="r1 rd" class="r1 r">aResourceWithETag</span> = <b>new</b> <a href="#104346db44bc9bb9" class="t constructor">AResourceWithETag</a>() { <a href="#1fe07ef0485c57fe" class="i property">ETag</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a> };
 
            <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="@0@mscorlib/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a>&gt;(() =&gt; <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<span class="r1 r">aResourceWithETag</span>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="66854e822fa5d286" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IfNotChangedReturnsIfMatchAccessCondition</a>()
        {
            <span class="i">IResourceWithETag</span> <span id="r2 rd" class="r2 r">aResourceWithETag</span> = <b>new</b> <a href="#104346db44bc9bb9" class="t constructor">AResourceWithETag</a>() { <a href="#1fe07ef0485c57fe" class="i property">ETag</a> = <span class="s">&quot;IHazETag&quot;</span> };
 
            <span class="i">AccessCondition</span> <span id="r3 rd" class="r3 r">result</span> = <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<span class="r2 r">aResourceWithETag</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r2 r">aResourceWithETag</span>.<span class="i">ETag</span>, <span class="r3 r">result</span>.<span class="i">IfMatch</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r3 r">result</span>.<span class="i">IfNoneMatch</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="2285175b6bf98118" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateEmptyConditionReturnsEmptyAccessCondition</a>()
        {
            <span class="i">AccessCondition</span> <span id="r4 rd" class="r4 r">result</span> = <span class="i">AccessCondition</span>.<span class="i">GenerateEmptyCondition</span>();
 
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r4 r">result</span>.<span class="i">IfMatch</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r4 r">result</span>.<span class="i">IfNoneMatch</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9917693de7575a45" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfExistsConditionReturnsIfMatchAccessCondition</a>()
        {
            <span class="i">AccessCondition</span> <span id="r5 rd" class="r5 r">result</span> = <span class="i">AccessCondition</span>.<span class="i">GenerateIfExistsCondition</span>();
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;*&quot;</span>, <span class="r5 r">result</span>.<span class="i">IfMatch</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r5 r">result</span>.<span class="i">IfNoneMatch</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="be68dfc0b8d27cdc" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfMatchConditionThrowsOnNullETag</a>()
        {
            <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="@0@mscorlib/A.html#c742289497493bb8" class="t t">ArgumentNullException</a>&gt;(() =&gt; <span class="i">AccessCondition</span>.<span class="i">GenerateIfMatchCondition</span>(<b>null</b>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="b8aa0048c103541d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfMatchConditionThrowsOnEmptyETag</a>()
        {
            <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="@0@mscorlib/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a>&gt;(() =&gt; <span class="i">AccessCondition</span>.<span class="i">GenerateIfMatchCondition</span>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="39c729517737a3ad" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfMatchConditionReturnsIfMatchAccessCondition</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">eTag</span> = <span class="s">&quot;IHazETag&quot;</span>;
 
            <span class="i">AccessCondition</span> <span id="r7 rd" class="r7 r">result</span> = <span class="i">AccessCondition</span>.<span class="i">GenerateIfMatchCondition</span>(<span class="r6 r">eTag</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r6 r">eTag</span>, <span class="r7 r">result</span>.<span class="i">IfMatch</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r7 r">result</span>.<span class="i">IfNoneMatch</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="ccd9df7b2a1651d5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfNotExistsConditionReturnsIfNoneMatchAccessCondition</a>()
        {
            <span class="i">AccessCondition</span> <span id="r8 rd" class="r8 r">result</span> = <span class="i">AccessCondition</span>.<span class="i">GenerateIfNotExistsCondition</span>();
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;*&quot;</span>, <span class="r8 r">result</span>.<span class="i">IfNoneMatch</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r8 r">result</span>.<span class="i">IfMatch</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="bf24ac4527c70fd0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfNoneMatchConditionThrowsOnNullETag</a>()
        {
            <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="@0@mscorlib/A.html#c742289497493bb8" class="t t">ArgumentNullException</a>&gt;(() =&gt; <span class="i">AccessCondition</span>.<span class="i">GenerateIfNoneMatchCondition</span>(<b>null</b>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="04470f9fb97a1f06" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfNoneMatchConditionThrowsOnEmptyETag</a>()
        {
            <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="@0@mscorlib/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a>&gt;(() =&gt; <span class="i">AccessCondition</span>.<span class="i">GenerateIfNoneMatchCondition</span>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9ddfa36a449e31a9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateIfMatchConditionReturnsIfNoneMatchAccessCondition</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">eTag</span> = <span class="s">&quot;IHazETag&quot;</span>;
 
            <b>var</b> <span id="r10 rd" class="r10 r">result</span> = <span class="i">AccessCondition</span>.<span class="i">GenerateIfNoneMatchCondition</span>(<span class="r9 r">eTag</span>);
 
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r9 r">eTag</span>, <span class="r10 r">result</span>.<span class="i">IfNoneMatch</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r10 r">result</span>.<span class="i">IfMatch</span>);
        }
 
        <b>internal static void</b> <a id="8eded2b420d9bafd" href="../R/8eded2b420d9bafd.html" target="n" data-glyph="74,1" class="i method">CreateOrUpdateIfNotExistsFailsOnExistingResource</a>&lt;<span id="r11 rd t" class="r11 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#d6a8fafda0383fc5" class="t t">Func</a>&lt;<span class="r11 r t">T</span>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>, <span class="r11 r t">T</span>&gt; <span id="r12 rd" class="r12 r">createOrUpdateFunc</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r11 r t">T</span>&gt; <span id="r13 rd" class="r13 r">newResourceDefinition</span>,
            <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<span class="r11 r t">T</span>, <span class="r11 r t">T</span>&gt; <span id="r14 rd" class="r14 r">mutateResourceDefinition</span>)
            <b>where</b> <span class="r11 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <span class="r11 r t">T</span> <a id="eb67a786a24309c9" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">CreateOrUpdate</a>(<span class="r11 r t">T</span> <span id="r15 rd" class="r15 r">a</span>, <span class="i">AccessCondition</span> <span id="r16 rd" class="r16 r">b</span>) =&gt; <span class="r12 r">createOrUpdateFunc</span>(<span class="r15 r">a</span>, <b>null</b>, <span class="r16 r">b</span>);
            <span class="r11 r t">var</span> <span id="r17 rd" class="r17 r">createdResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r13 r">newResourceDefinition</span>(), <span class="i">AccessCondition</span>.<span class="i">GenerateEmptyCondition</span>());
            <span class="r11 r t">var</span> <span id="r18 rd" class="r18 r">mutatedResource</span> = <span class="r14 r">mutateResourceDefinition</span>(<span class="r17 r">createdResource</span>);
 
            <a href="../Utilities/SearchAssert.cs.html#166eadd17fbab75c" class="t t">SearchAssert</a>.<span class="i">ThrowsCloudException</span>(
                () =&gt; <span class="i">CreateOrUpdate</span>(<span class="r18 r">mutatedResource</span>, <span class="i">AccessCondition</span>.<span class="i">GenerateIfNotExistsCondition</span>()),
                <span id="r19 rd" class="r19 r">e</span> =&gt; <span class="r19 r">e</span>.<span class="i">IsAccessConditionFailed</span>());
        }
 
        <b>internal static void</b> <a id="0eaa842ac66e03e3" href="../R/0eaa842ac66e03e3.html" target="n" data-glyph="74,1" class="i method">CreateOrUpdateIfNotExistsSucceedsOnNoResource</a>&lt;<span id="r20 rd t" class="r20 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#d6a8fafda0383fc5" class="t t">Func</a>&lt;<span class="r20 r t">T</span>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>, <span class="r20 r t">T</span>&gt; <span id="r21 rd" class="r21 r">createOrUpdateFunc</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r20 r t">T</span>&gt; <span id="r22 rd" class="r22 r">newResourceDefinition</span>)
            <b>where</b> <span class="r20 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <span class="r20 r t">T</span> <a id="eb67a786a24309c9" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">CreateOrUpdate</a>(<span class="r20 r t">T</span> <span id="r23 rd" class="r23 r">a</span>, <span class="i">AccessCondition</span> <span id="r24 rd" class="r24 r">b</span>) =&gt; <span class="r21 r">createOrUpdateFunc</span>(<span class="r23 r">a</span>, <b>null</b>, <span class="r24 r">b</span>);
            <span class="r20 r t">var</span> <span id="r25 rd" class="r25 r">resource</span> = <span class="r22 r">newResourceDefinition</span>();
 
            <span class="r20 r t">var</span> <span id="r26 rd" class="r26 r">updatedResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r25 r">resource</span>, <span class="i">AccessCondition</span>.<span class="i">GenerateIfNotExistsCondition</span>());
 
            <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r26 r">updatedResource</span>.<span class="i">ETag</span>);
        }
 
        <b>internal static void</b> <a id="cc10900f5b284ba3" href="../R/cc10900f5b284ba3.html" target="n" data-glyph="74,1" class="i method">UpdateIfExistsSucceedsOnExistingResource</a>&lt;<span id="r27 rd t" class="r27 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#d6a8fafda0383fc5" class="t t">Func</a>&lt;<span class="r27 r t">T</span>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>, <span class="r27 r t">T</span>&gt; <span id="r28 rd" class="r28 r">createOrUpdateFunc</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r27 r t">T</span>&gt; <span id="r29 rd" class="r29 r">newResourceDefinition</span>,
            <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<span class="r27 r t">T</span>, <span class="r27 r t">T</span>&gt; <span id="r30 rd" class="r30 r">mutateResourceDefinition</span>)
            <b>where</b> <span class="r27 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <span class="r27 r t">T</span> <a id="eb67a786a24309c9" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">CreateOrUpdate</a>(<span class="r27 r t">T</span> <span id="r31 rd" class="r31 r">a</span>, <span class="i">AccessCondition</span> <span id="r32 rd" class="r32 r">b</span>) =&gt; <span class="r28 r">createOrUpdateFunc</span>(<span class="r31 r">a</span>, <b>null</b>, <span class="r32 r">b</span>);
            <span class="r27 r t">var</span> <span id="r33 rd" class="r33 r">createdResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r29 r">newResourceDefinition</span>(), <span class="i">AccessCondition</span>.<span class="i">GenerateEmptyCondition</span>());
            <span class="r27 r t">var</span> <span id="r34 rd" class="r34 r">mutatedResource</span> = <span class="r30 r">mutateResourceDefinition</span>(<span class="r33 r">createdResource</span>);
 
            <span class="r27 r t">var</span> <span id="r35 rd" class="r35 r">updatedResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r34 r">mutatedResource</span>, <span class="i">AccessCondition</span>.<span class="i">GenerateIfExistsCondition</span>());
 
            <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r35 r">updatedResource</span>.<span class="i">ETag</span>);
            <span class="i">Assert</span>.<span class="i">NotEqual</span>(<span class="r33 r">createdResource</span>.<span class="i">ETag</span>, <span class="r35 r">updatedResource</span>.<span class="i">ETag</span>);
        }
 
        <b>internal static void</b> <a id="d412bc37330868b7" href="../R/d412bc37330868b7.html" target="n" data-glyph="74,1" class="i method">UpdateIfExistsFailsOnNoResource</a>&lt;<span id="r36 rd t" class="r36 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#d6a8fafda0383fc5" class="t t">Func</a>&lt;<span class="r36 r t">T</span>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>, <span class="r36 r t">T</span>&gt; <span id="r37 rd" class="r37 r">createOrUpdateFunc</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r36 r t">T</span>&gt; <span id="r38 rd" class="r38 r">newResourceDefinition</span>)
            <b>where</b> <span class="r36 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <span class="r36 r t">T</span> <a id="eb67a786a24309c9" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">CreateOrUpdate</a>(<span class="r36 r t">T</span> <span id="r39 rd" class="r39 r">a</span>, <span class="i">AccessCondition</span> <span id="r40 rd" class="r40 r">b</span>) =&gt; <span class="r37 r">createOrUpdateFunc</span>(<span class="r39 r">a</span>, <b>null</b>, <span class="r40 r">b</span>);
            <span class="r36 r t">var</span> <span id="r41 rd" class="r41 r">resource</span> = <span class="r38 r">newResourceDefinition</span>();
 
            <a href="../Utilities/SearchAssert.cs.html#166eadd17fbab75c" class="t t">SearchAssert</a>.<span class="i">ThrowsCloudException</span>(
                () =&gt; <span class="i">CreateOrUpdate</span>(<span class="r41 r">resource</span>, <span class="i">AccessCondition</span>.<span class="i">GenerateIfExistsCondition</span>()),
                <span id="r42 rd" class="r42 r">e</span> =&gt; <span class="r42 r">e</span>.<span class="i">IsAccessConditionFailed</span>());
 
            <span class="c">// The resource should never have been created on the server, and thus it should not have an ETag</span>
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r41 r">resource</span>.<span class="i">ETag</span>);
        }
 
        <b>internal static void</b> <a id="254bb213e929eab4" href="../R/254bb213e929eab4.html" target="n" data-glyph="74,1" class="i method">UpdateIfNotChangedSucceedsWhenResourceUnchanged</a>&lt;<span id="r43 rd t" class="r43 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#d6a8fafda0383fc5" class="t t">Func</a>&lt;<span class="r43 r t">T</span>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>, <span class="r43 r t">T</span>&gt; <span id="r44 rd" class="r44 r">createOrUpdateFunc</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r43 r t">T</span>&gt; <span id="r45 rd" class="r45 r">newResourceDefinition</span>,
            <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<span class="r43 r t">T</span>, <span class="r43 r t">T</span>&gt; <span id="r46 rd" class="r46 r">mutateResourceDefinition</span>)
            <b>where</b> <span class="r43 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <span class="r43 r t">T</span> <a id="eb67a786a24309c9" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">CreateOrUpdate</a>(<span class="r43 r t">T</span> <span id="r47 rd" class="r47 r">a</span>, <span class="i">AccessCondition</span> <span id="r48 rd" class="r48 r">b</span>) =&gt; <span class="r44 r">createOrUpdateFunc</span>(<span class="r47 r">a</span>, <b>null</b>, <span class="r48 r">b</span>);
            <span class="r43 r t">var</span> <span id="r49 rd" class="r49 r">createdResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r45 r">newResourceDefinition</span>(), <span class="i">AccessCondition</span>.<span class="i">GenerateEmptyCondition</span>());
            <span class="r43 r t">var</span> <span id="r50 rd" class="r50 r">mutatedResource</span> = <span class="r46 r">mutateResourceDefinition</span>(<span class="r49 r">createdResource</span>);
 
            <span class="r43 r t">var</span> <span id="r51 rd" class="r51 r">updatedResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r50 r">mutatedResource</span>, <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<span class="r49 r">createdResource</span>));
 
            <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r49 r">createdResource</span>.<span class="i">ETag</span>);
            <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r51 r">updatedResource</span>.<span class="i">ETag</span>);
            <span class="i">Assert</span>.<span class="i">NotEqual</span>(<span class="r49 r">createdResource</span>.<span class="i">ETag</span>, <span class="r51 r">updatedResource</span>.<span class="i">ETag</span>);
        }
 
        <b>internal static void</b> <a id="d4b7025797ac445a" href="../R/d4b7025797ac445a.html" target="n" data-glyph="74,1" class="i method">UpdateIfNotChangedFailsWhenResourceChanged</a>&lt;<span id="r52 rd t" class="r52 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#d6a8fafda0383fc5" class="t t">Func</a>&lt;<span class="r52 r t">T</span>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>, <span class="r52 r t">T</span>&gt; <span id="r53 rd" class="r53 r">createOrUpdateFunc</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r52 r t">T</span>&gt; <span id="r54 rd" class="r54 r">newResourceDefinition</span>,
            <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<span class="r52 r t">T</span>, <span class="r52 r t">T</span>&gt; <span id="r55 rd" class="r55 r">mutateResourceDefinition</span>)
            <b>where</b> <span class="r52 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <span class="r52 r t">T</span> <a id="eb67a786a24309c9" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">CreateOrUpdate</a>(<span class="r52 r t">T</span> <span id="r56 rd" class="r56 r">a</span>, <span class="i">AccessCondition</span> <span id="r57 rd" class="r57 r">b</span>) =&gt; <span class="r53 r">createOrUpdateFunc</span>(<span class="r56 r">a</span>, <b>null</b>, <span class="r57 r">b</span>);
            <span class="r52 r t">var</span> <span id="r58 rd" class="r58 r">createdResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r54 r">newResourceDefinition</span>(), <span class="i">AccessCondition</span>.<span class="i">GenerateEmptyCondition</span>());
            <span class="r52 r t">var</span> <span id="r59 rd" class="r59 r">mutatedResource</span> = <span class="r55 r">mutateResourceDefinition</span>(<span class="r58 r">createdResource</span>);
            <span class="r52 r t">var</span> <span id="r60 rd" class="r60 r">updatedResource</span> = <span class="i">CreateOrUpdate</span>(<span class="r59 r">mutatedResource</span>, <span class="i">AccessCondition</span>.<span class="i">GenerateEmptyCondition</span>());
 
            <a href="../Utilities/SearchAssert.cs.html#166eadd17fbab75c" class="t t">SearchAssert</a>.<span class="i">ThrowsCloudException</span>(
                () =&gt; <span class="i">CreateOrUpdate</span>(<span class="r60 r">updatedResource</span>, <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<span class="r58 r">createdResource</span>)),
                <span id="r61 rd" class="r61 r">e</span> =&gt; <span class="r61 r">e</span>.<span class="i">IsAccessConditionFailed</span>());
 
            <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r58 r">createdResource</span>.<span class="i">ETag</span>);
            <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r60 r">updatedResource</span>.<span class="i">ETag</span>);
            <span class="i">Assert</span>.<span class="i">NotEqual</span>(<span class="r58 r">createdResource</span>.<span class="i">ETag</span>, <span class="r60 r">updatedResource</span>.<span class="i">ETag</span>);
        }
 
        <b>internal static void</b> <a id="a8c72b55646c95ba" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeleteIfNotChangedWorksOnlyOnCurrentResource</a>&lt;<span id="r62 rd t" class="r62 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#28d0bef62ddfa8c8" class="t t">Action</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>&gt; <span id="r63 rd" class="r63 r">deleteAction</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r62 r t">T</span>&gt; <span id="r64 rd" class="r64 r">createResource</span>,
            <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<span class="r62 r t">T</span>, <span class="r62 r t">T</span>&gt; <span id="r65 rd" class="r65 r">updateResource</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r66 rd" class="r66 r">resourceName</span>)
            <b>where</b> <span class="r62 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <b>void</b> <a id="79a6eb7a23ce1ea6" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">Delete</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r67 rd" class="r67 r">a</span>, <span class="i">AccessCondition</span> <span id="r68 rd" class="r68 r">b</span>) =&gt; <span class="r63 r">deleteAction</span>(<span class="r67 r">a</span>, <b>null</b>, <span class="r68 r">b</span>);
            <span class="r62 r t">var</span> <span id="r69 rd" class="r69 r">staleResource</span> = <span class="r64 r">createResource</span>();
            <span class="r62 r t">var</span> <span id="r70 rd" class="r70 r">currentResource</span> = <span class="r65 r">updateResource</span>(<span class="r69 r">staleResource</span>);
 
            <a href="../Utilities/SearchAssert.cs.html#166eadd17fbab75c" class="t t">SearchAssert</a>.<span class="i">ThrowsCloudException</span>(
                () =&gt; <span class="i">Delete</span>(<span class="r66 r">resourceName</span>, <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<span class="r69 r">staleResource</span>)),
                <span id="r71 rd" class="r71 r">e</span> =&gt; <span class="r71 r">e</span>.<span class="i">IsAccessConditionFailed</span>());
            <span class="i">Delete</span>(<span class="r66 r">resourceName</span>, <span class="i">AccessCondition</span>.<span class="i">IfNotChanged</span>(<span class="r70 r">currentResource</span>));
        }
 
        <b>internal static void</b> <a id="831b76ba1d6f59fb" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeleteIfExistsWorksOnlyWhenResourceExists</a>&lt;<span id="r72 rd t" class="r72 r t">T</span>&gt;(
            <a href="@0@mscorlib/A.html#28d0bef62ddfa8c8" class="t t">Action</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <span class="i">SearchRequestOptions</span>, <span class="i">AccessCondition</span>&gt; <span id="r73 rd" class="r73 r">deleteAction</span>,
            <a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<span class="r72 r t">T</span>&gt; <span id="r74 rd" class="r74 r">createResource</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r75 rd" class="r75 r">resourceName</span>)
            <b>where</b> <span class="r72 r t">T</span> : <span class="i">IResourceWithETag</span>
        {
            <b>void</b> <a id="79a6eb7a23ce1ea6" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">Delete</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r76 rd" class="r76 r">a</span>, <span class="i">AccessCondition</span> <span id="r77 rd" class="r77 r">b</span>) =&gt; <span class="r73 r">deleteAction</span>(<span class="r76 r">a</span>, <b>null</b>, <span class="r77 r">b</span>);
            <span class="r74 r">createResource</span>();
 
            <span class="i">Delete</span>(<span class="r75 r">resourceName</span>, <span class="i">AccessCondition</span>.<span class="i">GenerateIfExistsCondition</span>());
            <a href="../Utilities/SearchAssert.cs.html#166eadd17fbab75c" class="t t">SearchAssert</a>.<span class="i">ThrowsCloudException</span>(
                () =&gt; <span class="i">Delete</span>(<span class="r75 r">resourceName</span>, <span class="i">AccessCondition</span>.<span class="i">GenerateIfExistsCondition</span>()),
                <span id="r78 rd" class="r78 r">e</span> =&gt; <span class="r78 r">e</span>.<span class="i">IsAccessConditionFailed</span>());
        }
 
        <b>private class</b> <a id="104346db44bc9bb9" href="../R/104346db44bc9bb9.html" target="n" data-glyph="4,1" class="t t"><span id="b2c759c5f9afd67b">AResourceWithETag</span></a> : <span class="i">IResourceWithETag</span>
        {
            <b>public string</b> <a id="1fe07ef0485c57fe" href="../R/1fe07ef0485c57fe.html" target="n" data-glyph="102,2" class="i property">ETag</a> { <b>get</b>; <b>set</b>; }
        }
    }
}
</pre></td></tr></table></div></body></html>
