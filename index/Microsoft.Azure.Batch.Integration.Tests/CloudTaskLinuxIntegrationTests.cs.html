<!DOCTYPE html>
<html><head><title>CloudTaskLinuxIntegrationTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(136);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Batch.Integration.Tests/CloudTaskLinuxIntegrationTests.cs" target="_top">CloudTaskLinuxIntegrationTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Batch.Integration.Tests" target="_top">Microsoft.Azure.Batch.Integration.Tests.csproj</a> (Microsoft.Azure.Batch.Integration.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>namespace</b> <span class="i n">BatchClientIntegrationTests</span>
{
    <b>using</b> <span class="i n">System</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
    <b>using</b> <span class="i n">BatchTestCommon</span>;
    <b>using</b> <span class="i n">Fixtures</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>.<span class="i n">Common</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>.<span class="i n">Integration</span>.<span class="i n">Tests</span>.<span class="i n">Infrastructure</span>;
    <b>using</b> <span class="i n">IntegrationTestUtilities</span>;
    <b>using</b> <span class="i n">Xunit</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>.<span class="i n">Integration</span>.<span class="i n">Tests</span>.<span class="i n">IntegrationTestUtilities</span>;
    <b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
 
    [<span class="t constructor">Collection</span>(<span class="s">&quot;SharedLinuxPoolCollection&quot;</span>)]
    <b>public class</b> <a id="1937411e9e378033" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">CloudTaskLinuxIntegrationTests</a>
    {
        <b>private readonly</b> <a href="Fixtures/PoolFixture.cs.html#adc4366cd44e6b53" class="t t">PoolFixture</a> <a id="a40a4a2cba515af9" href="R/a40a4a2cba515af9.html" target="n" data-glyph="46,1" class="i field">poolFixture</a>;
        <b>private static readonly</b> <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="cf7f2901393e7353" href="R/cf7f2901393e7353.html" target="n" data-glyph="46,1" class="i field">TestTimeout</a> = <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(3);
 
        <b>public</b> <a id="7d310060ebf721d9" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CloudTaskLinuxIntegrationTests</a>(<a href="Fixtures/IaasLinuxPoolFixture.cs.html#dd6fc787a86ea910" class="t t">IaasLinuxPoolFixture</a> <span id="r0 rd" class="r0 r">poolFixture</span>)
        {
            <a href="#1937411e9e378033" class="k">this</a>.<a href="#a40a4a2cba515af9" class="i field">poolFixture</a> = <span class="r0 r">poolFixture</span>;
        }
 
        [<span class="t constructor">Fact</span>]
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#cb987dbcc4b85937" class="i field">ShortDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d7c40d49fe6ac996" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">RunTaskAndUploadFiles_FilesAreSuccessfullyUploaded</a>()
        {
            <b>async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3b9be196a605b73c" href="R/3b9be196a605b73c.html" target="n" data-glyph="76,2" class="i method">test</a>()
            {
                <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a> <span id="r1 rd" class="r1 r">batchCli</span> = <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#70323b9a3f92692c" class="i method">OpenBatchClient</a>(<a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#554e2d8347b023b3" class="i method">GetCredentialsFromEnvironment</a>());
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r2 rd" class="r2 r">jobId</span> = <span class="s">&quot;RunTaskAndUploadFiles-&quot;</span> + <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#71e76a83fc8dd577" class="i method">GetMyName</a>();
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">containerName</span> = <span class="s">&quot;runtaskanduploadfiles&quot;</span>;
                <a href="IntegrationTestUtilities/FileUploadUtilities.cs.html#3b9275d3afe2c09e" class="t t">StagingStorageAccount</a> <span id="r4 rd" class="r4 r">storageAccount</span> = <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#2f9dcbe8d3162db7" class="i method">GetStorageCredentialsFromEnvironment</a>();
                <a href="/Azure.Storage.Blobs/A.html#5c3c4fe54cdb5868" class="t t">BlobServiceClient</a> <span id="r5 rd" class="r5 r">blobClient</span> = <a href="IntegrationTestUtilities/BlobUtilities.cs.html#73f0092f76658c91" class="t t">BlobUtilities</a>.<a href="IntegrationTestUtilities/BlobUtilities.cs.html#bd740311396496fd" class="i method">GetBlobServiceClient</a>(<span class="r4 r">storageAccount</span>);
                <a href="/Azure.Storage.Blobs/A.html#6bb2c165ee95c7d4" class="t t">BlobContainerClient</a> <span id="r6 rd" class="r6 r">containerClient</span> = <a href="IntegrationTestUtilities/BlobUtilities.cs.html#73f0092f76658c91" class="t t">BlobUtilities</a>.<a href="IntegrationTestUtilities/BlobUtilities.cs.html#cdfcbe1cbd2f9808" class="i method">GetBlobContainerClient</a>(<span class="r3 r">containerName</span>, <span class="r5 r">blobClient</span>, <span class="r4 r">storageAccount</span>);
 
                <b>try</b>
                {
                    <span class="c">// Create container and writeable SAS</span>
                    <span class="r6 r">containerClient</span>.<a href="/Azure.Storage.Blobs/A.html#ae92191ef11ca804" class="i method">CreateIfNotExists</a>();
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r7 rd" class="r7 r">sasUri</span> = <a href="IntegrationTestUtilities/BlobUtilities.cs.html#73f0092f76658c91" class="t t">BlobUtilities</a>.<a href="IntegrationTestUtilities/BlobUtilities.cs.html#538e616bfc9e4364" class="i method">GetWriteableSasUri</a>(<span class="r6 r">containerClient</span>, <span class="r4 r">storageAccount</span>);
 
                    <a href="/Microsoft.Azure.Batch/A.html#f7086b8696d5b14e" class="t t">CloudJob</a> <span id="r8 rd" class="r8 r">createJob</span> = <span class="r1 r">batchCli</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#2ea94429ae1a83f7" class="i method">CreateJob</a>(<span class="r2 r">jobId</span>, <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#f201a869350242a6" class="t constructor">PoolInformation</a>() { <a href="/Microsoft.Azure.Batch/A.html#269cf0d6e56e7e5e" class="i property">PoolId</a> = <a href="#a40a4a2cba515af9" class="i field">poolFixture</a>.<a href="Fixtures/PoolFixture.cs.html#df55b1cdf3dae3af" class="i property">PoolId</a> });
                    <span class="r8 r">createJob</span>.<a href="/Microsoft.Azure.Batch/A.html#3616feec2b409ce3" class="i method">Commit</a>();
 
                    <b>const string</b> <span id="r9 rd" class="r9 r">blobPrefix</span> = <span class="s">&quot;foo/bar&quot;</span>;
                    <b>const string</b> <span id="r10 rd" class="r10 r">taskId</span> = <span class="s">&quot;simpletask&quot;</span>;
 
                    <a href="/Microsoft.Azure.Batch/A.html#765781d719e0a77b" class="t t">OutputFileDestination</a> <span id="r11 rd" class="r11 r">destination</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#b8d617be3762d064" class="t constructor">OutputFileDestination</a>(<b>new</b> <a href="/Microsoft.Azure.Batch/A.html#6afa1fc2740f91a3" class="t constructor">OutputFileBlobContainerDestination</a>(<span class="r7 r">sasUri</span>, <span class="r9 r">blobPrefix</span>));
                    <a href="/Microsoft.Azure.Batch/A.html#c0da1aad704db526" class="t t">OutputFileUploadOptions</a> <span id="r12 rd" class="r12 r">uploadOptions</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#85cb71502a2ab264" class="t constructor">OutputFileUploadOptions</a>(<span class="r13 r">uploadCondition</span>: <a href="/Microsoft.Azure.Batch/A.html#13bb9deba85ee49c" class="t t">OutputFileUploadCondition</a>.<a href="/Microsoft.Azure.Batch/A.html#eb5a28f95a33d6d5" class="i field">TaskCompletion</a>);
                    <a href="/Microsoft.Azure.Batch/A.html#eeca8189f6dd1bc1" class="t t">CloudTask</a> <span id="r14 rd" class="r14 r">unboundTask</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#9feffc4561b02162" class="t constructor">CloudTask</a>(<span class="r10 r">taskId</span>, <span class="s">&quot;echo test&quot;</span>)
                    {
                        <a href="/Microsoft.Azure.Batch/A.html#ba34044855043c4e" class="i property">OutputFiles</a> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Microsoft.Azure.Batch/A.html#df15f3d0e86f9826" class="t t">OutputFile</a>&gt;
                            {
                                <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#5161b2edf1387fd2" class="t constructor">OutputFile</a>(<span class="s">@&quot;../*.txt&quot;</span>, <span class="r11 r">destination</span>, <span class="r12 r">uploadOptions</span>)
                            }
                    };
 
                    <span class="r1 r">batchCli</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#0ae8bcd2f0d07053" class="i method">AddTask</a>(<span class="r2 r">jobId</span>, <span class="r14 r">unboundTask</span>);
 
                    <a href="/Microsoft.Azure.Batch/A.html#f93c71bac5f9f1fd" class="k">var</a> <span id="r15 rd" class="r15 r">tasks</span> = <span class="r1 r">batchCli</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#385a3919a7427604" class="i method">ListTasks</a>(<span class="r2 r">jobId</span>);
 
                    <a href="/Microsoft.Azure.Batch/A.html#c27f3744780e0805" class="k">var</a> <span id="r16 rd" class="r16 r">monitor</span> = <span class="r1 r">batchCli</span>.<a href="/Microsoft.Azure.Batch/A.html#64529c3a532b3f2b" class="i property">Utilities</a>.<a href="/Microsoft.Azure.Batch/A.html#d4ceea47a8cdb7ed" class="i method">CreateTaskStateMonitor</a>();
                    <span class="r16 r">monitor</span>.<a href="/Microsoft.Azure.Batch/A.html#b5caf4dea114966b" class="i method">WaitAll</a>(<span class="r15 r">tasks</span>, <a href="/Microsoft.Azure.Batch/A.html#61427e025d3132b9" class="t t">TaskState</a>.<a href="/Microsoft.Azure.Batch/A.html#9dc78f8044c6f13b" class="i field">Completed</a>, <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(1));
 
                    <span class="c">// Ensure that the correct files got uploaded</span>
                    <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r17 rd" class="r17 r">blobs</span> = <span class="r6 r">containerClient</span>.<a href="IntegrationTestUtilities/BlobUtilities.cs.html#2e8d8f120ceb8a50" class="i method">GetAllBlobs</a>();
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(4, <span class="r17 r">blobs</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>()); <span class="c">//There are 4 .txt files created, stdout, stderr, fileuploadout, and fileuploaderr</span>
                    <b>foreach</b> (<a href="/Azure.Storage.Blobs/A.html#8029f8268c3df23c" class="k">var</a> <span id="r18 rd" class="r18 r">blob</span> <b>in</b> <span class="r17 r">blobs</span>)
                    {
                        <span class="t t">Assert</span>.<span class="i method">StartsWith</span>(<span class="r9 r">blobPrefix</span>, <span class="r18 r">blob</span>.<a href="/Azure.Storage.Blobs/A.html#1c486ee7e34147b4" class="i property">Name</a>);
                    }
                }
                <b>finally</b>
                {
                    <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#febdf0c7a8df4568" class="i method">DeleteJobIfExistsAsync</a>(<span class="r1 r">batchCli</span>, <span class="r2 r">jobId</span>).<a href="@0@mscorlib/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
                    <span class="r6 r">containerClient</span>.<a href="/Azure.Storage.Blobs/A.html#42450f84c76edbc6" class="i method">DeleteIfExists</a>();
                }
            }
 
            <b>await</b> <a href="IntegrationTestUtilities/SynchronizationContextHelper.cs.html#6ab3759e02709037" class="t t">SynchronizationContextHelper</a>.<a href="IntegrationTestUtilities/SynchronizationContextHelper.cs.html#1694a9aa5f940c26" class="i method">RunTestAsync</a>(<a href="#3b9be196a605b73c" class="i method">test</a>, <a href="#cf7f2901393e7353" class="i field">TestTimeout</a>);
        }
 
        [<span class="t constructor">Fact</span>]
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#4e0c76c1a7231ee3" class="i field">LongDuration</a>)]
        <b>public void</b> <a id="0b4bc6ac63ef03f0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestContainerTask</a>()
        {
            <b>void</b> <a id="3b9be196a605b73c" href="R/3b9be196a605b73c.html" target="n" data-glyph="76,2" class="i method">test</a>()
            {
                <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a> <span id="r19 rd" class="r19 r">client</span> = <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#70323b9a3f92692c" class="i method">OpenBatchClient</a>(<a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#554e2d8347b023b3" class="i method">GetCredentialsFromEnvironment</a>());
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">jobId</span> = <span class="s">&quot;ContainerJob&quot;</span> + <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#71e76a83fc8dd577" class="i method">GetMyName</a>();
 
                <b>try</b>
                {
                    <a href="/Microsoft.Azure.Batch/A.html#f7086b8696d5b14e" class="k">var</a> <span id="r21 rd" class="r21 r">job</span> = <span class="r19 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#2ea94429ae1a83f7" class="i method">CreateJob</a>(<span class="r20 r">jobId</span>, <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#f201a869350242a6" class="t constructor">PoolInformation</a>()
                    {
                        <a href="/Microsoft.Azure.Batch/A.html#269cf0d6e56e7e5e" class="i property">PoolId</a> = <a href="#a40a4a2cba515af9" class="i field">poolFixture</a>.<a href="Fixtures/PoolFixture.cs.html#df55b1cdf3dae3af" class="i property">PoolId</a>
                    });
                    <span class="r21 r">job</span>.<a href="/Microsoft.Azure.Batch/A.html#3616feec2b409ce3" class="i method">Commit</a>();
 
                    <a href="/Microsoft.Azure.Batch/A.html#eeca8189f6dd1bc1" class="k">var</a> <span id="r22 rd" class="r22 r">newTask</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#9feffc4561b02162" class="t constructor">CloudTask</a>(<span class="s">&quot;a&quot;</span>, <span class="s">&quot;cat /etc/centos-release&quot;</span>)
                    {
                        <a href="/Microsoft.Azure.Batch/A.html#2ba20eb0cc92f832" class="i property">ContainerSettings</a> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#21d67dc9bae43c4c" class="t constructor">TaskContainerSettings</a>(<span class="s">&quot;centos&quot;</span>)
                    };
                    <span class="r19 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#0ae8bcd2f0d07053" class="i method">AddTask</a>(<span class="r20 r">jobId</span>, <span class="r22 r">newTask</span>);
 
                    <a href="/Microsoft.Azure.Batch/A.html#f93c71bac5f9f1fd" class="k">var</a> <span id="r23 rd" class="r23 r">tasks</span> = <span class="r19 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#385a3919a7427604" class="i method">ListTasks</a>(<span class="r20 r">jobId</span>);
 
                    <a href="/Microsoft.Azure.Batch/A.html#c27f3744780e0805" class="k">var</a> <span id="r24 rd" class="r24 r">monitor</span> = <span class="r19 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#64529c3a532b3f2b" class="i property">Utilities</a>.<a href="/Microsoft.Azure.Batch/A.html#d4ceea47a8cdb7ed" class="i method">CreateTaskStateMonitor</a>();
                    <span class="r24 r">monitor</span>.<a href="/Microsoft.Azure.Batch/A.html#b5caf4dea114966b" class="i method">WaitAll</a>(<span class="r23 r">tasks</span>, <a href="/Microsoft.Azure.Batch/A.html#61427e025d3132b9" class="t t">TaskState</a>.<a href="/Microsoft.Azure.Batch/A.html#9dc78f8044c6f13b" class="i field">Completed</a>, <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(7));
 
                    <a href="/Microsoft.Azure.Batch/A.html#eeca8189f6dd1bc1" class="k">var</a> <span id="r25 rd" class="r25 r">task</span> = <span class="r23 r">tasks</span>.<a href="@0@System.Core/A.html#35e2ff5965cb4b7e" class="i method">Single</a>();
                    <span class="r25 r">task</span>.<a href="/Microsoft.Azure.Batch/A.html#c59301d7b808ab87" class="i method">Refresh</a>();
 
                    <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;ContainerPoolNotSupported&quot;</span>, <span class="r25 r">task</span>.<a href="/Microsoft.Azure.Batch/A.html#068ec1c242782c02" class="i property">ExecutionInformation</a>.<a href="/Microsoft.Azure.Batch/A.html#5e44ba3a4f2f4b0d" class="i property">FailureInformation</a>.<a href="/Microsoft.Azure.Batch/A.html#fa0de020a358c8c5" class="i property">Code</a>);
                }
                <b>finally</b>
                {
                    <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#febdf0c7a8df4568" class="i method">DeleteJobIfExistsAsync</a>(<span class="r19 r">client</span>, <span class="r20 r">jobId</span>).<a href="@0@mscorlib/A.html#1bfe9e19e44f4cfa" class="i method">Wait</a>();
                }
            }
 
            <a href="IntegrationTestUtilities/SynchronizationContextHelper.cs.html#6ab3759e02709037" class="t t">SynchronizationContextHelper</a>.<a href="IntegrationTestUtilities/SynchronizationContextHelper.cs.html#a1219f5208e7e69c" class="i method">RunTest</a>(<a href="#3b9be196a605b73c" class="i method">test</a>, <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(10));
        }
    }
}
</pre></td></tr></table></div></body></html>
