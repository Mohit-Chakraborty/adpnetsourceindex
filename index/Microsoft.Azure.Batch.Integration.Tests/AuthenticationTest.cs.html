<!DOCTYPE html>
<html><head><title>AuthenticationTest.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(133);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Batch.Integration.Tests/AuthenticationTest.cs" target="_top">AuthenticationTest.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/batch/Microsoft.Azure.Batch/tests/IntegrationTests/AuthenticationTest.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Batch.Integration.Tests" target="_top">Microsoft.Azure.Batch.Integration.Tests.csproj</a> (Microsoft.Azure.Batch.Integration.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">

<b>namespace</b> <span class="i n">BatchClientIntegrationTests</span>
{
    <b>using</b> <span class="i n">System</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>.<span class="i n">Http</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
    <b>using</b> <span class="i n">BatchClientIntegrationTests</span>.<span class="i n">IntegrationTestUtilities</span>;
    <b>using</b> <span class="i n">BatchTestCommon</span>;
    <b>using</b> <span class="i n">IntegrationTestCommon</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>.<span class="i n">Auth</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>.<span class="i n">Common</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Batch</span>.<span class="i n">Integration</span>.<span class="i n">Tests</span>.<span class="i n">Infrastructure</span>;
    <b>using</b> <span class="i n">Xunit</span>;
 
    <b>public class</b> <a id="d26597316a7b7e5e" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="dd7ec1c4178b7fc6">AuthenticationTest</span></a>
    {
        <b>private string</b> <a id="5dcd3b4caac92753" href="R/5dcd3b4caac92753.html" target="n" data-glyph="46,1" class="i field">invalidUrl</a> = <span class="s">&quot;https://fakeurl.batchintegrationtesting.com&quot;</span>;
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#cb987dbcc4b85937" class="i field">ShortDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="70fbacde86e9c37e" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanAuthenticateToServiceWithAADToken</a>()
        {
            <b>static</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="b5856bf9206423a4" href="R/b5856bf9206423a4.html" target="n" data-glyph="76,2" class="i method">tokenProvider</a>() =&gt; <a href="/Microsoft.Azure.Batch.IntegrationTestCommon/A.html#7c9a99a5a54bf799" class="t t">IntegrationTestCommon</a>.<a href="/Microsoft.Azure.Batch.IntegrationTestCommon/A.html#9aef80ba256c77f3" class="i method">GetAuthenticationTokenAsync</a>(<span class="s">&quot;https://batch.core.windows.net/&quot;</span>);
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r0 rd" class="r0 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#d63003afc5f245ad" class="i method">Open</a>(<b>new</b> <a href="/Microsoft.Azure.Batch/A.html#fe9e1f1ccda521e8" class="t constructor">BatchTokenCredentials</a>(<a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#34ec98f54745720a" class="i field">BatchAccountUrl</a>, <a href="#b5856bf9206423a4" class="i method">tokenProvider</a>));
            <b>await</b> <span class="r0 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>();
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#98240fbcedc92095" class="i field">VeryShortDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="9d897dfc15263f74" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanAuthenticateToServiceWithSharedKeyCredentials</a>()
        {
            <a href="/Microsoft.Azure.Batch/A.html#a26ae65f60c3b1be" class="t t">BatchSharedKeyCredentials</a> <span id="r1 rd" class="r1 r">credentials</span> = <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#554e2d8347b023b3" class="i method">GetCredentialsFromEnvironment</a>();
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r2 rd" class="r2 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#151d4d490aadb9e8" class="i method">Open</a>(<span class="r1 r">credentials</span>);
            <b>await</b> <span class="r2 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>();
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#98240fbcedc92095" class="i field">VeryShortDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="fb16c9b61c377dc2" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BadAccountUrlThrows</a>()
        {
            <a href="/Microsoft.Azure.Batch/A.html#a26ae65f60c3b1be" class="t t">BatchSharedKeyCredentials</a> <span id="r3 rd" class="r3 r">credentials</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#44d5e7722628ac62" class="t constructor">BatchSharedKeyCredentials</a>(
                <span class="s">$&quot;</span>{<a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#34ec98f54745720a" class="i field">BatchAccountUrl</a>}<span class="s">/badendpoint</span><span class="s">&quot;</span>,
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#180c3860f60310ff" class="i field">BatchAccountName</a>,
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#115141c33bc08ece" class="i field">BatchAccountKey</a>);
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r4 rd" class="r4 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#151d4d490aadb9e8" class="i method">Open</a>(<span class="r3 r">credentials</span>);
            <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#9aba12d160d070c9" class="i method">AssertThrowsAsync</a>&lt;<a href="/Microsoft.Azure.Batch/A.html#11968400ddac5a84" class="t t">BatchException</a>&gt;(<b>async</b> () =&gt; <b>await</b> <span class="r4 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>());
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#4e0c76c1a7231ee3" class="i field">LongDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="dce5e131eb20c816" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">InvalidAccountUrlThrows</a>()
        {
            <a href="/Microsoft.Azure.Batch/A.html#a26ae65f60c3b1be" class="t t">BatchSharedKeyCredentials</a> <span id="r5 rd" class="r5 r">credentials</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#44d5e7722628ac62" class="t constructor">BatchSharedKeyCredentials</a>(
                <a href="#5dcd3b4caac92753" class="i field">invalidUrl</a>,
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#180c3860f60310ff" class="i field">BatchAccountName</a>,
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#115141c33bc08ece" class="i field">BatchAccountKey</a>);
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r6 rd" class="r6 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#151d4d490aadb9e8" class="i method">Open</a>(<span class="r5 r">credentials</span>);
            <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#9aba12d160d070c9" class="i method">AssertThrowsAsync</a>&lt;<span class="t t">HttpRequestException</span>&gt;(<b>async</b> () =&gt; <b>await</b> <span class="r6 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>());
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#98240fbcedc92095" class="i field">VeryShortDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="1650f9a6ce631020" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BadAccountNameThrows</a>()
        {
            <a href="/Microsoft.Azure.Batch/A.html#a26ae65f60c3b1be" class="t t">BatchSharedKeyCredentials</a> <span id="r7 rd" class="r7 r">credentials</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#44d5e7722628ac62" class="t constructor">BatchSharedKeyCredentials</a>(
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#34ec98f54745720a" class="i field">BatchAccountUrl</a>,
                <span class="s">&quot;BadAccountName&quot;</span>,
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#115141c33bc08ece" class="i field">BatchAccountKey</a>);
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r8 rd" class="r8 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#151d4d490aadb9e8" class="i method">Open</a>(<span class="r7 r">credentials</span>);
            <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#9aba12d160d070c9" class="i method">AssertThrowsAsync</a>&lt;<a href="/Microsoft.Azure.Batch/A.html#11968400ddac5a84" class="t t">BatchException</a>&gt;(<b>async</b> () =&gt; <b>await</b> <span class="r8 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>());
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#cb987dbcc4b85937" class="i field">ShortDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="96bf76e4f7af42c5" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">InvalidAccountKeyThrows</a>()
        {
            <a href="/Microsoft.Azure.Batch/A.html#a26ae65f60c3b1be" class="t t">BatchSharedKeyCredentials</a> <span id="r9 rd" class="r9 r">credentials</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#44d5e7722628ac62" class="t constructor">BatchSharedKeyCredentials</a>(
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#34ec98f54745720a" class="i field">BatchAccountUrl</a>,
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#180c3860f60310ff" class="i field">BatchAccountName</a>,
                <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#f9e5bd7b69c5f334" class="i method">ToBase64String</a>(<a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@0@mscorlib/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="s">&quot;InvalidAccountKey&quot;</span>)));
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r10 rd" class="r10 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#151d4d490aadb9e8" class="i method">Open</a>(<span class="r9 r">credentials</span>);
            <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#9aba12d160d070c9" class="i method">AssertThrowsAsync</a>&lt;<a href="/Microsoft.Azure.Batch/A.html#11968400ddac5a84" class="t t">BatchException</a>&gt;(<b>async</b> () =&gt; <b>await</b> <span class="r10 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>());
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#4e0c76c1a7231ee3" class="i field">LongDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="88c04b00c22000be" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BadAccountKeyThrows</a>()
        {
            <a href="/Microsoft.Azure.Batch/A.html#a26ae65f60c3b1be" class="t t">BatchSharedKeyCredentials</a> <span id="r11 rd" class="r11 r">credentials</span> = <b>new</b> <a href="/Microsoft.Azure.Batch/A.html#44d5e7722628ac62" class="t constructor">BatchSharedKeyCredentials</a>(
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#34ec98f54745720a" class="i field">BatchAccountUrl</a>,
                <a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#180c3860f60310ff" class="i field">BatchAccountName</a>,
                <span class="s">&quot;BadAccountKey&quot;</span>);
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r12 rd" class="r12 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#151d4d490aadb9e8" class="i method">Open</a>(<span class="r11 r">credentials</span>);
            <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#9aba12d160d070c9" class="i method">AssertThrowsAsync</a>&lt;<a href="@0@mscorlib/A.html#80a470d64a9b80ef" class="t t">FormatException</a>&gt;(<b>async</b> () =&gt; <b>await</b> <span class="r12 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>());
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#4e0c76c1a7231ee3" class="i field">LongDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f15be92a2ca71349" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BadTokenHostThrows</a>()
        {
            <b>static</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="b5856bf9206423a4" href="R/b5856bf9206423a4.html" target="n" data-glyph="76,2" class="i method">tokenProvider</a>() =&gt; <a href="/Microsoft.Azure.Batch.IntegrationTestCommon/A.html#7c9a99a5a54bf799" class="t t">IntegrationTestCommon</a>.<a href="/Microsoft.Azure.Batch.IntegrationTestCommon/A.html#9aef80ba256c77f3" class="i method">GetAuthenticationTokenAsync</a>(<span class="s">&quot;https://batch.core.windows.net/&quot;</span>);
 
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r13 rd" class="r13 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#d63003afc5f245ad" class="i method">Open</a>(<b>new</b> <a href="/Microsoft.Azure.Batch/A.html#fe9e1f1ccda521e8" class="t constructor">BatchTokenCredentials</a>(<a href="#5dcd3b4caac92753" class="i field">invalidUrl</a>, <a href="#b5856bf9206423a4" class="i method">tokenProvider</a>));
            <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#9aba12d160d070c9" class="i method">AssertThrowsAsync</a>&lt;<span class="t t">HttpRequestException</span>&gt;(<b>async</b> () =&gt; <b>await</b> <span class="r13 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>());
        }
 
        [<a href="Infrastructure/LiveTestAttribute.cs.html#a1847f7966bb21d7" class="t constructor">LiveTest</a>]
        [<span class="t constructor">Fact</span>]
        [<span class="t constructor">Trait</span>(<a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#9c1513f600f7ef29" class="i field">TraitName</a>, <a href="/Microsoft.Azure.Batch.Common/A.html#f12b116e0e4623de" class="t t">TestTraits</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#8972788bc05b4b9f" class="t t">Duration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#3192e26026a08a2c" class="t t">Values</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#98240fbcedc92095" class="i field">VeryShortDuration</a>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="2c7f90b261872434" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">BadTokenThrows</a>()
        {
            <b>using</b> <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="k">var</a> <span id="r14 rd" class="r14 r">client</span> = <a href="/Microsoft.Azure.Batch/A.html#a93c5701bdd04ea3" class="t t">BatchClient</a>.<a href="/Microsoft.Azure.Batch/A.html#d63003afc5f245ad" class="i method">Open</a>(<b>new</b> <a href="/Microsoft.Azure.Batch/A.html#1c18dc6d9dd9aee8" class="t constructor">BatchTokenCredentials</a>(<a href="/Microsoft.Azure.Batch.Common/A.html#60de66d46149fa95" class="t t">TestCommon</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#592860b555542c88" class="i property">Configuration</a>.<a href="/Microsoft.Azure.Batch.Common/A.html#34ec98f54745720a" class="i field">BatchAccountUrl</a>, <span class="s">&quot;BadToken&quot;</span>));
            <b>await</b> <a href="IntegrationTestUtilities/TestUtilities.cs.html#f71534b6d265a791" class="t t">TestUtilities</a>.<a href="IntegrationTestUtilities/TestUtilities.cs.html#9aba12d160d070c9" class="i method">AssertThrowsAsync</a>&lt;<a href="/Microsoft.Azure.Batch/A.html#11968400ddac5a84" class="t t">BatchException</a>&gt;(<b>async</b> () =&gt; <b>await</b> <span class="r14 r">client</span>.<a href="/Microsoft.Azure.Batch/A.html#1b81be84b4bbfd3b" class="i property">JobOperations</a>.<a href="/Microsoft.Azure.Batch/A.html#5480ddcefca5a5a1" class="i method">ListJobs</a>().<a href="/Microsoft.Azure.Batch/A.html#723cee45811b5af1" class="i method">ToListAsync</a>());
        }
    }
}</pre></td></tr></table></div></body></html>
