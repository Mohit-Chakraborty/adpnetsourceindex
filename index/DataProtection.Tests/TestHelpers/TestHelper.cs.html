<!DOCTYPE html>
<html><head><title>TestHelper.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(121);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#DataProtection.Tests/TestHelpers/TestHelper.cs" target="_top">TestHelpers\TestHelper.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/dataprotection/Microsoft.Azure.Management.DataProtection/tests/TestHelpers/TestHelper.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#DataProtection.Tests" target="_top">Microsoft.Azure.Management.DataProtection.Backup.Tests.csproj</a> (DataProtection.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>.<span class="i">ClientRuntime</span>.<span class="i">Azure</span>.<span class="i">TestFramework</span>;
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">Xunit</span>;
<b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i">Newtonsoft</span>.<span class="i">Json</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">DataProtection</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>.<span class="i">Serialization</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">DataProtection</span>.<span class="i n">Backup</span>.<span class="i n">Tests</span>.<span class="i n">TestHelpers</span>
{
    <b>public class</b> <a id="de063f0381dc25e4" href="../R/de063f0381dc25e4.html" target="n" data-glyph="0,0" class="t t"><span id="75cca6ebb353433f">TestHelper</span></a> : <span class="i">IDisposable</span>
    {
        <b>public string</b> <a id="49c2473f4c8ff8e0" href="../R/49c2473f4c8ff8e0.html" target="n" data-glyph="42,1" class="i field">ResourceGroup</a> = <span class="s">&quot;mayaggarDiskRG&quot;</span>;
        <b>public string</b> <a id="1a230ffdb2bed309" href="../R/1a230ffdb2bed309.html" target="n" data-glyph="42,1" class="i field">VaultName</a> = <span class="s">&quot;DiskbackupVault2&quot;</span>;
        <b>public string</b> <a id="86a6f9ad8f1ebd25" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Location</a> = <span class="s">&quot;southeastasia&quot;</span>;
 
        <b>public</b> <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#d31d0239f36f3e54" class="t t">DataProtectionClient</a> <a id="c68b5478f8c72fd3" href="../R/c68b5478f8c72fd3.html" target="n" data-glyph="102,1" class="i property">BackupClient</a> { <b>get</b>; <b>private set</b>; }
 
        <b>public void</b> <a id="ed8a8b9f855b11a9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<span class="i">Dispose</span>();
        }
 
        <b>public void</b> <a id="df59538d17d628f4" href="../R/df59538d17d628f4.html" target="n" data-glyph="72,1" class="i method">Initialize</a>(<span class="i">MockContext</span> <span id="r0 rd" class="r0 r">context</span>)
        {
            <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a> = <span class="r0 r">context</span>.<span class="i">GetServiceClient</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#d31d0239f36f3e54" class="t t">DataProtectionClient</a>&gt;();
        }
 
        <b>public void</b> <a id="5ec6c06974cc94ea" href="../R/5ec6c06974cc94ea.html" target="n" data-glyph="72,1" class="i method">CreateVault</a>()
        {
            <b>string</b> <span id="r1 rd" class="r1 r">data</span> = <span class="s">&quot;{\n    \&quot;id\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/BackupVaults/DiskbackupVault2\&quot;,\n    \&quot;name\&quot;: \&quot;DiskbackupVault2\&quot;,\n    \&quot;type\&quot;: \&quot;Microsoft.DataProtection/BackupVaults\&quot;,\n    \&quot;location\&quot;: \&quot;southeastasia\&quot;,\n    \&quot;identity\&quot;: {\n        \&quot;type\&quot;: \&quot;systemAssigned\&quot;\n    },\n    \&quot;properties\&quot;: {\n        \&quot;storageSettings\&quot;: [\n            {\n                \&quot;datastoreType\&quot;: \&quot;VaultStore\&quot;,\n                \&quot;type\&quot;: \&quot;ZonallyRedundant\&quot;\n            },\n            {\n                \&quot;datastoreType\&quot;: \&quot;OperationalStore\&quot;,\n                \&quot;type\&quot;: \&quot;ZonallyRedundant\&quot;\n            }\n        ]\n    }\n}&quot;</span>;
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#16f82eb39188f951" class="t t">BackupVaultResource</a> <span id="r2 rd" class="r2 r">backupVaultResource</span> = <span class="i">SafeJsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#16f82eb39188f951" class="t t">BackupVaultResource</a>&gt;(<span class="r1 r">data</span>, <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c169b6962a51173a" class="i property">DeserializationSettings</a>);
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#16f82eb39188f951" class="t t">BackupVaultResource</a> <span id="r3 rd" class="r3 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#54873a93e8a2cd59" class="i property">BackupVaults</a>.<span class="i">CreateOrUpdate</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r2 r">backupVaultResource</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r3 r">response</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/backupVaults/DiskbackupVault2&quot;</span>, <span class="r3 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#2b784132d7678d6a" class="i property">Id</a>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;DiskbackupVault2&quot;</span>, <span class="r3 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c2049e4a74f035b6" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;southeastasia&quot;</span>, <span class="r3 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#bbd387be7e6f6632" class="i property">Location</a>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Microsoft.DataProtection/backupVaults&quot;</span>, <span class="r3 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#2ba44ba8a07b39dd" class="i property">Type</a>);
        }
 
        <b>public void</b> <a id="36470cb8f239df0e" href="../R/36470cb8f239df0e.html" target="n" data-glyph="72,1" class="i method">GetVault</a>()
        {
            <b>var</b> <span id="r4 rd" class="r4 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#54873a93e8a2cd59" class="i property">BackupVaults</a>.<span class="i">Get</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r4 r">response</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/backupVaults/DiskbackupVault2&quot;</span>, <span class="r4 r">response</span>.<span class="i">Id</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;DiskbackupVault2&quot;</span>, <span class="r4 r">response</span>.<span class="i">Name</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;southeastasia&quot;</span>, <span class="r4 r">response</span>.<span class="i">Location</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;Microsoft.DataProtection/backupVaults&quot;</span>, <span class="r4 r">response</span>.<span class="i">Type</span>);
        }
 
        <b>public void</b> <a id="d65b274cb9c6626c" href="../R/d65b274cb9c6626c.html" target="n" data-glyph="72,1" class="i method">CreatePolicy</a>(<b>string</b> <span id="r5 rd" class="r5 r">policyName</span>)
        {
            <b>string</b> <span id="r6 rd" class="r6 r">requestData</span> = <span class="s">&quot;{\r\n  \&quot;id\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/BackupVaults/DiskbackupVault2/backupPolicies/retentionpolicy2\&quot;,\r\n  \&quot;name\&quot;: \&quot;retentionpolicy2\&quot;,\r\n  \&quot;type\&quot;: \&quot;Microsoft.DataProtection/backupPolicies\&quot;,\r\n  \&quot;properties\&quot;: {\r\n\t\&quot;policyRules\&quot;: [\r\n\t  {\r\n\t\t\&quot;backupParameters\&quot;: {\r\n\t\t  \&quot;backupType\&quot;: \&quot;Incremental\&quot;,\r\n\t\t  \&quot;objectType\&quot;: \&quot;AzureBackupParams\&quot;\r\n\t\t},\r\n\t\t\&quot;trigger\&quot;: {\r\n\t\t  \&quot;schedule\&quot;: {\r\n\t\t\t\&quot;repeatingTimeIntervals\&quot;: [\r\n\t\t\t  \&quot;R/2019-12-26T13:08:27.8535071Z/PT4H\&quot;\r\n\t\t\t]\r\n\t\t  },\r\n\t\t  \&quot;taggingCriteria\&quot;: [\r\n\t\t\t{\r\n\t\t\t  \&quot;tagInfo\&quot;: {\r\n\t\t\t\t\&quot;tagName\&quot;: \&quot;Default\&quot;,\r\n\t\t\t\t\&quot;id\&quot;: \&quot;Default_\&quot;\r\n\t\t\t  },\r\n\t\t\t  \&quot;taggingPriority\&quot;: 99,\r\n\t\t\t  \&quot;isDefault\&quot;: true,\r\n\t\t\t  \&quot;objectType\&quot;: \&quot;TaggingCriteria\&quot;\r\n\t\t\t}\r\n\t\t  ],\r\n\t\t  \&quot;objectType\&quot;: \&quot;ScheduleBasedTriggerContext\&quot;\r\n\t\t},\r\n\t\t\&quot;dataStore\&quot;: {\r\n\t\t  \&quot;dataStoreType\&quot;: \&quot;OperationalStore\&quot;,\r\n\t\t  \&quot;objectType\&quot;: \&quot;DataStoreInfoBase\&quot;\r\n\t\t},\r\n\t\t\&quot;name\&quot;: \&quot;BackupHourly\&quot;,\r\n\t\t\&quot;objectType\&quot;: \&quot;AzureBackupRule\&quot;,\r\n\t\t\&quot;ruleType\&quot;: \&quot;Backup\&quot;\r\n\t  },\r\n\t  {\r\n\t\t\&quot;lifecycles\&quot;: [\r\n\t\t  {\r\n\t\t\t\&quot;sourceDataStore\&quot;: {\r\n\t\t\t  \&quot;dataStoreType\&quot;: \&quot;OperationalStore\&quot;,\r\n\t\t\t  \&quot;objectType\&quot;: \&quot;DataStoreInfoBase\&quot;\r\n\t\t\t},\r\n\t\t\t\&quot;deleteAfter\&quot;: {\r\n\t\t\t  \&quot;objectType\&quot;: \&quot;AbsoluteDeleteOption\&quot;,\r\n\t\t\t  \&quot;duration\&quot;: \&quot;P1W\&quot;\r\n\t\t\t}\r\n\t\t  }\r\n\t\t],\r\n\t\t\&quot;isDefault\&quot;: true,\r\n\t\t\&quot;name\&quot;: \&quot;Default\&quot;,\r\n\t\t\&quot;objectType\&quot;: \&quot;AzureRetentionRule\&quot;,\r\n\t\t\&quot;ruleType\&quot;: \&quot;Retention\&quot;\r\n\t  }\r\n\t],\r\n\t\&quot;name\&quot;: \&quot;retentionpolicy2\&quot;,\r\n\t\&quot;id\&quot;: \&quot;75efeda6-7c58-4771-a618-0ec86fe8e423\&quot;,\r\n\t\&quot;datasourceTypes\&quot;: [\r\n\t  \&quot;Microsoft.Compute/disks\&quot;\r\n\t],\r\n\t\&quot;objectType\&quot;: \&quot;BackupPolicy\&quot;\r\n  }\r\n}&quot;</span>;
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#9c1a610170536591" class="t t">BaseBackupPolicyResource</a> <span id="r7 rd" class="r7 r">body</span> = <span class="i">SafeJsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#9c1a610170536591" class="t t">BaseBackupPolicyResource</a>&gt;(<span class="r6 r">requestData</span>.<span class="i">ToString</span>(), <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c169b6962a51173a" class="i property">DeserializationSettings</a>);
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#9c1a610170536591" class="t t">BaseBackupPolicyResource</a> <span id="r8 rd" class="r8 r">baseBackupPolicyResource</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#2c832dd9695f3915" class="i property">BackupPolicies</a>.<span class="i">CreateOrUpdate</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r5 r">policyName</span>, <span class="r7 r">body</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r8 r">baseBackupPolicyResource</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;retentionpolicy2&quot;</span>, <span class="r8 r">baseBackupPolicyResource</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#bb3200b55b221651" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/backupVaults/DiskbackupVault2/backupPolicies/retentionpolicy2&quot;</span>, <span class="r8 r">baseBackupPolicyResource</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#a1df04804a5976e3" class="i property">Id</a>);
        }
 
        <b>public void</b> <a id="450661c643bc4450" href="../R/450661c643bc4450.html" target="n" data-glyph="72,1" class="i method">GetPolicy</a>(<b>string</b> <span id="r9 rd" class="r9 r">policyName</span>)
        {
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#9c1a610170536591" class="t t">BaseBackupPolicyResource</a> <span id="r10 rd" class="r10 r">baseBackupPolicyResource</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#2c832dd9695f3915" class="i property">BackupPolicies</a>.<span class="i">Get</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r9 r">policyName</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r10 r">baseBackupPolicyResource</span>);
        }
 
        <b>public void</b> <a id="beda7dfbf8f62626" href="../R/beda7dfbf8f62626.html" target="n" data-glyph="72,1" class="i method">ValidateForBackup</a>()
        {
            <b>string</b> <span id="r11 rd" class="r11 r">requestData</span> = <span class="s">&quot;{\r\n    \&quot;objectType\&quot;: \&quot;ValidateForBackupRequest\&quot;,\r\n\t\&quot;backupInstance\&quot;: {\r\n\t\t\&quot;objectType\&quot;: \&quot;BackupInstance\&quot;,\r\n\t\t\&quot;dataSourceInfo\&quot;: {\r\n\t\t\t\&quot;objectType\&quot;: \&quot;Datasource\&quot;,\r\n\t\t\t\&quot;resourceID\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.Compute/disks/testingDisk\&quot;,\r\n\t\t\t\&quot;resourceName\&quot;: \&quot;testingDisk\&quot;,\r\n\t\t\t\&quot;resourceType\&quot;: \&quot;Microsoft.Compute/disks\&quot;,\r\n\t\t\t\&quot;resourceUri\&quot;: \&quot;\&quot;,\r\n\t\t\t\&quot;resourceLocation\&quot;: \&quot;southeastasia\&quot;,\r\n\t\t\t\&quot;datasourceType\&quot;: \&quot;Microsoft.Compute/disks\&quot;\r\n\t\t},\r\n\t\t\&quot;policyInfo\&quot;: {\r\n\t\t\t\&quot;policyId\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/BackupVaults/DiskbackupVault2/backupPolicies/retentionpolicy2\&quot;,\r\n\t\t\t\&quot;name\&quot;: \&quot;retentionpolicy2\&quot;,\r\n\t\t\t\&quot;policyVersion\&quot;: \&quot;3.2\&quot;,\r\n\t\t\t\&quot;policyParameters\&quot;: {\r\n\t\t\t\t\&quot;dataStoreParametersList\&quot;: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\&quot;objectType\&quot;: \&quot;AzureOperationalStoreParameters\&quot;,\r\n\t\t\t\t\t\t\&quot;dataStoreType\&quot;: \&quot;OperationalStore\&quot;,\r\n\t\t\t\t\t\t\&quot;resourceGroupId\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarOTDSRG\&quot;\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}&quot;</span>;
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#1207ecde304f4369" class="t t">ValidateForBackupRequest</a> <span id="r12 rd" class="r12 r">body</span> = <span class="i">SafeJsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#1207ecde304f4369" class="t t">ValidateForBackupRequest</a>&gt;(<span class="r11 r">requestData</span>.<span class="i">ToString</span>(), <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c169b6962a51173a" class="i property">DeserializationSettings</a>);
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#93a69600786116bd" class="k">var</a> <span id="r13 rd" class="r13 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#248ad791f4e2623c" class="i property">BackupInstances</a>.<span class="i">ValidateForBackup</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r12 r">body</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#106b2fe2d55c559a" class="i property">BackupInstance</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r13 r">response</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r13 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#a4c22f3c4eb749d5" class="i property">JobId</a>);
        }
 
        <b>public void</b> <a id="f2399fb971d4f719" href="../R/f2399fb971d4f719.html" target="n" data-glyph="72,1" class="i method">CreateBackupInstance</a>()
        {
            <b>string</b> <span id="r14 rd" class="r14 r">requestData</span> = <span class="s">&quot;{\r\n\t\&quot;id\&quot;: null,\r\n\t\&quot;name\&quot;: \&quot;testingDisk\&quot;,\r\n\t\&quot;type\&quot;: \&quot;Microsoft.DataProtection/backupvaults/backupInstances\&quot;,\r\n\t\&quot;location\&quot;: null,\r\n\t\&quot;tags\&quot;: null,\r\n\t\&quot;eTag\&quot;: null,\r\n\t\&quot;properties\&quot;: {\r\n\t\t\&quot;objectType\&quot;: \&quot;BackupInstance\&quot;,\r\n\t\t\&quot;dataSourceInfo\&quot;: {\r\n\t\t\t\&quot;objectType\&quot;: \&quot;Datasource\&quot;,\r\n\t\t\t\&quot;resourceID\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.Compute/disks/testingDisk\&quot;,\r\n\t\t\t\&quot;resourceName\&quot;: \&quot;testingDisk\&quot;,\r\n\t\t\t\&quot;resourceType\&quot;: \&quot;Microsoft.Compute/disks\&quot;,\r\n\t\t\t\&quot;resourceUri\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.Compute/disks/testingDisk\&quot;,\r\n\t\t\t\&quot;resourceLocation\&quot;: \&quot;southeastasia\&quot;,\r\n\t\t\t\&quot;datasourceType\&quot;: \&quot;Microsoft.Compute/disks\&quot;\r\n\t\t},\r\n\t\t\&quot;policyInfo\&quot;: {\r\n\t\t\t\&quot;policyId\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/BackupVaults/DiskbackupVault2/backupPolicies/retentionpolicy2\&quot;,\r\n\t\t\t\&quot;name\&quot;: \&quot;retentionpolicy2\&quot;,\r\n\t\t\t\&quot;policyVersion\&quot;: \&quot;3.2\&quot;,\r\n            \&quot;policyParameters\&quot;: {\r\n\t\t\t\t\&quot;dataStoreParametersList\&quot;: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\&quot;objectType\&quot;: \&quot;AzureOperationalStoreParameters\&quot;,\r\n\t\t\t\t\t\t\&quot;dataStoreType\&quot;: \&quot;OperationalStore\&quot;,\r\n\t\t\t\t\t\t\&quot;resourceGroupId\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarOTDSRG\&quot;\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}&quot;</span>;
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#728ade2b6fa414cc" class="t t">BackupInstanceResource</a> <span id="r15 rd" class="r15 r">body</span> = <span class="i">SafeJsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#728ade2b6fa414cc" class="t t">BackupInstanceResource</a>&gt;(<span class="r14 r">requestData</span>.<span class="i">ToString</span>(), <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c169b6962a51173a" class="i property">DeserializationSettings</a>);
            <b>var</b> <span id="r16 rd" class="r16 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#248ad791f4e2623c" class="i property">BackupInstances</a>.<span class="i">CreateOrUpdate</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r15 r">body</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#bb3200b55b221651" class="i property">Name</a>, <span class="r15 r">body</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r16 r">response</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/backupVaults/DiskbackupVault2/backupInstances/testingDisk&quot;</span>, <span class="r16 r">response</span>.<span class="i">Id</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;testingDisk&quot;</span>, <span class="r16 r">response</span>.<span class="i">Name</span>);
        }
 
        <b>public void</b> <a id="2edd56c55fabad0c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetBackupInstance</a>(<b>string</b> <span id="r17 rd" class="r17 r">backupInstanceName</span>)
        {
            <b>var</b> <span id="r18 rd" class="r18 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#248ad791f4e2623c" class="i property">BackupInstances</a>.<span class="i">Get</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r17 r">backupInstanceName</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r18 r">response</span>);
        }
 
        <b>public void</b> <a id="9ed169837403451f" href="../R/9ed169837403451f.html" target="n" data-glyph="72,1" class="i method">TriggerBackup</a>(<b>string</b> <span id="r19 rd" class="r19 r">backupInstanceName</span>)
        {
            <span class="c">//JToken requestData = mockJson[&quot;Entries&quot;][7][&quot;RequestBody&quot;];</span>
            <b>string</b> <span id="r20 rd" class="r20 r">requestData</span> = <span class="s">&quot;{\r\n  \&quot;backupRuleOptions\&quot;: {\r\n    \&quot;ruleName\&quot;: \&quot;BackupHourly\&quot;,\r\n    \&quot;triggerOption\&quot;: {\r\n      \&quot;retentionTagOverride\&quot;: \&quot;Default\&quot;\r\n    }\r\n  }\r\n}&quot;</span>;
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#81fae634860dc06f" class="t t">TriggerBackupRequest</a> <span id="r21 rd" class="r21 r">body</span> = <span class="i">SafeJsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#81fae634860dc06f" class="t t">TriggerBackupRequest</a>&gt;(<span class="r20 r">requestData</span>.<span class="i">ToString</span>(), <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c169b6962a51173a" class="i property">DeserializationSettings</a>);
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#93a69600786116bd" class="k">var</a> <span id="r22 rd" class="r22 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#248ad791f4e2623c" class="i property">BackupInstances</a>.<span class="i">AdhocBackup</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r19 r">backupInstanceName</span>, <span class="r21 r">body</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c0414d1ee871b7ff" class="i property">BackupRuleOptions</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r22 r">response</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/backupVaults/DiskbackupVault2/backupJobs/610fe9cb-4196-4508-ab4b-4dbcfdc44b57&quot;</span>, <span class="r22 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#a4c22f3c4eb749d5" class="i property">JobId</a>);
        }
 
        <b>public void</b> <a id="579df616481a1d37" href="../R/579df616481a1d37.html" target="n" data-glyph="72,1" class="i method">ValidateForRestore</a>(<b>string</b> <span id="r23 rd" class="r23 r">backupInstanceName</span>)
        {
            <b>string</b> <span id="r24 rd" class="r24 r">requestData</span> = <span class="s">&quot;{\&quot;objectType\&quot;:\&quot;ValidateRestoreRequestObject\&quot;,\&quot;restoreRequestObject\&quot;:{\&quot;objectType\&quot;:\&quot;AzureBackupRecoveryPointBasedRestoreRequest\&quot;,\&quot;sourceDataStoreType\&quot;:\&quot;OperationalStore\&quot;,\&quot;restoreTargetInfo\&quot;:{\&quot;objectType\&quot;:\&quot;restoreTargetInfo\&quot;,\&quot;recoveryOption\&quot;:\&quot;FailIfExists\&quot;,\&quot;dataSourceInfo\&quot;:{\&quot;objectType\&quot;:\&quot;Datasource\&quot;,\&quot;resourceID\&quot;:\&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggartargetrg/providers/Microsoft.Compute/disks/restoredisk1\&quot;,\&quot;resourceName\&quot;:\&quot;restoredisk1\&quot;,\&quot;resourceType\&quot;:\&quot;Microsoft.Compute/disks\&quot;,\&quot;resourceLocation\&quot;:\&quot;centraluseuap\&quot;,\&quot;resourceUri\&quot;:\&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggartargetrg/providers/Microsoft.Compute/disks/restoredisk1\&quot;,\&quot;datasourceType\&quot;:\&quot;Microsoft.Compute/disks\&quot;},\&quot;restoreLocation\&quot;:\&quot;southeastasia\&quot;},\&quot;recoveryPointId\&quot;:\&quot;7327d7065c4145b3b6d80bcb8a787ea6\&quot;}}&quot;</span>;
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#fd956da1057def8c" class="t t">ValidateRestoreRequestObject</a> <span id="r25 rd" class="r25 r">body</span> = <span class="i">SafeJsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#fd956da1057def8c" class="t t">ValidateRestoreRequestObject</a>&gt;(<span class="r24 r">requestData</span>.<span class="i">ToString</span>(), <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c169b6962a51173a" class="i property">DeserializationSettings</a>);
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#93a69600786116bd" class="k">var</a> <span id="r26 rd" class="r26 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#248ad791f4e2623c" class="i property">BackupInstances</a>.<span class="i">ValidateRestore</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r23 r">backupInstanceName</span>, <span class="r25 r">body</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#f5bfc504284b377e" class="i property">RestoreRequestObject</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r26 r">response</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r26 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#a4c22f3c4eb749d5" class="i property">JobId</a>);
        }
 
        <b>public void</b> <a id="5e619addf004ff40" href="../R/5e619addf004ff40.html" target="n" data-glyph="72,1" class="i method">TriggerRestore</a>(<b>string</b> <span id="r27 rd" class="r27 r">backupInstanceName</span>)
        {
            <b>string</b> <span id="r28 rd" class="r28 r">requestData</span> = <span class="s">&quot;{\r\n\t\&quot;objectType\&quot;: \&quot;AzureBackupRecoveryPointBasedRestoreRequest\&quot;,\r\n    \&quot;recoveryPointId\&quot;: \&quot;7327d7065c4145b3b6d80bcb8a787ea6\&quot;,\r\n    \&quot;sourceDataStoreType\&quot;: \&quot;OperationalStore\&quot;,\r\n    \&quot;recoveryPointTime\&quot;: \&quot;2020-10-30T11:47:00.0000000Z\&quot;,\r\n   \t\&quot;restoreTargetInfo\&quot;: {\r\n\t\t\t\&quot;objectType\&quot;: \&quot;restoreTargetInfo\&quot;,\r\n\t\t\t\&quot;recoveryOption\&quot;: \&quot;FailIfExists\&quot;,\r\n\t\t\t\&quot;dataSourceInfo\&quot;: {\r\n\t\t\t\t\&quot;objectType\&quot;: \&quot;Datasource\&quot;,\r\n\t\t\t\t\&quot;resourceID\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarTargetRG/providers/Microsoft.Compute/disks/restoreDisk1\&quot;,\r\n\t\t\t\t\&quot;resourceName\&quot;: \&quot;restoreDisk1\&quot;,\r\n\t\t\t\t\&quot;resourceType\&quot;: \&quot;Microsoft.Compute/disks\&quot;,\r\n\t\t\t\t\&quot;resourceLocation\&quot;: \&quot;southeastasia\&quot;,\r\n\t\t\t\t\&quot;resourceUri\&quot;: \&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarTargetRG/providers/Microsoft.Compute/disks/restoreDisk1\&quot;,\r\n\t\t\t\t\&quot;datasourceType\&quot;: \&quot;Microsoft.Compute/disks\&quot;\r\n\t\t\t},\r\n\t\t\t\&quot;restoreLocation\&quot;: \&quot;southeastasia\&quot;\r\n\t\t}\r\n}&quot;</span>;
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#1bb31cdd7e08bf27" class="t t">AzureBackupRecoveryPointBasedRestoreRequest</a> <span id="r29 rd" class="r29 r">body</span> = <span class="i">SafeJsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#1bb31cdd7e08bf27" class="t t">AzureBackupRecoveryPointBasedRestoreRequest</a>&gt;(<span class="r28 r">requestData</span>.<span class="i">ToString</span>(), <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#c169b6962a51173a" class="i property">DeserializationSettings</a>);
            <a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#93a69600786116bd" class="k">var</a> <span id="r30 rd" class="r30 r">response</span> = <a href="#c68b5478f8c72fd3" class="i property">BackupClient</a>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#248ad791f4e2623c" class="i property">BackupInstances</a>.<span class="i">TriggerRestore</span>(<a href="#1a230ffdb2bed309" class="i field">VaultName</a>, <a href="#49c2473f4c8ff8e0" class="i field">ResourceGroup</a>, <span class="r27 r">backupInstanceName</span>, <span class="r29 r">body</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r30 r">response</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;/subscriptions/62b829ee-7936-40c9-a1c9-47a93f9f3965/resourceGroups/mayaggarDiskRG/providers/Microsoft.DataProtection/backupVaults/DiskbackupVault2/backupJobs/0c4803ea-3c92-40f1-a1dc-a5d7c602f1d5&quot;</span>, <span class="r30 r">response</span>.<a href="/Microsoft.Azure.Management.DataProtection.Backup/A.html#a4c22f3c4eb749d5" class="i property">JobId</a>);
        }
    }
}
</pre></td></tr></table></div></body></html>
