<!DOCTYPE html>
<html><head><title>AlgorithmResolver.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(88);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.KeyVault.Cryptography/AlgorithmResolver.cs" target="_top">AlgorithmResolver.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.KeyVault.Cryptography" target="_top">Microsoft.Azure.KeyVault.Cryptography.csproj</a> (Microsoft.Azure.KeyVault.Cryptography)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for</span>
<span class="c">// license information.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i n">CodeAnalysis</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">KeyVault</span>.<span class="i n">Cryptography</span>.<span class="i n">Algorithms</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">KeyVault</span>.<span class="i n">Cryptography</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Resolves algorithm name to implementations.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="165493d8325dd042" href="R/165493d8325dd042.html" target="n" data-glyph="0,0" class="t t"><span id="91cb4bf9713f419c">AlgorithmResolver</span></a>
    {
        <b>static</b> <a id="7ac8d16bc5a64f67" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">AlgorithmResolver</a>()
        {
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Aes128CbcHmacSha256.cs.html#bcdd4f4846e47053" class="t t">Aes128CbcHmacSha256</a>.<a href="Algorithms/Aes128CbcHmacSha256.cs.html#fe327294cd0ebebd" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Aes128CbcHmacSha256.cs.html#ff7e87a075c2c26d" class="t constructor">Aes128CbcHmacSha256</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Aes192CbcHmacSha384.cs.html#6d7521ac443a3eba" class="t t">Aes192CbcHmacSha384</a>.<a href="Algorithms/Aes192CbcHmacSha384.cs.html#d7e630d24772df99" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Aes192CbcHmacSha384.cs.html#5c302f8e2e4546b4" class="t constructor">Aes192CbcHmacSha384</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Aes256CbcHmacSha512.cs.html#9a68b1eb770d853f" class="t t">Aes256CbcHmacSha512</a>.<a href="Algorithms/Aes256CbcHmacSha512.cs.html#affc841790da6d67" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Aes256CbcHmacSha512.cs.html#a3d3a57d1294fd1e" class="t constructor">Aes256CbcHmacSha512</a>() );
 
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/AesCbc.cs.html#2d6b6702479a060f" class="t t">Aes128Cbc</a>.<a href="Algorithms/AesCbc.cs.html#043d17fd13452a15" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/AesCbc.cs.html#c73c56a51f3beacd" class="t constructor">Aes128Cbc</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/AesCbc.cs.html#efa574e68bd10c2b" class="t t">Aes192Cbc</a>.<a href="Algorithms/AesCbc.cs.html#4ad5e8e78ee4b196" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/AesCbc.cs.html#33bc1a1dd3e3ef5d" class="t constructor">Aes192Cbc</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/AesCbc.cs.html#c151aa73c9ffd15c" class="t t">Aes256Cbc</a>.<a href="Algorithms/AesCbc.cs.html#3fd603cdc8be139e" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/AesCbc.cs.html#173155a4a1cd888e" class="t constructor">Aes256Cbc</a>() );
 
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/AesKw128.cs.html#80fa36bc7ac51bc5" class="t t">AesKw128</a>.<a href="Algorithms/AesKw128.cs.html#f61bf56928eea44a" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/AesKw128.cs.html#3b5d74a0a98ea5dd" class="t constructor">AesKw128</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/AesKw192.cs.html#4bbc51461170699e" class="t t">AesKw192</a>.<a href="Algorithms/AesKw192.cs.html#33d26286c0571524" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/AesKw192.cs.html#b878fe670e0d8c14" class="t constructor">AesKw192</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/AesKw256.cs.html#43c4c75266b47fe3" class="t t">AesKw256</a>.<a href="Algorithms/AesKw256.cs.html#86e86afc1f24fa50" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/AesKw256.cs.html#a5d828769c5e557d" class="t constructor">AesKw256</a>() );
 
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Rsa15.cs.html#8e06200854ca448e" class="t t">Rsa15</a>.<a href="Algorithms/Rsa15.cs.html#234b7c20a087e6d0" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Rsa15.cs.html#5aefa9d50c946411" class="t constructor">Rsa15</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/RsaOaep.cs.html#0173c8445861a70f" class="t t">RsaOaep</a>.<a href="Algorithms/RsaOaep.cs.html#ae94444913156adb" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/RsaOaep.cs.html#828bc7fe360ab996" class="t constructor">RsaOaep</a>() );
 
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Rs256.cs.html#eb36db5576af72c9" class="t t">Rs256</a>.<a href="Algorithms/Rs256.cs.html#1fc4ad696fc3590c" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Rs256.cs.html#5a9b201310a1e134" class="t constructor">Rs256</a>() );
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">FullNetFx</span>
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/RsNull.cs.html#a600bb9499621b1d" class="t t">RsNull</a>.<a href="Algorithms/RsNull.cs.html#812057d695c5e142" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/RsNull.cs.html#837df1174c88b616" class="t constructor">RsNull</a>() );
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Es256.cs.html#40c5e6ca89818e29" class="t t">Es256</a>.<a href="Algorithms/Es256.cs.html#0541a65b7ec351fe" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Es256.cs.html#1760e4d30bf3f224" class="t constructor">Es256</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Es384.cs.html#bb2614692f58da05" class="t t">Es384</a>.<a href="Algorithms/Es384.cs.html#f8b9de617794a3a7" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Es384.cs.html#bf431361a316481d" class="t constructor">Es384</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Es512.cs.html#9927cb88ff7abde9" class="t t">Es512</a>.<a href="Algorithms/Es512.cs.html#ff324af84d4d8db5" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Es512.cs.html#b41d9d7fbc42f0c3" class="t constructor">Es512</a>() );
            <a href="#0c346ca8da89f28f" class="i field">Default</a>.<a href="#6194b759268e41d0" class="i method">AddAlgorithm</a>( <a href="Algorithms/Ecdsa256.cs.html#93579530cf8004f4" class="t t">ES256K</a>.<a href="Algorithms/Ecdsa256.cs.html#54e447cc7f36ef22" class="i field">AlgorithmName</a>, <b>new</b> <a href="Algorithms/Ecdsa256.cs.html#050609b76afa05d5" class="t constructor">ES256K</a>() );
        }
 
        [<a href="@0@mscorlib/A.html#5e00de6576fb9ce7" class="t constructor">SuppressMessage</a>(<span class="s">&quot;Microsoft.Security&quot;</span>, <span class="s">&quot;CA2104:DoNotDeclareReadOnlyMutableReferenceTypes&quot;</span>)]
        <b>public static readonly</b> <a href="#165493d8325dd042" class="t t">AlgorithmResolver</a> <a id="0c346ca8da89f28f" href="R/0c346ca8da89f28f.html" target="n" data-glyph="42,1" class="i field">Default</a> = <b>new</b> <a href="#165493d8325dd042" class="t constructor">AlgorithmResolver</a>();
 
        <b>private readonly</b> <a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="Algorithm.cs.html#93fb9baab5fec763" class="t t">Algorithm</a>&gt; <a id="56c2d8ccefa74aa0" href="R/56c2d8ccefa74aa0.html" target="n" data-glyph="46,1" class="i field">_algorithms</a> = <b>new</b> <a href="@0@mscorlib/A.html#bf6849e410b43c4c" class="t constructor">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="Algorithm.cs.html#93fb9baab5fec763" class="t t">Algorithm</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the implementation for an algorithm name</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">algorithmName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The algorithm name</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="Algorithm.cs.html#93fb9baab5fec763" class="t t">Algorithm</a> <a id="6fccb0c948237218" href="R/6fccb0c948237218.html" target="n" data-glyph="102,1" class="k">this</a>[ <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">algorithmName</span> ]
        {
            <b>get</b> { <b>return</b> <a href="#56c2d8ccefa74aa0" class="i field">_algorithms</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r0 r">algorithmName</span>]; }
            <b>set</b> { <a href="#56c2d8ccefa74aa0" class="i field">_algorithms</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r0 r">algorithmName</span>] = <b>value</b>;  }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an algorithm to the resolver</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">algorithmName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The algorithm name</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The provider for the algorithm</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="6194b759268e41d0" href="R/6194b759268e41d0.html" target="n" data-glyph="72,1" class="i method">AddAlgorithm</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">algorithmName</span>, <a href="Algorithm.cs.html#93fb9baab5fec763" class="t t">Algorithm</a> <span id="r2 rd" class="r2 r">provider</span> )
        {
            <b>if</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>( <span class="r1 r">algorithmName</span> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r1 r">algorithmName</span> ) );
 
            <b>if</b> ( <span class="r2 r">provider</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r2 r">provider</span> ) );
 
            <a href="#56c2d8ccefa74aa0" class="i field">_algorithms</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r1 r">algorithmName</span>] = <span class="r2 r">provider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes an algorithm from the resolver</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">algorithmName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The algorithm name</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="788cc9e979f432d3" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">RemoveAlgorithm</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">algorithmName</span> )
        {
            <a href="#56c2d8ccefa74aa0" class="i field">_algorithms</a>.<a href="@0@mscorlib/A.html#a6db5ffdec557169" class="i method">Remove</a>( <span class="r3 r">algorithmName</span> );
        }
    }
}
</pre></td></tr></table></div></body></html>
