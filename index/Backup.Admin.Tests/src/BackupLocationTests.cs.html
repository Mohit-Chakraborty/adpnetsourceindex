<!DOCTYPE html>
<html><head><title>BackupLocationTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(148);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Backup.Admin.Tests/src/BackupLocationTests.cs" target="_top">src\BackupLocationTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Backup.Admin.Tests" target="_top">tests\Microsoft.AzureStack.Management.Backup.Tests.csproj</a> (Backup.Admin.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for</span>
<span class="c">// license information.</span>
<span class="c">//</span>
 
 
<b>namespace</b> <span class="i n">Backup</span>.<span class="i n">Tests</span>
{
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">AzureStack</span>.<span class="i n">Management</span>.<span class="i n">Backup</span>.<span class="i n">Admin</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">AzureStack</span>.<span class="i n">Management</span>.<span class="i n">Backup</span>.<span class="i n">Admin</span>.<span class="i n">Models</span>;
    <b>using</b> <span class="i">System</span>;
    <b>using</b> <span class="i">Xunit</span>;
 
    <b>public class</b> <a id="a3d16f72ea820448" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="f32ef0625484199b">BackupLocationTests</span></a> : <a href="Helpers/BackupTestBase.cs.html#e302bb004782a72b" class="t t">BackupTestBase</a>
    {
 
        <b>private void</b> <a id="1c13058c28f3f4eb" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ValidateBackupLocation</a>(<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#60ee250e4c070624" class="t t">BackupLocation</a> <span id="r0 rd" class="r0 r">location</span>)
        {
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r0 r">location</span>);
 
            <span class="c">// Resource properties</span>
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r0 r">location</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#fe3a58db6ff40e4b" class="i property">Id</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r0 r">location</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#a735cd3732838147" class="i property">Type</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r0 r">location</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#647dd9bdb77c4df2" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r0 r">location</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#0d298efda6a9f945" class="i property">Location</a>);
 
            <span class="c">// Backup location properties</span>
            <span class="c">// TODO: Check with teams.</span>
        }
 
        <b>private void</b> <a id="f735ad18916fd18e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AssertSame</a>(<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#60ee250e4c070624" class="t t">BackupLocation</a> <span id="r1 rd" class="r1 r">expected</span>, <a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#60ee250e4c070624" class="t t">BackupLocation</a> <span id="r2 rd" class="r2 r">given</span>)
        {
            <b>if</b> (<span class="r1 r">expected</span> == <b>null</b>)
            {
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r2 r">given</span>);
            }
            <b>else</b>
            {
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r2 r">given</span>);
 
                <span class="c">// Resource properties</span>
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#fe3a58db6ff40e4b" class="i property">Id</a>.<span class="i">ToLower</span>(), <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#fe3a58db6ff40e4b" class="i property">Id</a>.<span class="i">ToLower</span>());
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#a735cd3732838147" class="i property">Type</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#a735cd3732838147" class="i property">Type</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#647dd9bdb77c4df2" class="i property">Name</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#647dd9bdb77c4df2" class="i property">Name</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#0d298efda6a9f945" class="i property">Location</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#0d298efda6a9f945" class="i property">Location</a>);
 
                <span class="c">// Location properties</span>
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#03b5d39d81f360b5" class="i property">AvailableCapacity</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#03b5d39d81f360b5" class="i property">AvailableCapacity</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#5954f3450c6fea35" class="i property">BackupFrequencyInHours</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#5954f3450c6fea35" class="i property">BackupFrequencyInHours</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#8f7d8733cadd94e8" class="i property">EncryptionCertBase64</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#8f7d8733cadd94e8" class="i property">EncryptionCertBase64</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#3767202b6f424ad9" class="i property">IsBackupSchedulerEnabled</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#3767202b6f424ad9" class="i property">IsBackupSchedulerEnabled</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#9d57ec55429996c1" class="i property">LastBackupTime</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#9d57ec55429996c1" class="i property">LastBackupTime</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#4f10b1f6ae746c6b" class="i property">NextBackupTime</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#4f10b1f6ae746c6b" class="i property">NextBackupTime</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#9d57ec55429996c1" class="i property">LastBackupTime</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#9d57ec55429996c1" class="i property">LastBackupTime</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#407a9820ada0e065" class="i property">Password</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#407a9820ada0e065" class="i property">Password</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#20db7a9d684bc77f" class="i property">Path</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#20db7a9d684bc77f" class="i property">Path</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r1 r">expected</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#0337859ead427d75" class="i property">UserName</a>, <span class="r2 r">given</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#0337859ead427d75" class="i property">UserName</a>);
 
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="da8055cda304c50f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestListBackupLocations</a>()
        {
            <span class="i">RunTest</span>((<span id="r3 rd" class="r3 r">client</span>) =&gt;
            {
                <b>var</b> <span id="r4 rd" class="r4 r">backupLocations</span> = <span class="r3 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">List</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>);
                <a href="Helpers/Common.cs.html#22823103ec71ea69" class="t t">Common</a>.<span class="i">MapOverIPage</span>(<span class="r4 r">backupLocations</span>, <span class="r3 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">ListNext</span>, <span class="i">ValidateBackupLocation</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="a85acfef871d8d65" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestGetBackupLocation</a>()
        {
            <span class="i">RunTest</span>((<span id="r5 rd" class="r5 r">client</span>) =&gt;
            {
                <b>var</b> <span id="r6 rd" class="r6 r">backupLocations</span> = <span class="r5 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">List</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>);
                <span class="r7 r t">var</span> <span id="r8 rd" class="r8 r">backupLocation</span> = <span class="r6 r">backupLocations</span>.<span class="i">GetFirst</span>();
                <b>var</b> <span id="r9 rd" class="r9 r">result</span> = <span class="r5 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">Get</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>, <span class="r8 r">backupLocation</span>.<span class="i">Name</span>);
                <span class="i">AssertSame</span>(<span class="r8 r">backupLocation</span>, <span class="r9 r">result</span>);
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="620c8dba88f836b1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestGetAllBackupLocation</a>()
        {
            <span class="i">RunTest</span>((<span id="r10 rd" class="r10 r">client</span>) =&gt;
            {
                <b>var</b> <span id="r11 rd" class="r11 r">backupLocations</span> = <span class="r10 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">List</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>);
                <a href="Helpers/Common.cs.html#22823103ec71ea69" class="t t">Common</a>.<span class="i">MapOverIPage</span>(<span class="r11 r">backupLocations</span>, <span class="r10 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">ListNext</span>, (<span id="r12 rd" class="r12 r">backupLocation</span>) =&gt;
                {
                    <b>var</b> <span id="r13 rd" class="r13 r">result</span> = <span class="r10 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">Get</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>, <span class="r12 r">backupLocation</span>.<span class="i">Name</span>);
                    <span class="i">AssertSame</span>(<span class="r12 r">backupLocation</span>, <span class="r13 r">result</span>);
                });
            });
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="c03dcae90b37033c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestUpdateBackupLocation</a>()
        {
            <span class="i">RunTest</span>((<span id="r14 rd" class="r14 r">client</span>) =&gt;
            {
 
                <b>var</b> <span id="r15 rd" class="r15 r">backupLocation</span> = <span class="r14 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">Get</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>, <span class="s">&quot;local&quot;</span>);
 
                <span class="r15 r">backupLocation</span>.<span class="i">Path</span> = <span class="s">@&quot;\\su1fileserver\SU1_Infrastructure_2\BackupStore&quot;</span>;
                <span class="r15 r">backupLocation</span>.<span class="i">UserName</span> = <span class="s">@&quot;azurestack\azurestackadmin&quot;</span>;
                <span class="r15 r">backupLocation</span>.<span class="i">Password</span> = <span class="s">&quot;password&quot;</span>;
                <span class="r15 r">backupLocation</span>.<span class="i">EncryptionCertBase64</span> = <span class="s">@&quot;encryptionCert&quot;</span>;
                <span class="r15 r">backupLocation</span>.<span class="i">IsBackupSchedulerEnabled</span> = <b>false</b>;
                <span class="r15 r">backupLocation</span>.<span class="i">BackupFrequencyInHours</span> = 10;
                <span class="r15 r">backupLocation</span>.<span class="i">BackupRetentionPeriodInDays</span> = 6;
 
                <a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#60ee250e4c070624" class="k">var</a> <span id="r16 rd" class="r16 r">result</span> = <span class="r14 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">Update</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>, <span class="s">&quot;local&quot;</span>, <span class="r15 r">backupLocation</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r16 r">result</span>);
 
                <span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#20db7a9d684bc77f" class="i property">Path</a> = <b>null</b>;
                <span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#0337859ead427d75" class="i property">UserName</a> = <b>null</b>;
                <span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#407a9820ada0e065" class="i property">Password</a> = <b>null</b>;
                <span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#8f7d8733cadd94e8" class="i property">EncryptionCertBase64</a> = <b>null</b>;
 
                <span class="r16 r">result</span> = <span class="r14 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">Update</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>, <span class="s">&quot;local&quot;</span>, <span class="r16 r">result</span>);
 
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#20db7a9d684bc77f" class="i property">Path</a>, <span class="r15 r">backupLocation</span>.<span class="i">Path</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#0337859ead427d75" class="i property">UserName</a>, <span class="r15 r">backupLocation</span>.<span class="i">UserName</span>);
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#407a9820ada0e065" class="i property">Password</a>);
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#8f7d8733cadd94e8" class="i property">EncryptionCertBase64</a>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#3767202b6f424ad9" class="i property">IsBackupSchedulerEnabled</a>, <span class="r15 r">backupLocation</span>.<span class="i">IsBackupSchedulerEnabled</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#5954f3450c6fea35" class="i property">BackupFrequencyInHours</a>, <span class="r15 r">backupLocation</span>.<span class="i">BackupFrequencyInHours</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r16 r">result</span>.<a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#cf3a3700a1d0c8ec" class="i property">BackupRetentionPeriodInDays</a>, <span class="r15 r">backupLocation</span>.<span class="i">BackupRetentionPeriodInDays</span>);
 
            }, <b>null</b>, <b>null</b>, <span class="i">System</span>.<span class="i">Net</span>.<span class="i">HttpStatusCode</span>.<span class="i">OK</span>, <b>false</b>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="2c8a0fb3b670e18b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateBackup</a>()
        {
            <span class="i">RunTest</span>((<span id="r17 rd" class="r17 r">client</span>) =&gt;
            {
                <a href="/Microsoft.AzureStack.Management.Backup.Admin/A.html#ca433119ae7fd825" class="k">var</a> <span id="r18 rd" class="r18 r">backup</span> = <span class="r17 r">client</span>.<span class="i">BackupLocations</span>.<span class="i">CreateBackup</span>(<a href="Helpers/BackupTestBase.cs.html#ae28ea022264f363" class="i field">ResourceGroupName</a>, <span class="s">&quot;local&quot;</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r18 r">backup</span>);
            });
        }
 
 
    }
}
</pre></td></tr></table></div></body></html>
