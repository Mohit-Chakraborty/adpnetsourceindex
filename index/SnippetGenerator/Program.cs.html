<!DOCTYPE html>
<html><head><title>Program.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(54);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#SnippetGenerator/Program.cs" target="_top">Program.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#SnippetGenerator" target="_top">SnippetGenerator.csproj</a> (SnippetGenerator)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
<b>using</b> <span class="i">McMaster</span>.<span class="i">Extensions</span>.<span class="i">CommandLineUtils</span>;
<b>using</b> <span class="i">Microsoft</span>.<span class="i">CodeAnalysis</span>.<span class="i">Options</span>;
 
<b>namespace</b> <span class="i n">SnippetGenerator</span>
{
    <b>public class</b> <a id="13ffaaf151994376" href="R/13ffaaf151994376.html" target="n" data-glyph="0,0" class="t t"><span id="7d2bf2758c8d3751">Program</span></a>
    {
 
        [<span class="i">Option</span>(<span class="i">ShortName</span> = <span class="s">&quot;b&quot;</span>)]
        <b>public string</b> <a id="075822ef7fcc577c" href="R/075822ef7fcc577c.html" target="n" data-glyph="102,1" class="i property">BasePath</a> { <b>get</b>; <b>set</b>; }
 
        <b>public void</b> <a id="de109e531bc77301" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OnExecuteAsync</a>()
        {
            <b>var</b> <span id="r0 rd" class="r0 r">baseDirectory</span> = <b>new</b> <span class="i">DirectoryInfo</span>(<a href="#075822ef7fcc577c" class="i property">BasePath</a>).<span class="i">Name</span>;
            <b>if</b> (<span class="r0 r">baseDirectory</span>.<span class="i">Equals</span>(<span class="s">&quot;sdk&quot;</span>))
            {
                <span class="i">Parallel</span>.<span class="i">ForEach</span>(<span class="i">Directory</span>.<span class="i">GetDirectories</span>(<a href="#075822ef7fcc577c" class="i property">BasePath</a>), <span id="r1 rd" class="r1 r">sdkDir</span> =&gt; <b>new</b> <span class="t">DirectoryProcessor</span>(<span class="r1 r">sdkDir</span>).<a href="DirectoryProcessor.cs.html#dfc629714b4917ed" class="i method">Process</a>());
            }
            <b>else</b>
            {
                <b>new</b> <a href="DirectoryProcessor.cs.html#e31d3d5509e0bee7" class="t constructor">DirectoryProcessor</a>(<a href="#075822ef7fcc577c" class="i property">BasePath</a>).<a href="DirectoryProcessor.cs.html#dfc629714b4917ed" class="i method">Process</a>();
            }
        }
 
        <b>public static int</b> <a id="b6f918dcac3dcb53" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Main</a>(<b>string</b>[] <span id="r2 rd" class="r2 r">args</span>)
        {
            <span class="i">ConsoleColor</span> <span id="r3 rd" class="r3 r">foreground</span> = <span class="i">Console</span>.<span class="i">ForegroundColor</span>;
 
            <b>try</b>
            {
                <b>return</b> <span class="i">CommandLineApplication</span>.<span class="i">Execute</span>&lt;<a href="#13ffaaf151994376" class="t t">Program</a>&gt;(<span class="r2 r">args</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r4 rd" class="r4 r">e</span>)
            {
                <span class="i">Console</span>.<span class="i">ForegroundColor</span> = <span class="i">ConsoleColor</span>.<span class="i">Red</span>;
 
                <span class="i">Console</span>.<span class="i">Error</span>.<span class="i">WriteLine</span>(<span class="r4 r">e</span>.<span class="i">ToString</span>());
                <b>return</b> 1;
            }
            <b>finally</b>
            {
                <span class="i">Console</span>.<span class="i">ForegroundColor</span> = <span class="r3 r">foreground</span>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
