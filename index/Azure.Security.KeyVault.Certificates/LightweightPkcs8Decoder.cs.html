<!DOCTYPE html>
<html><head><title>LightweightPkcs8Decoder.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(234);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Security.KeyVault.Certificates/LightweightPkcs8Decoder.cs" target="_top">LightweightPkcs8Decoder.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/keyvault/Azure.Security.KeyVault.Certificates/src/LightweightPkcs8Decoder.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Security.KeyVault.Certificates" target="_top">Azure.Security.KeyVault.Certificates.csproj</a> (Azure.Security.KeyVault.Certificates)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Security</span>.<span class="i n">Cryptography</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Core</span>
{
    <b>internal static</b> <a href="P/8907cf27e829343a.html" target="s" class="k">partial</a> <b>class</b> <a id="8907cf27e829343a" href="R/8907cf27e829343a.html" target="n" data-glyph="2,0" class="t t">LightweightPkcs8Decoder</a>
    {
        <b>private static readonly byte</b>[] <a id="3057dc6016a990f8" href="R/3057dc6016a990f8.html" target="n" data-glyph="46,1" class="i field">s_derIntegerOne</a> = { 0x02, 0x01, 0x01 };
        <b>private static readonly object</b>[] <a id="2160a6f924151687" href="R/2160a6f924151687.html" target="n" data-glyph="46,1" class="i field">s_argsFalse</a> = <b>new</b> <b>object</b>[] { <b>false</b> };
 
        <b>private static readonly byte</b>[] <a id="f97428d0180fa0d2" href="R/f97428d0180fa0d2.html" target="n" data-glyph="46,1" class="i field">s_ecAlgorithmId</a> =
        {
            0x06, 0x07, 0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x02, 0x01, <span class="c">// OID 1.2.840.10045.2.1, id-ecPublicKey</span>
        };
 
        <b>public static</b> <a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a> <a id="fc1aed0d062fd78a" href="R/fc1aed0d062fd78a.html" target="n" data-glyph="72,1" class="i method">DecodeECDsaPkcs8</a>(<b>byte</b>[] <span id="r0 rd" class="r0 r">pkcs8Bytes</span>, <a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a> <span id="r1 rd" class="r1 r">publicKey</span>)
        {
            <span class="c">// Based on https://tools.ietf.org/html/rfc5208 and https://www.secg.org/sec1-v2.pdf</span>
 
            <b>int</b> <span id="r2 rd" class="r2 r">offset</span> = 0;
 
            <span class="c">// PrivateKeyInfo SEQUENCE</span>
            <a href="Shared/LightweightPkcs8Decoder.cs.html#c8b87ff3f4afade5" class="i method">ConsumeFullPayloadTag</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, 0x30);
 
            <span class="c">// PKCS#8 PrivateKeyInfo.version == 0</span>
            <a href="Shared/LightweightPkcs8Decoder.cs.html#3f241927b2b21ca3" class="i method">ConsumeMatch</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, <a href="Shared/LightweightPkcs8Decoder.cs.html#0918de97787c2186" class="i field">s_derIntegerZero</a>);
 
            <span class="c">// PKCS#8 PrivateKeyInfo.sequence { AlgorithmIdentifier, CurveName }</span>
            <a href="Shared/LightweightPkcs8Decoder.cs.html#d6d494ad3fe6628d" class="i method">ReadPayloadTagLength</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, 0x30);
 
            <span class="c">// id-ecPublicKey AlgorithmIdentifier value</span>
            <a href="Shared/LightweightPkcs8Decoder.cs.html#3f241927b2b21ca3" class="i method">ConsumeMatch</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, <a href="#f97428d0180fa0d2" class="i field">s_ecAlgorithmId</a>);
 
            <span class="c">// Curve { named curve, or curve sequence }</span>
            <a href="#45d6f7a88cf5f8e4" class="t t">ECCurveProxy</a> <span id="r3 rd" class="r3 r">curve</span>;
            <b>if</b> (<span class="r0 r">pkcs8Bytes</span>[<span class="r2 r">offset</span>] == 0x06)
            {
                <span class="c">// Get named curve OID.</span>
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">namedCurveOid</span> = <a href="Shared/LightweightPkcs8Decoder.cs.html#5a23ad44825f6f97" class="i method">ReadObjectIdentifier</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>);
                <span class="r3 r">curve</span> = <b>new</b> <a href="#8b03692b088c71dd" class="t constructor">ECCurveProxy</a>(<span class="r4 r">namedCurveOid</span>);
            }
            <b>else</b> <b>if</b> (<span class="r0 r">pkcs8Bytes</span>[<span class="r2 r">offset</span>] == 0x30)
            {
                <span class="c">// If using explicit curve parameters, skip the sequence and take the curve from the public key.</span>
                <span class="c">// Since we read D, Q.X, and Q.Y below this will provide validation without incurring the risks of manually parsing.</span>
                <b>if</b> (<span class="r1 r">publicKey</span> <b>is null</b>)
                {
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#3be0a1f685d20864" class="t constructor">InvalidDataException</a>(<span class="s">&quot;Unsupported PKCS#8 Data&quot;</span>);
                }
 
                <span class="r3 r">curve</span> = <a href="#45d6f7a88cf5f8e4" class="t t">ECCurveProxy</a>.<a href="#5256f0c605bc7b3a" class="i method">ExportFromPublicKey</a>(<span class="r1 r">publicKey</span>);
 
                <span class="c">// skip this sequence</span>
                <b>int</b> <span id="r5 rd" class="r5 r">sequenceLength</span> = <a href="Shared/LightweightPkcs8Decoder.cs.html#d6d494ad3fe6628d" class="i method">ReadPayloadTagLength</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, 0x30);
                <span class="r2 r">offset</span> += <span class="r5 r">sequenceLength</span>;
            }
            <b>else</b>
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#3be0a1f685d20864" class="t constructor">InvalidDataException</a>(<span class="s">&quot;Invalid PKCS#8 Data&quot;</span>);
            }
 
            <span class="c">// ECPrivateKey value</span>
            <b>int</b> <span id="r6 rd" class="r6 r">privateKeyInfoLength</span> = <a href="Shared/LightweightPkcs8Decoder.cs.html#d6d494ad3fe6628d" class="i method">ReadPayloadTagLength</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, 0x04);
            <b>int</b> <span id="r7 rd" class="r7 r">privateKeyInfoEnd</span> = <span class="r2 r">offset</span> + <span class="r6 r">privateKeyInfoLength</span>;
 
            <span class="c">// ECPrivateKey SEQUENCE</span>
            <a href="Shared/LightweightPkcs8Decoder.cs.html#d6d494ad3fe6628d" class="i method">ReadPayloadTagLength</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, 0x30);
            <span class="c">// ECPrivateKey.version == 1</span>
            <a href="Shared/LightweightPkcs8Decoder.cs.html#3f241927b2b21ca3" class="i method">ConsumeMatch</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, <a href="#3057dc6016a990f8" class="i field">s_derIntegerOne</a>);
 
            <span class="c">// ECPrivateKey.privateKey</span>
            <a href="#4a0b3d48a0a9fe26" class="t t">ECParametersProxy</a> <span id="r8 rd" class="r8 r">ecParameters</span> = <b>new</b> <a href="#4a0b3d48a0a9fe26" class="t constructor">ECParametersProxy</a>
            {
                <a href="#4e578b7ba1f86560" class="i field">Curve</a> = <span class="r3 r">curve</span>,
                <a href="#e6339d2a5a4b013a" class="i field">D</a> = <a href="Shared/LightweightPkcs8Decoder.cs.html#eec7bf68a236983c" class="i method">ReadOctetString</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>),
            };
 
            <b>byte</b>[] <span id="r9 rd" class="r9 r">q</span>;
            <b>while</b> (<span class="r2 r">offset</span> &lt; <span class="r7 r">privateKeyInfoEnd</span>)
            {
                <b>byte</b> <span id="r10 rd" class="r10 r">tag</span> = <span class="r0 r">pkcs8Bytes</span>[<span class="r2 r">offset</span>++];
                <b>int</b> <span id="r11 rd" class="r11 r">length</span> = <a href="Shared/LightweightPkcs8Decoder.cs.html#689ea9d0a0b14cf6" class="i method">ReadLength</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>);
 
                <span class="c">// Optional ECDomainParameters [0]</span>
                <b>if</b> ((<span class="r10 r">tag</span> &amp; 0xa0) == <span class="r10 r">tag</span>)
                {
                    <span class="c">// Not expected; skip for now.</span>
                    <span class="r2 r">offset</span> += <span class="r11 r">length</span>;
                }
                <span class="c">// Optional PublicKey [1]</span>
                <b>else</b> <b>if</b> ((<span class="r10 r">tag</span> &amp; 0xa1) == <span class="r10 r">tag</span>)
                {
                    <span class="c">// Adapted from https://github.com/dotnet/runtime/blob/be74b4bd/src/libraries/Common/src/System/Security/Cryptography/EccKeyFormatHelper.cs#L115</span>
                    <span class="r9 r">q</span> = <a href="Shared/LightweightPkcs8Decoder.cs.html#b6548f2f54ad3512" class="i method">ReadBitString</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>);
 
                    <span class="c">// 04 (Uncompressed ECPoint) is almost always used.</span>
                    <b>if</b> (<span class="r9 r">q</span>[0] != 0x04)
                    {
                        <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#3be0a1f685d20864" class="t constructor">InvalidDataException</a>(<span class="s">&quot;Invalid PKCS#8 Data&quot;</span>);
                    }
 
                    <b>int</b> <span id="r12 rd" class="r12 r">privateKeySize</span> = <span class="r8 r">ecParameters</span>.<a href="#e6339d2a5a4b013a" class="i field">D</a>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a>;
                    <b>if</b> (<span class="r9 r">q</span>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a> != 2 * <span class="r12 r">privateKeySize</span> + 1)
                    {
                        <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#3be0a1f685d20864" class="t constructor">InvalidDataException</a>(<span class="s">&quot;Invalid PKCS#8 Data&quot;</span>);
                    }
 
                    <span class="r8 r">ecParameters</span>.<a href="#c42f5bf5cf1c0245" class="i field">X</a> = <span class="r9 r">q</span>.<span class="i method">AsSpan</span>(1, <span class="r12 r">privateKeySize</span>).<span class="i method">ToArray</span>();
                    <span class="r8 r">ecParameters</span>.<a href="#901b5c81d1217104" class="i field">Y</a> = <span class="r9 r">q</span>.<span class="i method">AsSpan</span>(1 + <span class="r12 r">privateKeySize</span>).<span class="i method">ToArray</span>();
                }
                <b>else</b>
                {
                    <span class="c">// Unexpected</span>
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#3be0a1f685d20864" class="t constructor">InvalidDataException</a>(<span class="s">&quot;Invalid PKCS#8 Data&quot;</span>);
                }
            }
 
            <span class="c">// Optional attributes from Key Vault.</span>
            <b>if</b> (<span class="r2 r">offset</span> &lt; <span class="r0 r">pkcs8Bytes</span>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a>)
            {
                <a href="Shared/LightweightPkcs8Decoder.cs.html#c8b87ff3f4afade5" class="i method">ConsumeFullPayloadTag</a>(<span class="r0 r">pkcs8Bytes</span>, <b>ref</b> <span class="r2 r">offset</span>, 0xa0);
            }
 
            <b>return</b> <span class="r8 r">ecParameters</span>.<a href="#09f4efce583f14f0" class="i method">ToECDsa</a>();
        }
 
        <b>private struct</b> <a id="4a0b3d48a0a9fe26" href="R/4a0b3d48a0a9fe26.html" target="n" data-glyph="112,1" class="t t"><span id="51e7abdedbf706a1">ECParametersProxy</span></a>
        {
            <b>private static</b> <a href="@1@netstandard/A.html#382d90b1fa682bac" class="t t">MethodInfo</a> <a id="a41ae371ae098626" href="R/a41ae371ae098626.html" target="n" data-glyph="46,2" class="i field">s_importParametersMethod</a>;
 
            <b>public</b> <a href="#45d6f7a88cf5f8e4" class="t t">ECCurveProxy</a> <a id="4e578b7ba1f86560" href="R/4e578b7ba1f86560.html" target="n" data-glyph="42,2" class="i field">Curve</a>;
            <b>public byte</b>[] <a id="e6339d2a5a4b013a" href="R/e6339d2a5a4b013a.html" target="n" data-glyph="42,2" class="i field">D</a>;
            <b>public byte</b>[] <a id="c42f5bf5cf1c0245" href="R/c42f5bf5cf1c0245.html" target="n" data-glyph="42,2" class="i field">X</a>;
            <b>public byte</b>[] <a id="901b5c81d1217104" href="R/901b5c81d1217104.html" target="n" data-glyph="42,2" class="i field">Y</a>;
 
            <b>public</b> <a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a> <a id="09f4efce583f14f0" href="R/09f4efce583f14f0.html" target="n" data-glyph="72,2" class="i method">ToECDsa</a>()
            {
                <b>if</b> (<a href="#a41ae371ae098626" class="i field">s_importParametersMethod</a> <b>is null</b>)
                {
                    <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r13 rd" class="r13 r">ecParametersType</span> = <b>typeof</b>(<a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a>).<a href="@1@netstandard/A.html#e87d536bd07fab01" class="i property">Assembly</a>.<a href="@1@netstandard/A.html#d2c38740a6b7facd" class="i method">GetType</a>(<span class="s">&quot;System.Security.Cryptography.ECParameters&quot;</span>)
                        ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#db107a1c43e88816" class="t constructor">PlatformNotSupportedException</a>(<span class="s">&quot;The current platform does not support reading an ECDsa private key from a PEM file&quot;</span>);
 
                    <a href="#a41ae371ae098626" class="i field">s_importParametersMethod</a> = <b>typeof</b>(<a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a>).<a href="@1@netstandard/A.html#6cd11a2e3211bf71" class="i method">GetMethod</a>(<span class="s">&quot;ImportParameters&quot;</span>, <a href="@1@netstandard/A.html#4795caf3b483702d" class="t t">BindingFlags</a>.<a href="@1@netstandard/A.html#54a14f747b06c614" class="i field">Instance</a> | <a href="@1@netstandard/A.html#4795caf3b483702d" class="t t">BindingFlags</a>.<a href="@1@netstandard/A.html#ef2ef39bdfa059df" class="i field">Public</a>, <b>null</b>, <b>new</b>[] { <span class="r13 r">ecParametersType</span> }, <b>null</b>);
                }
 
                <a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a> <span id="r14 rd" class="r14 r">ecdsa</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="r14 r">ecdsa</span> = <a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a>.<a href="@1@netstandard/A.html#d8a0dfe48cebe95e" class="i method">Create</a>();
                    <a href="#a41ae371ae098626" class="i field">s_importParametersMethod</a>.<a href="@1@netstandard/A.html#c8277ed81262a367" class="i method">Invoke</a>(<span class="r14 r">ecdsa</span>, <b>new</b>[] { <a href="#be1d55ceee37ee21" class="i method">ToObject</a>() });
 
                    <span class="c">// Make sure ecdsa is disposed if ImportParameters above fails.</span>
                    <a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a> <span id="r15 rd" class="r15 r">ret</span> = <span class="r14 r">ecdsa</span>;
                    <span class="r14 r">ecdsa</span> = <b>null</b>;
 
                    <b>return</b> <span class="r15 r">ret</span>;
                }
                <b>finally</b>
                {
                    <span class="r14 r">ecdsa</span>?.<a href="@1@netstandard/A.html#496ab6e6cbd2d299" class="i method">Dispose</a>();
                }
            }
 
            <span class="c">// ECParameters is defined in netstandard2.0 but not net461 (introduced in net47). Separate method with no inlining to prevent TypeLoadException on net461.</span>
            [<a href="@1@netstandard/A.html#b2f5af2558f436d5" class="t constructor">MethodImpl</a>(<a href="@1@netstandard/A.html#4159f5c528de6ee8" class="t t">MethodImplOptions</a>.<a href="@1@netstandard/A.html#f7d69d229fb17be2" class="i field">NoInlining</a>)]
            <b>public object</b> <a id="be1d55ceee37ee21" href="R/be1d55ceee37ee21.html" target="n" data-glyph="72,2" class="i method">ToObject</a>()
            {
                <a href="@1@netstandard/A.html#7d14b5ccc1ad89e4" class="t t">ECParameters</a> <span id="r16 rd" class="r16 r">ecParameters</span> = <b>new</b> <a href="@1@netstandard/A.html#7d14b5ccc1ad89e4" class="t constructor">ECParameters</a>();
                <span class="r16 r">ecParameters</span>.<a href="@1@netstandard/A.html#a2d4bcd9aeccf74a" class="i field">Curve</a> = (<a href="@1@netstandard/A.html#862dd4df962571de" class="t t">ECCurve</a>)<a href="#4e578b7ba1f86560" class="i field">Curve</a>.<a href="#5f9a629bbaffa4ee" class="i method">ToObject</a>();
                <span class="r16 r">ecParameters</span>.<a href="@1@netstandard/A.html#2b76c59cbcaffed3" class="i field">D</a> = <a href="#e6339d2a5a4b013a" class="i field">D</a>;
                <span class="r16 r">ecParameters</span>.<a href="@1@netstandard/A.html#270ee6ca5a3fdfd9" class="i field">Q</a>.<a href="@1@netstandard/A.html#4bd856efe6d51423" class="i field">X</a> = <a href="#c42f5bf5cf1c0245" class="i field">X</a>;
                <span class="r16 r">ecParameters</span>.<a href="@1@netstandard/A.html#270ee6ca5a3fdfd9" class="i field">Q</a>.<a href="@1@netstandard/A.html#d3e3a2655a4ac2df" class="i field">Y</a> = <a href="#901b5c81d1217104" class="i field">Y</a>;
 
                <b>return</b> <span class="r16 r">ecParameters</span>;
            }
        }
 
        <b>private struct</b> <a id="45d6f7a88cf5f8e4" href="R/45d6f7a88cf5f8e4.html" target="n" data-glyph="112,1" class="t t"><span id="e816f9ecbaa85208">ECCurveProxy</span></a>
        {
            <b>private static</b> <a href="@1@netstandard/A.html#382d90b1fa682bac" class="t t">MethodInfo</a> <a id="1031e4eadf438f64" href="R/1031e4eadf438f64.html" target="n" data-glyph="46,2" class="i field">s_exportParametersMethod</a>;
            <b>private static</b> <a href="@1@netstandard/A.html#329d417f4b15c86c" class="t t">FieldInfo</a> <a id="060c35edc7620d2a" href="R/060c35edc7620d2a.html" target="n" data-glyph="46,2" class="i field">s_curveField</a>;
 
            <b>private readonly string</b> <a id="336eb8796e2adc73" href="R/336eb8796e2adc73.html" target="n" data-glyph="46,2" class="i field">_namedCurveOid</a>;
            <b>private readonly object</b> <a id="8615a78f1ff9dc75" href="R/8615a78f1ff9dc75.html" target="n" data-glyph="46,2" class="i field">_curve</a>;
 
            <b>public</b> <a id="8b03692b088c71dd" href="R/8b03692b088c71dd.html" target="n" data-glyph="72,2" class="t constructor">ECCurveProxy</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">namedCurveOid</span>)
            {
                <a href="#336eb8796e2adc73" class="i field">_namedCurveOid</a> = <span class="r17 r">namedCurveOid</span>;
                <a href="#8615a78f1ff9dc75" class="i field">_curve</a> = <b>null</b>;
            }
 
            <b>private</b> <a id="1c75cab51f09a7ad" href="R/1c75cab51f09a7ad.html" target="n" data-glyph="76,2" class="t constructor">ECCurveProxy</a>(<b>object</b> <span id="r18 rd" class="r18 r">curve</span>)
            {
                <a href="#336eb8796e2adc73" class="i field">_namedCurveOid</a> = <b>null</b>;
                <a href="#8615a78f1ff9dc75" class="i field">_curve</a> = <span class="r18 r">curve</span>;
            }
 
            <b>public static</b> <a href="#45d6f7a88cf5f8e4" class="t t">ECCurveProxy</a> <a id="5256f0c605bc7b3a" href="R/5256f0c605bc7b3a.html" target="n" data-glyph="72,2" class="i method">ExportFromPublicKey</a>(<a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a> <span id="r19 rd" class="r19 r">publicKey</span>)
            {
                <b>if</b> (<a href="#1031e4eadf438f64" class="i field">s_exportParametersMethod</a> <b>is null</b>)
                {
                    <a href="#1031e4eadf438f64" class="i field">s_exportParametersMethod</a> = <b>typeof</b>(<a href="@1@netstandard/A.html#59084d68c76f225c" class="t t">ECDsa</a>).<a href="@1@netstandard/A.html#6cd11a2e3211bf71" class="i method">GetMethod</a>(<span class="s">&quot;ExportParameters&quot;</span>, <a href="@1@netstandard/A.html#4795caf3b483702d" class="t t">BindingFlags</a>.<a href="@1@netstandard/A.html#ef2ef39bdfa059df" class="i field">Public</a> | <a href="@1@netstandard/A.html#4795caf3b483702d" class="t t">BindingFlags</a>.<a href="@1@netstandard/A.html#54a14f747b06c614" class="i field">Instance</a>, <b>null</b>, <b>new</b>[] { <b>typeof</b>(<b>bool</b>) }, <b>null</b>)
                        ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#db107a1c43e88816" class="t constructor">PlatformNotSupportedException</a>(<span class="s">&quot;The current platform does not support reading an ECDsa private key from a PEM file&quot;</span>);
 
                    <a href="#060c35edc7620d2a" class="i field">s_curveField</a> = <a href="#1031e4eadf438f64" class="i field">s_exportParametersMethod</a>.<a href="@1@netstandard/A.html#5be6c92e98bc4044" class="i property">ReturnType</a>.<a href="@1@netstandard/A.html#0a8706ee1c09aece" class="i method">GetField</a>(<span class="s">&quot;Curve&quot;</span>, <a href="@1@netstandard/A.html#4795caf3b483702d" class="t t">BindingFlags</a>.<a href="@1@netstandard/A.html#ef2ef39bdfa059df" class="i field">Public</a> | <a href="@1@netstandard/A.html#4795caf3b483702d" class="t t">BindingFlags</a>.<a href="@1@netstandard/A.html#54a14f747b06c614" class="i field">Instance</a>);
                }
 
                <b>object</b> <span id="r20 rd" class="r20 r">parameters</span> = <a href="#1031e4eadf438f64" class="i field">s_exportParametersMethod</a>.<a href="@1@netstandard/A.html#c8277ed81262a367" class="i method">Invoke</a>(<span class="r19 r">publicKey</span>, <a href="#2160a6f924151687" class="i field">s_argsFalse</a>);
                <b>object</b> <span id="r21 rd" class="r21 r">curve</span> = <a href="#060c35edc7620d2a" class="i field">s_curveField</a>.<a href="@1@netstandard/A.html#f8ddbb1dc1c6b29e" class="i method">GetValue</a>(<span class="r20 r">parameters</span>);
 
                <b>return</b> <b>new</b> <a href="#1c75cab51f09a7ad" class="t constructor">ECCurveProxy</a>(<span class="r21 r">curve</span>);
            }
 
            <span class="c">// ECCurve is defined in netstandard2.0 but not net461 (introduced in net47). Separate method with no inlining to prevent TypeLoadException on net461.</span>
            [<a href="@1@netstandard/A.html#b2f5af2558f436d5" class="t constructor">MethodImpl</a>(<a href="@1@netstandard/A.html#4159f5c528de6ee8" class="t t">MethodImplOptions</a>.<a href="@1@netstandard/A.html#f7d69d229fb17be2" class="i field">NoInlining</a>)]
            <b>public object</b> <a id="5f9a629bbaffa4ee" href="R/5f9a629bbaffa4ee.html" target="n" data-glyph="72,2" class="i method">ToObject</a>()
            {
                <b>if</b> (<a href="#336eb8796e2adc73" class="i field">_namedCurveOid</a> != <b>null</b>)
                {
                    <b>return</b> <a href="@1@netstandard/A.html#862dd4df962571de" class="t t">ECCurve</a>.<a href="@1@netstandard/A.html#4082c8ae0eafa402" class="i method">CreateFromValue</a>(<a href="#336eb8796e2adc73" class="i field">_namedCurveOid</a>);
                }
 
                <b>return</b> <a href="#8615a78f1ff9dc75" class="i field">_curve</a>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
