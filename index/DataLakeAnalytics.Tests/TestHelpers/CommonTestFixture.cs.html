<!DOCTYPE html>
<html><head><title>CommonTestFixture.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(91);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#DataLakeAnalytics.Tests/TestHelpers/CommonTestFixture.cs" target="_top">TestHelpers\CommonTestFixture.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#DataLakeAnalytics.Tests" target="_top">Microsoft.Azure.Management.DataLakeAnalytics.Tests.csproj</a> (DataLakeAnalytics.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Test</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Rest</span>.<span class="i n">ClientRuntime</span>.<span class="i n">Azure</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">System</span>;
 
<b>namespace</b> <span class="i n">DataLakeAnalytics</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="5e5975164076a14f" href="../R/5e5975164076a14f.html" target="n" data-glyph="0,0" class="t t">CommonTestFixture</a> : <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d9819cf709ee326b" class="t t">TestBase</a>
    {
        <b>internal const string</b> <a id="6e68103d74e5454c" href="../R/6e68103d74e5454c.html" target="n" data-glyph="8,1" class="i field">SchemaName</a> = <span class="s">&quot;dbo&quot;</span>;
 
        <b>public string</b> <a id="dc1ee039d754dc78" href="../R/dc1ee039d754dc78.html" target="n" data-glyph="102,1" class="i property">ResourceGroupName</a> { <b>set</b>; <b>get</b>; }
        <b>public string</b> <a id="56b37104f7098b79" href="../R/56b37104f7098b79.html" target="n" data-glyph="102,1" class="i property">SecondDataLakeAnalyticsAccountName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="4f68e06dd0d8bc26" href="../R/4f68e06dd0d8bc26.html" target="n" data-glyph="102,1" class="i property">DataLakeAnalyticsAccountName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="804826e274675b96" href="../R/804826e274675b96.html" target="n" data-glyph="102,1" class="i property">SecondDataLakeStoreAccountName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="f913a156a6332d1b" href="../R/f913a156a6332d1b.html" target="n" data-glyph="102,1" class="i property">StorageAccountAccessKey</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="40763a212d695abe" href="../R/40763a212d695abe.html" target="n" data-glyph="102,1" class="i property">StorageAccountSuffix</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="82ae24b50311eb79" href="../R/82ae24b50311eb79.html" target="n" data-glyph="102,1" class="i property">StorageAccountName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="a79dd4d1f09f6c3e" href="../R/a79dd4d1f09f6c3e.html" target="n" data-glyph="102,1" class="i property">SecondDataLakeStoreAccountSuffix</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="48979583b6432952" href="../R/48979583b6432952.html" target="n" data-glyph="102,1" class="i property">DataLakeStoreAccountName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="8862b8a5c6a09114" href="../R/8862b8a5c6a09114.html" target="n" data-glyph="102,1" class="i property">DataLakeStoreAccountSuffix</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="5c0566d421c85bf4" href="../R/5c0566d421c85bf4.html" target="n" data-glyph="102,1" class="i property">DatabaseName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="fc8a71427cbc0d49" href="../R/fc8a71427cbc0d49.html" target="n" data-glyph="102,1" class="i property">TableName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="17946e3b0aac20d3" href="../R/17946e3b0aac20d3.html" target="n" data-glyph="102,1" class="i property">TvfName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="e57e74d7333c1184" href="../R/e57e74d7333c1184.html" target="n" data-glyph="102,1" class="i property">ViewName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="c07becd5acd6c927" href="../R/c07becd5acd6c927.html" target="n" data-glyph="102,1" class="i property">ProcName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="85042b71df8e1f74" href="../R/85042b71df8e1f74.html" target="n" data-glyph="102,1" class="i property">SecretName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="750877d70c8a40e3" href="../R/750877d70c8a40e3.html" target="n" data-glyph="102,1" class="i property">SecretPwd</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="fa8e2c4ce3a1fd16" href="../R/fa8e2c4ce3a1fd16.html" target="n" data-glyph="102,1" class="i property">CredentialName</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="911a000a791099c0" href="../R/911a000a791099c0.html" target="n" data-glyph="102,1" class="i property">HostUrl</a> { <b>get</b>; <b>set</b>; }
        <b>public string</b> <a id="f0376963b3844830" href="../R/f0376963b3844830.html" target="n" data-glyph="42,1" class="i field">Location</a> = <span class="s">&quot;East US 2&quot;</span>;
        <b>public</b> <a href="DataLakeAnalyticsManagementHelper.cs.html#64cb94fc87e13838" class="t t">DataLakeAnalyticsManagementHelper</a> <a id="d21bff64439667a1" href="../R/d21bff64439667a1.html" target="n" data-glyph="102,1" class="i property">DataLakeAnalyticsManagementHelper</a> { <b>get</b>; <b>set</b>; }
        <b>private</b> <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#99795cd14ff6aa3c" class="t t">MockContext</a> <a id="9aa6b49fe03ec456" href="../R/9aa6b49fe03ec456.html" target="n" data-glyph="46,1" class="i field">context</a>;
        <b>public</b> <a id="bdba94ab39545a55" href="../R/bdba94ab39545a55.html" target="n" data-glyph="72,1" class="t constructor">CommonTestFixture</a>(<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#99795cd14ff6aa3c" class="t t">MockContext</a> <span id="r0 rd" class="r0 r">contextToUse</span>, <b>bool</b> <span id="r1 rd" class="r1 r">createWasbAccount</span> = <b>false</b>, <b>bool</b> <span id="r2 rd" class="r2 r">isDogfood</span> = <b>false</b>)
        {
            <b>if</b>(<span class="r2 r">isDogfood</span>)
            {
                <a href="#f0376963b3844830" class="i field">Location</a> = <span class="s">&quot;Brazil South&quot;</span>;
            }
 
            <b>try</b> 
            {
                <a href="#9aa6b49fe03ec456" class="i field">context</a> = <span class="r0 r">contextToUse</span>;
                <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a> = <b>new</b> <a href="DataLakeAnalyticsManagementHelper.cs.html#a1b49cac0ed2bee5" class="t constructor">DataLakeAnalyticsManagementHelper</a>(<a href="#5e5975164076a14f" class="k">this</a>, <a href="#9aa6b49fe03ec456" class="i field">context</a>);
                <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a>.<a href="DataLakeAnalyticsManagementHelper.cs.html#595b8a18fd3ef802" class="i method">TryRegisterSubscriptionForResource</a>();
                <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a>.<a href="DataLakeAnalyticsManagementHelper.cs.html#595b8a18fd3ef802" class="i method">TryRegisterSubscriptionForResource</a>(<span class="s">&quot;Microsoft.Storage&quot;</span>);
                <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a>.<a href="DataLakeAnalyticsManagementHelper.cs.html#595b8a18fd3ef802" class="i method">TryRegisterSubscriptionForResource</a>(<span class="s">&quot;Microsoft.DataLakeStore&quot;</span>);
                <a href="#dc1ee039d754dc78" class="i property">ResourceGroupName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;rgaba1&quot;</span>);
                <a href="#4f68e06dd0d8bc26" class="i property">DataLakeAnalyticsAccountName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testaba1&quot;</span>);
                <a href="#56b37104f7098b79" class="i property">SecondDataLakeAnalyticsAccountName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testaba2&quot;</span>);
                <a href="#804826e274675b96" class="i property">SecondDataLakeStoreAccountName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;teststorage1&quot;</span>);
                <a href="#48979583b6432952" class="i property">DataLakeStoreAccountName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testdatalake1&quot;</span>);
                <a href="#804826e274675b96" class="i property">SecondDataLakeStoreAccountName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testdatalake2&quot;</span>);
                <a href="#82ae24b50311eb79" class="i property">StorageAccountName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testazureblob1&quot;</span>);
                <a href="#5c0566d421c85bf4" class="i property">DatabaseName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testdb1&quot;</span>);
                <a href="#fc8a71427cbc0d49" class="i property">TableName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testtbl1&quot;</span>);
                <a href="#17946e3b0aac20d3" class="i property">TvfName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testtvf1&quot;</span>);
                <a href="#c07becd5acd6c927" class="i property">ProcName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testproc1&quot;</span>);
                <a href="#e57e74d7333c1184" class="i property">ViewName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testview1&quot;</span>);
                <a href="#fa8e2c4ce3a1fd16" class="i property">CredentialName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testcred1&quot;</span>);
                <a href="#85042b71df8e1f74" class="i property">SecretName</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testsecret1&quot;</span>);
                <a href="#750877d70c8a40e3" class="i property">SecretPwd</a> = <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7e37892582ee2554" class="t t">TestUtilities</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c43847d890ddffef" class="i method">GenerateName</a>(<span class="s">&quot;testsecretpwd1&quot;</span>);
                <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a>.<a href="DataLakeAnalyticsManagementHelper.cs.html#35fb8a0b5863ad63" class="i method">TryCreateResourceGroup</a>(<a href="#dc1ee039d754dc78" class="i property">ResourceGroupName</a>, <a href="#f0376963b3844830" class="i field">Location</a>);
                <b>if</b> (<span class="r1 r">createWasbAccount</span>)
                {
                    <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">storageSuffix</span>;
                    <a href="#5e5975164076a14f" class="k">this</a>.<a href="#f913a156a6332d1b" class="i property">StorageAccountAccessKey</a> = <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a>.<a href="DataLakeAnalyticsManagementHelper.cs.html#e2b3292cbc011f46" class="i method">TryCreateStorageAccount</a>(<a href="#5e5975164076a14f" class="k">this</a>.<a href="#dc1ee039d754dc78" class="i property">ResourceGroupName</a>, <a href="#5e5975164076a14f" class="k">this</a>.<a href="#82ae24b50311eb79" class="i property">StorageAccountName</a>, <span class="s">&quot;DataLakeAnalyticsTestStorage&quot;</span>, <span class="s">&quot;DataLakeAnalyticsTestStorageDescription&quot;</span>, <a href="#5e5975164076a14f" class="k">this</a>.<a href="#f0376963b3844830" class="i field">Location</a>, <b>out</b> <span class="r3 r">storageSuffix</span>);
                    <a href="#5e5975164076a14f" class="k">this</a>.<a href="#40763a212d695abe" class="i property">StorageAccountSuffix</a> = <span class="r3 r">storageSuffix</span>;
                }
 
                <a href="#5e5975164076a14f" class="k">this</a>.<a href="#8862b8a5c6a09114" class="i property">DataLakeStoreAccountSuffix</a> = <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a>.<a href="DataLakeAnalyticsManagementHelper.cs.html#5f150ceb0449a668" class="i method">TryCreateDataLakeStoreAccount</a>(<a href="#5e5975164076a14f" class="k">this</a>.<a href="#dc1ee039d754dc78" class="i property">ResourceGroupName</a>, <a href="#5e5975164076a14f" class="k">this</a>.<a href="#f0376963b3844830" class="i field">Location</a>, <a href="#5e5975164076a14f" class="k">this</a>.<a href="#48979583b6432952" class="i property">DataLakeStoreAccountName</a>);
                <a href="#5e5975164076a14f" class="k">this</a>.<a href="#a79dd4d1f09f6c3e" class="i property">SecondDataLakeStoreAccountSuffix</a> = <a href="#d21bff64439667a1" class="i property">DataLakeAnalyticsManagementHelper</a>.<a href="DataLakeAnalyticsManagementHelper.cs.html#5f150ceb0449a668" class="i method">TryCreateDataLakeStoreAccount</a>(<a href="#5e5975164076a14f" class="k">this</a>.<a href="#dc1ee039d754dc78" class="i property">ResourceGroupName</a>, <a href="#5e5975164076a14f" class="k">this</a>.<a href="#f0376963b3844830" class="i field">Location</a>, <a href="#5e5975164076a14f" class="k">this</a>.<a href="#804826e274675b96" class="i property">SecondDataLakeStoreAccountName</a>);
            }
            <b>catch</b>
            {
                <a href="#b413d75490b6d063" class="i method">Cleanup</a>();
                <b>throw</b>;
            }
        }
 
        <b>private void</b> <a id="b413d75490b6d063" href="../R/b413d75490b6d063.html" target="n" data-glyph="76,1" class="i method">Cleanup</a>()
        {
            <b>if</b> (<a href="#9aa6b49fe03ec456" class="i field">context</a> != <b>null</b>)
            {
                <a href="#9aa6b49fe03ec456" class="i field">context</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#96233b5d8991f715" class="i method">Dispose</a>();
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
