<!DOCTYPE html>
<html><head><title>VisualStudioTokenProviderFileTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(52);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Services.AppAuthentication.Unit.Tests/VisualStudioTokenProviderFileTests.cs" target="_top">VisualStudioTokenProviderFileTests.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/mgmtcommon/AppAuthentication/Azure.Services.AppAuthentication.Unit.Tests/VisualStudioTokenProviderFileTests.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Services.AppAuthentication.Unit.Tests" target="_top">Microsoft.Azure.Services.AppAuthentication.Unit.Tests.csproj</a> (Microsoft.Azure.Services.AppAuthentication.Unit.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Services</span>.<span class="i n">AppAuthentication</span>.<span class="i n">TestCommon</span>;
<b>using</b> <span class="i n">Xunit</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Services</span>.<span class="i n">AppAuthentication</span>.<span class="i n">Unit</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="1605803f5e51a1e2" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="24dad09a950ed558">VisualStudioTokenProviderFileTests</span></a>
    {
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="4eddfca07d745df0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseFileWithOneProvider</a>()
        {
            <a href="/Microsoft.Azure.Services.AppAuthentication/A.html#b1bc989ab357078f" class="k">var</a> <span id="r0 rd" class="r0 r">visualStudioTokenProviderFile</span> = <a href="/Microsoft.Azure.Services.AppAuthentication/A.html#b1bc989ab357078f" class="t t">VisualStudioTokenProviderFile</a>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#537ad366e555acfb" class="i method">Load</a>(<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#2d7263f86a526264" class="i method">Combine</a>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#89851b6b454456ed" class="i field">TestFilesPath</a>, <span class="s">&quot;VisualStudioSingleTokenProvider.json&quot;</span>));
 
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r0 r">visualStudioTokenProviderFile</span>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r0 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>);
            <span class="t t">Assert</span>.<span class="i method">Single</span>(<span class="r0 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>);
 
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#7d3972061b66aeef" class="i field">TokenProviderPath</a>, <span class="r0 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[0].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#8e3cccc07a59723d" class="i field">Path</a>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r0 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[0].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#f0fbdb805ad155b5" class="i field">Arguments</a>);
 
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#f9f21cc726e285cf" class="i field">ServiceConfigFileArgument</a>, <span class="r0 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[0].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#f0fbdb805ad155b5" class="i field">Arguments</a>[0]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="83efd88fba585849" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseFileWithMultipleProviders</a>()
        {
            <a href="/Microsoft.Azure.Services.AppAuthentication/A.html#b1bc989ab357078f" class="k">var</a> <span id="r1 rd" class="r1 r">visualStudioTokenProviderFile</span> = <a href="/Microsoft.Azure.Services.AppAuthentication/A.html#b1bc989ab357078f" class="t t">VisualStudioTokenProviderFile</a>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#537ad366e555acfb" class="i method">Load</a>(<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#2d7263f86a526264" class="i method">Combine</a>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#89851b6b454456ed" class="i field">TestFilesPath</a>, <span class="s">&quot;VisualStudioMultiTokenProvider.json&quot;</span>));
 
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r1 r">visualStudioTokenProviderFile</span>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r1 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(3, <span class="r1 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>);
 
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#7d3972061b66aeef" class="i field">TokenProviderPath</a>, <span class="r1 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[0].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#8e3cccc07a59723d" class="i field">Path</a>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r1 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[0].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#f0fbdb805ad155b5" class="i field">Arguments</a>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r1 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[1].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#f0fbdb805ad155b5" class="i field">Arguments</a>);
 
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#3081570868c450de" class="i field">ServiceConfigFileArgumentName</a>, <span class="r1 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[0].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#f0fbdb805ad155b5" class="i field">Arguments</a>[0]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#f9f21cc726e285cf" class="i field">ServiceConfigFileArgument</a>, <span class="r1 r">visualStudioTokenProviderFile</span>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#533d68ab120a5ebe" class="i field">TokenProviders</a>[0].<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#f0fbdb805ad155b5" class="i field">Arguments</a>[1]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="43ccfb4a9772b0c0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseFileError</a>()
        {
            <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r2 rd" class="r2 r">exception</span> = <span class="t t">Assert</span>.<span class="i method">Throws</span>&lt;<a href="@0@mscorlib/A.html#80a470d64a9b80ef" class="t t">FormatException</a>&gt;(() =&gt; <a href="/Microsoft.Azure.Services.AppAuthentication/A.html#b1bc989ab357078f" class="t t">VisualStudioTokenProviderFile</a>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#537ad366e555acfb" class="i method">Load</a>(<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#2d7263f86a526264" class="i method">Combine</a>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#89851b6b454456ed" class="i field">TestFilesPath</a>, <span class="s">&quot;VisualStudioTokenProviderMissingPreference.json&quot;</span>)));
 
            <span class="t t">Assert</span>.<span class="i method">Contains</span>(<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#b1bc989ab357078f" class="t t">VisualStudioTokenProviderFile</a>.<a href="/Microsoft.Azure.Services.AppAuthentication/A.html#5c6f8d763c8cd983" class="i field">FormatExceptionMessage</a>, <span class="r2 r">exception</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
            <span class="t t">Assert</span>.<span class="i method">Contains</span>(<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#552fe1d84947f9ce" class="t t">Constants</a>.<a href="/Microsoft.Azure.Services.AppAuthentication.TestCommon/A.html#d59e6d3cf5097f9e" class="i field">PreferenceNotFound</a>, <span class="r2 r">exception</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
        }
    }
}
</pre></td></tr></table></div></body></html>
