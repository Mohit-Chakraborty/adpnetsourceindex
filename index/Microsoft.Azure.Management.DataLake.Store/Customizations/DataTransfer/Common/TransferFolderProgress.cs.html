<!DOCTYPE html>
<html><head><title>TransferFolderProgress.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(198);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Management.DataLake.Store/Customizations/DataTransfer/Common/TransferFolderProgress.cs" target="_top">Customizations\DataTransfer\Common\TransferFolderProgress.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Management.DataLake.Store" target="_top">Microsoft.Azure.Management.DataLake.Store.csproj</a> (Microsoft.Azure.Management.DataLake.Store)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">DataLake</span>.<span class="i n">Store</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Reports progress on an transfer for a folder.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="bff5545549325dae" href="../../../R/bff5545549325dae.html" target="n" data-glyph="0,0" class="t t">TransferFolderProgress</a>
    {
        
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private
        <b>private</b> <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="TransferProgress.cs.html#826dd519f4b122e1" class="t t">TransferProgress</a>&gt; <a id="1f960d9d5369be35" href="../../../R/1f960d9d5369be35.html" target="n" data-glyph="46,1" class="i field">_fileProgress</a>;
 
        <b>private</b> <a href="@0@mscorlib/A.html#18bcbcbdddbcfdcb" class="t t">ConcurrentQueue</a>&lt;<a href="TransferProgress.cs.html#826dd519f4b122e1" class="t t">TransferProgress</a>&gt; <a id="35c4a5c2592baf81" href="../../../R/35c4a5c2592baf81.html" target="n" data-glyph="46,1" class="i field">_progressBacklog</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#bff5545549325dae" class="t t">TransferFolderProgress</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">metadata</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The metadata.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="51eab58dc228198e" href="../../../R/51eab58dc228198e.html" target="n" data-glyph="74,1" class="t constructor">TransferFolderProgress</a>(<a href="TransferFolderMetadata.cs.html#e4a782a6b9f2d42c" class="t t">TransferFolderMetadata</a> <span id="r0 rd" class="r0 r">metadata</span>)
        {
            <a href="#f524df069b4e025c" class="i method">Populate</a>(<span class="r0 r">metadata</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Populates the specified metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">metadata</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The metadata.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f524df069b4e025c" href="../../../R/f524df069b4e025c.html" target="n" data-glyph="76,1" class="i method">Populate</a>(<a href="TransferFolderMetadata.cs.html#e4a782a6b9f2d42c" class="t t">TransferFolderMetadata</a> <span id="r1 rd" class="r1 r">metadata</span>)
        {
            <a href="#bff5545549325dae" class="k">this</a>.<a href="#b29dcd7b29759172" class="i property">TotalFileLength</a> = <span class="r1 r">metadata</span>.<a href="TransferFolderMetadata.cs.html#eddd4b4292178025" class="i property">TotalFileBytes</a>;
            <a href="#bff5545549325dae" class="k">this</a>.<a href="#281fe341e1c1dc52" class="i property">TotalFileCount</a> = <span class="r1 r">metadata</span>.<a href="TransferFolderMetadata.cs.html#cd91bae708e4eea3" class="i property">FileCount</a>;
            <a href="#1f960d9d5369be35" class="i field">_fileProgress</a> = <b>new</b> <a href="@0@mscorlib/A.html#b65c1a07c4e5b13a" class="t constructor">List</a>&lt;<a href="TransferProgress.cs.html#826dd519f4b122e1" class="t t">TransferProgress</a>&gt;(<a href="#bff5545549325dae" class="k">this</a>.<a href="#281fe341e1c1dc52" class="i property">TotalFileCount</a>);
            <a href="#35c4a5c2592baf81" class="i field">_progressBacklog</a> = <b>new</b> <a href="@0@mscorlib/A.html#a773570b1b021cff" class="t constructor">ConcurrentQueue</a>&lt;<a href="TransferProgress.cs.html#826dd519f4b122e1" class="t t">TransferProgress</a>&gt;();
 
            <b>foreach</b> (<a href="TransferMetadata.cs.html#3c08d873a58fc637" class="k">var</a> <span id="r2 rd" class="r2 r">fileMetadata</span> <b>in</b> <span class="r1 r">metadata</span>.<a href="TransferFolderMetadata.cs.html#9a427422bf099d1c" class="i property">Files</a>)
            {
                <a href="TransferProgress.cs.html#826dd519f4b122e1" class="k">var</a> <span id="r3 rd" class="r3 r">toAdd</span> = <b>new</b> <a href="TransferProgress.cs.html#139b7421a458a679" class="t constructor">TransferProgress</a>(<span class="r2 r">fileMetadata</span>);
                <b>if</b> (<span class="r2 r">fileMetadata</span>.<a href="TransferMetadata.cs.html#a9be239c5fd0d8d5" class="i property">Status</a> == <a href="SegmentTransferStatus.cs.html#f871cd80cd9814cc" class="t t">SegmentTransferStatus</a>.<a href="SegmentTransferStatus.cs.html#2c215e272001fbf1" class="i field">Complete</a>)
                {
                    <a href="#bff5545549325dae" class="k">this</a>.<a href="#0217ff46ee9eb5e6" class="i property">TransferredByteCount</a> += <span class="r2 r">fileMetadata</span>.<a href="TransferMetadata.cs.html#c2f4b2ebd90b6cb3" class="i property">FileLength</a>;
                    <a href="#bff5545549325dae" class="k">this</a>.<a href="#2063e3ec01b69798" class="i property">TransferredFileCount</a>++;
                    <span class="r3 r">toAdd</span>.<a href="TransferProgress.cs.html#046dfb2b07447b2f" class="i property">TransferredByteCount</a> = <span class="r3 r">toAdd</span>.<a href="TransferProgress.cs.html#404d09eed93fe47f" class="i property">TotalFileLength</a>;
                    <b>foreach</b>(<a href="SegmentTransferProgress.cs.html#47a2d1611194ef16" class="k">var</a> <span id="r4 rd" class="r4 r">segment</span> <b>in</b> <span class="r3 r">toAdd</span>.<a href="TransferProgress.cs.html#5cf8cf9659e8e26f" class="i field">_segmentProgress</a>)
                    {
                        <span class="r4 r">segment</span>.<a href="SegmentTransferProgress.cs.html#e4367bbb6193828a" class="i property">TransferredByteCount</a> = <span class="r4 r">segment</span>.<a href="SegmentTransferProgress.cs.html#0cd2a0922031d248" class="i property">Length</a>;
                    }
                }
 
                <a href="#1f960d9d5369be35" class="i field">_fileProgress</a>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r3 r">toAdd</span>);
            }
        }
 
        <b>internal</b> <a href="@0@mscorlib/A.html#3980e012bae82e96" class="t t">Thread</a> <a id="2698a108fc4ae50e" href="../../../R/2698a108fc4ae50e.html" target="n" data-glyph="74,1" class="i method">GetProgressTrackingThread</a>(<a href="@0@mscorlib/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r5 rd" class="r5 r">token</span>)
        {
            <b>return</b> <b>new</b> <a href="@0@mscorlib/A.html#76f340c84df6da8d" class="t constructor">Thread</a>(() =&gt;
            {
                <b>try</b>
                {
                    <a href="#bff5545549325dae" class="k">this</a>.<a href="#047b21b3baa49160" class="i method">SetSegmentProgress</a>(<span class="r5 r">token</span>);
                }
                <b>catch</b> (<a href="@0@mscorlib/A.html#a0a8b79c277cf327" class="t t">OperationCanceledException</a>)
                {
                    <span class="c">// do nothing, since we have already cancelled.</span>
                }
            });
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value indicating the total length of the file to transfer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The total length of the file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public long</b> <a id="b29dcd7b29759172" href="../../../R/b29dcd7b29759172.html" target="n" data-glyph="102,1" class="i property">TotalFileLength</a> { <b>get</b>; <b>private set</b>; }
 
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the total file count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The total file count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public int</b> <a id="281fe341e1c1dc52" href="../../../R/281fe341e1c1dc52.html" target="n" data-glyph="102,1" class="i property">TotalFileCount</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value indicating the number of bytes that have been transferred so far.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The transferred byte count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public long</b> <a id="0217ff46ee9eb5e6" href="../../../R/0217ff46ee9eb5e6.html" target="n" data-glyph="102,1" class="i property">TransferredByteCount</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the transferred file count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The transferred file count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public long</b> <a id="2063e3ec01b69798" href="../../../R/2063e3ec01b69798.html" target="n" data-glyph="102,1" class="i property">TransferredFileCount</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the count of files that failed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The failed file count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public long</b> <a id="da0b734b91dd12b7" href="../../../R/da0b734b91dd12b7.html" target="n" data-glyph="102,1" class="i property">FailedFileCount</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the transfer progress for a particular file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">segmentNumber</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The sequence number of the file to retrieve information for</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="TransferProgress.cs.html#826dd519f4b122e1" class="t t">TransferProgress</a> <a id="9964a4b82d15ec99" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetSegmentProgress</a>(<b>int</b> <span id="r6 rd" class="r6 r">segmentNumber</span>)
        {
            <b>return</b> <a href="#1f960d9d5369be35" class="i field">_fileProgress</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r6 r">segmentNumber</span>];
        }
 
        <b>internal void</b> <a id="3c0f2d4d3e8dc007" href="../../../R/3c0f2d4d3e8dc007.html" target="n" data-glyph="74,1" class="i method">SetSegmentProgress</a>(<a href="TransferProgress.cs.html#826dd519f4b122e1" class="t t">TransferProgress</a> <span id="r7 rd" class="r7 r">segmentProgress</span>)
        {
            <a href="#35c4a5c2592baf81" class="i field">_progressBacklog</a>.<a href="@0@mscorlib/A.html#62bea3a8141ed2a9" class="i method">Enqueue</a>(<span class="r7 r">segmentProgress</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Updates the progress to indicate that a file failed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b9ba462005b44874" href="../../../R/b9ba462005b44874.html" target="n" data-glyph="74,1" class="i method">OnFileTransferThreadAborted</a>(<a href="TransferMetadata.cs.html#3c08d873a58fc637" class="t t">TransferMetadata</a> <span id="r8 rd" class="r8 r">failedFile</span>)
        {
            ++<a href="#bff5545549325dae" class="k">this</a>.<a href="#da0b734b91dd12b7" class="i property">FailedFileCount</a>;
            
            <a href="TransferProgress.cs.html#826dd519f4b122e1" class="k">var</a> <span id="r9 rd" class="r9 r">previousProgress</span> = <a href="#1f960d9d5369be35" class="i field">_fileProgress</a>.<a href="@0@System.Core/A.html#e73922753675387a" class="i method">Where</a>(<span id="r10 rd" class="r10 r">p</span> =&gt; <span class="r10 r">p</span>.<a href="TransferProgress.cs.html#be27b8e22e026489" class="i property">TransferId</a>.<a href="@0@mscorlib/A.html#b98069ccbe2d3960" class="i method">Equals</a>(<span class="r8 r">failedFile</span>.<a href="TransferMetadata.cs.html#94ead8daa60a5847" class="i property">TransferId</a>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>)).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
            <b>foreach</b> (<a href="SegmentTransferProgress.cs.html#47a2d1611194ef16" class="k">var</a> <span id="r11 rd" class="r11 r">segment</span> <b>in</b> <span class="r9 r">previousProgress</span>.<a href="TransferProgress.cs.html#5cf8cf9659e8e26f" class="i field">_segmentProgress</a>)
            {
                <span class="c">// only fail out segments that haven&#39;t been completed.</span>
                <b>if</b> (<span class="r11 r">segment</span>.<a href="SegmentTransferProgress.cs.html#0cd2a0922031d248" class="i property">Length</a> != <span class="r11 r">segment</span>.<a href="SegmentTransferProgress.cs.html#e4367bbb6193828a" class="i property">TransferredByteCount</a>)
                {
                    <span class="r11 r">segment</span>.<a href="SegmentTransferProgress.cs.html#5a3cd865feb41971" class="i property">IsFailed</a> = <b>true</b>;
                }
 
                <span class="r9 r">previousProgress</span>.<a href="TransferProgress.cs.html#46365dcd844e992a" class="i method">SetSegmentProgress</a>(<span class="r11 r">segment</span>);
            }
            
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Updates the progress while there is still progress to update.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="047b21b3baa49160" href="../../../R/047b21b3baa49160.html" target="n" data-glyph="76,1" class="i method">SetSegmentProgress</a>(<a href="@0@mscorlib/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r12 rd" class="r12 r">token</span>)
        {
            <a href="TransferProgress.cs.html#826dd519f4b122e1" class="t t">TransferProgress</a> <span id="r13 rd" class="r13 r">segmentProgress</span>;
            <b>while</b> (<a href="#bff5545549325dae" class="k">this</a>.<a href="#2063e3ec01b69798" class="i property">TransferredFileCount</a> + <a href="#bff5545549325dae" class="k">this</a>.<a href="#da0b734b91dd12b7" class="i property">FailedFileCount</a> &lt; <a href="#bff5545549325dae" class="k">this</a>.<a href="#281fe341e1c1dc52" class="i property">TotalFileCount</a>)
            {
                <span class="r12 r">token</span>.<a href="@0@mscorlib/A.html#d2864d73804288fc" class="i method">ThrowIfCancellationRequested</a>();
                <b>if</b>(<a href="#35c4a5c2592baf81" class="i field">_progressBacklog</a>.<a href="@0@mscorlib/A.html#88b9f17c9182267f" class="i method">TryDequeue</a>(<b>out</b> <span class="r13 r">segmentProgress</span>))
                {
                    <span class="r12 r">token</span>.<a href="@0@mscorlib/A.html#d2864d73804288fc" class="i method">ThrowIfCancellationRequested</a>();
                    <a href="TransferProgress.cs.html#826dd519f4b122e1" class="k">var</a> <span id="r14 rd" class="r14 r">previousProgress</span> = <a href="#1f960d9d5369be35" class="i field">_fileProgress</a>.<a href="@0@System.Core/A.html#e73922753675387a" class="i method">Where</a>(<span id="r15 rd" class="r15 r">p</span> =&gt; <span class="r15 r">p</span>.<a href="TransferProgress.cs.html#be27b8e22e026489" class="i property">TransferId</a>.<a href="@0@mscorlib/A.html#b98069ccbe2d3960" class="i method">Equals</a>(<span class="r13 r">segmentProgress</span>.<a href="TransferProgress.cs.html#be27b8e22e026489" class="i property">TransferId</a>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>)).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
                    <b>long</b> <span id="r16 rd" class="r16 r">deltaLength</span> = <span class="r13 r">segmentProgress</span>.<a href="TransferProgress.cs.html#046dfb2b07447b2f" class="i property">TransferredByteCount</a> - <span class="r14 r">previousProgress</span>.<a href="TransferProgress.cs.html#046dfb2b07447b2f" class="i property">TransferredByteCount</a>;
                    <a href="#bff5545549325dae" class="k">this</a>.<a href="#0217ff46ee9eb5e6" class="i property">TransferredByteCount</a> += <span class="r16 r">deltaLength</span>;
 
                    <span class="c">// check to see if this transfer is complete and that we haven&#39;t already marked it as complete</span>
                    <b>if</b> (<span class="r13 r">segmentProgress</span>.<a href="TransferProgress.cs.html#046dfb2b07447b2f" class="i property">TransferredByteCount</a> == <span class="r13 r">segmentProgress</span>.<a href="TransferProgress.cs.html#404d09eed93fe47f" class="i property">TotalFileLength</a> &amp;&amp; <span class="r16 r">deltaLength</span> &gt; 0)
                    {
                        ++<a href="#bff5545549325dae" class="k">this</a>.<a href="#2063e3ec01b69798" class="i property">TransferredFileCount</a>;
                    }
 
                    <span class="c">// Iterate through all the segments inside this transfer we are setting to get them up-to-date</span>
                    <b>foreach</b> (<a href="SegmentTransferProgress.cs.html#47a2d1611194ef16" class="k">var</a> <span id="r17 rd" class="r17 r">segment</span> <b>in</b> <span class="r13 r">segmentProgress</span>.<a href="TransferProgress.cs.html#5cf8cf9659e8e26f" class="i field">_segmentProgress</a>)
                    {
                        <span class="r12 r">token</span>.<a href="@0@mscorlib/A.html#d2864d73804288fc" class="i method">ThrowIfCancellationRequested</a>();
                        <span class="r14 r">previousProgress</span>.<a href="TransferProgress.cs.html#46365dcd844e992a" class="i method">SetSegmentProgress</a>(<span class="r17 r">segment</span>);
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    }
}
</pre></td></tr></table></div></body></html>
