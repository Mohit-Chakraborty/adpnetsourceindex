<!DOCTYPE html>
<html><head><title>ECParameters.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(536);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.KeyVault.WebKey/ECParameters.cs" target="_top">ECParameters.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master//sdk/keyvault/Microsoft.Azure.KeyVault.WebKey/src/ECParameters.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.KeyVault.WebKey" target="_top">Microsoft.Azure.KeyVault.WebKey.csproj</a> (Microsoft.Azure.KeyVault.WebKey)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for</span>
<span class="c">// license information.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Security</span>.<span class="i n">Cryptography</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">KeyVault</span>.<span class="i n">WebKey</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> EC parameters class.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="35603abbad105a6f" href="R/35603abbad105a6f.html" target="n" data-glyph="0,0" class="t t"><span id="786e7d996b8a2320">ECParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of this curve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="8f8286c0e07b945f" href="R/8f8286c0e07b945f.html" target="n" data-glyph="102,1" class="i property">Curve</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> X coordinate for the Elliptic Curve point.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public byte</b>[] <a id="83f99d3895629ae5" href="R/83f99d3895629ae5.html" target="n" data-glyph="102,1" class="i property">X</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Y coordinate for the Elliptic Curve point.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public byte</b>[] <a id="0ab81a4d6208a3cc" href="R/0ab81a4d6208a3cc.html" target="n" data-glyph="102,1" class="i property">Y</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ECC private key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public byte</b>[] <a id="8c8f223bb8c260ce" href="R/8c8f223bb8c260ce.html" target="n" data-glyph="102,1" class="i property">D</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="@0@System.Core/A.html#32ff7a0bb2100c56" class="t t">ECDsaCng</a> <a id="6e60d595526b62e5" href="R/6e60d595526b62e5.html" target="n" data-glyph="74,1" class="i method">ToEcdsa</a>( <b>bool</b> <span id="r0 rd" class="r0 r">includePrivateParameters</span> )
        {
            <b>switch</b> ( <a href="#8f8286c0e07b945f" class="i property">Curve</a> )
            {
                <b>case</b> <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#6a1a931e140d8adf" class="i field">P256</a>:
                    <b>return</b> <a href="#b1372c55b4d8d8e5" class="i method">ToNistCurveEcdsa</a>( <span class="r0 r">includePrivateParameters</span> ? <a href="#08fb2d61d3796f81" class="i field">BCRYPT_ECDSA_PRIVATE_P256_MAGIC</a> : <a href="#c4f06584933aa41b" class="i field">BCRYPT_ECDSA_PUBLIC_P256_MAGIC</a>, 32, <span class="r0 r">includePrivateParameters</span> );
 
                <b>case</b> <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#8c9b687b5dca9101" class="i field">P384</a>:
                    <b>return</b> <a href="#b1372c55b4d8d8e5" class="i method">ToNistCurveEcdsa</a>( <span class="r0 r">includePrivateParameters</span> ? <a href="#f975805720ffeb6d" class="i field">BCRYPT_ECDSA_PRIVATE_P384_MAGIC</a> : <a href="#3e7fe98cc0228d11" class="i field">BCRYPT_ECDSA_PUBLIC_P384_MAGIC</a>, 48, <span class="r0 r">includePrivateParameters</span> );
 
                <b>case</b> <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#f3954843cd633684" class="i field">P521</a>:
                    <b>return</b> <a href="#b1372c55b4d8d8e5" class="i method">ToNistCurveEcdsa</a>( <span class="r0 r">includePrivateParameters</span> ? <a href="#ed5dc0081ee9ea17" class="i field">BCRYPT_ECDSA_PRIVATE_P521_MAGIC</a> : <a href="#647f5377c713c2b2" class="i field">BCRYPT_ECDSA_PUBLIC_P521_MAGIC</a>, 66, <span class="r0 r">includePrivateParameters</span> );
 
                <b>case</b> <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#a386af2b91da273d" class="i field">P256K</a>:
                    <b>return</b> <a href="#1087cdbf248b8302" class="i method">ToGenericCurveEcdsa</a>( <span class="r0 r">includePrivateParameters</span> ? <a href="#0b051c91394b3172" class="i field">BCRYPT_ECDSA_PRIVATE_GENERIC_MAGIC</a> : <a href="#a3a7345431bb7f72" class="i field">BCRYPT_ECDSA_PUBLIC_GENERIC_MAGIC</a>, <a href="#e0fbafee98f9125b" class="i property">Secp256k1</a>, <span class="r0 r">includePrivateParameters</span> );
 
                <b>default</b>:
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r1 rd" class="r1 r">curveDesc</span> = <a href="#8f8286c0e07b945f" class="i property">Curve</a> == <b>null</b> ? <span class="s">&quot;null&quot;</span> : <span class="s">$&quot;</span>\&quot;{<a href="#8f8286c0e07b945f" class="i property">Curve</a>}\&quot;<span class="s">&quot;</span>;
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">Invalid curve: </span>{<span class="r1 r">curveDesc</span>}<span class="s">&quot;</span> );
            }
        }
 
        <b>private</b> <a href="@0@System.Core/A.html#32ff7a0bb2100c56" class="t t">ECDsaCng</a> <a id="b1372c55b4d8d8e5" href="R/b1372c55b4d8d8e5.html" target="n" data-glyph="76,1" class="i method">ToNistCurveEcdsa</a>( <b>int</b> <span id="r2 rd" class="r2 r">dwMagic</span>, <b>int</b> <span id="r3 rd" class="r3 r">sizeInBytes</span>, <b>bool</b> <span id="r4 rd" class="r4 r">includePrivateParameters</span> )
        {
            <b>const int</b> <span id="r5 rd" class="r5 r">sizeOfdwMagic</span> = <b>sizeof</b>( <b>uint</b> );
            <b>const int</b> <span id="r6 rd" class="r6 r">sizeOfdwSize</span> = <b>sizeof</b>( <b>uint</b> );
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r7 rd" class="r7 r">sizeOfX</span> = <span class="r3 r">sizeInBytes</span>;
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r8 rd" class="r8 r">sizeOfY</span> = <span class="r3 r">sizeInBytes</span>;
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r9 rd" class="r9 r">sizeOfD</span> = <span class="r4 r">includePrivateParameters</span> ? <span class="r3 r">sizeInBytes</span> : 0;
 
            <b>var</b> <span id="r10 rd" class="r10 r">keyBlob</span> = <b>new</b> <b>byte</b>[<span class="r5 r">sizeOfdwMagic</span> + <span class="r6 r">sizeOfdwSize</span> + <span class="r7 r">sizeOfX</span> + <span class="r8 r">sizeOfY</span> + <span class="r9 r">sizeOfD</span>];
 
            <b>using</b> ( <a href="@0@mscorlib/A.html#cf806b417abe1a35" class="k">var</a> <span id="r11 rd" class="r11 r">writer</span> = <b>new</b> <a href="@0@mscorlib/A.html#93163b0edbac85a5" class="t constructor">BinaryWriter</a>( <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>( <span class="r10 r">keyBlob</span> ) ) )
            {
                <span class="r11 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <span class="r2 r">dwMagic</span> );
                <span class="r11 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <span class="r3 r">sizeInBytes</span> );
                <a href="#ec6b1cfe76c9cfd5" class="i method">AlignAndWrite</a>( <span class="r11 r">writer</span>, <a href="#83f99d3895629ae5" class="i property">X</a>, <span class="r3 r">sizeInBytes</span>, <b>nameof</b>( <a href="#83f99d3895629ae5" class="i property">X</a> ) );
                <a href="#ec6b1cfe76c9cfd5" class="i method">AlignAndWrite</a>( <span class="r11 r">writer</span>, <a href="#0ab81a4d6208a3cc" class="i property">Y</a>, <span class="r3 r">sizeInBytes</span>, <b>nameof</b>( <a href="#0ab81a4d6208a3cc" class="i property">Y</a> ) );
                <b>if</b> ( <span class="r4 r">includePrivateParameters</span> )
                    <a href="#ec6b1cfe76c9cfd5" class="i method">AlignAndWrite</a>( <span class="r11 r">writer</span>, <a href="#8c8f223bb8c260ce" class="i property">D</a>, <span class="r3 r">sizeInBytes</span>, <b>nameof</b>( <a href="#8c8f223bb8c260ce" class="i property">D</a> ) );
            }
 
            <a href="@0@System.Core/A.html#d22415edef5b8a28" class="k">var</a> <span id="r12 rd" class="r12 r">key</span> = <a href="@0@System.Core/A.html#d22415edef5b8a28" class="t t">CngKey</a>.<a href="@0@System.Core/A.html#9a999db22eb5332e" class="i method">Import</a>( <span class="r10 r">keyBlob</span>, <span class="r4 r">includePrivateParameters</span> ? <a href="@0@System.Core/A.html#d5fe5c517d3c590f" class="t t">CngKeyBlobFormat</a>.<a href="@0@System.Core/A.html#8930480a09293f41" class="i property">EccPrivateBlob</a> : <a href="@0@System.Core/A.html#d5fe5c517d3c590f" class="t t">CngKeyBlobFormat</a>.<a href="@0@System.Core/A.html#3dba1487cc6061d8" class="i property">EccPublicBlob</a> );
            <b>return</b> <b>new</b> <a href="@0@System.Core/A.html#1ee60f249b2afc62" class="t constructor">ECDsaCng</a>( <span class="r12 r">key</span> );
        }
 
        <b>private</b> <a href="@0@System.Core/A.html#32ff7a0bb2100c56" class="t t">ECDsaCng</a> <a id="1087cdbf248b8302" href="R/1087cdbf248b8302.html" target="n" data-glyph="76,1" class="i method">ToGenericCurveEcdsa</a>( <b>int</b> <span id="r13 rd" class="r13 r">dwMagic</span>, <a href="#1f0f2857c46fee4c" class="t t">BCRYPT_ECC_PARAMETER_HEADER</a> <span id="r14 rd" class="r14 r">curveParameters</span>, <b>bool</b> <span id="r15 rd" class="r15 r">includePrivateParameters</span> )
        {
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r16 rd" class="r16 r">sizeInBytes</span> = <span class="r14 r">curveParameters</span>.<a href="#9eae6a3b096f5860" class="i property">KeySizeInBytes</a>;
            <b>var</b> <span id="r17 rd" class="r17 r">keyBlob</span> = <b>new</b> <b>byte</b>[<span class="r14 r">curveParameters</span>.<a href="#9df4d76ff428836e" class="i property">KeyBlobSize</a>];
 
            <b>using</b> ( <a href="@0@mscorlib/A.html#cf806b417abe1a35" class="k">var</a> <span id="r18 rd" class="r18 r">writer</span> = <b>new</b> <a href="@0@mscorlib/A.html#93163b0edbac85a5" class="t constructor">BinaryWriter</a>( <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>( <span class="r17 r">keyBlob</span> ) ) )
            {
                <span class="r18 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <span class="r13 r">dwMagic</span> );
                <span class="r14 r">curveParameters</span>.<a href="#c5c283ef346e8bfc" class="i method">WriteTo</a>( <span class="r18 r">writer</span> );
 
                <a href="#ec6b1cfe76c9cfd5" class="i method">AlignAndWrite</a>( <span class="r18 r">writer</span>, <a href="#83f99d3895629ae5" class="i property">X</a>, <span class="r16 r">sizeInBytes</span>, <b>nameof</b>( <a href="#83f99d3895629ae5" class="i property">X</a> ) );
                <a href="#ec6b1cfe76c9cfd5" class="i method">AlignAndWrite</a>( <span class="r18 r">writer</span>, <a href="#0ab81a4d6208a3cc" class="i property">Y</a>, <span class="r16 r">sizeInBytes</span>, <b>nameof</b>( <a href="#0ab81a4d6208a3cc" class="i property">Y</a> ) );
                <b>if</b> ( <span class="r15 r">includePrivateParameters</span> )
                    <a href="#ec6b1cfe76c9cfd5" class="i method">AlignAndWrite</a>( <span class="r18 r">writer</span>, <a href="#8c8f223bb8c260ce" class="i property">D</a>, <span class="r16 r">sizeInBytes</span>, <b>nameof</b>( <a href="#8c8f223bb8c260ce" class="i property">D</a> ) );
            }
 
            <a href="@0@System.Core/A.html#d22415edef5b8a28" class="k">var</a> <span id="r19 rd" class="r19 r">key</span> = <a href="@0@System.Core/A.html#d22415edef5b8a28" class="t t">CngKey</a>.<a href="@0@System.Core/A.html#9a999db22eb5332e" class="i method">Import</a>( <span class="r17 r">keyBlob</span>, <span class="r15 r">includePrivateParameters</span> ? <a href="#85a05d5b962bc039" class="i field">CngKeyBlobFormat_EccFullPrivateBlob</a> : <a href="#d11a641d153f5d4f" class="i field">CngKeyBlobFormat_EccFullPublicBlob</a> );
            <b>return</b> <b>new</b> <a href="@0@System.Core/A.html#1ee60f249b2afc62" class="t constructor">ECDsaCng</a>( <span class="r19 r">key</span> );
        }
 
        <b>private static void</b> <a id="ec6b1cfe76c9cfd5" href="R/ec6b1cfe76c9cfd5.html" target="n" data-glyph="76,1" class="i method">AlignAndWrite</a>( <a href="@0@mscorlib/A.html#cf806b417abe1a35" class="t t">BinaryWriter</a> <span id="r20 rd" class="r20 r">writer</span>, <b>byte</b>[] <span id="r21 rd" class="r21 r">bytes</span>, <b>int</b> <span id="r22 rd" class="r22 r">size</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r23 rd" class="r23 r">paramName</span> )
        {
            <b>if</b> ( <span class="r21 r">bytes</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Value of </span>{<span class="r23 r">paramName</span>}<span class="s"> is null.</span><span class="s">&quot;</span> );
 
            <b>if</b> ( <span class="r21 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt;= <span class="r22 r">size</span> )
            {
                <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r24 rd" class="r24 r">i</span> = 0; <span class="r24 r">i</span> &lt; <span class="r21 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r22 r">size</span>; ++<span class="r24 r">i</span> )
                    <b>if</b> ( <span class="r21 r">bytes</span>[<span class="r24 r">i</span>] != 0 )
                        <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Value of </span>{<span class="r23 r">paramName</span>}<span class="s"> is bigger than allowed for this curve.</span><span class="s">&quot;</span> );
 
                <span class="r20 r">writer</span>.<a href="@0@mscorlib/A.html#fae34c4f5667c7a2" class="i method">Write</a>( <span class="r21 r">bytes</span>, <span class="r21 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r22 r">size</span>, <span class="r22 r">size</span> );
                <b>return</b>;
            }
 
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r25 rd" class="r25 r">i</span> = <span class="r21 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r25 r">i</span> &lt; <span class="r22 r">size</span>; ++<span class="r25 r">i</span> )
                <span class="r20 r">writer</span>.<a href="@0@mscorlib/A.html#430d3c5573a2b429" class="i method">Write</a>( (<b>byte</b>) 0 );
 
            <span class="r20 r">writer</span>.<a href="@0@mscorlib/A.html#3b784e1877648aef" class="i method">Write</a>( <span class="r21 r">bytes</span> );
        }
 
        <b>internal static</b> <a href="#35603abbad105a6f" class="t t">ECParameters</a> <a id="f6dec6c3986c4b1c" href="R/f6dec6c3986c4b1c.html" target="n" data-glyph="74,1" class="i method">FromEcdsa</a>( <a href="@0@System.Core/A.html#32ff7a0bb2100c56" class="t t">ECDsaCng</a> <span id="r26 rd" class="r26 r">ecdsa</span>, <b>bool</b> <span id="r27 rd" class="r27 r">includePrivateParameters</span> )
        {
            <b>if</b> ( <span class="r26 r">ecdsa</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r26 r">ecdsa</span> ) );
 
            <a href="@0@System.Core/A.html#d5fe5c517d3c590f" class="k">var</a> <span id="r28 rd" class="r28 r">keyBlobFormat</span> = <span class="r27 r">includePrivateParameters</span> ? <a href="@0@System.Core/A.html#d5fe5c517d3c590f" class="t t">CngKeyBlobFormat</a>.<a href="@0@System.Core/A.html#8930480a09293f41" class="i property">EccPrivateBlob</a> : <a href="@0@System.Core/A.html#d5fe5c517d3c590f" class="t t">CngKeyBlobFormat</a>.<a href="@0@System.Core/A.html#3dba1487cc6061d8" class="i property">EccPublicBlob</a>;
            <b>var</b> <span id="r29 rd" class="r29 r">keyBlob</span> = <span class="r26 r">ecdsa</span>.<a href="@0@System.Core/A.html#bcfc1ba2cdcbf8d2" class="i property">Key</a>.<a href="@0@System.Core/A.html#ca4839739cc6ca23" class="i method">Export</a>( <span class="r28 r">keyBlobFormat</span> );
 
            <span class="c">// If curve is generic, we need to export again to get the full blob.</span>
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r30 rd" class="r30 r">dwMagic</span> = <a href="@0@mscorlib/A.html#8640d8adfffb155b" class="t t">BitConverter</a>.<a href="@0@mscorlib/A.html#1618fc20415532f2" class="i method">ToInt32</a>( <span class="r29 r">keyBlob</span>, 0 );
            <b>switch</b> ( <span class="r30 r">dwMagic</span> )
            {
                <b>case</b> <a href="#a3a7345431bb7f72" class="i field">BCRYPT_ECDSA_PUBLIC_GENERIC_MAGIC</a>:
                    <span class="r29 r">keyBlob</span> = <span class="r26 r">ecdsa</span>.<a href="@0@System.Core/A.html#bcfc1ba2cdcbf8d2" class="i property">Key</a>.<a href="@0@System.Core/A.html#ca4839739cc6ca23" class="i method">Export</a>( <a href="#d11a641d153f5d4f" class="i field">CngKeyBlobFormat_EccFullPublicBlob</a> );
                    <b>break</b>;
                <b>case</b> <a href="#0b051c91394b3172" class="i field">BCRYPT_ECDSA_PRIVATE_GENERIC_MAGIC</a>:
                    <span class="r29 r">keyBlob</span> = <span class="r26 r">ecdsa</span>.<a href="@0@System.Core/A.html#bcfc1ba2cdcbf8d2" class="i property">Key</a>.<a href="@0@System.Core/A.html#ca4839739cc6ca23" class="i method">Export</a>( <a href="#85a05d5b962bc039" class="i field">CngKeyBlobFormat_EccFullPrivateBlob</a> );
                    <b>break</b>;
            }
 
            <a href="#35603abbad105a6f" class="k">var</a> <span id="r31 rd" class="r31 r">result</span> = <b>new</b> <a href="#35603abbad105a6f" class="t constructor">ECParameters</a>();
            <b>using</b> ( <a href="@0@mscorlib/A.html#4f6cad84482876ff" class="k">var</a> <span id="r32 rd" class="r32 r">reader</span> = <b>new</b> <a href="@0@mscorlib/A.html#6fcf6f88785c9632" class="t constructor">BinaryReader</a>( <b>new</b> <a href="@0@mscorlib/A.html#f92fa270fda9a82b" class="t constructor">MemoryStream</a>( <span class="r29 r">keyBlob</span> ) ) )
            {
                <span class="r30 r">dwMagic</span> = <span class="r32 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
                <b>switch</b> ( <span class="r30 r">dwMagic</span> )
                {
                    <b>case</b> <a href="#c4f06584933aa41b" class="i field">BCRYPT_ECDSA_PUBLIC_P256_MAGIC</a>:
                        <a href="#738da679ebbe572a" class="i method">ThrowIfPrivateParametersNeeded</a>( <span class="r27 r">includePrivateParameters</span>, <a href="#08fb2d61d3796f81" class="i field">BCRYPT_ECDSA_PRIVATE_P256_MAGIC</a>, <span class="r30 r">dwMagic</span> );
                        <a href="#d7e1f522a1a59873" class="i method">ReadNistBlob</a>( <span class="r32 r">reader</span>, 32, <span class="r31 r">result</span>, <b>false</b> );
                        <span class="r31 r">result</span>.<a href="#8f8286c0e07b945f" class="i property">Curve</a> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#6a1a931e140d8adf" class="i field">P256</a>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#08fb2d61d3796f81" class="i field">BCRYPT_ECDSA_PRIVATE_P256_MAGIC</a>:
                        <a href="#d7e1f522a1a59873" class="i method">ReadNistBlob</a>( <span class="r32 r">reader</span>, 32, <span class="r31 r">result</span>, <b>true</b> );
                        <span class="r31 r">result</span>.<a href="#8f8286c0e07b945f" class="i property">Curve</a> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#6a1a931e140d8adf" class="i field">P256</a>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#3e7fe98cc0228d11" class="i field">BCRYPT_ECDSA_PUBLIC_P384_MAGIC</a>:
                        <a href="#738da679ebbe572a" class="i method">ThrowIfPrivateParametersNeeded</a>( <span class="r27 r">includePrivateParameters</span>, <a href="#f975805720ffeb6d" class="i field">BCRYPT_ECDSA_PRIVATE_P384_MAGIC</a>, <span class="r30 r">dwMagic</span> );
                        <a href="#d7e1f522a1a59873" class="i method">ReadNistBlob</a>( <span class="r32 r">reader</span>, 48, <span class="r31 r">result</span>, <b>false</b> );
                        <span class="r31 r">result</span>.<a href="#8f8286c0e07b945f" class="i property">Curve</a> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#8c9b687b5dca9101" class="i field">P384</a>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#f975805720ffeb6d" class="i field">BCRYPT_ECDSA_PRIVATE_P384_MAGIC</a>:
                        <a href="#d7e1f522a1a59873" class="i method">ReadNistBlob</a>( <span class="r32 r">reader</span>, 48, <span class="r31 r">result</span>, <b>true</b> );
                        <span class="r31 r">result</span>.<a href="#8f8286c0e07b945f" class="i property">Curve</a> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#8c9b687b5dca9101" class="i field">P384</a>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#647f5377c713c2b2" class="i field">BCRYPT_ECDSA_PUBLIC_P521_MAGIC</a>:
                        <a href="#738da679ebbe572a" class="i method">ThrowIfPrivateParametersNeeded</a>( <span class="r27 r">includePrivateParameters</span>, <a href="#ed5dc0081ee9ea17" class="i field">BCRYPT_ECDSA_PRIVATE_P521_MAGIC</a>, <span class="r30 r">dwMagic</span> );
                        <a href="#d7e1f522a1a59873" class="i method">ReadNistBlob</a>( <span class="r32 r">reader</span>, 66, <span class="r31 r">result</span>, <b>false</b> );
                        <span class="r31 r">result</span>.<a href="#8f8286c0e07b945f" class="i property">Curve</a> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#f3954843cd633684" class="i field">P521</a>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#ed5dc0081ee9ea17" class="i field">BCRYPT_ECDSA_PRIVATE_P521_MAGIC</a>:
                        <a href="#d7e1f522a1a59873" class="i method">ReadNistBlob</a>( <span class="r32 r">reader</span>, 66, <span class="r31 r">result</span>, <b>true</b> );
                        <span class="r31 r">result</span>.<a href="#8f8286c0e07b945f" class="i property">Curve</a> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#f3954843cd633684" class="i field">P521</a>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#a3a7345431bb7f72" class="i field">BCRYPT_ECDSA_PUBLIC_GENERIC_MAGIC</a>:
                        <a href="#738da679ebbe572a" class="i method">ThrowIfPrivateParametersNeeded</a>( <span class="r27 r">includePrivateParameters</span>, <a href="#0b051c91394b3172" class="i field">BCRYPT_ECDSA_PRIVATE_GENERIC_MAGIC</a>, <span class="r30 r">dwMagic</span> );
                        <a href="#51f7ca6a2c05546b" class="i method">ReadGenericBlob</a>( <span class="r32 r">reader</span>, 32, <span class="r31 r">result</span>, <b>false</b> );
                        <b>break</b>;
 
                    <b>case</b> <a href="#0b051c91394b3172" class="i field">BCRYPT_ECDSA_PRIVATE_GENERIC_MAGIC</a>:
                        <a href="#51f7ca6a2c05546b" class="i method">ReadGenericBlob</a>( <span class="r32 r">reader</span>, 32, <span class="r31 r">result</span>, <b>true</b> );
                        <b>break</b>;
 
                    <b>default</b>:
                        <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3d3c2c03118be4f8" class="t constructor">NotSupportedException</a>( <span class="s">$&quot;</span><span class="s">Unexpected CNG key blob type. Magic number: 0x</span>{<span class="r30 r">dwMagic</span>:<span class="s">X</span>}<span class="s">.</span><span class="s">&quot;</span> );
                }
            }
 
            <b>return</b> <span class="r31 r">result</span>;
        }
 
        <b>private static void</b> <a id="738da679ebbe572a" href="R/738da679ebbe572a.html" target="n" data-glyph="76,1" class="i method">ThrowIfPrivateParametersNeeded</a>( <b>bool</b> <span id="r33 rd" class="r33 r">privateParametersNeeded</span>, <b>int</b> <span id="r34 rd" class="r34 r">expectedMagic</span>, <b>int</b> <span id="r35 rd" class="r35 r">actualMagic</span> )
        {
            <b>if</b> ( <span class="r33 r">privateParametersNeeded</span> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">CNG returned key blob without private parameters. Expected magic: 0x</span>{<span class="r34 r">expectedMagic</span>:<span class="s">X</span>}<span class="s">, Actual magic: 0x</span>{<span class="r35 r">actualMagic</span>:<span class="s">X</span>}<span class="s">&quot;</span> );
        }
 
        <b>private static void</b> <a id="d7e1f522a1a59873" href="R/d7e1f522a1a59873.html" target="n" data-glyph="76,1" class="i method">ReadNistBlob</a>( <a href="@0@mscorlib/A.html#4f6cad84482876ff" class="t t">BinaryReader</a> <span id="r36 rd" class="r36 r">reader</span>, <b>int</b> <span id="r37 rd" class="r37 r">expectedSize</span>, <a href="#35603abbad105a6f" class="t t">ECParameters</a> <span id="r38 rd" class="r38 r">dest</span>, <b>bool</b> <span id="r39 rd" class="r39 r">includePrivateParameters</span> )
        {
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r40 rd" class="r40 r">size</span> = <span class="r36 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
            <span class="r38 r">dest</span>.<a href="#83f99d3895629ae5" class="i property">X</a> = <a href="#3d302ffe36be4892" class="i method">ValidateSize</a>( <span class="r36 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r40 r">size</span> ), <span class="r37 r">expectedSize</span>, <b>nameof</b>( <span class="r38 r">dest</span>.<a href="#83f99d3895629ae5" class="i property">X</a> ) );
            <span class="r38 r">dest</span>.<a href="#0ab81a4d6208a3cc" class="i property">Y</a> = <a href="#3d302ffe36be4892" class="i method">ValidateSize</a>( <span class="r36 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r40 r">size</span> ), <span class="r37 r">expectedSize</span>, <b>nameof</b>( <span class="r38 r">dest</span>.<a href="#0ab81a4d6208a3cc" class="i property">Y</a> ) );
            <b>if</b> ( <span class="r39 r">includePrivateParameters</span> )
                <span class="r38 r">dest</span>.<a href="#8c8f223bb8c260ce" class="i property">D</a> = <a href="#3d302ffe36be4892" class="i method">ValidateSize</a>( <span class="r36 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r40 r">size</span> ), <span class="r37 r">expectedSize</span>, <b>nameof</b>( <span class="r38 r">dest</span>.<a href="#8c8f223bb8c260ce" class="i property">D</a> ) );
        }
 
        <b>private static void</b> <a id="51f7ca6a2c05546b" href="R/51f7ca6a2c05546b.html" target="n" data-glyph="76,1" class="i method">ReadGenericBlob</a>( <a href="@0@mscorlib/A.html#4f6cad84482876ff" class="t t">BinaryReader</a> <span id="r41 rd" class="r41 r">reader</span>, <b>int</b> <span id="r42 rd" class="r42 r">expectedSize</span>, <a href="#35603abbad105a6f" class="t t">ECParameters</a> <span id="r43 rd" class="r43 r">dest</span>, <b>bool</b> <span id="r44 rd" class="r44 r">includePrivateParameters</span> )
        {
            <span class="c">/*  struct BCRYPT_ECCFULLKEY_BLOB
                {
                    ULONG dwMagic;              // BCRYPT_ECDSA_PUBLIC_GENERIC_MAGIC or BCRYPT_ECDSA_PRIVATE_GENERIC_MAGIC
                    BCRYPT_ECC_PARAMETER_HEADER curveParameters;
                    BYTE Qx[cbFieldLength]      // X-coordinate of the public point.
                    BYTE Qy[cbFieldLength]      // Y-coordinate of the public point.
                    BYTE d[cbSubgroupOrder]     // Private key. Zero if only public key is required.
                }
            */</span>
 
            <span class="c">// The magic was read before.</span>
 
            <a href="#1f0f2857c46fee4c" class="k">var</a> <span id="r45 rd" class="r45 r">curve</span> = <b>new</b> <a href="#1f0f2857c46fee4c" class="t constructor">BCRYPT_ECC_PARAMETER_HEADER</a>();
            <span class="r45 r">curve</span>.<a href="#9d55af257864d006" class="i method">ReadFrom</a>( <span class="r41 r">reader</span> );
 
            <b>if</b> ( !<span class="r45 r">curve</span>.<a href="#b90ada8f8e64cdca" class="i method">Equals</a>( <a href="#e0fbafee98f9125b" class="i property">Secp256k1</a> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3d3c2c03118be4f8" class="t constructor">NotSupportedException</a>( <span class="s">$&quot;</span><span class="s">Unsupported curve: </span>{<span class="r45 r">curve</span>}<span class="s">&quot;</span> );
 
            <span class="r43 r">dest</span>.<a href="#8f8286c0e07b945f" class="i property">Curve</a> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#a386af2b91da273d" class="i field">P256K</a>;
 
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r46 rd" class="r46 r">cbFieldLength</span> = <span class="r45 r">curve</span>.<a href="#8dfca146d02b2ad0" class="i field">Prime</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
            <span class="r43 r">dest</span>.<a href="#83f99d3895629ae5" class="i property">X</a> = <a href="#3d302ffe36be4892" class="i method">ValidateSize</a>( <span class="r41 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r46 r">cbFieldLength</span> ), <span class="r42 r">expectedSize</span>, <b>nameof</b>( <span class="r43 r">dest</span>.<a href="#83f99d3895629ae5" class="i property">X</a> ) );
            <span class="r43 r">dest</span>.<a href="#0ab81a4d6208a3cc" class="i property">Y</a> = <a href="#3d302ffe36be4892" class="i method">ValidateSize</a>( <span class="r41 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r46 r">cbFieldLength</span> ), <span class="r42 r">expectedSize</span>, <b>nameof</b>( <span class="r43 r">dest</span>.<a href="#0ab81a4d6208a3cc" class="i property">Y</a> ) );
            <b>if</b> ( <span class="r44 r">includePrivateParameters</span> )
                <span class="r43 r">dest</span>.<a href="#8c8f223bb8c260ce" class="i property">D</a> = <a href="#3d302ffe36be4892" class="i method">ValidateSize</a>( <span class="r41 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r46 r">cbFieldLength</span> ), <span class="r42 r">expectedSize</span>, <b>nameof</b>( <span class="r43 r">dest</span>.<a href="#8c8f223bb8c260ce" class="i property">D</a> ) );
        }
 
        <b>private static</b> <a href="#1f0f2857c46fee4c" class="t t">BCRYPT_ECC_PARAMETER_HEADER</a> <a id="7a154b735a24c6fd" href="R/7a154b735a24c6fd.html" target="n" data-glyph="46,1" class="i field">_secp256k1</a>;
 
        <b>private static</b> <a href="#1f0f2857c46fee4c" class="t t">BCRYPT_ECC_PARAMETER_HEADER</a> <a id="e0fbafee98f9125b" href="R/e0fbafee98f9125b.html" target="n" data-glyph="106,1" class="i property">Secp256k1</a>
        {
            <b>get</b>
            {
                <b>if</b> ( <a href="#7a154b735a24c6fd" class="i field">_secp256k1</a> != <b>null</b> )
                    <b>return</b> <a href="#7a154b735a24c6fd" class="i field">_secp256k1</a>;
 
                <b>return</b> <a href="#7a154b735a24c6fd" class="i field">_secp256k1</a> = <b>new</b> <a href="#1f0f2857c46fee4c" class="t constructor">BCRYPT_ECC_PARAMETER_HEADER</a>
                {
                    <a href="#f0cef5c564aa560c" class="i field">dwVersion</a> = 0x1,
                    <a href="#906d2ad04a573fd8" class="i field">dwCurveType</a> = 0x1,
                    <a href="#aa4632622b9024bf" class="i field">dwCurveGenerationAlgId</a> = 0x0,
                    <a href="#8dfca146d02b2ad0" class="i field">Prime</a> = <b>new</b> <b>byte</b>[] {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFF, 0xFF, 0xFC, 0x2F},
                    <a href="#07890936213e893b" class="i field">A</a> = <b>new</b> <b>byte</b>[] {0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0},
                    <a href="#4e59dbbfbe837f20" class="i field">B</a> = <b>new</b> <b>byte</b>[] {0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7},
                    <a href="#665b60a722d328b3" class="i field">Gx</a> = <b>new</b> <b>byte</b>[] {0x79, 0xBE, 0x66, 0x7E, 0xF9, 0xDC, 0xBB, 0xAC, 0x55, 0xA0, 0x62, 0x95, 0xCE, 0x87, 0xB, 0x7, 0x2, 0x9B, 0xFC, 0xDB, 0x2D, 0xCE, 0x28, 0xD9, 0x59, 0xF2, 0x81, 0x5B, 0x16, 0xF8, 0x17, 0x98},
                    <a href="#b73c3eafb2070b85" class="i field">Gy</a> = <b>new</b> <b>byte</b>[] {0x48, 0x3A, 0xDA, 0x77, 0x26, 0xA3, 0xC4, 0x65, 0x5D, 0xA4, 0xFB, 0xFC, 0xE, 0x11, 0x8, 0xA8, 0xFD, 0x17, 0xB4, 0x48, 0xA6, 0x85, 0x54, 0x19, 0x9C, 0x47, 0xD0, 0x8F, 0xFB, 0x10, 0xD4, 0xB8},
                    <a href="#5e3160ca9fbdd459" class="i field">Order</a> = <b>new</b> <b>byte</b>[] {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xBA, 0xAE, 0xDC, 0xE6, 0xAF, 0x48, 0xA0, 0x3B, 0xBF, 0xD2, 0x5E, 0x8C, 0xD0, 0x36, 0x41, 0x41},
                    <a href="#99d7574e66994047" class="i field">Cofactor</a> = <b>new</b> <b>byte</b>[] {0x1},
                    <a href="#aa8cabd2e0390d56" class="i field">Seed</a> = <b>new</b> <b>byte</b>[] { },
                };
            }
        }
 
        <b>private static byte</b>[] <a id="3d302ffe36be4892" href="R/3d302ffe36be4892.html" target="n" data-glyph="76,1" class="i method">ValidateSize</a>( <b>byte</b>[] <span id="r47 rd" class="r47 r">bytes</span>, <b>int</b> <span id="r48 rd" class="r48 r">expectedSize</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r49 rd" class="r49 r">fieldName</span> )
        {
            <b>if</b> ( <span class="r47 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; <span class="r48 r">expectedSize</span> )
                <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r50 rd" class="r50 r">i</span> = 0; <span class="r50 r">i</span> &lt; <span class="r47 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r48 r">expectedSize</span>; ++<span class="r50 r">i</span> )
                    <b>if</b> ( <span class="r47 r">bytes</span>[<span class="r50 r">i</span>] != 0 )
                        <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">Key parameter </span>{<span class="r49 r">fieldName</span>}<span class="s"> is larger than expected.</span><span class="s">&quot;</span> );
            <b>return</b> <span class="r47 r">bytes</span>;
        }
 
        <b>internal const int</b> <a id="c4f06584933aa41b" href="R/c4f06584933aa41b.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PUBLIC_P256_MAGIC</a> = 0x31534345;
        <b>internal const int</b> <a id="08fb2d61d3796f81" href="R/08fb2d61d3796f81.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PRIVATE_P256_MAGIC</a> = 0x32534345;
        <b>internal const int</b> <a id="3e7fe98cc0228d11" href="R/3e7fe98cc0228d11.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PUBLIC_P384_MAGIC</a> = 0x33534345;
        <b>internal const int</b> <a id="f975805720ffeb6d" href="R/f975805720ffeb6d.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PRIVATE_P384_MAGIC</a> = 0x34534345;
        <b>internal const int</b> <a id="647f5377c713c2b2" href="R/647f5377c713c2b2.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PUBLIC_P521_MAGIC</a> = 0x35534345;
        <b>internal const int</b> <a id="ed5dc0081ee9ea17" href="R/ed5dc0081ee9ea17.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PRIVATE_P521_MAGIC</a> = 0x36534345;
        <b>internal const int</b> <a id="a3a7345431bb7f72" href="R/a3a7345431bb7f72.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PUBLIC_GENERIC_MAGIC</a> = 0x50444345;
        <b>internal const int</b> <a id="0b051c91394b3172" href="R/0b051c91394b3172.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECDSA_PRIVATE_GENERIC_MAGIC</a> = 0x56444345;
 
        <b>internal const string</b> <a id="b8d07caf05328b46" href="R/b8d07caf05328b46.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECCFULLPUBLIC_BLOB</a> = <span class="s">&quot;ECCFULLPUBLICBLOB&quot;</span>;
        <b>internal const string</b> <a id="a785c30d66a422fd" href="R/a785c30d66a422fd.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECCFULLPRIVATE_BLOB</a> = <span class="s">&quot;ECCFULLPRIVATEBLOB&quot;</span>;
 
        <b>private static readonly</b> <a href="@0@System.Core/A.html#d5fe5c517d3c590f" class="t t">CngKeyBlobFormat</a> <a id="d11a641d153f5d4f" href="R/d11a641d153f5d4f.html" target="n" data-glyph="46,1" class="i field">CngKeyBlobFormat_EccFullPublicBlob</a> = <b>new</b> <a href="@0@System.Core/A.html#20b5095557b65a9a" class="t constructor">CngKeyBlobFormat</a>( <a href="#b8d07caf05328b46" class="i field">BCRYPT_ECCFULLPUBLIC_BLOB</a> );
        <b>private static readonly</b> <a href="@0@System.Core/A.html#d5fe5c517d3c590f" class="t t">CngKeyBlobFormat</a> <a id="85a05d5b962bc039" href="R/85a05d5b962bc039.html" target="n" data-glyph="46,1" class="i field">CngKeyBlobFormat_EccFullPrivateBlob</a> = <b>new</b> <a href="@0@System.Core/A.html#20b5095557b65a9a" class="t constructor">CngKeyBlobFormat</a>( <a href="#a785c30d66a422fd" class="i field">BCRYPT_ECCFULLPRIVATE_BLOB</a> );
    }
 
    <b>internal sealed class</b> <a id="1f0f2857c46fee4c" href="R/1f0f2857c46fee4c.html" target="n" data-glyph="2,0" class="t t"><span id="0cf682d7eeacb1e1">BCRYPT_ECC_PARAMETER_HEADER</span></a>
    {
        <b>internal const int</b> <a id="bb155e9a1b22c3c4" href="R/bb155e9a1b22c3c4.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECC_PRIME_SHORT_WEIERSTRASS_CURVE</a> = 0x1;
        <b>internal const int</b> <a id="c1efb763be65f4cc" href="R/c1efb763be65f4cc.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECC_PRIME_TWISTED_EDWARDS_CURVE</a> = 0x2;
        <b>internal const int</b> <a id="9ac939dca52b6617" href="R/9ac939dca52b6617.html" target="n" data-glyph="8,1" class="i field">BCRYPT_ECC_PRIME_MONTGOMERY_CURVE</a> = 0x3;
 
        <b>internal const int</b> <a id="d958737fef355023" href="R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">BCRYPT_NO_CURVE_GENERATION_ALG_ID</a> = 0x0;
 
        <b>public int</b> <a id="f0cef5c564aa560c" href="R/f0cef5c564aa560c.html" target="n" data-glyph="42,1" class="i field">dwVersion</a>;
        <b>public int</b> <a id="906d2ad04a573fd8" href="R/906d2ad04a573fd8.html" target="n" data-glyph="42,1" class="i field">dwCurveType</a>;
        <b>public int</b> <a id="aa4632622b9024bf" href="R/aa4632622b9024bf.html" target="n" data-glyph="42,1" class="i field">dwCurveGenerationAlgId</a>;
        <b>public byte</b>[] <a id="8dfca146d02b2ad0" href="R/8dfca146d02b2ad0.html" target="n" data-glyph="42,1" class="i field">Prime</a>;
        <b>public byte</b>[] <a id="07890936213e893b" href="R/07890936213e893b.html" target="n" data-glyph="42,1" class="i field">A</a>;
        <b>public byte</b>[] <a id="4e59dbbfbe837f20" href="R/4e59dbbfbe837f20.html" target="n" data-glyph="42,1" class="i field">B</a>;
        <b>public byte</b>[] <a id="665b60a722d328b3" href="R/665b60a722d328b3.html" target="n" data-glyph="42,1" class="i field">Gx</a>;
        <b>public byte</b>[] <a id="b73c3eafb2070b85" href="R/b73c3eafb2070b85.html" target="n" data-glyph="42,1" class="i field">Gy</a>;
        <b>public byte</b>[] <a id="5e3160ca9fbdd459" href="R/5e3160ca9fbdd459.html" target="n" data-glyph="42,1" class="i field">Order</a>;
        <b>public byte</b>[] <a id="99d7574e66994047" href="R/99d7574e66994047.html" target="n" data-glyph="42,1" class="i field">Cofactor</a>;
        <b>public byte</b>[] <a id="aa8cabd2e0390d56" href="R/aa8cabd2e0390d56.html" target="n" data-glyph="42,1" class="i field">Seed</a>;
 
        <b>public int</b> <a id="9eae6a3b096f5860" href="R/9eae6a3b096f5860.html" target="n" data-glyph="102,1" class="i property">KeySizeInBytes</a> =&gt; <a href="#8dfca146d02b2ad0" class="i field">Prime</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
 
        <b>public int</b> <a id="949d615a548980eb" href="R/949d615a548980eb.html" target="n" data-glyph="102,1" class="i property">CurveBlobSize</a>
        {
            <b>get</b>
            {
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r51 rd" class="r51 r">cbFieldLength</span> = <a href="#8dfca146d02b2ad0" class="i field">Prime</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r52 rd" class="r52 r">cbSubgroupOrder</span> = <a href="#5e3160ca9fbdd459" class="i field">Order</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r53 rd" class="r53 r">cbCofactor</span> = <a href="#99d7574e66994047" class="i field">Cofactor</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r54 rd" class="r54 r">cbSeed</span> = <a href="#aa8cabd2e0390d56" class="i field">Seed</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
 
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r55 rd" class="r55 r">size</span> = 7 * <b>sizeof</b>( <b>uint</b> ) + 5 * <span class="r51 r">cbFieldLength</span> + <span class="r52 r">cbSubgroupOrder</span> + <span class="r53 r">cbCofactor</span> + <span class="r54 r">cbSeed</span>;
 
                <b>return</b> <span class="r55 r">size</span>;
            }
        }
 
        <b>public int</b> <a id="9df4d76ff428836e" href="R/9df4d76ff428836e.html" target="n" data-glyph="102,1" class="i property">KeyBlobSize</a>
        {
            <b>get</b>
            {
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r56 rd" class="r56 r">cbFieldLength</span> = <a href="#8dfca146d02b2ad0" class="i field">Prime</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r57 rd" class="r57 r">size</span> = <b>sizeof</b>( <b>uint</b> ) + <a href="#949d615a548980eb" class="i property">CurveBlobSize</a> + 3 * <span class="r56 r">cbFieldLength</span>;
                <b>return</b> <span class="r57 r">size</span>;
            }
        }
 
        <b>public override string</b> <a id="ea94bce1558a298a" href="R/ea94bce1558a298a.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="k">var</a> <span id="r58 rd" class="r58 r">sb</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">&quot;{&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#f0cef5c564aa560c" class="i field">dwVersion</a> )}<span class="s"> = 0x</span>{<a href="#f0cef5c564aa560c" class="i field">dwVersion</a>:<span class="s">X</span>}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#906d2ad04a573fd8" class="i field">dwCurveType</a> )}<span class="s"> = 0x</span>{<a href="#906d2ad04a573fd8" class="i field">dwCurveType</a>:<span class="s">X</span>}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#aa4632622b9024bf" class="i field">dwCurveGenerationAlgId</a> )}<span class="s"> = 0x</span>{<a href="#aa4632622b9024bf" class="i field">dwCurveGenerationAlgId</a>:<span class="s">X</span>}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#8dfca146d02b2ad0" class="i field">Prime</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#8dfca146d02b2ad0" class="i field">Prime</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#07890936213e893b" class="i field">A</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#07890936213e893b" class="i field">A</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#4e59dbbfbe837f20" class="i field">B</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#4e59dbbfbe837f20" class="i field">B</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#665b60a722d328b3" class="i field">Gx</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#665b60a722d328b3" class="i field">Gx</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#b73c3eafb2070b85" class="i field">Gy</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#b73c3eafb2070b85" class="i field">Gy</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#5e3160ca9fbdd459" class="i field">Order</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#5e3160ca9fbdd459" class="i field">Order</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#99d7574e66994047" class="i field">Cofactor</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#99d7574e66994047" class="i field">Cofactor</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">$&quot;</span><span class="s">    </span>{<b>nameof</b>( <a href="#aa8cabd2e0390d56" class="i field">Seed</a> )}<span class="s"> = </span>{<a href="#51044fb7db9a179c" class="i method">GetBytesDesc</a>( <a href="#aa8cabd2e0390d56" class="i field">Seed</a> )}<span class="s">,</span><span class="s">&quot;</span> );
            <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>( <span class="s">&quot;}&quot;</span> );
            <b>return</b> <span class="r58 r">sb</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>();
        }
 
        <b>private static string</b> <a id="51044fb7db9a179c" href="R/51044fb7db9a179c.html" target="n" data-glyph="76,1" class="i method">GetBytesDesc</a>( <b>byte</b>[] <span id="r59 rd" class="r59 r">bytes</span> )
        {
            <b>if</b> ( <span class="r59 r">bytes</span> == <b>null</b> )
                <b>return</b> <span class="s">&quot;null&quot;</span>;
 
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="k">var</a> <span id="r60 rd" class="r60 r">sb</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
            <span class="r60 r">sb</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="s">&quot;new byte[] { &quot;</span> );
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r61 rd" class="r61 r">i</span> = 0; <span class="r61 r">i</span> &lt; <span class="r59 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; ++<span class="r61 r">i</span> )
            {
                <b>if</b> ( <span class="r61 r">i</span> &gt; 0 )
                    <span class="r60 r">sb</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="s">&quot;, &quot;</span> );
                <span class="r60 r">sb</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="s">&quot;0x&quot;</span> ).<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="r59 r">bytes</span>[<span class="r61 r">i</span>].<a href="@0@mscorlib/A.html#51506b5791391f8f" class="i method">ToString</a>( <span class="s">&quot;X&quot;</span> ) );
            }
            <span class="r60 r">sb</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="s">&quot; }&quot;</span> );
 
            <b>return</b> <span class="r60 r">sb</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>();
        }
 
        <b>public override bool</b> <a id="b90ada8f8e64cdca" href="R/b90ada8f8e64cdca.html" target="n" data-glyph="72,1" class="i method">Equals</a>( <b>object</b> <span id="r62 rd" class="r62 r">obj</span> )
        {
            <b>if</b> ( <span class="r62 r">obj</span> == <a href="#1f0f2857c46fee4c" class="k">this</a> )
                <b>return</b> <b>true</b>;
 
            <a href="#1f0f2857c46fee4c" class="k">var</a> <span id="r63 rd" class="r63 r">other</span> = <span class="r62 r">obj</span> <b>as</b> <a href="#1f0f2857c46fee4c" class="t t">BCRYPT_ECC_PARAMETER_HEADER</a>;
            <b>if</b> ( <span class="r63 r">other</span> == <b>null</b> )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r63 r">other</span>.<a href="#f0cef5c564aa560c" class="i field">dwVersion</a> != <a href="#f0cef5c564aa560c" class="i field">dwVersion</a> )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r63 r">other</span>.<a href="#906d2ad04a573fd8" class="i field">dwCurveType</a> != <a href="#906d2ad04a573fd8" class="i field">dwCurveType</a> )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r63 r">other</span>.<a href="#aa4632622b9024bf" class="i field">dwCurveGenerationAlgId</a> != <a href="#aa4632622b9024bf" class="i field">dwCurveGenerationAlgId</a> )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#8dfca146d02b2ad0" class="i field">Prime</a>, <a href="#8dfca146d02b2ad0" class="i field">Prime</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#07890936213e893b" class="i field">A</a>, <a href="#07890936213e893b" class="i field">A</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#4e59dbbfbe837f20" class="i field">B</a>, <a href="#4e59dbbfbe837f20" class="i field">B</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#665b60a722d328b3" class="i field">Gx</a>, <a href="#665b60a722d328b3" class="i field">Gx</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#b73c3eafb2070b85" class="i field">Gy</a>, <a href="#b73c3eafb2070b85" class="i field">Gy</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#5e3160ca9fbdd459" class="i field">Order</a>, <a href="#5e3160ca9fbdd459" class="i field">Order</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#99d7574e66994047" class="i field">Cofactor</a>, <a href="#99d7574e66994047" class="i field">Cofactor</a> ) )
                <b>return</b> <b>false</b>;
            <b>if</b> ( !<a href="#211f77a7c49df8f3" class="i method">BytesEquals</a>( <span class="r63 r">other</span>.<a href="#aa8cabd2e0390d56" class="i field">Seed</a>, <a href="#aa8cabd2e0390d56" class="i field">Seed</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public override int</b> <a id="ecf65333eb373813" href="R/ecf65333eb373813.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>return</b> <a href="#bb155e9a1b22c3c4" class="i field">BCRYPT_ECC_PRIME_SHORT_WEIERSTRASS_CURVE</a>.<a href="@0@mscorlib/A.html#2d2b91f1bdc71dbb" class="i method">GetHashCode</a>()
                * <a href="#c1efb763be65f4cc" class="i field">BCRYPT_ECC_PRIME_TWISTED_EDWARDS_CURVE</a>.<a href="@0@mscorlib/A.html#2d2b91f1bdc71dbb" class="i method">GetHashCode</a>()
                * <a href="#9ac939dca52b6617" class="i field">BCRYPT_ECC_PRIME_MONTGOMERY_CURVE</a>.<a href="@0@mscorlib/A.html#2d2b91f1bdc71dbb" class="i method">GetHashCode</a>();
        }
 
 
        <b>private static bool</b> <a id="211f77a7c49df8f3" href="R/211f77a7c49df8f3.html" target="n" data-glyph="76,1" class="i method">BytesEquals</a>( <b>byte</b>[] <span id="r64 rd" class="r64 r">a</span>, <b>byte</b>[] <span id="r65 rd" class="r65 r">b</span> )
        {
            <b>if</b> ( <span class="r64 r">a</span> == <span class="r65 r">b</span> )
                <b>return</b> <b>true</b>;
 
            <b>if</b> ( ( <span class="r64 r">a</span> == <b>null</b> ) != ( <span class="r65 r">b</span> == <b>null</b> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r64 r">a</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> != <span class="r65 r">b</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> )
                <b>return</b> <b>false</b>;
 
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r66 rd" class="r66 r">i</span> = 0; <span class="r66 r">i</span> &lt; <span class="r64 r">a</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; ++<span class="r66 r">i</span> )
                <b>if</b> ( <span class="r64 r">a</span>[<span class="r66 r">i</span>] != <span class="r65 r">b</span>[<span class="r66 r">i</span>] )
                    <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public void</b> <a id="9d55af257864d006" href="R/9d55af257864d006.html" target="n" data-glyph="72,1" class="i method">ReadFrom</a>( <a href="@0@mscorlib/A.html#4f6cad84482876ff" class="t t">BinaryReader</a> <span id="r67 rd" class="r67 r">reader</span> )
        {
            <span class="c">/*
                struct BCRYPT_ECC_PARAMETER_HEADER
                {
                    ULONG                   dwVersion;              //Version of the structure
                    ECC_CURVE_TYPE_ENUM     dwCurveType;            //Supported curve types.
                    ECC_CURVE_ALG_ID_ENUM   dwCurveGenerationAlgId; //For X.592 verification purposes, if we include Seed we will need to include the algorithm ID.
                    ULONG                   cbFieldLength;          //Byte length of the fields P, A, B, X, Y.
                    ULONG                   cbSubgroupOrder;        //Byte length of the subgroup.
                    ULONG                   cbCofactor;             //Byte length of cofactor of G in E.
                    ULONG                   cbSeed;                 //Byte length of the seed used to generate the curve.
                    //P[cbFieldLength]              Prime specifying the base field.
                    //A[cbFieldLength]              Coefficient A of the equation y^2 = x^3 + A*x + B mod p
                    //B[cbFieldLength]              Coefficient B of the equation y^2 = x^3 + A*x + B mod p
                    //Gx[cbFieldLength]             X-coordinate of the base point.
                    //Gy[cbFieldLength]             Y-coordinate of the base point.
                    //n[cbSubgroupOrder]            Order of the group generated by G = (x,y)
                    //h[cbCofactor]                 Cofactor of G in E.
                    //S[cbSeed]                     Seed of the curve.
                }
             */</span>
 
            <a href="#f0cef5c564aa560c" class="i field">dwVersion</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
            <a href="#906d2ad04a573fd8" class="i field">dwCurveType</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
            <a href="#aa4632622b9024bf" class="i field">dwCurveGenerationAlgId</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r68 rd" class="r68 r">cbFieldLength</span> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r69 rd" class="r69 r">cbSubgroupOrder</span> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r70 rd" class="r70 r">cbCofactor</span> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r71 rd" class="r71 r">cbSeed</span> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#95b16031011c2e9f" class="i method">ReadInt32</a>();
 
            <a href="#8dfca146d02b2ad0" class="i field">Prime</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r68 r">cbFieldLength</span> );
            <a href="#07890936213e893b" class="i field">A</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r68 r">cbFieldLength</span> );
            <a href="#4e59dbbfbe837f20" class="i field">B</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r68 r">cbFieldLength</span> );
            <a href="#665b60a722d328b3" class="i field">Gx</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r68 r">cbFieldLength</span> );
            <a href="#b73c3eafb2070b85" class="i field">Gy</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r68 r">cbFieldLength</span> );
            <a href="#5e3160ca9fbdd459" class="i field">Order</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r69 r">cbSubgroupOrder</span> );
            <a href="#99d7574e66994047" class="i field">Cofactor</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r70 r">cbCofactor</span> );
            <a href="#aa8cabd2e0390d56" class="i field">Seed</a> = <span class="r67 r">reader</span>.<a href="@0@mscorlib/A.html#f4904e94e7164f50" class="i method">ReadBytes</a>( <span class="r71 r">cbSeed</span> );
        }
 
        <b>public void</b> <a id="c5c283ef346e8bfc" href="R/c5c283ef346e8bfc.html" target="n" data-glyph="72,1" class="i method">WriteTo</a>( <a href="@0@mscorlib/A.html#cf806b417abe1a35" class="t t">BinaryWriter</a> <span id="r72 rd" class="r72 r">writer</span> )
        {
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r73 rd" class="r73 r">cbFieldLength</span> = <a href="#8dfca146d02b2ad0" class="i field">Prime</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r74 rd" class="r74 r">cbSubgroupOrder</span> = <a href="#5e3160ca9fbdd459" class="i field">Order</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r75 rd" class="r75 r">cbCofactor</span> = <a href="#99d7574e66994047" class="i field">Cofactor</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r76 rd" class="r76 r">cbSeed</span> = <a href="#aa8cabd2e0390d56" class="i field">Seed</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>;
 
            <span class="r72 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <a href="#f0cef5c564aa560c" class="i field">dwVersion</a> );
            <span class="r72 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <a href="#906d2ad04a573fd8" class="i field">dwCurveType</a> );
            <span class="r72 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <a href="#aa4632622b9024bf" class="i field">dwCurveGenerationAlgId</a> );
            <span class="r72 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <span class="r73 r">cbFieldLength</span> );
            <span class="r72 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <span class="r74 r">cbSubgroupOrder</span> );
            <span class="r72 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <span class="r75 r">cbCofactor</span> );
            <span class="r72 r">writer</span>.<a href="@0@mscorlib/A.html#0dcb1e4b7b6cce02" class="i method">Write</a>( <span class="r76 r">cbSeed</span> );
 
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#8dfca146d02b2ad0" class="i field">Prime</a>, <span class="r73 r">cbFieldLength</span>, <b>nameof</b>( <a href="#8dfca146d02b2ad0" class="i field">Prime</a> ) );
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#07890936213e893b" class="i field">A</a>, <span class="r73 r">cbFieldLength</span>, <b>nameof</b>( <a href="#07890936213e893b" class="i field">A</a> ) );
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#4e59dbbfbe837f20" class="i field">B</a>, <span class="r73 r">cbFieldLength</span>, <b>nameof</b>( <a href="#4e59dbbfbe837f20" class="i field">B</a> ) );
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#665b60a722d328b3" class="i field">Gx</a>, <span class="r73 r">cbFieldLength</span>, <b>nameof</b>( <a href="#665b60a722d328b3" class="i field">Gx</a> ) );
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#b73c3eafb2070b85" class="i field">Gy</a>, <span class="r73 r">cbFieldLength</span>, <b>nameof</b>( <a href="#b73c3eafb2070b85" class="i field">Gy</a> ) );
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#5e3160ca9fbdd459" class="i field">Order</a>, <span class="r74 r">cbSubgroupOrder</span>, <b>nameof</b>( <a href="#5e3160ca9fbdd459" class="i field">Order</a> ) );
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#99d7574e66994047" class="i field">Cofactor</a>, <span class="r75 r">cbCofactor</span>, <b>nameof</b>( <a href="#99d7574e66994047" class="i field">Cofactor</a> ) );
            <a href="#9e5c636636b932f1" class="i method">AlignAndWrite</a>( <span class="r72 r">writer</span>, <a href="#aa8cabd2e0390d56" class="i field">Seed</a>, <span class="r76 r">cbSeed</span>, <b>nameof</b>( <a href="#aa8cabd2e0390d56" class="i field">Seed</a> ) );
        }
 
        <b>private static void</b> <a id="9e5c636636b932f1" href="R/9e5c636636b932f1.html" target="n" data-glyph="76,1" class="i method">AlignAndWrite</a>( <a href="@0@mscorlib/A.html#cf806b417abe1a35" class="t t">BinaryWriter</a> <span id="r77 rd" class="r77 r">writer</span>, <b>byte</b>[] <span id="r78 rd" class="r78 r">bytes</span>, <b>int</b> <span id="r79 rd" class="r79 r">size</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r80 rd" class="r80 r">paramName</span> )
        {
            <b>if</b> ( <span class="r78 r">bytes</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Value of </span>{<span class="r80 r">paramName</span>}<span class="s"> is null.</span><span class="s">&quot;</span> );
 
            <b>if</b> ( <span class="r78 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt;= <span class="r79 r">size</span> )
            {
                <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r81 rd" class="r81 r">i</span> = 0; <span class="r81 r">i</span> &lt; <span class="r78 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r79 r">size</span>; ++<span class="r81 r">i</span> )
                    <b>if</b> ( <span class="r78 r">bytes</span>[<span class="r81 r">i</span>] != 0 )
                        <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Value of </span>{<span class="r80 r">paramName</span>}<span class="s"> is bigger than allowed for this curve.</span><span class="s">&quot;</span> );
 
                <span class="r77 r">writer</span>.<a href="@0@mscorlib/A.html#fae34c4f5667c7a2" class="i method">Write</a>( <span class="r78 r">bytes</span>, <span class="r78 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r79 r">size</span>, <span class="r79 r">size</span> );
                <b>return</b>;
            }
 
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r82 rd" class="r82 r">i</span> = <span class="r78 r">bytes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r82 r">i</span> &lt; <span class="r79 r">size</span>; ++<span class="r82 r">i</span> )
                <span class="r77 r">writer</span>.<a href="@0@mscorlib/A.html#430d3c5573a2b429" class="i method">Write</a>( (<b>byte</b>) 0 );
 
            <span class="r77 r">writer</span>.<a href="@0@mscorlib/A.html#3b784e1877648aef" class="i method">Write</a>( <span class="r78 r">bytes</span> );
        }
    }
}</pre></td></tr></table></div></body></html>
