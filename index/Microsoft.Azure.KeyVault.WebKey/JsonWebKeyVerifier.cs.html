<!DOCTYPE html>
<html><head><title>JsonWebKeyVerifier.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(1134);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.KeyVault.WebKey/JsonWebKeyVerifier.cs" target="_top">JsonWebKeyVerifier.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/keyvault/Microsoft.Azure.KeyVault.WebKey/src/JsonWebKeyVerifier.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.KeyVault.WebKey" target="_top">Microsoft.Azure.KeyVault.WebKey.csproj</a> (Microsoft.Azure.KeyVault.WebKey)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for</span>
<span class="c">// license information.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">KeyVault</span>.<span class="i n">WebKey</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A class that verifies instances of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> according to key type. </span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="ff6492f97841b27c" href="R/ff6492f97841b27c.html" target="n" data-glyph="0,0" class="t t">JsonWebKeyVerifier</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates which type of key this verifier applies to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is typically a value of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, though other values are allowed if registered</span>
        <span class="c">///</span><span class="c"> with the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4e3dacff09d5ba57" class="i method">Register</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method.</span>
        <b>public string</b> <a id="f24d9d2cb110a56c" href="R/f24d9d2cb110a56c.html" target="n" data-glyph="102,1" class="i property">Kty</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance setting the specified value in the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f24d9d2cb110a56c" class="i property">Kty</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">kty</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates which type of key this verifier applies to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#c742289497493bb8" class="t t">ArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the specified value is </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, empty or whitespace.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the specified value contains invalid characters.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="801a395a36fd2c8a" href="R/801a395a36fd2c8a.html" target="n" data-glyph="75,1" class="t constructor">JsonWebKeyVerifier</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">kty</span> )
        {
            <b>if</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>( <span class="r0 r">kty</span> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r0 r">kty</span> ) );
 
            <b>foreach</b> ( <a href="@0@mscorlib/A.html#02f2b1a33b09362d" class="k">var</a> <span id="r1 rd" class="r1 r">ch</span> <b>in</b> <span class="r0 r">kty</span> )
            {
                <b>if</b> ( <span class="r1 r">ch</span> &gt;= <span class="s">&#39;0&#39;</span> &amp;&amp; <span class="r1 r">ch</span> &lt;= <span class="s">&#39;9&#39;</span> )
                    <b>continue</b>;
                <b>if</b> ( <span class="r1 r">ch</span> &gt;= <span class="s">&#39;A&#39;</span> &amp;&amp; <span class="r1 r">ch</span> &lt;= <span class="s">&#39;Z&#39;</span> )
                    <b>continue</b>;
                <b>if</b> ( <span class="r1 r">ch</span> &gt;= <span class="s">&#39;a&#39;</span> &amp;&amp; <span class="r1 r">ch</span> &lt;= <span class="s">&#39;z&#39;</span> )
                    <b>continue</b>;
                <b>if</b> ( <span class="r1 r">ch</span> == <span class="s">&#39;-&#39;</span> || <span class="r1 r">ch</span> == <span class="s">&#39;.&#39;</span> || <span class="r1 r">ch</span> == <span class="s">&#39;_&#39;</span> )
                    <b>continue</b>;
 
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>( <span class="s">&quot;Value contains invalid characters.&quot;</span>, <b>nameof</b>( <span class="r0 r">kty</span> ) );
            }
 
            <a href="#f24d9d2cb110a56c" class="i property">Kty</a> = <span class="r0 r">kty</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tells if the type of key verified by this object supports public key algorithms.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note to implementers: if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, the methods</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5c866fe2fe985e6d" class="i method">IsPublicKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0fd667a773713058" class="i method">IsPublicKeyValid</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#362b23dd29bac854" class="i method">IsPrivateKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7e5f6f0ad1e55790" class="i method">IsPrivateKeyValid</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> must be overridden.</span>
        <b>public abstract bool</b> <a id="201903d91d882721" href="R/201903d91d882721.html" target="n" data-glyph="102,1" class="i property">IsPublicKeyCrypto</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tells if the type of key verified by this object supports symmetric key algorithms.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note to implementers: if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, the methods</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d47069983536ad64" class="i method">IsSymmetricKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#701d1a5d2f88bed7" class="i method">IsSymmetricKeyValid</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> must be overridden.</span>
        <b>public abstract bool</b> <a id="866d036300177bb4" href="R/866d036300177bb4.html" target="n" data-glyph="102,1" class="i property">IsSymmetricKeyCrypto</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tells if the type of key verified by this object contains a secret component, such as a hardware key token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note to implementers: if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, the methods</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7195282c5be95736" class="i method">IsSecretKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#ce58c3855dff9492" class="i method">IsSecretKeyValid</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> must be overridden.</span>
        <b>public abstract bool</b> <a id="b19fd42474c34cb5" href="R/b19fd42474c34cb5.html" target="n" data-glyph="102,1" class="i property">HasSecretKey</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance contains values at properties that represent the public key. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If all required public key properties (for the key type) are specified in the instance, the method must return</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and not modify the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">missingProps</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If some public key property is missing, the method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and set </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">missingProps</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> with a value - typically a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>{<span class="r3 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> - containing all missing properties.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">missingProps</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that tells the list of missing properties. Callers must</span>
        <span class="c">///</span><span class="c"> set the variable to </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, and examine the value only if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="5c866fe2fe985e6d" href="R/5c866fe2fe985e6d.html" target="n" data-glyph="72,1" class="i method">IsPublicKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r4 rd" class="r4 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r2 rd" class="r2 r">missingProps</span> )
        {
            <b>throw</b> <a href="#e5b662f9e05a4369" class="i method">ThrowDefaultForPublicKeyCrypto</a>( <b>nameof</b>( <span class="i">IsPublicKeyComplete</span> ) );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance contains a possibly valid public key (see remarks). </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Because fully validating a key may require unfeasable amount of resources, this method only has to check</span>
        <span class="c">///</span><span class="c"> for obvious issues. As a guideline, we say that the code only verifies obvious issues if it runs in constant time.</span>
        <span class="c">///</span><span class="c"> It&#39;s perfectly valid for implementors to do nothing and simply return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">This method assumes that </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5c866fe2fe985e6d" class="i method">IsPublicKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> was called and returned </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">. It</span>
        <span class="c">///</span><span class="c"> doesn&#39;t test again for the presence of required properties. It may throw </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#2d739200b2282eb9" class="t t">NullReferenceException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> if the caller doesn&#39;t see </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5c866fe2fe985e6d" class="i method">IsPublicKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> returning </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> first.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If the valiation code finds no issue, this method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> without modifying the value of </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">errorMsg</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If some issue is found, this method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and tell more details in the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">errorMsg</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">errorMsg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that will contain an error message. Callers must</span>
        <span class="c">///</span><span class="c"> set the variable to </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, and examine the value only if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="0fd667a773713058" href="R/0fd667a773713058.html" target="n" data-glyph="72,1" class="i method">IsPublicKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r6 rd" class="r6 r">webKey</span>, <b>ref string</b> <span id="r5 rd" class="r5 r">errorMsg</span> )
        {
            <b>throw</b> <a href="#e5b662f9e05a4369" class="i method">ThrowDefaultForPublicKeyCrypto</a>( <b>nameof</b>( <span class="i">IsPublicKeyValid</span> ) );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Same as </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5c866fe2fe985e6d" class="i method">IsPublicKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, but for the private key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="362b23dd29bac854" href="R/362b23dd29bac854.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r7 rd" class="r7 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r8 rd" class="r8 r">missingProps</span> )
        {
            <b>throw</b> <a href="#e5b662f9e05a4369" class="i method">ThrowDefaultForPublicKeyCrypto</a>( <b>nameof</b>( <span class="i">IsPrivateKeyComplete</span> ) );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Same as </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0fd667a773713058" class="i method">IsPublicKeyValid</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, but for the private key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="7e5f6f0ad1e55790" href="R/7e5f6f0ad1e55790.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r9 rd" class="r9 r">webKey</span>, <b>ref string</b> <span id="r10 rd" class="r10 r">errorMsg</span> )
        {
            <b>throw</b> <a href="#e5b662f9e05a4369" class="i method">ThrowDefaultForPublicKeyCrypto</a>( <b>nameof</b>( <span class="i">IsPrivateKeyValid</span> ) );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance contains values in one or more properties that</span>
        <span class="c">///</span><span class="c"> represent the private key. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">This method is used to protect private key material from accidental leakage.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span><span class="c">   </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If no private key property (for the key type) is specified in the instance, the method must return</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and not modify the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">specifiedProps</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If one or more private key property is specified, the method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and optionally</span>
        <span class="c">///</span><span class="c"> set </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">specifiedProps</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> with a value - typically a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>{<span class="r12 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> - containing the specified properties.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">specifiedProps</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that tells the list of specified properties. Callers must</span>
        <span class="c">///</span><span class="c"> set the variable to </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and examine the value only if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> if a value is found in at least one property that describe the private key;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="aa732bda9623ab02" href="R/aa732bda9623ab02.html" target="n" data-glyph="72,1" class="i method">IsAnyPrivateKeyParamSpecified</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r13 rd" class="r13 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r11 rd" class="r11 r">specifiedProps</span> )
        {
            <b>throw</b> <a href="#e5b662f9e05a4369" class="i method">ThrowDefaultForPublicKeyCrypto</a>( <b>nameof</b>( <span class="i">IsAnyPrivateKeyParamSpecified</span> ) );
        }
 
        <b>private</b> <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <a id="e5b662f9e05a4369" href="R/e5b662f9e05a4369.html" target="n" data-glyph="76,1" class="i method">ThrowDefaultForPublicKeyCrypto</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">methodName</span> )
        {
            <b>if</b> ( <a href="#201903d91d882721" class="i property">IsPublicKeyCrypto</a> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3f64c7634faf1768" class="t constructor">NotImplementedException</a>( <span class="s">$&quot;</span><span class="s">Type </span>{<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>}<span class="s"> is a bad implementation. If </span>{<b>nameof</b>( <a href="#201903d91d882721" class="i property">IsPublicKeyCrypto</a> )}<span class="s"> returns true, then </span>{<span class="r14 r">methodName</span>}<span class="s"> must be overridden and the base must not be called.</span><span class="s">&quot;</span> );
 
            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">Type </span>{<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>}<span class="s"> is not intended for public key cryptography.</span><span class="s">&quot;</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance contains values at properties that represent the symmetric key. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If all required symmetric key properties (for the key type) are specified in the instance, the method must return</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and not modify the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">missingProps</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If some property is missing, the method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and set </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">missingProps</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> to a value - typically a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>{<span class="r16 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> - containing all missing properties.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">missingProps</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that tells the list of missing properties. Callers must</span>
        <span class="c">///</span><span class="c"> set the variable to </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, and examine the value only if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="d47069983536ad64" href="R/d47069983536ad64.html" target="n" data-glyph="72,1" class="i method">IsSymmetricKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r17 rd" class="r17 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r15 rd" class="r15 r">missingProps</span> )
        {
            <b>throw</b> <a href="#369ed2354a41b6dd" class="i method">ThrowDefaultForSymmetricKeyCrypto</a>( <b>nameof</b>( <span class="i">IsSymmetricKeyComplete</span> ) );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance contains a possibly valid symmetric key (see remarks). </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Because fully validating a key may require unfeasable amount of resources, this method only has to check</span>
        <span class="c">///</span><span class="c"> for obvious issues. As a guideline, we say that the code only verifies obvious issues if it runs in constant time.</span>
        <span class="c">///</span><span class="c"> It&#39;s perfectly valid for implementors to do nothing and simply return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">This method assumes that </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d47069983536ad64" class="i method">IsSymmetricKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> was called and returned </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">. It</span>
        <span class="c">///</span><span class="c"> doesn&#39;t test again for the presence of required properties. It may throw </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#2d739200b2282eb9" class="t t">NullReferenceException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> if the caller doesn&#39;t see </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d47069983536ad64" class="i method">IsSymmetricKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> returning </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> first.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If the valiation code finds no issue, this method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> without modifying the value of </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">errorMsg</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If some issue is found, this method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and tell more details in the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">errorMsg</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">errorMsg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that will contain an error message. Callers must</span>
        <span class="c">///</span><span class="c"> set the variable to </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, and examine the value only if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="701d1a5d2f88bed7" href="R/701d1a5d2f88bed7.html" target="n" data-glyph="72,1" class="i method">IsSymmetricKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r19 rd" class="r19 r">webKey</span>, <b>ref string</b> <span id="r18 rd" class="r18 r">errorMsg</span> )
        {
            <b>throw</b> <a href="#369ed2354a41b6dd" class="i method">ThrowDefaultForSymmetricKeyCrypto</a>( <b>nameof</b>( <span class="i">IsSymmetricKeyValid</span> ) );
        }
 
        <b>private</b> <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <a id="369ed2354a41b6dd" href="R/369ed2354a41b6dd.html" target="n" data-glyph="76,1" class="i method">ThrowDefaultForSymmetricKeyCrypto</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">methodName</span> )
        {
            <b>if</b> ( <a href="#866d036300177bb4" class="i property">IsSymmetricKeyCrypto</a> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3f64c7634faf1768" class="t constructor">NotImplementedException</a>( <span class="s">$&quot;</span><span class="s">Type </span>{<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>}<span class="s"> is a bad implementation. If </span>{<b>nameof</b>( <a href="#866d036300177bb4" class="i property">IsSymmetricKeyCrypto</a> )}<span class="s"> returns true, then </span>{<span class="r20 r">methodName</span>}<span class="s"> must be overridden and the base must not be called.</span><span class="s">&quot;</span> );
 
            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">Type </span>{<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>}<span class="s"> is not intended for symmetric key cryptography.</span><span class="s">&quot;</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance contains values at properties that represent the secret key. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If all required secret key properties (for the key type) are specified in the instance, the method must return</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and not modify the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">missingProps</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If some property is missing, the method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and set </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">missingProps</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> to a value - typically a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>{<span class="r22 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> - containing all missing properties.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">missingProps</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that tells the list of missing properties. Callers must</span>
        <span class="c">///</span><span class="c"> set the variable to </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, and examine the value only if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="7195282c5be95736" href="R/7195282c5be95736.html" target="n" data-glyph="72,1" class="i method">IsSecretKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r23 rd" class="r23 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r21 rd" class="r21 r">missingProps</span> )
        {
            <b>throw</b> <a href="#9075274d22872619" class="i method">ThrowDefaultForSecretKeyCrypto</a>( <b>nameof</b>( <span class="i">IsSecretKeyComplete</span> ) );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance contains a possibly valid secret key (see remarks). </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Because fully validating a key may require unfeasable amount of resources, this method only has to check</span>
        <span class="c">///</span><span class="c"> for obvious issues. As a guideline, we say that the code only verifies obvious issues if it runs in constant time.</span>
        <span class="c">///</span><span class="c"> It&#39;s perfectly valid for implementors to do nothing and simply return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">This method assumes that </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7195282c5be95736" class="i method">IsSecretKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> was called and returned </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">. It</span>
        <span class="c">///</span><span class="c"> doesn&#39;t test again for the presence of required properties. It may throw </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#2d739200b2282eb9" class="t t">NullReferenceException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> if the caller doesn&#39;t see </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7195282c5be95736" class="i method">IsSecretKeyComplete</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> returning </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> first.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If the valiation code finds no issue, this method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> without modifying the value of </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">errorMsg</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If some issue is found, this method must return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and tell more details in the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">errorMsg</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">errorMsg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that will contain an error message. Callers must</span>
        <span class="c">///</span><span class="c"> set the variable to </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, and examine the value only if this method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="ce58c3855dff9492" href="R/ce58c3855dff9492.html" target="n" data-glyph="72,1" class="i method">IsSecretKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r25 rd" class="r25 r">webKey</span>, <b>ref string</b> <span id="r24 rd" class="r24 r">errorMsg</span> )
        {
            <b>throw</b> <a href="#9075274d22872619" class="i method">ThrowDefaultForSecretKeyCrypto</a>( <b>nameof</b>( <span class="i">IsSecretKeyValid</span> ) );
        }
 
        <b>private</b> <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <a id="9075274d22872619" href="R/9075274d22872619.html" target="n" data-glyph="76,1" class="i method">ThrowDefaultForSecretKeyCrypto</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r26 rd" class="r26 r">methodName</span> )
        {
            <b>if</b> ( <a href="#b19fd42474c34cb5" class="i property">HasSecretKey</a> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3f64c7634faf1768" class="t constructor">NotImplementedException</a>( <span class="s">$&quot;</span><span class="s">Type </span>{<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>}<span class="s"> is a bad implementation. If </span>{<b>nameof</b>( <a href="#b19fd42474c34cb5" class="i property">HasSecretKey</a> )}<span class="s"> returns true, then </span>{<span class="r26 r">methodName</span>}<span class="s"> must be overridden and the base must not be called.</span><span class="s">&quot;</span> );
 
            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">Type </span>{<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>}<span class="s"> is not intended to keys that have a secret component (for instance, HSM keys).</span><span class="s">&quot;</span> );
        }
 
        <b>private static volatile</b> <a href="@0@System/A.html#6f4f66b9b70e07ba" class="t t">SortedSet</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="2d877be58bb6684d" href="R/2d877be58bb6684d.html" target="n" data-glyph="46,1" class="i field">_validOperations</a>;
 
        <b>public static bool</b> <a id="04f40a27cbdbaf3e" href="R/04f40a27cbdbaf3e.html" target="n" data-glyph="72,1" class="i method">IsOperationValid</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r27 rd" class="r27 r">opName</span> )
        {
            <b>if</b> ( <a href="#2d877be58bb6684d" class="i field">_validOperations</a> == <b>null</b> )
            {
                <span class="c">// No lock here; we accept multiple threads initializing.</span>
                <a href="@0@System/A.html#6f4f66b9b70e07ba" class="k">var</a> <span id="r28 rd" class="r28 r">validOperations</span> = <b>new</b> <a href="@0@System/A.html#ba5599687aa3cc38" class="t constructor">SortedSet</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;();
 
                <b>foreach</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r29 rd" class="r29 r">op</span> <b>in</b> <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#e2f7f08e654cef62" class="i property">AllOperations</a> )
                    <span class="r28 r">validOperations</span>.<a href="@0@System/A.html#024e625be14755a5" class="i method">Add</a>( <span class="r29 r">op</span> );
 
                <a href="#2d877be58bb6684d" class="i field">_validOperations</a> = <span class="r28 r">validOperations</span>;
            }
 
            <span class="c">// No lock here; collection is read-only at this time.</span>
            <b>return</b> <a href="#2d877be58bb6684d" class="i field">_validOperations</a>.<a href="@0@System/A.html#4d751277d64317f3" class="i method">Contains</a>( <span class="r27 r">opName</span> );
        }
 
        <b>private volatile</b> <a href="@0@System/A.html#6f4f66b9b70e07ba" class="t t">SortedSet</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="d71d065579582071" href="R/d71d065579582071.html" target="n" data-glyph="46,1" class="i field">_compatibleOperations</a>;
 
        <b>public bool</b> <a id="1c2dd9eda0b32f2b" href="R/1c2dd9eda0b32f2b.html" target="n" data-glyph="72,1" class="i method">IsOperationCompatible</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r30 rd" class="r30 r">opName</span> )
        {
            <b>if</b> ( <a href="#d71d065579582071" class="i field">_compatibleOperations</a> == <b>null</b> )
            {
                <span class="c">// No lock here; we accept multiple threads initializing.</span>
                <a href="@0@System/A.html#6f4f66b9b70e07ba" class="k">var</a> <span id="r31 rd" class="r31 r">compatibleOperations</span> = <b>new</b> <a href="@0@System/A.html#ba5599687aa3cc38" class="t constructor">SortedSet</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;();
 
                <a href="#c41dc238ae1b9d71" class="i method">AddCompatibleOperations</a>( <span class="r31 r">compatibleOperations</span> );
 
                <a href="#d71d065579582071" class="i field">_compatibleOperations</a> = <span class="r31 r">compatibleOperations</span>;
            }
 
            <span class="c">// No lock here; collection is read-only at this time.</span>
            <b>return</b> <a href="#d71d065579582071" class="i field">_compatibleOperations</a>.<a href="@0@System/A.html#4d751277d64317f3" class="i method">Contains</a>( <span class="r30 r">opName</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds to the specified collection all operations that can be performed with keys whose type is handled by</span>
        <span class="c">///</span><span class="c"> this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For instance, if keys can only be used for digital signatures, this method should add only </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#dfad66299196683a" class="i field">Sign</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#caef56d617f788b0" class="i field">Verify</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">. </span>
        <b>protected abstract void</b> <a id="c41dc238ae1b9d71" href="R/c41dc238ae1b9d71.html" target="n" data-glyph="75,1" class="i method">AddCompatibleOperations</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r32 rd" class="r32 r">compatibleOperations</span> );
 
        <b>private</b> <a href="@0@System.Core/A.html#2d265edc718b158b" class="t t">HashSet</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="38a09703a1311357" href="R/38a09703a1311357.html" target="n" data-glyph="46,1" class="i field">_usedProperties</a>;
 
        <b>public bool</b> <a id="faab186187c304b1" href="R/faab186187c304b1.html" target="n" data-glyph="72,1" class="i method">IsPropertyUsed</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r33 rd" class="r33 r">propName</span> )
        {
            <b>if</b> ( <a href="#38a09703a1311357" class="i field">_usedProperties</a> == <b>null</b> )
            {
                <span class="c">// No lock here; we accept multiple threads initializing.</span>
                <a href="@0@System.Core/A.html#2d265edc718b158b" class="k">var</a> <span id="r34 rd" class="r34 r">usedProperties</span> = <b>new</b> <a href="@0@System.Core/A.html#eca9ea30fa3b2c28" class="t constructor">HashSet</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;();
 
                <a href="#35c6ee5d385f639c" class="i method">AddUsedProperties</a>( <span class="r34 r">usedProperties</span> );
 
                <span class="r34 r">usedProperties</span>.<a href="@0@System.Core/A.html#43a2b651926474a7" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#36858ce6958e4bba" class="i field">Property_Kid</a> );
                <span class="r34 r">usedProperties</span>.<a href="@0@System.Core/A.html#43a2b651926474a7" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#4e8418ebe072d1ae" class="i field">Property_Kty</a> );
                <span class="r34 r">usedProperties</span>.<a href="@0@System.Core/A.html#43a2b651926474a7" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#ef92d89a1d6ca577" class="i field">Property_KeyOps</a> );
 
                <a href="#38a09703a1311357" class="i field">_usedProperties</a> = <span class="r34 r">usedProperties</span>;
            }
 
            <span class="c">// No lock here; collection is read-only at this point.</span>
            <b>return</b> <a href="#38a09703a1311357" class="i field">_usedProperties</a>.<a href="@0@System.Core/A.html#06d905a0ac76e4f5" class="i method">Contains</a>( <span class="r33 r">propName</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds to the specified collection all JsonWebKey properties that are useful to keys whose type is handled by</span>
        <span class="c">///</span><span class="c"> this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">This method must add JSON property names, such as </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&quot;crv&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&quot;p&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, etc. It must not add</span>
        <span class="c">///</span><span class="c"> C# property names.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">This method doesn&#39;t have to add </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&quot;kid&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&quot;kty&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&quot;key_ops&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Thes properties are assumed to be useful to all keys.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span><span class="c">. </span>
        <b>protected abstract void</b> <a id="35c6ee5d385f639c" href="R/35c6ee5d385f639c.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r35 rd" class="r35 r">usedProperties</span> );
 
        [<a href="@0@mscorlib/A.html#5bbb5168ad9d1021" class="t constructor">Flags</a>]
        <b>public enum</b> <a id="b6eebebcdba481cc" href="R/b6eebebcdba481cc.html" target="n" data-glyph="18,1" class="t t"><span id="81db55d53ccdf62f">Options</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use this value if you don&#39;t want to specify any other.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="5536abdb9a8b6745" href="R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">None</a> = 0,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Fails if any private key material is present. Use this to defend against leakage. </span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> This value is only used for keys that support public key cryptography. It&#39;s ignored in other key types.</span>
            <a id="06c5e2e3437e414d" href="R/06c5e2e3437e414d.html" target="n" data-glyph="24,2" class="i field">DenyPrivateKey</a> <span class="c">/*********/</span> = 1 &lt;&lt; 0,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Fails if private key material is not fully present. Use this before storing or importing a JsonWebKey</span>
            <span class="c">///</span><span class="c"> value into a subsystem that needs to keep the private key. </span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> This value is only used for keys that support public key cryptography. It&#39;s ignored in other key types.</span>
            <a id="66b062492c53e66a" href="R/66b062492c53e66a.html" target="n" data-glyph="24,2" class="i field">RequirePrivateKey</a> <span class="c">/******/</span> = 1 &lt;&lt; 1,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Fails if there the </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&quot;key_ops&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> value of the verified key contains an incompatible operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="f3de36510d4f9fc1" href="R/f3de36510d4f9fc1.html" target="n" data-glyph="24,2" class="i field">DenyIncompatibleOperations</a> = 1 &lt;&lt; 2,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Fails if the JsonWebKey object describes values at properties that are not used by the corresponding key type.</span>
            <span class="c">///</span><span class="c"> Use this to defend against properties incorrectly set, and also some forms of leakage.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="9df620bfc41c931d" href="R/9df620bfc41c931d.html" target="n" data-glyph="24,2" class="i field">DenyExtraneousFields</a> <span class="c">/***/</span> = 1 &lt;&lt; 3,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Reserved for future use.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="f3a6c6c1908caf47" href="R/f3a6c6c1908caf47.html" target="n" data-glyph="24,2" class="i field">VerifyDecrypt</a> <span class="c">/**********/</span> = 1 &lt;&lt; 10,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Reserved for future use.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="8c7f182c66809340" href="R/8c7f182c66809340.html" target="n" data-glyph="24,2" class="i field">VerifySign</a> <span class="c">/*************/</span> = 1 &lt;&lt; 11,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Do not return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> if the verification fails; throws an exception instead.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="4b5e82756625e9e1" href="R/4b5e82756625e9e1.html" target="n" data-glyph="24,2" class="i field">ThrowException</a> <span class="c">/*********/</span> = 1 &lt;&lt; 20
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies the specified JsonWebKey instance. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Verification first examines the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#bf5694ab09c369fd" class="i property">Kty</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> property to select a verifier instance</span>
        <span class="c">///</span><span class="c"> (for more information, see the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4e3dacff09d5ba57" class="i method">Register</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method). If a verifier is found, it&#39;s used to check</span>
        <span class="c">///</span><span class="c"> if the key conforms to the corresponding key type.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The instance to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Tells how verification is to behave.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">error</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that will tell the error message, if verification fails. This</span>
        <span class="c">///</span><span class="c"> is only set if the method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">. If the method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> or throws</span>
        <span class="c">///</span><span class="c"> an exception, the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">error</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> will not me modified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> if the JsonWebKey value is valid, </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false otherwise</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#c742289497493bb8" class="t t">ArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">webKey</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">options</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter contains invalid options.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKeyVerificationException.cs.html#bf30b37d5ea0073b" class="t t">JsonWebKeyVerificationException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the JsonWebKey object is invalid and the option </span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#4b5e82756625e9e1" class="i field">ThrowException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> was specified.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b6eebebcdba481cc" class="t t">Options</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="aef3debc8f450943" href="R/aef3debc8f450943.html" target="n" data-glyph="72,1" class="i method">Verify</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r36 rd" class="r36 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r37 rd" class="r37 r">options</span>, <b>ref string</b> <span id="r38 rd" class="r38 r">error</span> )
        {
            <b>if</b> ( <span class="r36 r">webKey</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r36 r">webKey</span> ) );
 
            <b>if</b> ( <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#06c5e2e3437e414d" class="i field">DenyPrivateKey</a> ) &amp;&amp; <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#66b062492c53e66a" class="i field">RequirePrivateKey</a> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Cannot use </span>{<a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#06c5e2e3437e414d" class="i field">DenyPrivateKey</a>}<span class="s"> and </span>{<a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#66b062492c53e66a" class="i field">RequirePrivateKey</a>}<span class="s"> at same time.</span><span class="s">&quot;</span>, <b>nameof</b>( <span class="r37 r">options</span> ) );
 
            <b>if</b> ( <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#f3a6c6c1908caf47" class="i field">VerifyDecrypt</a> ) || <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#8c7f182c66809340" class="i field">VerifySign</a> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#085d4139ffb78d13" class="t constructor">NotImplementedException</a>();
 
            <b>if</b> ( !<a href="#6091b1ba956e6b5b" class="i method">VerifyNotNullOrWhiteSpace</a>( <span class="r36 r">webKey</span>.<a href="JsonWebKey.cs.html#bf5694ab09c369fd" class="i property">Kty</a>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#4e8418ebe072d1ae" class="i field">Property_Kty</a>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r36 r">webKey</span>.<a href="JsonWebKey.cs.html#bf5694ab09c369fd" class="i property">Kty</a> != <a href="#f24d9d2cb110a56c" class="i property">Kty</a> )
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span>, <span class="s">$&quot;</span><span class="s">Expected </span>{<a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#4e8418ebe072d1ae" class="i field">Property_Kty</a>}<span class="s"> to be \&quot;</span>{<a href="#f24d9d2cb110a56c" class="i property">Kty</a>}<span class="s">\&quot;, but found something else.</span><span class="s">&quot;</span> );
 
            <b>if</b> ( <a href="#201903d91d882721" class="i property">IsPublicKeyCrypto</a> )
            {
                <b>if</b> ( !<a href="#d69627940976b9b3" class="i method">VerifyPublicKey</a>( <a href="#ff6492f97841b27c" class="k">this</a>, <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                    <b>return</b> <b>false</b>;
 
                <b>if</b> ( <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#06c5e2e3437e414d" class="i field">DenyPrivateKey</a> ) &amp;&amp; !<a href="#95189c700e510cb8" class="i method">VerifyNoPrivateKey</a>( <a href="#ff6492f97841b27c" class="k">this</a>, <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                    <b>return</b> <b>false</b>;
 
                <b>if</b> ( <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#66b062492c53e66a" class="i field">RequirePrivateKey</a> ) &amp;&amp; !<a href="#55121dd374f03685" class="i method">VerifyPrivateKey</a>( <a href="#ff6492f97841b27c" class="k">this</a>, <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                    <b>return</b> <b>false</b>;
            }
 
            <b>if</b> ( <a href="#866d036300177bb4" class="i property">IsSymmetricKeyCrypto</a> )
            {
                <b>if</b> ( !<a href="#364d0cf6b638eb34" class="i method">VerifySymmetricKey</a>( <a href="#ff6492f97841b27c" class="k">this</a>, <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                    <b>return</b> <b>false</b>;
            }
 
            <b>if</b> ( <a href="#b19fd42474c34cb5" class="i property">HasSecretKey</a> &amp;&amp; !<a href="#4c9e460d6c278b1a" class="i method">VerifySecretKey</a>( <a href="#ff6492f97841b27c" class="k">this</a>, <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#f3de36510d4f9fc1" class="i field">DenyIncompatibleOperations</a> ) &amp;&amp; !<a href="#b423194fadb7c135" class="i method">VerifyOperationsAreCompatible</a>( <a href="#ff6492f97841b27c" class="k">this</a>, <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#f3de36510d4f9fc1" class="i field">DenyIncompatibleOperations</a> ) &amp;&amp; !<a href="#5a943be4df4f61b6" class="i method">VerifyOperationsAreValid</a>( <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r37 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#9df620bfc41c931d" class="i field">DenyExtraneousFields</a> ) &amp;&amp; !<a href="#adc0aa61f2d1a684" class="i method">VerifyNoExtraneousFields</a>( <a href="#ff6492f97841b27c" class="k">this</a>, <span class="r36 r">webKey</span>, <span class="r37 r">options</span>, <b>ref</b> <span class="r38 r">error</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies the specified JsonWebKey instance according to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#bf5694ab09c369fd" class="i property">Kty</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method selects a verifier based on the value of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#bf5694ab09c369fd" class="i property">Kty</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> then calls the verifier&#39;s </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#aef3debc8f450943" class="i method">Verify</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">webKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">error</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#aef3debc8f450943" class="i method">Verify</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public static bool</b> <a id="3c5a1f74ee4018e9" href="R/3c5a1f74ee4018e9.html" target="n" data-glyph="72,1" class="i method">VerifyByKeyType</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r39 rd" class="r39 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r40 rd" class="r40 r">options</span>, <b>ref string</b> <span id="r41 rd" class="r41 r">error</span> )
        {
            <b>if</b> ( <span class="r39 r">webKey</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r39 r">webKey</span> ) );
 
            <b>if</b> ( !<a href="#6091b1ba956e6b5b" class="i method">VerifyNotNullOrWhiteSpace</a>( <span class="r39 r">webKey</span>.<a href="JsonWebKey.cs.html#bf5694ab09c369fd" class="i property">Kty</a>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#4e8418ebe072d1ae" class="i field">Property_Kty</a>, <span class="r40 r">options</span>, <b>ref</b> <span class="r41 r">error</span> ) )
                <b>return</b> <b>false</b>;
 
            <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r42 rd" class="r42 r">verifier</span>;
 
            <b>lock</b> ( <a href="#0d2c03f8a64e5522" class="i field">_verifiersLock</a> )
            {
                <a href="#3f1eb079a9e3f67d" class="i method">InitVerifiers</a>();
                <b>if</b> ( !<a href="#8c6a8f2599b125b9" class="i method">VerifyEnum</a>( <span class="r39 r">webKey</span>.<a href="JsonWebKey.cs.html#bf5694ab09c369fd" class="i property">Kty</a>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#4e8418ebe072d1ae" class="i field">Property_Kty</a>, <a href="#e546d8bc2ba30d61" class="i field">_verifiers</a>, <b>out</b> <span class="r42 r">verifier</span>, <span class="r40 r">options</span>, <b>ref</b> <span class="r41 r">error</span> ) )
                    <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <span class="r42 r">verifier</span>.<a href="#aef3debc8f450943" class="i method">Verify</a>( <span class="r39 r">webKey</span>, <span class="r40 r">options</span>, <b>ref</b> <span class="r41 r">error</span> );
        }
 
        <b>private static readonly object</b> <a id="0d2c03f8a64e5522" href="R/0d2c03f8a64e5522.html" target="n" data-glyph="46,1" class="i field">_verifiersLock</a> = <b>new</b> <b>object</b>();
 
        <b>private static volatile</b> <a href="@0@System/A.html#1a01ea5555bded49" class="t t">SortedDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>&gt; <a id="e546d8bc2ba30d61" href="R/e546d8bc2ba30d61.html" target="n" data-glyph="46,1" class="i field">_verifiers</a>;
 
        <b>private static void</b> <a id="3f1eb079a9e3f67d" href="R/3f1eb079a9e3f67d.html" target="n" data-glyph="76,1" class="i method">InitVerifiers</a>()
        {
            <b>if</b> ( <a href="#e546d8bc2ba30d61" class="i field">_verifiers</a> != <b>null</b> )
                <b>return</b>;
 
            <a href="@0@System/A.html#1a01ea5555bded49" class="k">var</a> <span id="r43 rd" class="r43 r">verifiers</span> = <b>new</b> <a href="@0@System/A.html#0bb732b26ed811ac" class="t constructor">SortedDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>&gt;();
 
            <a href="#deed4567200fd626" class="i method">RegisterAt</a>( <span class="r43 r">verifiers</span>, <a href="#b2fe694464bf173a" class="t t">OctetKeyVerifier</a>.<a href="#2c8a1659ca788080" class="i property">Instance</a> );
            <a href="#deed4567200fd626" class="i method">RegisterAt</a>( <span class="r43 r">verifiers</span>, <a href="#d83c603ac214b00b" class="t t">EllipticCurveKeyVerifier</a>.<a href="#3093a615b09cb17a" class="i property">Instance</a> );
            <a href="#deed4567200fd626" class="i method">RegisterAt</a>( <span class="r43 r">verifiers</span>, <a href="#a2036279fd4c0f26" class="t t">EllipticCurveHsmKeyVerifier</a>.<a href="#388eca60df94f701" class="i property">Instance</a> );
            <a href="#deed4567200fd626" class="i method">RegisterAt</a>( <span class="r43 r">verifiers</span>, <a href="#23bb0515995723cc" class="t t">RsaKeyVerifier</a>.<a href="#8f03854b1c5f4bac" class="i property">Instance</a> );
            <a href="#deed4567200fd626" class="i method">RegisterAt</a>( <span class="r43 r">verifiers</span>, <a href="#e1ef8d9631597f46" class="t t">RsaHsmKeyVerifier</a>.<a href="#8b9eb7aaa0d42b41" class="i property">Instance</a> );
 
            <a href="#e546d8bc2ba30d61" class="i field">_verifiers</a> = <span class="r43 r">verifiers</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Registers a verifier for a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f24d9d2cb110a56c" class="i property">Kty</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throws exception is a previous verifier for same </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f24d9d2cb110a56c" class="i property">Kty</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> value is already registered.</span>
        <span class="c">///</span><span class="c"> There is no need to register verifiers for values described on </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">verifier</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The verifier to register.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a0dd2e1d2cf4ddfb" class="i method">GetVerifier</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public static void</b> <a id="4e3dacff09d5ba57" href="R/4e3dacff09d5ba57.html" target="n" data-glyph="72,1" class="i method">Register</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r44 rd" class="r44 r">verifier</span> )
        {
            <b>if</b> ( <span class="r44 r">verifier</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r44 r">verifier</span> ) );
 
            <b>lock</b> ( <a href="#0d2c03f8a64e5522" class="i field">_verifiersLock</a> )
            {
                <a href="#3f1eb079a9e3f67d" class="i method">InitVerifiers</a>();
                <a href="#deed4567200fd626" class="i method">RegisterAt</a>( <a href="#e546d8bc2ba30d61" class="i field">_verifiers</a>, <span class="r44 r">verifier</span> );
            }
        }
 
        <b>private static void</b> <a id="deed4567200fd626" href="R/deed4567200fd626.html" target="n" data-glyph="76,1" class="i method">RegisterAt</a>( <a href="@0@mscorlib/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>&gt; <span id="r45 rd" class="r45 r">verifiers</span>, <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r46 rd" class="r46 r">verifier</span> )
        {
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>( <span class="r45 r">verifiers</span> != <b>null</b> );
 
            <b>if</b> ( <span class="r45 r">verifiers</span>.<a href="@0@mscorlib/A.html#6b9f9049901aacea" class="i method">TryGetValue</a>( <span class="r46 r">verifier</span>.<a href="#f24d9d2cb110a56c" class="i property">Kty</a>, <b>out</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <b>_</b> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">Value already registered for \&quot;</span>{<span class="r46 r">verifier</span>.<a href="#f24d9d2cb110a56c" class="i property">Kty</a>}<span class="s">\&quot;.</span><span class="s">&quot;</span> );
 
            <span class="r45 r">verifiers</span><a href="@0@mscorlib/A.html#86884956b17e491a">[</a><span class="r46 r">verifier</span>.<a href="#f24d9d2cb110a56c" class="i property">Kty</a>] = <span class="r46 r">verifier</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the verifier registered for the specified kty value, or null if the kty value was not registered.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method never returns null for values described on </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4e3dacff09d5ba57" class="i method">Register</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public static</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <a id="a0dd2e1d2cf4ddfb" href="R/a0dd2e1d2cf4ddfb.html" target="n" data-glyph="72,1" class="i method">GetVerifier</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r47 rd" class="r47 r">kty</span> )
        {
            <b>if</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>( <span class="r47 r">kty</span> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r47 r">kty</span> ) );
 
            <b>lock</b> ( <a href="#0d2c03f8a64e5522" class="i field">_verifiersLock</a> )
            {
                <a href="#3f1eb079a9e3f67d" class="i method">InitVerifiers</a>();
                <a href="#e546d8bc2ba30d61" class="i field">_verifiers</a>.<a href="@0@System/A.html#df02b190dd5d9feb" class="i method">TryGetValue</a>( <span class="r47 r">kty</span>, <b>out</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r48 rd" class="r48 r">result</span> );
                <b>return</b> <span class="r48 r">result</span>;
            }
        }
 
        <b>private static bool</b> <a id="d69627940976b9b3" href="R/d69627940976b9b3.html" target="n" data-glyph="76,1" class="i method">VerifyPublicKey</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r49 rd" class="r49 r">verifier</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r50 rd" class="r50 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r51 rd" class="r51 r">options</span>, <b>ref string</b> <span id="r52 rd" class="r52 r">error</span> )
        {
            <b>return</b> <a href="#8bf6d5d124134927" class="i method">VerifyKeyParameters</a>(
                <span class="s">&quot;public&quot;</span>,
                <span class="r49 r">verifier</span>.<a href="#5c866fe2fe985e6d" class="i method">IsPublicKeyComplete</a>,
                <span class="r49 r">verifier</span>.<a href="#0fd667a773713058" class="i method">IsPublicKeyValid</a>,
                <span class="r50 r">webKey</span>,
                <span class="r51 r">options</span>,
                <b>ref</b> <span class="r52 r">error</span> );
        }
 
        <b>private static bool</b> <a id="95189c700e510cb8" href="R/95189c700e510cb8.html" target="n" data-glyph="76,1" class="i method">VerifyNoPrivateKey</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r53 rd" class="r53 r">verifier</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r54 rd" class="r54 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r55 rd" class="r55 r">options</span>, <b>ref string</b> <span id="r56 rd" class="r56 r">error</span> )
        {
            <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r57 rd" class="r57 r">specifiedProps</span> = <b>null</b>;
            <b>if</b> ( !<span class="r53 r">verifier</span>.<a href="#aa732bda9623ab02" class="i method">IsAnyPrivateKeyParamSpecified</a>( <span class="r54 r">webKey</span>, <b>ref</b> <span class="r57 r">specifiedProps</span> ) )
                <b>return</b> <b>true</b>;
 
            <b>if</b> ( <span class="r57 r">specifiedProps</span> == <b>null</b> || <span class="r57 r">specifiedProps</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> == 0 )
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r55 r">options</span>, <b>ref</b> <span class="r56 r">error</span>, <span class="s">&quot;Private key parameters must not be specified.&quot;</span> );
 
            <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r55 r">options</span>, <b>ref</b> <span class="r56 r">error</span>, <span class="s">$&quot;</span><span class="s">Private key parameters must not be specified: </span>{<a href="#b475cd1bb3489966" class="i method">SurroundWithQuotes</a>( <span class="r57 r">specifiedProps</span> )}<span class="s">&quot;</span> );
        }
 
        <b>private static bool</b> <a id="55121dd374f03685" href="R/55121dd374f03685.html" target="n" data-glyph="76,1" class="i method">VerifyPrivateKey</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r58 rd" class="r58 r">verifier</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r59 rd" class="r59 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r60 rd" class="r60 r">options</span>, <b>ref string</b> <span id="r61 rd" class="r61 r">error</span> )
        {
            <b>return</b> <a href="#8bf6d5d124134927" class="i method">VerifyKeyParameters</a>(
                <span class="s">&quot;private&quot;</span>,
                <span class="r58 r">verifier</span>.<a href="#362b23dd29bac854" class="i method">IsPrivateKeyComplete</a>,
                <span class="r58 r">verifier</span>.<a href="#7e5f6f0ad1e55790" class="i method">IsPrivateKeyValid</a>,
                <span class="r59 r">webKey</span>,
                <span class="r60 r">options</span>,
                <b>ref</b> <span class="r61 r">error</span> );
        }
 
        <b>private static bool</b> <a id="364d0cf6b638eb34" href="R/364d0cf6b638eb34.html" target="n" data-glyph="76,1" class="i method">VerifySymmetricKey</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r62 rd" class="r62 r">verifier</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r63 rd" class="r63 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r64 rd" class="r64 r">options</span>, <b>ref string</b> <span id="r65 rd" class="r65 r">error</span> )
        {
            <b>return</b> <a href="#8bf6d5d124134927" class="i method">VerifyKeyParameters</a>(
                <span class="s">&quot;symmetric&quot;</span>,
                <span class="r62 r">verifier</span>.<a href="#d47069983536ad64" class="i method">IsSymmetricKeyComplete</a>,
                <span class="r62 r">verifier</span>.<a href="#701d1a5d2f88bed7" class="i method">IsSymmetricKeyValid</a>,
                <span class="r63 r">webKey</span>,
                <span class="r64 r">options</span>,
                <b>ref</b> <span class="r65 r">error</span> );
        }
 
        <b>private static bool</b> <a id="4c9e460d6c278b1a" href="R/4c9e460d6c278b1a.html" target="n" data-glyph="76,1" class="i method">VerifySecretKey</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r66 rd" class="r66 r">verifier</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r67 rd" class="r67 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r68 rd" class="r68 r">options</span>, <b>ref string</b> <span id="r69 rd" class="r69 r">error</span> )
        {
            <b>return</b> <a href="#8bf6d5d124134927" class="i method">VerifyKeyParameters</a>(
                <span class="s">&quot;secret&quot;</span>,
                <span class="r66 r">verifier</span>.<a href="#7195282c5be95736" class="i method">IsSecretKeyComplete</a>,
                <span class="r66 r">verifier</span>.<a href="#ce58c3855dff9492" class="i method">IsSecretKeyValid</a>,
                <span class="r67 r">webKey</span>,
                <span class="r68 r">options</span>,
                <b>ref</b> <span class="r69 r">error</span> );
        }
 
        <b>private delegate bool</b> <a id="ebef62c6f5950b14" href="R/ebef62c6f5950b14.html" target="n" data-glyph="16,1" class="t t"><span id="e371ecef1dc35970">IsCompleteProc</span></a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r70 rd" class="r70 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r71 rd" class="r71 r">missingProps</span> );
 
        <b>private delegate bool</b> <a id="7188fd1c5e324ed6" href="R/7188fd1c5e324ed6.html" target="n" data-glyph="16,1" class="t t"><span id="c48ce1becee6e22f">IsValidProc</span></a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r72 rd" class="r72 r">webKey</span>, <b>ref string</b> <span id="r73 rd" class="r73 r">errorMsg</span> );
 
        <b>private static bool</b> <a id="8bf6d5d124134927" href="R/8bf6d5d124134927.html" target="n" data-glyph="76,1" class="i method">VerifyKeyParameters</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r74 rd" class="r74 r">name</span>, <a href="#ebef62c6f5950b14" class="t t">IsCompleteProc</a> <span id="r75 rd" class="r75 r">isCompleteProc</span>, <a href="#7188fd1c5e324ed6" class="t t">IsValidProc</a> <span id="r76 rd" class="r76 r">isValidProc</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r77 rd" class="r77 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r78 rd" class="r78 r">options</span>, <b>ref string</b> <span id="r79 rd" class="r79 r">error</span> )
        {
            <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r80 rd" class="r80 r">missingParams</span> = <b>null</b>;
            <b>if</b> ( !<span class="r75 r">isCompleteProc</span>( <span class="r77 r">webKey</span>, <b>ref</b> <span class="r80 r">missingParams</span> ) )
            {
                <b>if</b> ( <span class="r80 r">missingParams</span> == <b>null</b> || <span class="r80 r">missingParams</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> == 0 )
                    <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r78 r">options</span>, <b>ref</b> <span class="r79 r">error</span>, <span class="s">$&quot;</span><span class="s">Missing </span>{<span class="r74 r">name</span>}<span class="s"> key parameters.</span><span class="s">&quot;</span> );
 
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r78 r">options</span>, <b>ref</b> <span class="r79 r">error</span>, <span class="s">$&quot;</span><span class="s">Missing </span>{<span class="r74 r">name</span>}<span class="s"> key parameters: </span>{<a href="#b475cd1bb3489966" class="i method">SurroundWithQuotes</a>( <span class="r80 r">missingParams</span> )}<span class="s">&quot;</span> );
            }
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r81 rd" class="r81 r">errorMsg</span> = <b>null</b>;
            <b>if</b> ( !<span class="r76 r">isValidProc</span>( <span class="r77 r">webKey</span>, <b>ref</b> <span class="r81 r">errorMsg</span> ) )
            {
                <b>if</b> ( <span class="r81 r">errorMsg</span> != <b>null</b> )
                    <span class="r81 r">errorMsg</span> = <span class="s">$&quot;</span><span class="s">Invalid </span>{<span class="r74 r">name</span>}<span class="s"> key parameters: </span>{<span class="r81 r">errorMsg</span>}<span class="s">&quot;</span>;
                <b>else</b>
                    <span class="r81 r">errorMsg</span> = <span class="s">$&quot;</span><span class="s">Invalid </span>{<span class="r74 r">name</span>}<span class="s"> key parameters.</span><span class="s">&quot;</span>;
 
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r78 r">options</span>, <b>ref</b> <span class="r79 r">error</span>, <span class="r81 r">errorMsg</span> );
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="5a943be4df4f61b6" href="R/5a943be4df4f61b6.html" target="n" data-glyph="76,1" class="i method">VerifyOperationsAreValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r82 rd" class="r82 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r83 rd" class="r83 r">options</span>, <b>ref string</b> <span id="r84 rd" class="r84 r">error</span> )
        {
            <b>if</b> ( <span class="r82 r">webKey</span>.<a href="JsonWebKey.cs.html#6c108e193a5974bc" class="i property">KeyOps</a> == <b>null</b> )
                <b>return</b> <b>true</b>;
 
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r85 rd" class="r85 r">invalid</span> = <b>null</b>;
 
            <b>foreach</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r86 rd" class="r86 r">keyOp</span> <b>in</b> <span class="r82 r">webKey</span>.<a href="JsonWebKey.cs.html#6c108e193a5974bc" class="i property">KeyOps</a> )
                <b>if</b> ( !<a href="#04f40a27cbdbaf3e" class="i method">IsOperationValid</a>( <span class="r86 r">keyOp</span> ) )
                {
                    <b>if</b> ( <span class="r85 r">invalid</span> == <b>null</b> )
                        <span class="r85 r">invalid</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
                    <b>else</b>
                        <span class="r85 r">invalid</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="s">&quot;, &quot;</span> );
 
                    <span class="r85 r">invalid</span>.<a href="@0@mscorlib/A.html#a2e7c78d85807da5" class="i method">Append</a>( <span class="s">&#39;&quot;&#39;</span> ).<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="r86 r">keyOp</span> ).<a href="@0@mscorlib/A.html#a2e7c78d85807da5" class="i method">Append</a>( <span class="s">&#39;&quot;&#39;</span> );
                }
 
            <b>if</b> ( <span class="r85 r">invalid</span> != <b>null</b> )
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r87 rd" class="r87 r">validOps</span> = <a href="#b475cd1bb3489966" class="i method">SurroundWithQuotes</a>( <a href="#2d877be58bb6684d" class="i field">_validOperations</a> );
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r83 r">options</span>, <b>ref</b> <span class="r84 r">error</span>, <span class="s">$&quot;</span><span class="s">Found invalid operations: </span>{<span class="r85 r">invalid</span>}<span class="s">. Valid operations are: </span>{<span class="r87 r">validOps</span>}<span class="s">.</span><span class="s">&quot;</span> );
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="b423194fadb7c135" href="R/b423194fadb7c135.html" target="n" data-glyph="76,1" class="i method">VerifyOperationsAreCompatible</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r88 rd" class="r88 r">verifier</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r89 rd" class="r89 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r90 rd" class="r90 r">options</span>, <b>ref string</b> <span id="r91 rd" class="r91 r">error</span> )
        {
            <b>if</b> ( <span class="r89 r">webKey</span>.<a href="JsonWebKey.cs.html#6c108e193a5974bc" class="i property">KeyOps</a> == <b>null</b> )
                <b>return</b> <b>true</b>;
 
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r92 rd" class="r92 r">incompatible</span> = <b>null</b>;
 
            <b>foreach</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r93 rd" class="r93 r">keyOp</span> <b>in</b> <span class="r89 r">webKey</span>.<a href="JsonWebKey.cs.html#6c108e193a5974bc" class="i property">KeyOps</a> )
                <b>if</b> ( !<span class="r88 r">verifier</span>.<a href="#1c2dd9eda0b32f2b" class="i method">IsOperationCompatible</a>( <span class="r93 r">keyOp</span> ) )
                {
                    <b>if</b> ( <span class="r92 r">incompatible</span> == <b>null</b> )
                        <span class="r92 r">incompatible</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
                    <b>else</b>
                        <span class="r92 r">incompatible</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="s">&quot;, &quot;</span> );
 
                    <span class="r92 r">incompatible</span>.<a href="@0@mscorlib/A.html#a2e7c78d85807da5" class="i method">Append</a>( <span class="s">&#39;&quot;&#39;</span> ).<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="r93 r">keyOp</span> ).<a href="@0@mscorlib/A.html#a2e7c78d85807da5" class="i method">Append</a>( <span class="s">&#39;&quot;&#39;</span> );
                }
 
            <b>if</b> ( <span class="r92 r">incompatible</span> != <b>null</b> )
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r94 rd" class="r94 r">compatibleOps</span> = <a href="#b475cd1bb3489966" class="i method">SurroundWithQuotes</a>( <span class="r88 r">verifier</span>.<a href="#d71d065579582071" class="i field">_compatibleOperations</a> );
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r90 r">options</span>, <b>ref</b> <span class="r91 r">error</span>, <span class="s">$&quot;</span><span class="s">Found invalid or incompatible operations: </span>{<span class="r92 r">incompatible</span>}<span class="s">. Valid and compatible operations are: </span>{<span class="r94 r">compatibleOps</span>}<span class="s">.</span><span class="s">&quot;</span> );
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="adc0aa61f2d1a684" href="R/adc0aa61f2d1a684.html" target="n" data-glyph="76,1" class="i method">VerifyNoExtraneousFields</a>( <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <span id="r95 rd" class="r95 r">verifier</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r96 rd" class="r96 r">webKey</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r97 rd" class="r97 r">options</span>, <b>ref string</b> <span id="r98 rd" class="r98 r">error</span> )
        {
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r99 rd" class="r99 r">extraneous</span> = <b>null</b>;
 
            <b>void</b> <a id="efcb4b9b1457011b" href="R/efcb4b9b1457011b.html" target="n" data-glyph="76,2" class="i method">VerifyProperty</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r100 rd" class="r100 r">name</span>, <b>object</b> <span id="r101 rd" class="r101 r">value</span> )
            {
                <b>if</b> ( <span class="r101 r">value</span> == <b>null</b> || <span class="r95 r">verifier</span>.<a href="#faab186187c304b1" class="i method">IsPropertyUsed</a>( <span class="r100 r">name</span> ) )
                    <b>return</b>;
 
                <b>if</b> ( <span class="r99 r">extraneous</span> == <b>null</b> )
                    <span class="r99 r">extraneous</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
                <b>else</b>
                    <span class="r99 r">extraneous</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="s">&quot;, &quot;</span> );
 
                <span class="r99 r">extraneous</span>.<a href="@0@mscorlib/A.html#a2e7c78d85807da5" class="i method">Append</a>( <span class="s">&#39;&quot;&#39;</span> ).<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>( <span class="r100 r">name</span> ).<a href="@0@mscorlib/A.html#a2e7c78d85807da5" class="i method">Append</a>( <span class="s">&#39;&quot;&#39;</span> );
            }
 
            <span class="r96 r">webKey</span>.<a href="JsonWebKey.cs.html#9b603d03d75b226c" class="i method">VisitProperties</a>( <a href="#efcb4b9b1457011b" class="i method">VerifyProperty</a> );
 
            <b>if</b> ( <span class="r99 r">extraneous</span> != <b>null</b> )
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r97 r">options</span>, <b>ref</b> <span class="r98 r">error</span>, <span class="s">$&quot;</span><span class="s">Extraneous properties: </span>{<span class="r99 r">extraneous</span>}<span class="s">&quot;</span> );
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="8c6a8f2599b125b9" href="R/8c6a8f2599b125b9.html" target="n" data-glyph="76,1" class="i method">VerifyEnum</a>&lt;<span id="r102 rd t" class="r102 r t">T</span>&gt;( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r103 rd" class="r103 r">value</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r104 rd" class="r104 r">name</span>, <a href="@0@mscorlib/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <span class="r102 r t">T</span>&gt; <span id="r105 rd" class="r105 r">dictionary</span>, <b>out</b> <span class="r102 r t">T</span> <span id="r106 rd" class="r106 r">item</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r107 rd" class="r107 r">options</span>, <b>ref string</b> <span id="r108 rd" class="r108 r">error</span> )
        {
            <b>if</b> ( !<span class="r105 r">dictionary</span>.<a href="@0@mscorlib/A.html#6b9f9049901aacea" class="i method">TryGetValue</a>( <span class="r103 r">value</span>, <b>out</b> <span class="r106 r">item</span> ) )
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r107 r">options</span>, <b>ref</b> <span class="r108 r">error</span>, <span class="s">$&quot;</span><span class="s">Expected </span>{<span class="r104 r">name</span>}<span class="s"> to be one of </span>{<a href="#b475cd1bb3489966" class="i method">SurroundWithQuotes</a>( <span class="r105 r">dictionary</span>.<a href="@0@mscorlib/A.html#6141d2484c7e5c1a" class="i property">Keys</a> )}<span class="s">, but found something else.</span><span class="s">&quot;</span> );
 
            <b>if</b> ( <span class="r106 r">item</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">$&quot;</span><span class="s">Dictionary for </span>{<span class="r104 r">name</span>}<span class="s"> is returning null for \&quot;</span>{<span class="r103 r">value</span>}<span class="s">\&quot;.</span><span class="s">&quot;</span> );
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="6091b1ba956e6b5b" href="R/6091b1ba956e6b5b.html" target="n" data-glyph="76,1" class="i method">VerifyNotNullOrWhiteSpace</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r109 rd" class="r109 r">value</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r110 rd" class="r110 r">name</span>, <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r111 rd" class="r111 r">options</span>, <b>ref string</b> <span id="r112 rd" class="r112 r">error</span> )
        {
            <b>if</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>( <span class="r109 r">value</span> ) )
                <b>return</b> <a href="#fd184fe73c60e07a" class="i method">SetError</a>( <span class="r111 r">options</span>, <b>ref</b> <span class="r112 r">error</span>, <span class="s">$&quot;</span><span class="s">A value for </span>{<span class="r110 r">name</span>}<span class="s"> is mandatory.</span><span class="s">&quot;</span> );
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="fd184fe73c60e07a" href="R/fd184fe73c60e07a.html" target="n" data-glyph="76,1" class="i method">SetError</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a> <span id="r113 rd" class="r113 r">options</span>, <b>ref string</b> <span id="r114 rd" class="r114 r">error</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r115 rd" class="r115 r">message</span> )
        {
            <b>if</b> ( <span class="r113 r">options</span>.<a href="@0@mscorlib/A.html#9cd73f33d2df3074" class="i method">HasFlag</a>( <a href="#b6eebebcdba481cc" class="t t">Options</a>.<a href="#4b5e82756625e9e1" class="i field">ThrowException</a> ) )
                <b>throw</b> <b>new</b> <a href="JsonWebKeyVerificationException.cs.html#ede173cc68bb11b1" class="t constructor">JsonWebKeyVerificationException</a>( <span class="r115 r">message</span> );
            <span class="r114 r">error</span> = <span class="r115 r">message</span>;
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method that surrounds string values with double-quotes. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For instance, the strings Foo, Bar cause this method to return </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&quot;Foo&quot;, &quot;Bar&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span>
        <b>protected static string</b> <a id="b475cd1bb3489966" href="R/b475cd1bb3489966.html" target="n" data-glyph="75,1" class="i method">SurroundWithQuotes</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r116 rd" class="r116 r">items</span> )
        {
            <b>return</b> <span class="s">&quot;\&quot;&quot;</span> + <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#fa961ce440526a4d" class="i method">Join</a>( <span class="s">&quot;\&quot;, \&quot;&quot;</span>, <span class="r116 r">items</span> ) + <span class="s">&quot;\&quot;&quot;</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method that joins the operation of creating a collection (if required) and adding an item to it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the collection is null, this method creates one of type </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>{<span class="r117 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">. Then it adds the specified item to the collection.</span>
        <b>protected static void</b> <a id="1fa219a1a8479413" href="R/1fa219a1a8479413.html" target="n" data-glyph="75,1" class="i method">AddItem</a>&lt;<span id="r118 rd t" class="r118 r t">T</span>&gt;( <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<span class="r118 r t">T</span>&gt; <span id="r119 rd" class="r119 r">items</span>, <span class="r118 r t">T</span> <span id="r120 rd" class="r120 r">newItem</span> )
        {
            <b>if</b> ( <span class="r119 r">items</span> == <b>null</b> )
                <span class="r119 r">items</span> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<span class="r118 r t">T</span>&gt;();
            <span class="r119 r">items</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <span class="r120 r">newItem</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method that validates the size of a byte array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">A valid array meets the following criteria:</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">list</span> <span class="c">type</span><span class="c">=</span><span class="c">&quot;</span><span class="c">bullet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">description</span><span class="c">&gt;</span><span class="c">is not </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">;</span><span class="c">&lt;/</span><span class="c">description</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">description</span><span class="c">&gt;</span><span class="c">the length is at least </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">requiredSize</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">; and</span><span class="c">&lt;/</span><span class="c">description</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">description</span><span class="c">&gt;</span><span class="c">excess leading bytes are all zeros.</span><span class="c">&lt;/</span><span class="c">description</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The array to validate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The array name, which may be used to build error messages.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">requiredSize</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The required size, in bytes.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">errorMsg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A reference to a variable that will contain the error message. This is only set</span>
        <span class="c">///</span><span class="c"> if the method returns </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> if the array has a valid size; </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">false otherwise</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected static bool</b> <a id="73add10f5297e945" href="R/73add10f5297e945.html" target="n" data-glyph="75,1" class="i method">ValidateKeyParameterSize</a>( <b>byte</b>[] <span id="r122 rd" class="r122 r">value</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r123 rd" class="r123 r">name</span>, <b>int</b> <span id="r121 rd" class="r121 r">requiredSize</span>, <b>ref string</b> <span id="r124 rd" class="r124 r">errorMsg</span> )
        {
            <b>if</b> ( <span class="r122 r">value</span> == <b>null</b> || <span class="r122 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &lt; <span class="r121 r">requiredSize</span> )
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r125 rd" class="r125 r">sizeDesc</span> = <span class="r122 r">value</span> == <b>null</b> ? <span class="s">&quot;null&quot;</span> : <span class="r122 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>.<a href="@0@mscorlib/A.html#8d6f2d8bc0589463" class="i method">ToString</a>();
                <span class="r124 r">errorMsg</span> = <span class="s">$&quot;</span><span class="s">Expected </span>{<span class="r123 r">name</span>}<span class="s"> to have at least </span>{<span class="r121 r">requiredSize</span>}<span class="s"> bytes, but found </span>{<span class="r125 r">sizeDesc</span>}<span class="s">.</span><span class="s">&quot;</span>;
                <b>return</b> <b>false</b>;
            }
 
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r126 rd" class="r126 r">excess</span> = <span class="r122 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r121 r">requiredSize</span>;
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r127 rd" class="r127 r">i</span> = 0; <span class="r127 r">i</span> &lt; <span class="r126 r">excess</span>; ++<span class="r127 r">i</span> )
            {
                <b>if</b> ( <span class="r122 r">value</span>[<span class="r127 r">i</span>] != 0 )
                    <span class="r124 r">errorMsg</span> = <span class="s">$&quot;</span><span class="s">Expected </span>{<span class="r123 r">name</span>}<span class="s"> to have at most </span>{<span class="r121 r">requiredSize</span>}<span class="s"> bytes, but found </span>{<span class="r121 r">requiredSize</span> + <span class="r126 r">excess</span>}<span class="s">.</span><span class="s">&quot;</span>;
                --<span class="r126 r">excess</span>;
            }
 
            <b>return</b> <b>true</b>;
        }
    }
 
    <b>internal sealed class</b> <a id="b2fe694464bf173a" href="R/b2fe694464bf173a.html" target="n" data-glyph="2,0" class="t t">OctetKeyVerifier</a> : <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>
    {
        <b>public static</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <a id="2c8a1659ca788080" href="R/2c8a1659ca788080.html" target="n" data-glyph="102,1" class="i property">Instance</a> { <b>get</b>; } = <b>new</b> <a href="#5d00b1731a611f03" class="t constructor">OctetKeyVerifier</a>();
 
        <b>private</b> <a id="5d00b1731a611f03" href="R/5d00b1731a611f03.html" target="n" data-glyph="76,1" class="t constructor">OctetKeyVerifier</a>() : <a href="#801a395a36fd2c8a" class="k">base</a>( <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#0db095c52fbd796e" class="i field">Octet</a> )
        {
        }
 
        <b>public override bool</b> <a id="f4863779e789e12d" href="R/f4863779e789e12d.html" target="n" data-glyph="102,1" class="i property">IsPublicKeyCrypto</a> =&gt; <b>false</b>;
        <b>public override bool</b> <a id="23bff29f25d6ea01" href="R/23bff29f25d6ea01.html" target="n" data-glyph="102,1" class="i property">IsSymmetricKeyCrypto</a> =&gt; <b>true</b>;
        <b>public override bool</b> <a id="93533e18134d7f91" href="R/93533e18134d7f91.html" target="n" data-glyph="102,1" class="i property">HasSecretKey</a> =&gt; <b>false</b>;
 
        <b>protected override void</b> <a id="493e949d25dda829" href="R/493e949d25dda829.html" target="n" data-glyph="75,1" class="i method">AddCompatibleOperations</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r128 rd" class="r128 r">compatibleOperations</span> )
        {
            <span class="r128 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#0ad2e310a327bc4e" class="i field">Encrypt</a> );
            <span class="r128 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#f832ee804afdf570" class="i field">Decrypt</a> );
            <span class="r128 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#d4d21c6a56aded5e" class="i field">Wrap</a> );
            <span class="r128 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#aee4eb84be49afde" class="i field">Unwrap</a> );
        }
 
        <b>protected override void</b> <a id="4e458caf1dae2acc" href="R/4e458caf1dae2acc.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r129 rd" class="r129 r">usedProperties</span> )
        {
            <span class="r129 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#aaae99cacf4df119" class="i field">Property_K</a> );
        }
 
        <b>public override bool</b> <a id="5e8e42406a56a2de" href="R/5e8e42406a56a2de.html" target="n" data-glyph="72,1" class="i method">IsSymmetricKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r130 rd" class="r130 r">arg</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r131 rd" class="r131 r">missingProps</span> )
        {
            <b>if</b> ( <span class="r130 r">arg</span>.<a href="JsonWebKey.cs.html#20ddcb570f4681b4" class="i property">K</a> == <b>null</b> || <span class="r130 r">arg</span>.<a href="JsonWebKey.cs.html#20ddcb570f4681b4" class="i property">K</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r131 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#aaae99cacf4df119" class="i field">Property_K</a> );
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="9852ce50c6afe913" href="R/9852ce50c6afe913.html" target="n" data-glyph="72,1" class="i method">IsSymmetricKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r132 rd" class="r132 r">arg</span>, <b>ref string</b> <span id="r133 rd" class="r133 r">errorMsg</span> )
        {
            <b>return</b> <b>true</b>;
        }
    }
 
    <b>internal abstract class</b> <a id="6c6b874b162ce007" href="R/6c6b874b162ce007.html" target="n" data-glyph="2,0" class="t t">EllipticCurveKeyVerifierBase</a> : <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>
    {
        <b>protected</b> <a id="15c62a685016d29a" href="R/15c62a685016d29a.html" target="n" data-glyph="75,1" class="t constructor">EllipticCurveKeyVerifierBase</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r134 rd" class="r134 r">kty</span> ) : <a href="#801a395a36fd2c8a" class="k">base</a>( <span class="r134 r">kty</span> )
        {
        }
 
        <b>public override bool</b> <a id="944c9a1d4af6f90a" href="R/944c9a1d4af6f90a.html" target="n" data-glyph="102,1" class="i property">IsPublicKeyCrypto</a> =&gt; <b>true</b>;
        <b>public override bool</b> <a id="f5c4b0d82c9c0a6c" href="R/f5c4b0d82c9c0a6c.html" target="n" data-glyph="102,1" class="i property">IsSymmetricKeyCrypto</a> =&gt; <b>false</b>;
 
        <b>protected override void</b> <a id="27030623bb0dfe3b" href="R/27030623bb0dfe3b.html" target="n" data-glyph="75,1" class="i method">AddCompatibleOperations</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r135 rd" class="r135 r">compatibleOperations</span> )
        {
            <span class="r135 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#dfad66299196683a" class="i field">Sign</a> );
            <span class="r135 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#caef56d617f788b0" class="i field">Verify</a> );
        }
 
        <b>protected override void</b> <a id="0da9d84517710cd4" href="R/0da9d84517710cd4.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r136 rd" class="r136 r">usedProperties</span> )
        {
            <span class="r136 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#864ee2a94713c0c3" class="i field">Property_Crv</a> );
            <span class="r136 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#0f34139924a692a4" class="i field">Property_X</a> );
            <span class="r136 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#d2787473e2b73357" class="i field">Property_Y</a> );
        }
 
        <b>public override bool</b> <a id="1503dfa8ee627745" href="R/1503dfa8ee627745.html" target="n" data-glyph="72,1" class="i method">IsPublicKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r137 rd" class="r137 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r138 rd" class="r138 r">missingProps</span> )
        {
            <a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r139 rd" class="r139 r">result</span> = <b>true</b>;
 
            <b>if</b> ( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>( <span class="r137 r">webKey</span>.<a href="JsonWebKey.cs.html#9cf03f581bcca3f1" class="i property">CurveName</a> ) )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r138 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#864ee2a94713c0c3" class="i field">Property_Crv</a> );
                <span class="r139 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r137 r">webKey</span>.<a href="JsonWebKey.cs.html#3087694fafdb835b" class="i property">X</a> == <b>null</b> || <span class="r137 r">webKey</span>.<a href="JsonWebKey.cs.html#3087694fafdb835b" class="i property">X</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r138 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#0f34139924a692a4" class="i field">Property_X</a> );
                <span class="r139 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r137 r">webKey</span>.<a href="JsonWebKey.cs.html#16ff122891b4ddee" class="i property">Y</a> == <b>null</b> || <span class="r137 r">webKey</span>.<a href="JsonWebKey.cs.html#16ff122891b4ddee" class="i property">Y</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r138 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#d2787473e2b73357" class="i field">Property_Y</a> );
                <span class="r139 r">result</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r139 r">result</span>;
        }
 
        <b>public override bool</b> <a id="eaa75f51f0524211" href="R/eaa75f51f0524211.html" target="n" data-glyph="72,1" class="i method">IsPublicKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r140 rd" class="r140 r">webKey</span>, <b>ref string</b> <span id="r141 rd" class="r141 r">errorMsg</span> )
        {
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r142 rd" class="r142 r">requiredSize</span> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#8531d282f59980ef" class="i method">GetKeyParameterSize</a>( <span class="r140 r">webKey</span>.<a href="JsonWebKey.cs.html#9cf03f581bcca3f1" class="i property">CurveName</a> );
 
            <b>if</b> ( <span class="r142 r">requiredSize</span> &lt; 0 )
            {
                <span class="r141 r">errorMsg</span> = <span class="s">$&quot;</span><span class="s">Unsupported curve: \&quot;</span>{<span class="r140 r">webKey</span>.<a href="JsonWebKey.cs.html#9cf03f581bcca3f1" class="i property">CurveName</a>}<span class="s">\&quot;. Supported curves are: </span>{<a href="#b475cd1bb3489966" class="i method">SurroundWithQuotes</a>( <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#cde9af484cc76a1e" class="i property">AllCurves</a> )}<span class="s">.</span><span class="s">&quot;</span>;
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> ( !<a href="#73add10f5297e945" class="i method">ValidateKeyParameterSize</a>( <span class="r140 r">webKey</span>.<a href="JsonWebKey.cs.html#3087694fafdb835b" class="i property">X</a>, <b>nameof</b>( <span class="r140 r">webKey</span>.<a href="JsonWebKey.cs.html#3087694fafdb835b" class="i property">X</a> ), <span class="r142 r">requiredSize</span>, <b>ref</b> <span class="r141 r">errorMsg</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#73add10f5297e945" class="i method">ValidateKeyParameterSize</a>( <span class="r140 r">webKey</span>.<a href="JsonWebKey.cs.html#16ff122891b4ddee" class="i property">Y</a>, <b>nameof</b>( <span class="r140 r">webKey</span>.<a href="JsonWebKey.cs.html#16ff122891b4ddee" class="i property">Y</a> ), <span class="r142 r">requiredSize</span>, <b>ref</b> <span class="r141 r">errorMsg</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
    }
 
    <b>internal sealed class</b> <a id="d83c603ac214b00b" href="R/d83c603ac214b00b.html" target="n" data-glyph="2,0" class="t t">EllipticCurveKeyVerifier</a> : <a href="#6c6b874b162ce007" class="t t">EllipticCurveKeyVerifierBase</a>
    {
        <b>public static</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <a id="3093a615b09cb17a" href="R/3093a615b09cb17a.html" target="n" data-glyph="102,1" class="i property">Instance</a> { <b>get</b>; } = <b>new</b> <a href="#b4b414d7631353df" class="t constructor">EllipticCurveKeyVerifier</a>();
 
        <b>private</b> <a id="b4b414d7631353df" href="R/b4b414d7631353df.html" target="n" data-glyph="76,1" class="t constructor">EllipticCurveKeyVerifier</a>() : <a href="#15c62a685016d29a" class="k">base</a>( <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#8ec62d93b4c095ea" class="i field">EllipticCurve</a> )
        {
        }
 
        <b>public override bool</b> <a id="d483d77df85d615b" href="R/d483d77df85d615b.html" target="n" data-glyph="102,1" class="i property">HasSecretKey</a> =&gt; <b>false</b>;
 
        <b>protected override void</b> <a id="2410385250715b6b" href="R/2410385250715b6b.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r143 rd" class="r143 r">usedProperties</span> )
        {
            <a href="#6c6b874b162ce007" class="k">base</a>.<a href="#0da9d84517710cd4" class="i method">AddUsedProperties</a>( <span class="r143 r">usedProperties</span> );
            <span class="r143 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#7fc2aed8a5ac2411" class="i field">Property_D</a> );
        }
 
        <b>public override bool</b> <a id="4e43c0d3d73ea125" href="R/4e43c0d3d73ea125.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r144 rd" class="r144 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r145 rd" class="r145 r">missingProps</span> )
        {
            <b>if</b> ( <span class="r144 r">webKey</span>.<a href="JsonWebKey.cs.html#e36618c05b815e77" class="i property">D</a> == <b>null</b> || <span class="r144 r">webKey</span>.<a href="JsonWebKey.cs.html#e36618c05b815e77" class="i property">D</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r145 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#7fc2aed8a5ac2411" class="i field">Property_D</a> );
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="9fea7f39fa893f4b" href="R/9fea7f39fa893f4b.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r146 rd" class="r146 r">webKey</span>, <b>ref string</b> <span id="r147 rd" class="r147 r">errorMsg</span> )
        {
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r148 rd" class="r148 r">requiredSize</span> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#8531d282f59980ef" class="i method">GetKeyParameterSize</a>( <span class="r146 r">webKey</span>.<a href="JsonWebKey.cs.html#9cf03f581bcca3f1" class="i property">CurveName</a> );
 
            <b>if</b> ( <span class="r148 r">requiredSize</span> &lt; 0 )
            {
                <span class="r147 r">errorMsg</span> = <span class="s">$&quot;</span><span class="s">Unsupported curve: \&quot;</span>{<span class="r146 r">webKey</span>.<a href="JsonWebKey.cs.html#9cf03f581bcca3f1" class="i property">CurveName</a>}<span class="s">\&quot;. Supported curves are: </span>{<a href="#b475cd1bb3489966" class="i method">SurroundWithQuotes</a>( <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#cde9af484cc76a1e" class="i property">AllCurves</a> )}<span class="s">.</span><span class="s">&quot;</span>;
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> ( !<a href="#73add10f5297e945" class="i method">ValidateKeyParameterSize</a>( <span class="r146 r">webKey</span>.<a href="JsonWebKey.cs.html#e36618c05b815e77" class="i property">D</a>, <b>nameof</b>( <span class="r146 r">webKey</span>.<a href="JsonWebKey.cs.html#e36618c05b815e77" class="i property">D</a> ), <span class="r148 r">requiredSize</span>, <b>ref</b> <span class="r147 r">errorMsg</span> ) )
                <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
    }
 
    <b>internal sealed class</b> <a id="a2036279fd4c0f26" href="R/a2036279fd4c0f26.html" target="n" data-glyph="2,0" class="t t">EllipticCurveHsmKeyVerifier</a> : <a href="#6c6b874b162ce007" class="t t">EllipticCurveKeyVerifierBase</a>
    {
        <b>public static</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <a id="388eca60df94f701" href="R/388eca60df94f701.html" target="n" data-glyph="102,1" class="i property">Instance</a> { <b>get</b>; } = <b>new</b> <a href="#68cb663ee41ee28b" class="t constructor">EllipticCurveHsmKeyVerifier</a>();
 
        <b>private</b> <a id="68cb663ee41ee28b" href="R/68cb663ee41ee28b.html" target="n" data-glyph="76,1" class="t constructor">EllipticCurveHsmKeyVerifier</a>() : <a href="#15c62a685016d29a" class="k">base</a>( <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#55119789cad072b9" class="i field">EllipticCurveHsm</a> )
        {
        }
 
        <b>public override bool</b> <a id="997e85e18a1b1752" href="R/997e85e18a1b1752.html" target="n" data-glyph="102,1" class="i property">HasSecretKey</a> =&gt; <b>true</b>;
 
        <b>protected override void</b> <a id="18c8a7bc025200cb" href="R/18c8a7bc025200cb.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r149 rd" class="r149 r">usedProperties</span> )
        {
            <a href="#6c6b874b162ce007" class="k">base</a>.<a href="#0da9d84517710cd4" class="i method">AddUsedProperties</a>( <span class="r149 r">usedProperties</span> );
            <span class="r149 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#362d7ff46280bcc0" class="i field">Property_T</a> );
        }
 
        <b>public override bool</b> <a id="f71b5744f16fa5d7" href="R/f71b5744f16fa5d7.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r150 rd" class="r150 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r151 rd" class="r151 r">missingProps</span> )
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="5ad59a4fdc1497f3" href="R/5ad59a4fdc1497f3.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r152 rd" class="r152 r">webKey</span>, <b>ref string</b> <span id="r153 rd" class="r153 r">errorMsg</span> )
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="84ef4f7e3d7196fb" href="R/84ef4f7e3d7196fb.html" target="n" data-glyph="72,1" class="i method">IsSecretKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r154 rd" class="r154 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r155 rd" class="r155 r">missingProps</span> )
        {
            <b>if</b> ( <span class="r154 r">webKey</span>.<a href="JsonWebKey.cs.html#849f90102ea84e9c" class="i property">T</a> == <b>null</b> || <span class="r154 r">webKey</span>.<a href="JsonWebKey.cs.html#849f90102ea84e9c" class="i property">T</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r155 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#362d7ff46280bcc0" class="i field">Property_T</a> );
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="70f258b2d7f92d78" href="R/70f258b2d7f92d78.html" target="n" data-glyph="72,1" class="i method">IsSecretKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r156 rd" class="r156 r">webKey</span>, <b>ref string</b> <span id="r157 rd" class="r157 r">errorMsg</span> )
        {
            <b>return</b> <b>true</b>;
        }
    }
 
    <b>internal abstract class</b> <a id="edc2ddab1a5c8ed9" href="R/edc2ddab1a5c8ed9.html" target="n" data-glyph="2,0" class="t t">RsaKeyVerifierBase</a> : <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>
    {
        <b>protected</b> <a id="5ac1f2af0767035e" href="R/5ac1f2af0767035e.html" target="n" data-glyph="75,1" class="t constructor">RsaKeyVerifierBase</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r158 rd" class="r158 r">kty</span> ) : <a href="#801a395a36fd2c8a" class="k">base</a>( <span class="r158 r">kty</span> )
        {
        }
 
        <b>public override bool</b> <a id="2d7cd35cf839bed0" href="R/2d7cd35cf839bed0.html" target="n" data-glyph="102,1" class="i property">IsPublicKeyCrypto</a> =&gt; <b>true</b>;
        <b>public override bool</b> <a id="9e28677819535707" href="R/9e28677819535707.html" target="n" data-glyph="102,1" class="i property">IsSymmetricKeyCrypto</a> =&gt; <b>false</b>;
 
        <b>protected override void</b> <a id="77f1ed14b8e38385" href="R/77f1ed14b8e38385.html" target="n" data-glyph="75,1" class="i method">AddCompatibleOperations</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r159 rd" class="r159 r">compatibleOperations</span> )
        {
            <span class="r159 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#0ad2e310a327bc4e" class="i field">Encrypt</a> );
            <span class="r159 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#f832ee804afdf570" class="i field">Decrypt</a> );
            <span class="r159 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#d4d21c6a56aded5e" class="i field">Wrap</a> );
            <span class="r159 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#aee4eb84be49afde" class="i field">Unwrap</a> );
            <span class="r159 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#dfad66299196683a" class="i field">Sign</a> );
            <span class="r159 r">compatibleOperations</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKeyOperations.cs.html#b9f5c67cab5ac556" class="t t">JsonWebKeyOperation</a>.<a href="JsonWebKeyOperations.cs.html#caef56d617f788b0" class="i field">Verify</a> );
        }
 
        <b>protected override void</b> <a id="ffda5a764a99d94a" href="R/ffda5a764a99d94a.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r160 rd" class="r160 r">usedProperties</span> )
        {
            <span class="r160 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#31f5c82686642d09" class="i field">Property_E</a> );
            <span class="r160 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#f823a96150567f92" class="i field">Property_N</a> );
        }
 
        <b>public override bool</b> <a id="3551338385e492fe" href="R/3551338385e492fe.html" target="n" data-glyph="72,1" class="i method">IsPublicKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r161 rd" class="r161 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r162 rd" class="r162 r">missingProps</span> )
        {
            <a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r163 rd" class="r163 r">result</span> = <b>true</b>;
 
            <b>if</b> ( <span class="r161 r">webKey</span>.<a href="JsonWebKey.cs.html#12108e7b667ecd5e" class="i property">E</a> == <b>null</b> || <span class="r161 r">webKey</span>.<a href="JsonWebKey.cs.html#12108e7b667ecd5e" class="i property">E</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r162 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#31f5c82686642d09" class="i field">Property_E</a> );
                <span class="r163 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r161 r">webKey</span>.<a href="JsonWebKey.cs.html#c852bc6e5241eab3" class="i property">N</a> == <b>null</b> || <span class="r161 r">webKey</span>.<a href="JsonWebKey.cs.html#c852bc6e5241eab3" class="i property">N</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r162 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#f823a96150567f92" class="i field">Property_N</a> );
                <span class="r163 r">result</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r163 r">result</span>;
        }
 
        <b>public override bool</b> <a id="0de18ee9942e16ba" href="R/0de18ee9942e16ba.html" target="n" data-glyph="72,1" class="i method">IsPublicKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r164 rd" class="r164 r">webKey</span>, <b>ref string</b> <span id="r165 rd" class="r165 r">errorMsg</span> )
        {
            <b>return</b> <b>true</b>;
        }
    }
 
    <b>internal sealed class</b> <a id="23bb0515995723cc" href="R/23bb0515995723cc.html" target="n" data-glyph="2,0" class="t t">RsaKeyVerifier</a> : <a href="#edc2ddab1a5c8ed9" class="t t">RsaKeyVerifierBase</a>
    {
        <b>public static</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <a id="8f03854b1c5f4bac" href="R/8f03854b1c5f4bac.html" target="n" data-glyph="102,1" class="i property">Instance</a> { <b>get</b>; } = <b>new</b> <a href="#8ab7a7c2645e22e6" class="t constructor">RsaKeyVerifier</a>();
 
        <b>private</b> <a id="8ab7a7c2645e22e6" href="R/8ab7a7c2645e22e6.html" target="n" data-glyph="76,1" class="t constructor">RsaKeyVerifier</a>() : <a href="#5ac1f2af0767035e" class="k">base</a>( <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#cc9d39c080719cc8" class="i field">Rsa</a> )
        {
        }
 
        <b>public override bool</b> <a id="66f2f8a1d5a0aafa" href="R/66f2f8a1d5a0aafa.html" target="n" data-glyph="102,1" class="i property">HasSecretKey</a> =&gt; <b>false</b>;
 
        <b>protected override void</b> <a id="91898c1dab16b3ee" href="R/91898c1dab16b3ee.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r166 rd" class="r166 r">usedProperties</span> )
        {
            <a href="#edc2ddab1a5c8ed9" class="k">base</a>.<a href="#ffda5a764a99d94a" class="i method">AddUsedProperties</a>( <span class="r166 r">usedProperties</span> );
            <span class="r166 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#7fc2aed8a5ac2411" class="i field">Property_D</a> );
            <span class="r166 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#171f792c3767d289" class="i field">Property_DP</a> );
            <span class="r166 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#e082d689f73de895" class="i field">Property_DQ</a> );
            <span class="r166 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#b4304fdea09b63b3" class="i field">Property_P</a> );
            <span class="r166 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#1f1451dc3faff063" class="i field">Property_Q</a> );
            <span class="r166 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#b7cb39faf60c7ba0" class="i field">Property_QI</a> );
        }
 
        <b>public override bool</b> <a id="af073e1b0ca5631f" href="R/af073e1b0ca5631f.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r167 rd" class="r167 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r168 rd" class="r168 r">missingProps</span> )
        {
            <a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r169 rd" class="r169 r">result</span> = <b>true</b>;
 
            <b>if</b> ( <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#e36618c05b815e77" class="i property">D</a> == <b>null</b> || <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#e36618c05b815e77" class="i property">D</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r168 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#7fc2aed8a5ac2411" class="i field">Property_D</a> );
                <span class="r169 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#ee12900e829c9da2" class="i property">DP</a> == <b>null</b> || <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#ee12900e829c9da2" class="i property">DP</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r168 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#171f792c3767d289" class="i field">Property_DP</a> );
                <span class="r169 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#65719c489919d919" class="i property">DQ</a> == <b>null</b> || <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#65719c489919d919" class="i property">DQ</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r168 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#e082d689f73de895" class="i field">Property_DQ</a> );
                <span class="r169 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#b18a4697a345d9b6" class="i property">P</a> == <b>null</b> || <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#b18a4697a345d9b6" class="i property">P</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r168 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#b4304fdea09b63b3" class="i field">Property_P</a> );
                <span class="r169 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#88d5be9b58de3cd9" class="i property">Q</a> == <b>null</b> || <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#88d5be9b58de3cd9" class="i property">Q</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r168 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#1f1451dc3faff063" class="i field">Property_Q</a> );
                <span class="r169 r">result</span> = <b>false</b>;
            }
 
            <b>if</b> ( <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#9094a77b302e79bc" class="i property">QI</a> == <b>null</b> || <span class="r167 r">webKey</span>.<a href="JsonWebKey.cs.html#9094a77b302e79bc" class="i property">QI</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r168 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#b7cb39faf60c7ba0" class="i field">Property_QI</a> );
                <span class="r169 r">result</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r169 r">result</span>;
        }
 
        <b>public override bool</b> <a id="3f5547462c148af0" href="R/3f5547462c148af0.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r170 rd" class="r170 r">webKey</span>, <b>ref string</b> <span id="r171 rd" class="r171 r">errorMsg</span> )
        {
            <b>return</b> <b>true</b>;
        }
    }
 
    <b>internal sealed class</b> <a id="e1ef8d9631597f46" href="R/e1ef8d9631597f46.html" target="n" data-glyph="2,0" class="t t">RsaHsmKeyVerifier</a> : <a href="#edc2ddab1a5c8ed9" class="t t">RsaKeyVerifierBase</a>
    {
        <b>public static</b> <a href="#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a> <a id="8b9eb7aaa0d42b41" href="R/8b9eb7aaa0d42b41.html" target="n" data-glyph="102,1" class="i property">Instance</a> { <b>get</b>; } = <b>new</b> <a href="#756c79eb81624e35" class="t constructor">RsaHsmKeyVerifier</a>();
 
        <b>private</b> <a id="756c79eb81624e35" href="R/756c79eb81624e35.html" target="n" data-glyph="76,1" class="t constructor">RsaHsmKeyVerifier</a>() : <a href="#5ac1f2af0767035e" class="k">base</a>( <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#d474964d1d7a4763" class="i field">RsaHsm</a> )
        {
        }
 
        <b>public override bool</b> <a id="6fb915879c45be00" href="R/6fb915879c45be00.html" target="n" data-glyph="102,1" class="i property">HasSecretKey</a> =&gt; <b>true</b>;
 
        <b>protected override void</b> <a id="e1fe535b60d4758d" href="R/e1fe535b60d4758d.html" target="n" data-glyph="75,1" class="i method">AddUsedProperties</a>( <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r172 rd" class="r172 r">usedProperties</span> )
        {
            <a href="#edc2ddab1a5c8ed9" class="k">base</a>.<a href="#ffda5a764a99d94a" class="i method">AddUsedProperties</a>( <span class="r172 r">usedProperties</span> );
            <span class="r172 r">usedProperties</span>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#362d7ff46280bcc0" class="i field">Property_T</a> );
        }
 
        <b>public override bool</b> <a id="1b4db3b0a535eb0a" href="R/1b4db3b0a535eb0a.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r173 rd" class="r173 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r174 rd" class="r174 r">missingProps</span> )
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="c094dcfa37c76c7c" href="R/c094dcfa37c76c7c.html" target="n" data-glyph="72,1" class="i method">IsPrivateKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r175 rd" class="r175 r">webKey</span>, <b>ref string</b> <span id="r176 rd" class="r176 r">errorMsg</span> )
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="a28e0d378a001e6d" href="R/a28e0d378a001e6d.html" target="n" data-glyph="72,1" class="i method">IsSecretKeyComplete</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r177 rd" class="r177 r">webKey</span>, <b>ref</b> <a href="@0@mscorlib/A.html#a9bf1395d3addc77" class="t t">ICollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r178 rd" class="r178 r">missingProps</span> )
        {
            <b>if</b> ( <span class="r177 r">webKey</span>.<a href="JsonWebKey.cs.html#849f90102ea84e9c" class="i property">T</a> == <b>null</b> || <span class="r177 r">webKey</span>.<a href="JsonWebKey.cs.html#849f90102ea84e9c" class="i property">T</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
            {
                <a href="#1fa219a1a8479413" class="i method">AddItem</a>( <b>ref</b> <span class="r178 r">missingProps</span>, <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a>.<a href="JsonWebKey.cs.html#362d7ff46280bcc0" class="i field">Property_T</a> );
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public override bool</b> <a id="24ee5f652caa0f4d" href="R/24ee5f652caa0f4d.html" target="n" data-glyph="72,1" class="i method">IsSecretKeyValid</a>( <a href="JsonWebKey.cs.html#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r179 rd" class="r179 r">webKey</span>, <b>ref string</b> <span id="r180 rd" class="r180 r">errorMsg</span> )
        {
            <b>return</b> <b>true</b>;
        }
    }
}</pre></td></tr></table></div></body></html>
