<!DOCTYPE html>
<html><head><title>JsonWebKey.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(757);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.KeyVault.WebKey/JsonWebKey.cs" target="_top">JsonWebKey.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.KeyVault.WebKey" target="_top">Microsoft.Azure.KeyVault.WebKey\src\Microsoft.Azure.KeyVault.WebKey.csproj</a> (Microsoft.Azure.KeyVault.WebKey)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for</span>
<span class="c">// license information.</span>
<span class="c">// </span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Security</span>.<span class="i n">Cryptography</span>;
<b>using</b> <span class="i">Newtonsoft</span>.<span class="i">Json</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">KeyVault</span>.<span class="i n">WebKey</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> As of http://tools.ietf.org/html/draft-ietf-jose-json-web-key-18</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">JsonObject</span>]
    <b>public sealed class</b> <a id="072f5b35a8ee35c6" href="R/072f5b35a8ee35c6.html" target="n" data-glyph="0,0" class="t t">JsonWebKey</a>
    {
        <span class="c">// DataContract property names</span>
        <b>internal const string</b> <a id="36858ce6958e4bba" href="R/36858ce6958e4bba.html" target="n" data-glyph="8,1" class="i field">Property_Kid</a> = <span class="s">&quot;kid&quot;</span>;
 
        <b>internal const string</b> <a id="4e8418ebe072d1ae" href="R/4e8418ebe072d1ae.html" target="n" data-glyph="8,1" class="i field">Property_Kty</a> = <span class="s">&quot;kty&quot;</span>;
        <b>internal const string</b> <a id="ef92d89a1d6ca577" href="R/ef92d89a1d6ca577.html" target="n" data-glyph="8,1" class="i field">Property_KeyOps</a> = <span class="s">&quot;key_ops&quot;</span>;
 
        <span class="c">// RSA Key Property Names</span>
        <b>internal const string</b> <a id="7fc2aed8a5ac2411" href="R/7fc2aed8a5ac2411.html" target="n" data-glyph="8,1" class="i field">Property_D</a> = <span class="s">&quot;d&quot;</span>;
 
        <b>internal const string</b> <a id="171f792c3767d289" href="R/171f792c3767d289.html" target="n" data-glyph="8,1" class="i field">Property_DP</a> = <span class="s">&quot;dp&quot;</span>;
        <b>internal const string</b> <a id="e082d689f73de895" href="R/e082d689f73de895.html" target="n" data-glyph="8,1" class="i field">Property_DQ</a> = <span class="s">&quot;dq&quot;</span>;
        <b>internal const string</b> <a id="31f5c82686642d09" href="R/31f5c82686642d09.html" target="n" data-glyph="8,1" class="i field">Property_E</a> = <span class="s">&quot;e&quot;</span>;
        <b>internal const string</b> <a id="b7cb39faf60c7ba0" href="R/b7cb39faf60c7ba0.html" target="n" data-glyph="8,1" class="i field">Property_QI</a> = <span class="s">&quot;qi&quot;</span>;
        <b>internal const string</b> <a id="f823a96150567f92" href="R/f823a96150567f92.html" target="n" data-glyph="8,1" class="i field">Property_N</a> = <span class="s">&quot;n&quot;</span>;
        <b>internal const string</b> <a id="b4304fdea09b63b3" href="R/b4304fdea09b63b3.html" target="n" data-glyph="8,1" class="i field">Property_P</a> = <span class="s">&quot;p&quot;</span>;
        <b>internal const string</b> <a id="1f1451dc3faff063" href="R/1f1451dc3faff063.html" target="n" data-glyph="8,1" class="i field">Property_Q</a> = <span class="s">&quot;q&quot;</span>;
 
        <span class="c">// ECC Key Property Names</span>
        <b>internal const string</b> <a id="864ee2a94713c0c3" href="R/864ee2a94713c0c3.html" target="n" data-glyph="8,1" class="i field">Property_Crv</a> = <span class="s">&quot;crv&quot;</span>;
 
        <b>internal const string</b> <a id="0f34139924a692a4" href="R/0f34139924a692a4.html" target="n" data-glyph="8,1" class="i field">Property_X</a> = <span class="s">&quot;x&quot;</span>;
 
        <b>internal const string</b> <a id="d2787473e2b73357" href="R/d2787473e2b73357.html" target="n" data-glyph="8,1" class="i field">Property_Y</a> = <span class="s">&quot;y&quot;</span>;
        <span class="c">// Property_D the same as RSA Key</span>
 
        <span class="c">// Symmetric Key Property Names</span>
        <b>internal const string</b> <a id="aaae99cacf4df119" href="R/aaae99cacf4df119.html" target="n" data-glyph="8,1" class="i field">Property_K</a> = <span class="s">&quot;k&quot;</span>;
 
        <span class="c">// HSM Token Property Names</span>
        <b>internal const string</b> <a id="362d7ff46280bcc0" href="R/362d7ff46280bcc0.html" target="n" data-glyph="8,1" class="i field">Property_T</a> = <span class="s">&quot;key_hsm&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Key Identifier</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#36858ce6958e4bba" class="i field">Property_Kid</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        <b>public string</b> <a id="fe5560cce3efa496" href="R/fe5560cce3efa496.html" target="n" data-glyph="102,1" class="i property">Kid</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets supported JsonWebKey key types (kty) for Elliptic</span>
        <span class="c">///</span><span class="c"> Curve, RSA, HSM, Octet, usually RSA. Possible values include:</span>
        <span class="c">///</span><span class="c"> &#39;EC&#39;, &#39;RSA&#39;, &#39;RSA-HSM&#39;, &#39;oct&#39;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#4e8418ebe072d1ae" class="i field">Property_Kty</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Always</span> )]
        <b>public string</b> <a id="bf5694ab09c369fd" href="R/bf5694ab09c369fd.html" target="n" data-glyph="102,1" class="i property">Kty</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Supported Key Operations</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#ef92d89a1d6ca577" class="i field">Property_KeyOps</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        <b>public</b> <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="6c108e193a5974bc" href="R/6c108e193a5974bc.html" target="n" data-glyph="102,1" class="i property">KeyOps</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> RSA Public Key Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA modulus, in Base64.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#f823a96150567f92" class="i field">Property_N</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="c852bc6e5241eab3" href="R/c852bc6e5241eab3.html" target="n" data-glyph="102,1" class="i property">N</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA public exponent, in Base64.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#31f5c82686642d09" class="i field">Property_E</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="12108e7b667ecd5e" href="R/12108e7b667ecd5e.html" target="n" data-glyph="102,1" class="i property">E</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> RSA Private Key Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA Private Key Parameter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#171f792c3767d289" class="i field">Property_DP</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="ee12900e829c9da2" href="R/ee12900e829c9da2.html" target="n" data-glyph="102,1" class="i property">DP</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA Private Key Parameter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#e082d689f73de895" class="i field">Property_DQ</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="65719c489919d919" href="R/65719c489919d919.html" target="n" data-glyph="102,1" class="i property">DQ</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA Private Key Parameter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#b7cb39faf60c7ba0" class="i field">Property_QI</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="9094a77b302e79bc" href="R/9094a77b302e79bc.html" target="n" data-glyph="102,1" class="i property">QI</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA secret prime</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#b4304fdea09b63b3" class="i field">Property_P</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="b18a4697a345d9b6" href="R/b18a4697a345d9b6.html" target="n" data-glyph="102,1" class="i property">P</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA secret prime, with p </span><span class="c">&amp;lt;</span><span class="c"> q</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#1f1451dc3faff063" class="i field">Property_Q</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="88d5be9b58de3cd9" href="R/88d5be9b58de3cd9.html" target="n" data-glyph="102,1" class="i property">Q</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> EC Public Key Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The curve for Elliptic Curve Cryptography (ECC) algorithms</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#864ee2a94713c0c3" class="i field">Property_Crv</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        <b>public string</b> <a id="9cf03f581bcca3f1" href="R/9cf03f581bcca3f1.html" target="n" data-glyph="102,1" class="i property">CurveName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> X coordinate for the Elliptic Curve point.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#0f34139924a692a4" class="i field">Property_X</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="3087694fafdb835b" href="R/3087694fafdb835b.html" target="n" data-glyph="102,1" class="i property">X</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Y coordinate for the Elliptic Curve point.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#d2787473e2b73357" class="i field">Property_Y</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="16ff122891b4ddee" href="R/16ff122891b4ddee.html" target="n" data-glyph="102,1" class="i property">Y</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> EC and RSA Private Key Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RSA private exponent or ECC private key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#7fc2aed8a5ac2411" class="i field">Property_D</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="e36618c05b815e77" href="R/e36618c05b815e77.html" target="n" data-glyph="102,1" class="i property">D</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Symmetric Key Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Symmetric key</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#aaae99cacf4df119" class="i field">Property_K</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="20ddcb570f4681b4" href="R/20ddcb570f4681b4.html" target="n" data-glyph="102,1" class="i property">K</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> HSM Token, used with &quot;Bring Your Own Key&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonProperty</span>( <span class="i">DefaultValueHandling</span> = <span class="i">DefaultValueHandling</span>.<span class="i">Ignore</span>, <span class="i">NullValueHandling</span> = <span class="i">NullValueHandling</span>.<span class="i">Ignore</span>, <span class="i">PropertyName</span> = <a href="#362d7ff46280bcc0" class="i field">Property_T</a>, <span class="i">Required</span> = <span class="i">Required</span>.<span class="i">Default</span> )]
        [<span class="i">JsonConverter</span>( <b>typeof</b>( <a href="Base64UrlJsonConverter.cs.html#57ae6be32a86c457" class="t t">Base64UrlJsonConverter</a> ) )]
        <b>public byte</b>[] <a id="849f90102ea84e9c" href="R/849f90102ea84e9c.html" target="n" data-glyph="102,1" class="i property">T</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Holds properties that are not part of current schema.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonExtensionData</span>]
        <b>public</b> <a href="@0@mscorlib/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <a id="64759c8012133d30" href="R/64759c8012133d30.html" target="n" data-glyph="42,1" class="i field">ExtensionData</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Iterates over all JSON properties of this object, calling the specified visitor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All JSON properties are visited. This includes normal properties, properties that are not useful for the</span>
        <span class="c">///</span><span class="c"> key type, and properties that are not part of current schema (extension data).</span>
        <span class="c">///</span><span class="c"> Users must assume the properties are visited in random order.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">visitor</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A visitor that will be called for each property.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="9b603d03d75b226c" href="R/9b603d03d75b226c.html" target="n" data-glyph="72,1" class="i method">VisitProperties</a>( <a href="@0@mscorlib/A.html#27863de72c2c9b49" class="t t">Action</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <span id="r0 rd" class="r0 r">visitor</span> )
        {
            <b>if</b> ( <span class="r0 r">visitor</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <b>nameof</b>( <span class="r0 r">visitor</span> ) );
 
            <span class="r0 r">visitor</span>( <a href="#864ee2a94713c0c3" class="i field">Property_Crv</a>, <a href="#9cf03f581bcca3f1" class="i property">CurveName</a> );
            <span class="r0 r">visitor</span>( <a href="#7fc2aed8a5ac2411" class="i field">Property_D</a>, <a href="#e36618c05b815e77" class="i property">D</a> );
            <span class="r0 r">visitor</span>( <a href="#171f792c3767d289" class="i field">Property_DP</a>, <a href="#ee12900e829c9da2" class="i property">DP</a> );
            <span class="r0 r">visitor</span>( <a href="#e082d689f73de895" class="i field">Property_DQ</a>, <a href="#65719c489919d919" class="i property">DQ</a> );
            <span class="r0 r">visitor</span>( <a href="#31f5c82686642d09" class="i field">Property_E</a>, <a href="#12108e7b667ecd5e" class="i property">E</a> );
            <span class="r0 r">visitor</span>( <a href="#aaae99cacf4df119" class="i field">Property_K</a>, <a href="#20ddcb570f4681b4" class="i property">K</a> );
            <span class="r0 r">visitor</span>( <a href="#ef92d89a1d6ca577" class="i field">Property_KeyOps</a>, <a href="#6c108e193a5974bc" class="i property">KeyOps</a> );
            <span class="r0 r">visitor</span>( <a href="#36858ce6958e4bba" class="i field">Property_Kid</a>, <a href="#fe5560cce3efa496" class="i property">Kid</a> );
            <span class="r0 r">visitor</span>( <a href="#4e8418ebe072d1ae" class="i field">Property_Kty</a>, <a href="#bf5694ab09c369fd" class="i property">Kty</a> );
            <span class="r0 r">visitor</span>( <a href="#f823a96150567f92" class="i field">Property_N</a>, <a href="#c852bc6e5241eab3" class="i property">N</a> );
            <span class="r0 r">visitor</span>( <a href="#b4304fdea09b63b3" class="i field">Property_P</a>, <a href="#b18a4697a345d9b6" class="i property">P</a> );
            <span class="r0 r">visitor</span>( <a href="#1f1451dc3faff063" class="i field">Property_Q</a>, <a href="#88d5be9b58de3cd9" class="i property">Q</a> );
            <span class="r0 r">visitor</span>( <a href="#362d7ff46280bcc0" class="i field">Property_T</a>, <a href="#849f90102ea84e9c" class="i property">T</a> );
            <span class="r0 r">visitor</span>( <a href="#0f34139924a692a4" class="i field">Property_X</a>, <a href="#3087694fafdb835b" class="i property">X</a> );
            <span class="r0 r">visitor</span>( <a href="#d2787473e2b73357" class="i field">Property_Y</a>, <a href="#16ff122891b4ddee" class="i property">Y</a> );
 
            <b>if</b> ( <a href="#64759c8012133d30" class="i field">ExtensionData</a> != <b>null</b> )
                <b>foreach</b> ( <a href="@0@mscorlib/A.html#8585965bb176a426" class="k">var</a> <span id="r1 rd" class="r1 r">entry</span> <b>in</b> <a href="#64759c8012133d30" class="i field">ExtensionData</a> )
                    <span class="r0 r">visitor</span>( <span class="r1 r">entry</span>.<a href="@0@mscorlib/A.html#f9d1c04feb1af032" class="i property">Key</a>, <span class="r1 r">entry</span>.<a href="@0@mscorlib/A.html#38c0e86cc4b30170" class="i property">Value</a> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">JsonConstructor</span>]
        <b>public</b> <a id="7e44e4e1a4778cc9" href="R/7e44e4e1a4778cc9.html" target="n" data-glyph="72,1" class="t constructor">JsonWebKey</a>()
        {
            <span class="c">// Intentionally empty</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts an AES object to a WebKey of type Octet</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">aesProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="dbdbb452464448ae" href="R/dbdbb452464448ae.html" target="n" data-glyph="72,1" class="t constructor">JsonWebKey</a>( <a href="@0@mscorlib/A.html#ddb5f33f82818174" class="t t">Aes</a> <span id="r2 rd" class="r2 r">aesProvider</span> )
        {
            <b>if</b> ( <span class="r2 r">aesProvider</span> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>( <span class="s">&quot;aesProvider&quot;</span> );
 
            <a href="#bf5694ab09c369fd" class="i property">Kty</a> = <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#0db095c52fbd796e" class="i field">Octet</a>;
            <a href="#20ddcb570f4681b4" class="i property">K</a> = <span class="r2 r">aesProvider</span>.<a href="@0@mscorlib/A.html#d12a38c78f5c3174" class="i property">Key</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance with the key provided by the ECDsa object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">ecsda</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ECDsa object previously initialized with the desired key.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">includePrivateParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Tells if the instance must inclue private parameters.</span>
        <span class="c">///</span><span class="c"> This requires the key in the ECDsa object to include private material and be marked as exportable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="ca9cc4d8b3fc8a31" href="R/ca9cc4d8b3fc8a31.html" target="n" data-glyph="72,1" class="t constructor">JsonWebKey</a>(<a href="@0@System.Core/A.html#59084d68c76f225c" class="t t">ECDsa</a> <span id="r3 rd" class="r3 r">ecsda</span>, <b>bool</b> <span id="r4 rd" class="r4 r">includePrivateParameters</span> = <b>false</b> )
            : <a href="#bd1475a2a996e042" class="k">this</a>( <span class="r5 r">ecParameters</span>: <a href="EccExtension.cs.html#86ef017d3d645e53" class="t t">EccExtension</a>.<a href="EccExtension.cs.html#fa76508549d44541" class="i method">ExportParameters</a>( <span class="r3 r">ecsda</span>, <span class="r4 r">includePrivateParameters</span> ) )
        {
            <a href="#6c108e193a5974bc" class="i property">KeyOps</a> = <span class="r3 r">ecsda</span>.<a href="EccExtension.cs.html#b167fa1d4e5a15fa" class="i method">GetKeyOperations</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a ECParameters object to a WebKey of type EC.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">ecParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The EC object to convert</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A WebKey representing the EC object</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a id="bd1475a2a996e042" href="R/bd1475a2a996e042.html" target="n" data-glyph="72,1" class="t constructor">JsonWebKey</a>( <a href="ECParameters.cs.html#35603abbad105a6f" class="t t">ECParameters</a> <span id="r5 rd" class="r5 r">ecParameters</span> )
        {
            <a href="#bf5694ab09c369fd" class="i property">Kty</a> = <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#8ec62d93b4c095ea" class="i field">EllipticCurve</a>;
 
            <a href="#9cf03f581bcca3f1" class="i property">CurveName</a> = <span class="r5 r">ecParameters</span>.<a href="ECParameters.cs.html#8f8286c0e07b945f" class="i property">Curve</a>;
            <a href="#e36618c05b815e77" class="i property">D</a> = <span class="r5 r">ecParameters</span>.<a href="ECParameters.cs.html#8c8f223bb8c260ce" class="i property">D</a>;
            <a href="#3087694fafdb835b" class="i property">X</a> = <span class="r5 r">ecParameters</span>.<a href="ECParameters.cs.html#83f99d3895629ae5" class="i property">X</a>;
            <a href="#16ff122891b4ddee" class="i property">Y</a> = <span class="r5 r">ecParameters</span>.<a href="ECParameters.cs.html#0ab81a4d6208a3cc" class="i property">Y</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a RSA object to a WebKey of type RSA.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">rsaProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The RSA object to convert</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">includePrivateParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True to include the RSA private key parameters</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A WebKey representing the RSA object</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a id="b066a64626cd9815" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">JsonWebKey</a>( <a href="@0@mscorlib/A.html#9e72392556b1419c" class="t t">RSA</a> <span id="r6 rd" class="r6 r">rsaProvider</span>, <b>bool</b> <span id="r7 rd" class="r7 r">includePrivateParameters</span> = <b>false</b> ) : <a href="#4e0f3846c09e77bd" class="k">this</a>( <span class="r6 r">rsaProvider</span>.<a href="@0@mscorlib/A.html#24a0e5b7ec837b0b" class="i method">ExportParameters</a>( <span class="r7 r">includePrivateParameters</span> ) )
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a RSAParameters object to a WebKey of type RSA.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">rsaParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The RSA object to convert</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A WebKey representing the RSA object</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a id="4e0f3846c09e77bd" href="R/4e0f3846c09e77bd.html" target="n" data-glyph="72,1" class="t constructor">JsonWebKey</a>( <a href="@0@mscorlib/A.html#dfd6cfff509b13df" class="t t">RSAParameters</a> <span id="r8 rd" class="r8 r">rsaParameters</span> )
        {
            <a href="#bf5694ab09c369fd" class="i property">Kty</a> = <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#cc9d39c080719cc8" class="i field">Rsa</a>;
 
            <a href="#12108e7b667ecd5e" class="i property">E</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#91d13f36d3d02fd7" class="i field">Exponent</a>;
            <a href="#c852bc6e5241eab3" class="i property">N</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#f2621da5f160ffb5" class="i field">Modulus</a>;
 
            <a href="#e36618c05b815e77" class="i property">D</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#33f3738835659b02" class="i field">D</a>;
            <a href="#ee12900e829c9da2" class="i property">DP</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#7b8dbd3faf1d9481" class="i field">DP</a>;
            <a href="#65719c489919d919" class="i property">DQ</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#155c902ff43a9ea8" class="i field">DQ</a>;
            <a href="#9094a77b302e79bc" class="i property">QI</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#8c8c5dd0c42c705e" class="i field">InverseQ</a>;
            <a href="#b18a4697a345d9b6" class="i property">P</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#0c464c45da683f89" class="i field">P</a>;
            <a href="#88d5be9b58de3cd9" class="i property">Q</a> = <span class="r8 r">rsaParameters</span>.<a href="@0@mscorlib/A.html#e6f0eac2caa4e0c0" class="i field">Q</a>;
        }
 
        <b>public override bool</b> <a id="33f746a7681bcc7e" href="R/33f746a7681bcc7e.html" target="n" data-glyph="72,1" class="i method">Equals</a>( <b>object</b> <span id="r9 rd" class="r9 r">obj</span> )
        {
            <b>if</b> ( <span class="r9 r">obj</span> == <a href="#072f5b35a8ee35c6" class="k">this</a> )
                <b>return</b> <b>true</b>;
 
            <a href="#072f5b35a8ee35c6" class="k">var</a> <span id="r10 rd" class="r10 r">other</span> = <span class="r9 r">obj</span> <b>as</b> <a href="#072f5b35a8ee35c6" class="t t">JsonWebKey</a>;
 
            <b>if</b> ( <span class="r10 r">other</span> == <b>null</b> )
                <b>return</b> <b>false</b>;
 
            <b>return</b> <a href="#dd2022e1649e713a" class="i method">Equals</a>( <span class="r10 r">other</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compares </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> objects</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">other</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object to compare with </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c"> whether the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#072f5b35a8ee35c6" class="t t">JsonWebKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> objects are equals </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="dd2022e1649e713a" href="R/dd2022e1649e713a.html" target="n" data-glyph="72,1" class="i method">Equals</a>( <a href="#072f5b35a8ee35c6" class="t t">JsonWebKey</a> <span id="r11 rd" class="r11 r">other</span> )
        {
            <b>if</b> ( <span class="r11 r">other</span> == <a href="#072f5b35a8ee35c6" class="k">this</a> )
                <b>return</b> <b>true</b>;
 
            <b>if</b> ( <span class="r11 r">other</span> == <b>null</b> )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#372d790ddae4cbb4" class="i method">Equals</a>( <a href="#fe5560cce3efa496" class="i property">Kid</a>, <span class="r11 r">other</span>.<a href="#fe5560cce3efa496" class="i property">Kid</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#372d790ddae4cbb4" class="i method">Equals</a>( <a href="#bf5694ab09c369fd" class="i property">Kty</a>, <span class="r11 r">other</span>.<a href="#bf5694ab09c369fd" class="i property">Kty</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#3c476d305db91fae" class="i method">AreEqual</a>( <a href="#6c108e193a5974bc" class="i property">KeyOps</a>, <span class="r11 r">other</span>.<a href="#6c108e193a5974bc" class="i property">KeyOps</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#372d790ddae4cbb4" class="i method">Equals</a>( <a href="#9cf03f581bcca3f1" class="i property">CurveName</a>, <span class="r11 r">other</span>.<a href="#9cf03f581bcca3f1" class="i property">CurveName</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#20ddcb570f4681b4" class="i property">K</a>, <span class="r11 r">other</span>.<a href="#20ddcb570f4681b4" class="i property">K</a> ) )
                <b>return</b> <b>false</b>;
 
            <span class="c">// Public parameters</span>
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#c852bc6e5241eab3" class="i property">N</a>, <span class="r11 r">other</span>.<a href="#c852bc6e5241eab3" class="i property">N</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#12108e7b667ecd5e" class="i property">E</a>, <span class="r11 r">other</span>.<a href="#12108e7b667ecd5e" class="i property">E</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#3087694fafdb835b" class="i property">X</a>, <span class="r11 r">other</span>.<a href="#3087694fafdb835b" class="i property">X</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#16ff122891b4ddee" class="i property">Y</a>, <span class="r11 r">other</span>.<a href="#16ff122891b4ddee" class="i property">Y</a> ) )
                <b>return</b> <b>false</b>;
 
            <span class="c">// Private parameters</span>
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#e36618c05b815e77" class="i property">D</a>, <span class="r11 r">other</span>.<a href="#e36618c05b815e77" class="i property">D</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#ee12900e829c9da2" class="i property">DP</a>, <span class="r11 r">other</span>.<a href="#ee12900e829c9da2" class="i property">DP</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#65719c489919d919" class="i property">DQ</a>, <span class="r11 r">other</span>.<a href="#65719c489919d919" class="i property">DQ</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#9094a77b302e79bc" class="i property">QI</a>, <span class="r11 r">other</span>.<a href="#9094a77b302e79bc" class="i property">QI</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#b18a4697a345d9b6" class="i property">P</a>, <span class="r11 r">other</span>.<a href="#b18a4697a345d9b6" class="i property">P</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#88d5be9b58de3cd9" class="i property">Q</a>, <span class="r11 r">other</span>.<a href="#88d5be9b58de3cd9" class="i property">Q</a> ) )
                <b>return</b> <b>false</b>;
 
            <span class="c">// HSM token</span>
            <b>if</b> ( !<a href="#e81c59d05ea8d4ff" class="i method">AreEqual</a>( <a href="#849f90102ea84e9c" class="i property">T</a>, <span class="r11 r">other</span>.<a href="#849f90102ea84e9c" class="i property">T</a> ) )
                <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="e81c59d05ea8d4ff" href="R/e81c59d05ea8d4ff.html" target="n" data-glyph="76,1" class="i method">AreEqual</a>( <b>byte</b>[] <span id="r12 rd" class="r12 r">a</span>, <b>byte</b>[] <span id="r13 rd" class="r13 r">b</span> )
        {
            <b>if</b> ( <span class="r12 r">a</span> == <span class="r13 r">b</span> )
                <b>return</b> <b>true</b>;
 
            <b>if</b> ( <span class="r12 r">a</span> == <b>null</b> )
                <span class="c">// b can&#39;t be null because otherwise we would return true above.</span>
                <b>return</b> <span class="r13 r">b</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0;
 
            <b>if</b> ( <span class="r13 r">b</span> == <b>null</b> )
                <span class="c">// Likewise, a can&#39;t be null.</span>
                <b>return</b> <span class="r12 r">a</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0;
 
            <b>if</b> ( <span class="r12 r">a</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> != <span class="r13 r">b</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> )
                <b>return</b> <b>false</b>;
 
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r14 rd" class="r14 r">i</span> = 0; <span class="r14 r">i</span> &lt; <span class="r12 r">a</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; ++<span class="r14 r">i</span> )
                <b>if</b> ( <span class="r12 r">a</span>[<span class="r14 r">i</span>] != <span class="r13 r">b</span>[<span class="r14 r">i</span>] )
                    <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="3c476d305db91fae" href="R/3c476d305db91fae.html" target="n" data-glyph="76,1" class="i method">AreEqual</a>( <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r15 rd" class="r15 r">a</span>, <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r16 rd" class="r16 r">b</span> )
        {
            <b>if</b> ( <span class="r15 r">a</span> == <span class="r16 r">b</span> )
                <b>return</b> <b>true</b>;
 
            <b>if</b> ( ( <span class="r15 r">a</span> == <b>null</b> ) != ( <span class="r16 r">b</span> == <b>null</b> ) )
                <b>return</b> <b>false</b>;
 
            <b>if</b> ( <span class="r15 r">a</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> != <span class="r16 r">b</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> )
                <b>return</b> <b>false</b>;
 
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r17 rd" class="r17 r">i</span> = 0; <span class="r17 r">i</span> &lt; <span class="r15 r">a</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>; ++<span class="r17 r">i</span> )
                <b>if</b> ( <span class="r15 r">a</span><a href="@0@mscorlib/A.html#396bb785d31f5979">[</a><span class="r17 r">i</span>] != <span class="r16 r">b</span><a href="@0@mscorlib/A.html#396bb785d31f5979">[</a><span class="r17 r">i</span>] )
                    <b>return</b> <b>false</b>;
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public override int</b> <a id="524bae65c01a2e56" href="R/524bae65c01a2e56.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r18 rd" class="r18 r">hashCode</span> = 48313; <span class="c">// setting it to a random prime number</span>
 
            <b>if</b> ( <a href="#fe5560cce3efa496" class="i property">Kid</a> != <b>null</b> )
            {
                <span class="r18 r">hashCode</span> += <a href="#fe5560cce3efa496" class="i property">Kid</a>.<a href="@0@mscorlib/A.html#0a17bbac4851d0d4" class="i method">GetHashCode</a>();
            }
 
            <b>switch</b> ( <a href="#bf5694ab09c369fd" class="i property">Kty</a> )
            {
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#0db095c52fbd796e" class="i field">Octet</a>:
                    <b>return</b> <span class="r18 r">hashCode</span> + <a href="#601893bca249f08b" class="i method">GetHashCode</a>( <a href="#20ddcb570f4681b4" class="i property">K</a> );
 
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#8ec62d93b4c095ea" class="i field">EllipticCurve</a>:
                    <b>return</b> <span class="r18 r">hashCode</span> + <a href="#601893bca249f08b" class="i method">GetHashCode</a>( <a href="#3087694fafdb835b" class="i property">X</a> );
 
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#cc9d39c080719cc8" class="i field">Rsa</a>:
                    <b>return</b> <span class="r18 r">hashCode</span> + <a href="#601893bca249f08b" class="i method">GetHashCode</a>( <a href="#c852bc6e5241eab3" class="i property">N</a> );
 
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#55119789cad072b9" class="i field">EllipticCurveHsm</a>:
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#d474964d1d7a4763" class="i field">RsaHsm</a>:
                    <b>return</b> <span class="r18 r">hashCode</span> + <a href="#601893bca249f08b" class="i method">GetHashCode</a>( <a href="#849f90102ea84e9c" class="i property">T</a> );
 
                <b>default</b>:
                    <b>return</b> <span class="r18 r">hashCode</span>;
            }
        }
 
        <b>private static int</b> <a id="601893bca249f08b" href="R/601893bca249f08b.html" target="n" data-glyph="76,1" class="i method">GetHashCode</a>( <b>byte</b>[] <span id="r19 rd" class="r19 r">obj</span> )
        {
            <b>if</b> ( <span class="r19 r">obj</span> == <b>null</b> || <span class="r19 r">obj</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
                <b>return</b> 0;
 
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r20 rd" class="r20 r">hashCode</span> = 0;
 
            <span class="c">// Rotate by 3 bits and XOR the new value.</span>
            <b>foreach</b> ( <a href="@0@mscorlib/A.html#3933aebb80415ce0" class="k">var</a> <span id="r21 rd" class="r21 r">v</span> <b>in</b> <span class="r19 r">obj</span> )
                <span class="r20 r">hashCode</span> = ( <span class="r20 r">hashCode</span> &lt;&lt; 3 ) | ( <span class="r20 r">hashCode</span> &gt;&gt; 29 ) ^ <span class="r21 r">v</span>;
 
            <b>return</b> <span class="r20 r">hashCode</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies whether this object has a private key</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c"> True if the object has private key; false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4b252a24a3c6edcd" href="R/4b252a24a3c6edcd.html" target="n" data-glyph="72,1" class="i method">HasPrivateKey</a>()
        {
            <b>switch</b> ( <a href="#bf5694ab09c369fd" class="i property">Kty</a> )
            {
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#0db095c52fbd796e" class="i field">Octet</a>:
                    <b>return</b> <a href="#20ddcb570f4681b4" class="i property">K</a> != <b>null</b>;
 
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#8ec62d93b4c095ea" class="i field">EllipticCurve</a>:
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#55119789cad072b9" class="i field">EllipticCurveHsm</a>:
                    <b>return</b> <a href="#e36618c05b815e77" class="i property">D</a> != <b>null</b>;
 
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#cc9d39c080719cc8" class="i field">Rsa</a>:
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#d474964d1d7a4763" class="i field">RsaHsm</a>:
                    <b>return</b> <a href="#e36618c05b815e77" class="i property">D</a> != <b>null</b> &amp;&amp; <a href="#ee12900e829c9da2" class="i property">DP</a> != <b>null</b> &amp;&amp; <a href="#65719c489919d919" class="i property">DQ</a> != <b>null</b> &amp;&amp; <a href="#9094a77b302e79bc" class="i property">QI</a> != <b>null</b> &amp;&amp; <a href="#b18a4697a345d9b6" class="i property">P</a> != <b>null</b> &amp;&amp; <a href="#88d5be9b58de3cd9" class="i property">Q</a> != <b>null</b>;
 
                <b>default</b>:
                    <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the WebKey object is valid according to the rules for</span>
        <span class="c">///</span><span class="c"> each of value of JsonWebKeyType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">true if the WebKey is valid</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b162328ed9923255" href="R/b162328ed9923255.html" target="n" data-glyph="72,1" class="i method">IsValid</a>()
        {
            <a href="JsonWebKeyVerifier.cs.html#b6eebebcdba481cc" class="k">var</a> <span id="r22 rd" class="r22 r">verifierOptions</span> =
                <a href="JsonWebKeyVerifier.cs.html#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>.<a href="JsonWebKeyVerifier.cs.html#b6eebebcdba481cc" class="t t">Options</a>.<a href="JsonWebKeyVerifier.cs.html#f3de36510d4f9fc1" class="i field">DenyIncompatibleOperations</a> |
                <a href="JsonWebKeyVerifier.cs.html#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>.<a href="JsonWebKeyVerifier.cs.html#b6eebebcdba481cc" class="t t">Options</a>.<a href="JsonWebKeyVerifier.cs.html#9df620bfc41c931d" class="i field">DenyExtraneousFields</a>;
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r23 rd" class="r23 r">unused</span> = <b>null</b>;
            <b>return</b> <a href="JsonWebKeyVerifier.cs.html#ff6492f97841b27c" class="t t">JsonWebKeyVerifier</a>.<a href="JsonWebKeyVerifier.cs.html#3c5a1f74ee4018e9" class="i method">VerifyByKeyType</a>( <a href="#072f5b35a8ee35c6" class="k">this</a>, <span class="r22 r">verifierOptions</span>, <b>ref</b> <span class="r23 r">unused</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a WebKey of type Octet to an AES object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An AES object</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@mscorlib/A.html#ddb5f33f82818174" class="t t">Aes</a> <a id="3b32768a4546e0e7" href="R/3b32768a4546e0e7.html" target="n" data-glyph="72,1" class="i method">ToAes</a>()
        {
            <b>if</b> ( !<a href="#bf5694ab09c369fd" class="i property">Kty</a>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>( <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#0db095c52fbd796e" class="i field">Octet</a> ) )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">&quot;key is not an octet key&quot;</span> );
 
            <b>if</b> ( <a href="#20ddcb570f4681b4" class="i property">K</a> == <b>null</b> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>( <span class="s">&quot;key does not contain a value&quot;</span> );
 
            <a href="@0@mscorlib/A.html#ddb5f33f82818174" class="k">var</a> <span id="r24 rd" class="r24 r">result</span> = <a href="@0@mscorlib/A.html#ddb5f33f82818174" class="t t">Aes</a>.<a href="@0@mscorlib/A.html#f7c32038963e5062" class="i method">Create</a>();
 
            <b>if</b> ( <span class="r24 r">result</span> != <b>null</b> )
                <span class="r24 r">result</span>.<a href="@0@mscorlib/A.html#d12a38c78f5c3174" class="i property">Key</a> = <a href="#20ddcb570f4681b4" class="i property">K</a>;
 
            <b>return</b> <span class="r24 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove leading zeros from all RSA parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="60fa9f30ba6ee72c" href="R/60fa9f30ba6ee72c.html" target="n" data-glyph="72,1" class="i method">CanonicalizeRSA</a>()
        {
            <a href="#c852bc6e5241eab3" class="i property">N</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#c852bc6e5241eab3" class="i property">N</a> );
            <a href="#12108e7b667ecd5e" class="i property">E</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#12108e7b667ecd5e" class="i property">E</a> );
            <a href="#e36618c05b815e77" class="i property">D</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#e36618c05b815e77" class="i property">D</a> );
            <a href="#ee12900e829c9da2" class="i property">DP</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#ee12900e829c9da2" class="i property">DP</a> );
            <a href="#65719c489919d919" class="i property">DQ</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#65719c489919d919" class="i property">DQ</a> );
            <a href="#9094a77b302e79bc" class="i property">QI</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#9094a77b302e79bc" class="i property">QI</a> );
            <a href="#b18a4697a345d9b6" class="i property">P</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#b18a4697a345d9b6" class="i property">P</a> );
            <a href="#88d5be9b58de3cd9" class="i property">Q</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#88d5be9b58de3cd9" class="i property">Q</a> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a WebKey of type RSA or RSAHSM to a RSA object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">includePrivateParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Tells if private material must be included.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An initialized RSA instance</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@mscorlib/A.html#9e72392556b1419c" class="t t">RSA</a> <a id="8985ec19329e609f" href="R/8985ec19329e609f.html" target="n" data-glyph="72,1" class="i method">ToRSA</a>( <b>bool</b> <span id="r25 rd" class="r25 r">includePrivateParameters</span> = <b>false</b> )
        {
            <a href="@0@mscorlib/A.html#dfd6cfff509b13df" class="k">var</a> <span id="r26 rd" class="r26 r">rsaParameters</span> = <a href="#a292683941d8b085" class="i method">ToRSAParameters</a>( <span class="r25 r">includePrivateParameters</span> );
            <a href="@0@mscorlib/A.html#9e72392556b1419c" class="k">var</a> <span id="r27 rd" class="r27 r">result</span> = <a href="@0@mscorlib/A.html#9e72392556b1419c" class="t t">RSA</a>.<a href="@0@mscorlib/A.html#7c10efd163896171" class="i method">Create</a>();
            <span class="r27 r">result</span>.<a href="@0@mscorlib/A.html#4219e2cf695e37fd" class="i method">ImportParameters</a>( <span class="r26 r">rsaParameters</span> );
            <b>return</b> <span class="r27 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a WebKey of type RSA or RSAHSM to a RSA parameter object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">includePrivateParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Tells if private material must be included.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An RSA parameter</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@mscorlib/A.html#dfd6cfff509b13df" class="t t">RSAParameters</a> <a id="a292683941d8b085" href="R/a292683941d8b085.html" target="n" data-glyph="72,1" class="i method">ToRSAParameters</a>( <b>bool</b> <span id="r28 rd" class="r28 r">includePrivateParameters</span> = <b>false</b> )
        {
            <b>if</b> ( <a href="#bf5694ab09c369fd" class="i property">Kty</a> != <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#cc9d39c080719cc8" class="i field">Rsa</a> &amp;&amp; <a href="#bf5694ab09c369fd" class="i property">Kty</a> != <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#d474964d1d7a4763" class="i field">RsaHsm</a> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">&quot;JsonWebKey is not a RSA key&quot;</span> );
 
            <a href="#3b534b5294b9bb0b" class="i method">VerifyNonZero</a>( <b>nameof</b>( <a href="#c852bc6e5241eab3" class="i property">N</a> ), <a href="#c852bc6e5241eab3" class="i property">N</a> );
            <a href="#3b534b5294b9bb0b" class="i method">VerifyNonZero</a>( <b>nameof</b>( <a href="#12108e7b667ecd5e" class="i property">E</a> ), <a href="#12108e7b667ecd5e" class="i property">E</a> );
 
            <span class="c">// Length requirements defined by 2.2.2.9.1 RSA Private Key BLOB (https://msdn.microsoft.com/en-us/library/cc250013.aspx).</span>
            <span class="c">// See KV bugs 190589 and 183469.</span>
 
            <a href="@0@mscorlib/A.html#dfd6cfff509b13df" class="k">var</a> <span id="r29 rd" class="r29 r">result</span> = <b>new</b> <a href="@0@mscorlib/A.html#dfd6cfff509b13df" class="t constructor">RSAParameters</a>();
            <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#f2621da5f160ffb5" class="i field">Modulus</a> = <a href="#9ce4d0950e96cfe7" class="i method">RemoveLeadingZeros</a>( <a href="#c852bc6e5241eab3" class="i property">N</a> );
            <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#91d13f36d3d02fd7" class="i field">Exponent</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#12108e7b667ecd5e" class="i property">E</a> ), <a href="#12108e7b667ecd5e" class="i property">E</a>, 4 );
 
            <b>if</b> ( <span class="r28 r">includePrivateParameters</span> )
            {
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r30 rd" class="r30 r">bitlen</span> = <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#f2621da5f160ffb5" class="i field">Modulus</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> * 8;
 
                <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#33f3738835659b02" class="i field">D</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#e36618c05b815e77" class="i property">D</a> ), <a href="#e36618c05b815e77" class="i property">D</a>, <span class="r30 r">bitlen</span> / 8 );
                <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#7b8dbd3faf1d9481" class="i field">DP</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#ee12900e829c9da2" class="i property">DP</a> ), <a href="#ee12900e829c9da2" class="i property">DP</a>, <span class="r30 r">bitlen</span> / 16 );
                <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#155c902ff43a9ea8" class="i field">DQ</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#65719c489919d919" class="i property">DQ</a> ), <a href="#65719c489919d919" class="i property">DQ</a>, <span class="r30 r">bitlen</span> / 16 );
                <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#8c8c5dd0c42c705e" class="i field">InverseQ</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#9094a77b302e79bc" class="i property">QI</a> ), <a href="#9094a77b302e79bc" class="i property">QI</a>, <span class="r30 r">bitlen</span> / 16 );
                <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#0c464c45da683f89" class="i field">P</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#b18a4697a345d9b6" class="i property">P</a> ), <a href="#b18a4697a345d9b6" class="i property">P</a>, <span class="r30 r">bitlen</span> / 16 );
                <span class="r29 r">result</span>.<a href="@0@mscorlib/A.html#e6f0eac2caa4e0c0" class="i field">Q</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#88d5be9b58de3cd9" class="i property">Q</a> ), <a href="#88d5be9b58de3cd9" class="i property">Q</a>, <span class="r30 r">bitlen</span> / 16 );
            }
 
            <b>return</b> <span class="r29 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a WebKey of type EC or EC-HSM to an ECDsa object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">includePrivateParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Tells if private material must be included.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An initialized ECDsa instance</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@System.Core/A.html#59084d68c76f225c" class="t t">ECDsa</a> <a id="118a8b68f400983e" href="R/118a8b68f400983e.html" target="n" data-glyph="72,1" class="i method">ToECDsa</a>( <b>bool</b> <span id="r31 rd" class="r31 r">includePrivateParameters</span> = <b>false</b> )
        {
            <b>return</b> <a href="#7098cfae074b12d3" class="i method">ToEcParameters</a>( <span class="r31 r">includePrivateParameters</span> ).<a href="ECParameters.cs.html#6e60d595526b62e5" class="i method">ToEcdsa</a>( <span class="r31 r">includePrivateParameters</span> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a WebKey of type EC or EC-HSM to an EC parameter object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">includePrivateParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Tells if private material must be included.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An EC parameter object</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="ECParameters.cs.html#35603abbad105a6f" class="t t">ECParameters</a> <a id="7098cfae074b12d3" href="R/7098cfae074b12d3.html" target="n" data-glyph="72,1" class="i method">ToEcParameters</a>( <b>bool</b> <span id="r32 rd" class="r32 r">includePrivateParameters</span> = <b>false</b> )
        {
            <b>if</b> ( <a href="#bf5694ab09c369fd" class="i property">Kty</a> != <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#8ec62d93b4c095ea" class="i field">EllipticCurve</a> &amp;&amp; <a href="#bf5694ab09c369fd" class="i property">Kty</a> != <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#55119789cad072b9" class="i field">EllipticCurveHsm</a> )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">&quot;JsonWebKey is not an EC key&quot;</span> );
 
            <a href="#3b534b5294b9bb0b" class="i method">VerifyNonZero</a>( <b>nameof</b>( <a href="#3087694fafdb835b" class="i property">X</a> ), <a href="#3087694fafdb835b" class="i property">X</a> );
            <a href="#3b534b5294b9bb0b" class="i method">VerifyNonZero</a>( <b>nameof</b>( <a href="#16ff122891b4ddee" class="i property">Y</a> ), <a href="#16ff122891b4ddee" class="i property">Y</a> );
 
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r33 rd" class="r33 r">requiredSize</span> = <a href="JsonWebKeyCurveName.cs.html#880f0ad409210774" class="t t">JsonWebKeyCurveName</a>.<a href="JsonWebKeyCurveName.cs.html#8531d282f59980ef" class="i method">GetKeyParameterSize</a>( <a href="#9cf03f581bcca3f1" class="i property">CurveName</a> );
            <b>if</b> ( <span class="r33 r">requiredSize</span> &lt; 0 )
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r34 rd" class="r34 r">curveDesc</span> = <a href="#9cf03f581bcca3f1" class="i property">CurveName</a> == <b>null</b> ? <span class="s">&quot;null&quot;</span> : <span class="s">$&quot;</span>\&quot;{<a href="#9cf03f581bcca3f1" class="i property">CurveName</a>}\&quot;<span class="s">&quot;</span>;
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Invalid curve type: </span>{<span class="r34 r">curveDesc</span>}<span class="s">&quot;</span> );
            }
 
            <a href="ECParameters.cs.html#35603abbad105a6f" class="k">var</a> <span id="r35 rd" class="r35 r">result</span> = <b>new</b> <a href="ECParameters.cs.html#35603abbad105a6f" class="t constructor">ECParameters</a>();
            <span class="r35 r">result</span>.<a href="ECParameters.cs.html#8f8286c0e07b945f" class="i property">Curve</a> = <a href="#9cf03f581bcca3f1" class="i property">CurveName</a>;
            <span class="r35 r">result</span>.<a href="ECParameters.cs.html#83f99d3895629ae5" class="i property">X</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#3087694fafdb835b" class="i property">X</a> ), <a href="#3087694fafdb835b" class="i property">X</a>, <span class="r33 r">requiredSize</span> );
            <span class="r35 r">result</span>.<a href="ECParameters.cs.html#0ab81a4d6208a3cc" class="i property">Y</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#16ff122891b4ddee" class="i property">Y</a> ), <a href="#16ff122891b4ddee" class="i property">Y</a>, <span class="r33 r">requiredSize</span> );
 
            <b>if</b> ( <span class="r32 r">includePrivateParameters</span> )
            {
                <a href="#3b534b5294b9bb0b" class="i method">VerifyNonZero</a>( <b>nameof</b>( <a href="#e36618c05b815e77" class="i property">D</a> ), <a href="#e36618c05b815e77" class="i property">D</a> );
                <span class="r35 r">result</span>.<a href="ECParameters.cs.html#8c8f223bb8c260ce" class="i property">D</a> = <a href="#3873de779bef9a12" class="i method">ForceLength</a>( <b>nameof</b>( <a href="#e36618c05b815e77" class="i property">D</a> ), <a href="#e36618c05b815e77" class="i property">D</a>, <span class="r33 r">requiredSize</span> );
            }
 
            <b>return</b> <span class="r35 r">result</span>;
        }
 
        <b>private static void</b> <a id="3b534b5294b9bb0b" href="R/3b534b5294b9bb0b.html" target="n" data-glyph="76,1" class="i method">VerifyNonZero</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r36 rd" class="r36 r">name</span>, <b>byte</b>[] <span id="r37 rd" class="r37 r">value</span> )
        {
            <b>if</b> ( <span class="r37 r">value</span> != <b>null</b> )
                <b>foreach</b> ( <a href="@0@mscorlib/A.html#3933aebb80415ce0" class="k">var</a> <span id="r38 rd" class="r38 r">t</span> <b>in</b> <span class="r37 r">value</span> )
                    <b>if</b> ( <span class="r38 r">t</span> != 0 )
                        <b>return</b>;
 
            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Value of \&quot;</span>{<span class="r36 r">name</span>}<span class="s">\&quot; must be non-zero.</span><span class="s">&quot;</span> );
        }
 
        <b>private static byte</b>[] <a id="9ce4d0950e96cfe7" href="R/9ce4d0950e96cfe7.html" target="n" data-glyph="76,1" class="i method">RemoveLeadingZeros</a>( <b>byte</b>[] <span id="r39 rd" class="r39 r">value</span> )
        {
            <span class="c">// Do nothing if:</span>
            <span class="c">// 1) value is null.</span>
            <span class="c">// 2) value is empty.</span>
            <span class="c">// 3) value has length of 1 (this is considered a useful zero).</span>
            <span class="c">// 4) first byte is already non-zero (optimization).</span>
            <b>if</b> ( <span class="r39 r">value</span> == <b>null</b> || <span class="r39 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &lt;= 1 || <span class="r39 r">value</span>[0] != 0 )
                <b>return</b> <span class="r39 r">value</span>;
 
            <span class="c">// We know that value[0] is zero, so we start from 1.</span>
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r40 rd" class="r40 r">i</span> = 1; <span class="r40 r">i</span> &lt; <span class="r39 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; ++<span class="r40 r">i</span> )
            {
                <b>if</b> ( <span class="r39 r">value</span>[<span class="r40 r">i</span>] != 0 )
                {
                    <b>var</b> <span id="r41 rd" class="r41 r">result</span> = <b>new</b> <b>byte</b>[<span class="r39 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r40 r">i</span>];
                    <a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>( <span class="r39 r">value</span>, <span class="r40 r">i</span>, <span class="r41 r">result</span>, 0, <span class="r41 r">result</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> );
                    <b>return</b> <span class="r41 r">result</span>;
                }
            }
 
            <span class="c">// If all is zero, return an array with a single useful zero.</span>
            <b>return</b> <b>new</b> <b>byte</b>[] {0};
        }
 
        <b>private static byte</b>[] <a id="3873de779bef9a12" href="R/3873de779bef9a12.html" target="n" data-glyph="76,1" class="i method">ForceLength</a>( <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r42 rd" class="r42 r">name</span>, <b>byte</b>[] <span id="r43 rd" class="r43 r">value</span>, <b>int</b> <span id="r44 rd" class="r44 r">requiredLength</span> )
        {
            <b>if</b> ( <span class="r43 r">value</span> == <b>null</b> || <span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0 )
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Value of \&quot;</span>{<span class="r42 r">name</span>}<span class="s">\&quot; is null or empty.</span><span class="s">&quot;</span> );
 
            <b>if</b> ( <span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == <span class="r44 r">requiredLength</span> )
                <b>return</b> <span class="r43 r">value</span>;
 
            <b>if</b> ( <span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &lt; <span class="r44 r">requiredLength</span> )
            {
                <b>var</b> <span id="r45 rd" class="r45 r">padded</span> = <b>new</b> <b>byte</b>[<span class="r44 r">requiredLength</span>];
                <a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>( <span class="r43 r">value</span>, 0, <span class="r45 r">padded</span>, <span class="r44 r">requiredLength</span> - <span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> );
                <b>return</b> <span class="r45 r">padded</span>;
            }
 
            <span class="c">// value.Length &gt; requiredLength</span>
 
            <span class="c">// Make sure the extra bytes are all zeros.</span>
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r46 rd" class="r46 r">extraLen</span> = <span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r44 r">requiredLength</span>;
            <b>for</b> ( <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r47 rd" class="r47 r">i</span> = 0; <span class="r47 r">i</span> &lt; <span class="r46 r">extraLen</span>; ++<span class="r47 r">i</span> )
                <b>if</b> ( <span class="r43 r">value</span>[<span class="r47 r">i</span>] != 0 )
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>( <span class="s">$&quot;</span><span class="s">Invalid length of \&quot;</span>{<span class="r42 r">name</span>}<span class="s">\&quot;: expected at most </span>{<span class="r44 r">requiredLength</span>}<span class="s"> bytes, found </span>{<span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r47 r">i</span>}<span class="s"> bytes.</span><span class="s">&quot;</span> );
 
            <b>var</b> <span id="r48 rd" class="r48 r">trimmed</span> = <b>new</b> <b>byte</b>[<span class="r44 r">requiredLength</span>];
            <a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>( <span class="r43 r">value</span>, <span class="r43 r">value</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r44 r">requiredLength</span>, <span class="r48 r">trimmed</span>, 0, <span class="r44 r">requiredLength</span> );
            <b>return</b> <span class="r48 r">trimmed</span>;
        }
 
        <b>public override string</b> <a id="bfe419bd1a3bc7a2" href="R/bfe419bd1a3bc7a2.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <span class="i">JsonConvert</span>.<span class="i">SerializeObject</span>( <a href="#072f5b35a8ee35c6" class="k">this</a> );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Best effort to clear private key material </span>
        <span class="c">///</span><span class="c"> Not strong guarantee since GC may move the arrays during compact.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="7463fe388de24d8d" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ClearMemory</a>()
        {
            <span class="c">// We ignore kty and clear everything.</span>
 
            <span class="c">// Octet keys:</span>
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#20ddcb570f4681b4" class="i property">K</a> );
            <a href="#20ddcb570f4681b4" class="i property">K</a> = <b>null</b>;
 
            <span class="c">// Rsa keys:</span>
 
            <span class="c">// We want to clear public key to avoid identification.</span>
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#c852bc6e5241eab3" class="i property">N</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#12108e7b667ecd5e" class="i property">E</a> );
 
            <span class="c">// Private material of RSA:</span>
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#e36618c05b815e77" class="i property">D</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#ee12900e829c9da2" class="i property">DP</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#65719c489919d919" class="i property">DQ</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#9094a77b302e79bc" class="i property">QI</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#b18a4697a345d9b6" class="i property">P</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#88d5be9b58de3cd9" class="i property">Q</a> );
            <a href="#c852bc6e5241eab3" class="i property">N</a> = <a href="#12108e7b667ecd5e" class="i property">E</a> = <a href="#e36618c05b815e77" class="i property">D</a> = <a href="#ee12900e829c9da2" class="i property">DP</a> = <a href="#65719c489919d919" class="i property">DQ</a> = <a href="#9094a77b302e79bc" class="i property">QI</a> = <a href="#b18a4697a345d9b6" class="i property">P</a> = <a href="#88d5be9b58de3cd9" class="i property">Q</a> = <b>null</b>;
 
            <span class="c">// RsaHsm keys:</span>
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#849f90102ea84e9c" class="i property">T</a> );
            <a href="#849f90102ea84e9c" class="i property">T</a> = <b>null</b>;
 
            <span class="c">// Elliptic curve</span>
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#3087694fafdb835b" class="i property">X</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#16ff122891b4ddee" class="i property">Y</a> );
            <a href="#0cb9e02cc473f01b" class="i method">ZeroArray</a>( <a href="#e36618c05b815e77" class="i property">D</a> ); <span class="c">// D is intentionally repeated.</span>
            <a href="#3087694fafdb835b" class="i property">X</a> = <a href="#16ff122891b4ddee" class="i property">Y</a> = <a href="#e36618c05b815e77" class="i property">D</a> = <b>null</b>;
 
            <b>switch</b> ( <a href="#bf5694ab09c369fd" class="i property">Kty</a> )
            {
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#0db095c52fbd796e" class="i field">Octet</a>:
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#8ec62d93b4c095ea" class="i field">EllipticCurve</a>:
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#55119789cad072b9" class="i field">EllipticCurveHsm</a>:
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#cc9d39c080719cc8" class="i field">Rsa</a>:
                <b>case</b> <a href="JsonWebKeyType.cs.html#c90001f143f0f6b2" class="t t">JsonWebKeyType</a>.<a href="JsonWebKeyType.cs.html#d474964d1d7a4763" class="i field">RsaHsm</a>:
                    <span class="c">// Supported types fall here.</span>
                    <b>break</b>;
 
                <b>default</b>:
                    <span class="c">// Unsupported types fall here.</span>
                    <span class="c">// If someone forgets to implement ClearMemory() for a new kty, this exception will reveal the mistake.</span>
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3f64c7634faf1768" class="t constructor">NotImplementedException</a>( <span class="s">$&quot;</span><span class="s">Unsupported kty: </span>{<a href="#bf5694ab09c369fd" class="i property">Kty</a>}<span class="s">&quot;</span> );
            }
        }
 
        <b>private static void</b> <a id="0cb9e02cc473f01b" href="R/0cb9e02cc473f01b.html" target="n" data-glyph="76,1" class="i method">ZeroArray</a>( <b>byte</b>[] <span id="r49 rd" class="r49 r">a</span> )
        {
            <b>if</b> ( <span class="r49 r">a</span> == <b>null</b> )
                <b>return</b>;
            <a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#bed27cecfb5f7a6c" class="i method">Clear</a>( <span class="r49 r">a</span>, 0, <span class="r49 r">a</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> );
        }
    }
}</pre></td></tr></table></div></body></html>
