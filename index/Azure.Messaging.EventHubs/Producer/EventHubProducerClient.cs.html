<!DOCTYPE html>
<html><head><title>EventHubProducerClient.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1333);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Messaging.EventHubs/Producer/EventHubProducerClient.cs" target="_top">Producer\EventHubProducerClient.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/eventhub/Azure.Messaging.EventHubs/src/Producer/EventHubProducerClient.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Messaging.EventHubs" target="_top">Azure.Messaging.EventHubs.csproj</a> (Azure.Messaging.EventHubs)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i n">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">ExceptionServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">Pipeline</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">EventHubs</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">EventHubs</span>.<span class="i n">Diagnostics</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">EventHubs</span>.<span class="i n">Producer</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">   A client responsible for publishing </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> to a specific Event Hub,</span>
    <span class="c">///</span><span class="c">   grouped together in batches.  Depending on the options specified when sending, events data</span>
    <span class="c">///</span><span class="c">   may be automatically routed to an available partition or sent to a specifically requested partition.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     Allowing automatic routing of partitions is recommended when:</span>
    <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">- The sending of events needs to be highly available.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">- The event data should be evenly distributed among all available partitions.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">   </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     If no partition is specified, the following rules are used for automatically selecting one:</span>
    <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">1) Distribute the events equally amongst all available partitions using a round-robin approach.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">2) If a partition becomes unavailable, the Event Hubs service will automatically detect it and forward the message to another available partition.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">   </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is safe to cache and use for the lifetime of an application, and that is best practice when the application</span>
    <span class="c">///</span><span class="c">     publishes events regularly or semi-regularly.  The producer holds responsibility for efficient resource management, working to keep resource usage low during</span>
    <span class="c">///</span><span class="c">     periods of inactivity and manage health during periods of higher use.  Calling either the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2eb79cfef4719809" class="i method">CloseAsync</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5234a099c0472763" class="i method">DisposeAsync</a><span class="c">&quot;</span> <span class="c">/&gt;</span>
    <span class="c">///</span><span class="c">     method as the application is shutting down will ensure that network resources and other unmanaged objects are properly cleaned up.</span>
    <span class="c">///</span><span class="c">   </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span>
    <b>public class</b> <a id="b7beffbdf44e79fc" href="../R/b7beffbdf44e79fc.html" target="n" data-glyph="0,0" class="t t">EventHubProducerClient</a> : <span class="t t">IAsyncDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The maximum number of attempts that may be made to get a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> from the pool.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="dc87c93644a34960" href="../R/dc87c93644a34960.html" target="n" data-glyph="8,1" class="i field">MaximumCreateProducerAttempts</a> = 3;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The minimum allowable size, in bytes, for a batch to be sent.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="f5c4df681c98cbef" href="../R/f5c4df681c98cbef.html" target="n" data-glyph="8,1" class="i field">MinimumBatchSizeLimit</a> = 24;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The set of default publishing options to use when no specific options are requested.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <a href="SendEventOptions.cs.html#b41cc3b18fb38fa6" class="t t">SendEventOptions</a> <a id="821b504168147ec5" href="../R/821b504168147ec5.html" target="n" data-glyph="46,1" class="i field">DefaultSendOptions</a> = <b>new</b> <a href="SendEventOptions.cs.html#5a6b1f1bd55ed08b" class="t constructor">SendEventOptions</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Sets how long a dedicated </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> would sit in memory before its </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducerPool.cs.html#06f35c4320e1620b" class="t t">TransportProducerPool</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> would remove and close it.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="074c4d935365654e" href="../R/074c4d935365654e.html" target="n" data-glyph="46,1" class="i field">PartitionProducerLifespan</a> = <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@1@netstandard/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(5);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Indicates whether or not this instance has been closed.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private volatile bool</b> <a id="53ad2b1b1f8236a1" href="../R/53ad2b1b1f8236a1.html" target="n" data-glyph="46,1" class="i field">_closed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The fully qualified Event Hubs namespace that the producer is associated with.  This is likely</span>
        <span class="c">///</span><span class="c">   to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public string</b> <a id="22b20f2db40d78c1" href="../R/22b20f2db40d78c1.html" target="n" data-glyph="102,1" class="i property">FullyQualifiedNamespace</a> =&gt; <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#42574858f23f2a35" class="i property">FullyQualifiedNamespace</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The name of the Event Hub that the producer is connected to, specific to the</span>
        <span class="c">///</span><span class="c">   Event Hubs namespace that contains it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public string</b> <a id="bb3c308a01df058d" href="../R/bb3c308a01df058d.html" target="n" data-glyph="102,1" class="i property">EventHubName</a> =&gt; <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#9d66313561b8598d" class="i property">EventHubName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Indicates whether or not this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> has been closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the client is closed; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public bool</b> <a id="c76931ed1332ae9f" href="../R/c76931ed1332ae9f.html" target="n" data-glyph="102,1" class="i property">IsClosed</a>
        {
            <b>get</b> =&gt; <a href="#53ad2b1b1f8236a1" class="i field">_closed</a>;
            <b>protected set</b> =&gt; <a href="#53ad2b1b1f8236a1" class="i field">_closed</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Indicates whether the client has ownership of the associated </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubConnection.cs.html#0646809725209998" class="t t">EventHubConnection</a><span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c">   and should take responsibility for managing its lifespan.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private bool</b> <a id="b3dcd4d204e256f4" href="../R/b3dcd4d204e256f4.html" target="n" data-glyph="106,1" class="i property">OwnsConnection</a> { <b>get</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The policy to use for determining retry behavior for when an operation fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private</b> <a href="../EventHubsRetryPolicy.cs.html#bc28d871ab581a88" class="t t">EventHubsRetryPolicy</a> <a id="adccef4568aae506" href="../R/adccef4568aae506.html" target="n" data-glyph="106,1" class="i property">RetryPolicy</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The set of options to use with the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">  instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private</b> <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <a id="086ff8df84f0af37" href="../R/086ff8df84f0af37.html" target="n" data-glyph="106,1" class="i property">Options</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The active connection to the Azure Event Hubs service, enabling client communications for metadata</span>
        <span class="c">///</span><span class="c">   about the associated Event Hub and access to a transport-aware producer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private</b> <a href="../EventHubConnection.cs.html#0646809725209998" class="t t">EventHubConnection</a> <a id="303dfa24a25e6f0f" href="../R/303dfa24a25e6f0f.html" target="n" data-glyph="106,1" class="i property">Connection</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducerPool.cs.html#06f35c4320e1620b" class="t t">TransportProducerPool</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> used to manage a set of partition specific </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private</b> <a href="../Core/TransportProducerPool.cs.html#06f35c4320e1620b" class="t t">TransportProducerPool</a> <a id="3ca7484d6d1e808c" href="../R/3ca7484d6d1e808c.html" target="n" data-glyph="106,1" class="i property">PartitionProducerPool</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The publishing-related state associated with partitions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Created if the producer has been configured with one or more features which requires</span>
        <span class="c">///</span><span class="c">   publishing to partitions in a stateful manner; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private</b> <a href="@1@netstandard/A.html#2e5ef5704344a309" class="t t">ConcurrentDictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a>&gt; <a id="dbd7b33e45213fb5" href="../R/dbd7b33e45213fb5.html" target="n" data-glyph="106,1" class="i property">PartitionState</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">connectionString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The connection string to use for connecting to the Event Hubs namespace; it is expected that the Event Hub name and the shared key properties are contained in this connection string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   If the connection string is copied from the Event Hubs namespace, it will likely not contain the name of the desired Event Hub,</span>
        <span class="c">///</span><span class="c">   which is needed.  In this case, the name can be added manually by adding &quot;;EntityPath=[[ EVENT HUB NAME ]]&quot; to the end of the</span>
        <span class="c">///</span><span class="c">   connection string.  For example, &quot;;EntityPath=telemetry-hub&quot;.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">   If you have defined a shared access policy directly on the Event Hub itself, then copying the connection string from that</span>
        <span class="c">///</span><span class="c">   Event Hub will result in a connection string that contains the name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-get-connection-string</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How to get an Event Hubs connection string</span><span class="c">&lt;/</span><span class="c">seealso</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="67b622ba4269d939" href="../R/67b622ba4269d939.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">connectionString</span>) : <a href="#8d77ead7cefaf3d4" class="k">this</a>(<span class="r0 r">connectionString</span>, <b>null</b>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">connectionString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The connection string to use for connecting to the Event Hubs namespace; it is expected that the Event Hub name and the shared key properties are contained in this connection string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">clientOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of options to use for this consumer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   If the connection string is copied from the Event Hubs namespace, it will likely not contain the name of the desired Event Hub,</span>
        <span class="c">///</span><span class="c">   which is needed.  In this case, the name can be added manually by adding &quot;;EntityPath=[[ EVENT HUB NAME ]]&quot; to the end of the</span>
        <span class="c">///</span><span class="c">   connection string.  For example, &quot;;EntityPath=telemetry-hub&quot;.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">   If you have defined a shared access policy directly on the Event Hub itself, then copying the connection string from that</span>
        <span class="c">///</span><span class="c">   Event Hub will result in a connection string that contains the name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-get-connection-string</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How to get an Event Hubs connection string</span><span class="c">&lt;/</span><span class="c">seealso</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="e4c491e4fc1e1d29" href="../R/e4c491e4fc1e1d29.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">connectionString</span>,
                                      <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r2 rd" class="r2 r">clientOptions</span>) : <a href="#8d77ead7cefaf3d4" class="k">this</a>(<span class="r1 r">connectionString</span>, <b>null</b>, <span class="r2 r">clientOptions</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">connectionString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The connection string to use for connecting to the Event Hubs namespace; it is expected that the shared key properties are contained in this connection string, but not the Event Hub name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">eventHubName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the specific Event Hub to associate the producer with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   If the connection string is copied from the Event Hub itself, it will contain the name of the desired Event Hub,</span>
        <span class="c">///</span><span class="c">   and can be used directly without passing the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">eventHubName</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.  The name of the Event Hub should be</span>
        <span class="c">///</span><span class="c">   passed only once, either as part of the connection string or separately.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-get-connection-string</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How to get an Event Hubs connection string</span><span class="c">&lt;/</span><span class="c">seealso</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="e55cb8ea8e8cf512" href="../R/e55cb8ea8e8cf512.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">connectionString</span>,
                                      <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">eventHubName</span>) : <a href="#8d77ead7cefaf3d4" class="k">this</a>(<span class="r3 r">connectionString</span>, <span class="r4 r">eventHubName</span>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">connectionString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The connection string to use for connecting to the Event Hubs namespace; it is expected that the shared key properties are contained in this connection string, but not the Event Hub name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">eventHubName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the specific Event Hub to associate the producer with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">clientOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the producer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   If the connection string is copied from the Event Hub itself, it will contain the name of the desired Event Hub,</span>
        <span class="c">///</span><span class="c">   and can be used directly without passing the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">eventHubName</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.  The name of the Event Hub should be</span>
        <span class="c">///</span><span class="c">   passed only once, either as part of the connection string or separately.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-get-connection-string</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How to get an Event Hubs connection string</span><span class="c">&lt;/</span><span class="c">seealso</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="8d77ead7cefaf3d4" href="../R/8d77ead7cefaf3d4.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r5 rd" class="r5 r">connectionString</span>,
                                      <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">eventHubName</span>,
                                      <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r7 rd" class="r7 r">clientOptions</span>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#6f15f042abe7f96a" class="i method">AssertNotNullOrEmpty</a>(<span class="r5 r">connectionString</span>, <b>nameof</b>(<span class="r5 r">connectionString</span>));
            <span class="r7 r">clientOptions</span> = <span class="r7 r">clientOptions</span>?.<a href="EventHubProducerClientOptions.cs.html#7423b2f22a851573" class="i method">Clone</a>() ?? <b>new</b> <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t constructor">EventHubProducerClientOptions</a>();
 
            <a href="#b3dcd4d204e256f4" class="i property">OwnsConnection</a> = <b>true</b>;
            <a href="#303dfa24a25e6f0f" class="i property">Connection</a> = <b>new</b> <a href="../EventHubConnection.cs.html#298a945ee13156f2" class="t constructor">EventHubConnection</a>(<span class="r5 r">connectionString</span>, <span class="r6 r">eventHubName</span>, <span class="r7 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#647c846d6842d3b2" class="i property">ConnectionOptions</a>);
            <a href="#adccef4568aae506" class="i property">RetryPolicy</a> = <span class="r7 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#18c31e7bf251ae6e" class="i property">RetryOptions</a>.<a href="../SharedSource/Core/EventHubsRetryOptionsExtensions.cs.html#f1a0f56e5cda073f" class="i method">ToRetryPolicy</a>();
            <a href="#086ff8df84f0af37" class="i property">Options</a> = <span class="r7 r">clientOptions</span>;
 
            <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a> = <b>new</b> <a href="../Core/TransportProducerPool.cs.html#c63b09b0603442c7" class="t constructor">TransportProducerPool</a>(<span id="r8 rd" class="r8 r">partitionId</span> =&gt;
                <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#70206bd0a4e0c7b6" class="i method">CreateTransportProducer</a>(
                    <span class="r8 r">partitionId</span>,
                    <span class="r7 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#0b1b4ff4bcf0cd40" class="i method">CreateFeatureFlags</a>(),
                    <a href="#086ff8df84f0af37" class="i property">Options</a>.<a href="EventHubProducerClientOptions.cs.html#5f6d257cdcadeeb6" class="i method">GetPublishingOptionsOrDefaultForPartition</a>(<span class="r8 r">partitionId</span>),
                    <a href="#adccef4568aae506" class="i property">RetryPolicy</a>));
 
            <b>if</b> (<a href="#5dddcdf10cf22840" class="i method">RequiresStatefulPartitions</a>(<span class="r7 r">clientOptions</span>))
            {
                <a href="#dbd7b33e45213fb5" class="i property">PartitionState</a> = <b>new</b> <a href="@1@netstandard/A.html#abc35f3c19fa0290" class="t constructor">ConcurrentDictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a>&gt;();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Event Hubs namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">eventHubName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the specific Event Hub to associate the producer with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The shared access key credential to use for authorization.  Access controls may be specified by the Event Hubs namespace or the requested Event Hub, depending on Azure configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">clientOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the producer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="0316be162f49d8cb" href="../R/0316be162f49d8cb.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">fullyQualifiedNamespace</span>,
                                      <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">eventHubName</span>,
                                      <a href="/Azure.Core/A.html#ff9da284cd79b59b" class="t t">AzureNamedKeyCredential</a> <span id="r11 rd" class="r11 r">credential</span>,
                                      <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r12 rd" class="r12 r">clientOptions</span> = <b>default</b>) : <a href="#c38fee62062ba547" class="k">this</a>(<span class="r9 r">fullyQualifiedNamespace</span>, <span class="r10 r">eventHubName</span>, (<b>object</b>)<span class="r11 r">credential</span>, <span class="r12 r">clientOptions</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Event Hubs namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">eventHubName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the specific Event Hub to associate the producer with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The shared access signature credential to use for authorization.  Access controls may be specified by the Event Hubs namespace or the requested Event Hub, depending on Azure configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">clientOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the producer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="e081dca2d4bfe283" href="../R/e081dca2d4bfe283.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r13 rd" class="r13 r">fullyQualifiedNamespace</span>,
                                      <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">eventHubName</span>,
                                      <a href="/Azure.Core/A.html#77bc7924ac000276" class="t t">AzureSasCredential</a> <span id="r15 rd" class="r15 r">credential</span>,
                                      <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r16 rd" class="r16 r">clientOptions</span> = <b>default</b>) : <a href="#c38fee62062ba547" class="k">this</a>(<span class="r13 r">fullyQualifiedNamespace</span>, <span class="r14 r">eventHubName</span>, (<b>object</b>)<span class="r15 r">credential</span>, <span class="r16 r">clientOptions</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Event Hubs namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">eventHubName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the specific Event Hub to associate the producer with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Azure managed identity credential to use for authorization.  Access controls may be specified by the Event Hubs namespace or the requested Event Hub, depending on Azure configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">clientOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the producer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="b782f43087095e85" href="../R/b782f43087095e85.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">fullyQualifiedNamespace</span>,
                                      <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r18 rd" class="r18 r">eventHubName</span>,
                                      <a href="/Azure.Core/A.html#d93a9ffee404e938" class="t t">TokenCredential</a> <span id="r19 rd" class="r19 r">credential</span>,
                                      <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r20 rd" class="r20 r">clientOptions</span> = <b>default</b>): <a href="#c38fee62062ba547" class="k">this</a>(<span class="r17 r">fullyQualifiedNamespace</span>, <span class="r18 r">eventHubName</span>, (<b>object</b>)<span class="r19 r">credential</span>, <span class="r20 r">clientOptions</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">connection</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubConnection.cs.html#0646809725209998" class="t t">EventHubConnection</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> connection to use for communication with the Event Hubs service.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">clientOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the producer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public</b> <a id="9524ace4bed34bcb" href="../R/9524ace4bed34bcb.html" target="n" data-glyph="72,1" class="t constructor">EventHubProducerClient</a>(<a href="../EventHubConnection.cs.html#0646809725209998" class="t t">EventHubConnection</a> <span id="r21 rd" class="r21 r">connection</span>,
                                      <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r22 rd" class="r22 r">clientOptions</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r21 r">connection</span>, <b>nameof</b>(<span class="r21 r">connection</span>));
            <span class="r22 r">clientOptions</span> = <span class="r22 r">clientOptions</span>?.<a href="EventHubProducerClientOptions.cs.html#7423b2f22a851573" class="i method">Clone</a>() ?? <b>new</b> <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t constructor">EventHubProducerClientOptions</a>();
 
            <a href="#b3dcd4d204e256f4" class="i property">OwnsConnection</a> = <b>false</b>;
            <a href="#303dfa24a25e6f0f" class="i property">Connection</a> = <span class="r21 r">connection</span>;
            <a href="#adccef4568aae506" class="i property">RetryPolicy</a> = <span class="r22 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#18c31e7bf251ae6e" class="i property">RetryOptions</a>.<a href="../SharedSource/Core/EventHubsRetryOptionsExtensions.cs.html#f1a0f56e5cda073f" class="i method">ToRetryPolicy</a>();
            <a href="#086ff8df84f0af37" class="i property">Options</a> = <span class="r22 r">clientOptions</span>;
 
            <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a> = <b>new</b> <a href="../Core/TransportProducerPool.cs.html#c63b09b0603442c7" class="t constructor">TransportProducerPool</a>(<span id="r23 rd" class="r23 r">partitionId</span> =&gt;
                <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#70206bd0a4e0c7b6" class="i method">CreateTransportProducer</a>(
                    <span class="r23 r">partitionId</span>,
                    <span class="r22 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#0b1b4ff4bcf0cd40" class="i method">CreateFeatureFlags</a>(),
                    <a href="#086ff8df84f0af37" class="i property">Options</a>.<a href="EventHubProducerClientOptions.cs.html#5f6d257cdcadeeb6" class="i method">GetPublishingOptionsOrDefaultForPartition</a>(<span class="r23 r">partitionId</span>),
                    <a href="#adccef4568aae506" class="i property">RetryPolicy</a>));
 
            <b>if</b> (<a href="#5dddcdf10cf22840" class="i method">RequiresStatefulPartitions</a>(<span class="r22 r">clientOptions</span>))
            {
                <a href="#dbd7b33e45213fb5" class="i property">PartitionState</a> = <b>new</b> <a href="@1@netstandard/A.html#abc35f3c19fa0290" class="t constructor">ConcurrentDictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a>&gt;();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">connection</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The connection to use as the basis for delegation of client-type operations.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">transportProducer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The transport producer instance to use as the basis for service communication.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">partitionProducerPool</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducerPool.cs.html#06f35c4320e1620b" class="t t">TransportProducerPool</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> used to manage a set of partition specific </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   This constructor is intended to be used internally for functional</span>
        <span class="c">///</span><span class="c">   testing only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>internal</b> <a id="95655a15231fcd94" href="../R/95655a15231fcd94.html" target="n" data-glyph="74,1" class="t constructor">EventHubProducerClient</a>(<a href="../EventHubConnection.cs.html#0646809725209998" class="t t">EventHubConnection</a> <span id="r24 rd" class="r24 r">connection</span>,
                                        <a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a> <span id="r25 rd" class="r25 r">transportProducer</span>,
                                        <a href="../Core/TransportProducerPool.cs.html#06f35c4320e1620b" class="t t">TransportProducerPool</a> <span id="r26 rd" class="r26 r">partitionProducerPool</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r24 r">connection</span>, <b>nameof</b>(<span class="r24 r">connection</span>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r25 r">transportProducer</span>, <b>nameof</b>(<span class="r25 r">transportProducer</span>));
 
            <a href="#b3dcd4d204e256f4" class="i property">OwnsConnection</a> = <b>false</b>;
            <a href="#303dfa24a25e6f0f" class="i property">Connection</a> = <span class="r24 r">connection</span>;
            <a href="#adccef4568aae506" class="i property">RetryPolicy</a> = <b>new</b> <a href="../EventHubsRetryOptions.cs.html#a38af17da5dfdcd4" class="t constructor">EventHubsRetryOptions</a>().<a href="../SharedSource/Core/EventHubsRetryOptionsExtensions.cs.html#f1a0f56e5cda073f" class="i method">ToRetryPolicy</a>();
            <a href="#086ff8df84f0af37" class="i property">Options</a> = <b>new</b> <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t constructor">EventHubProducerClientOptions</a>();
            <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a> = <span class="r26 r">partitionProducerPool</span> ?? <b>new</b> <a href="../Core/TransportProducerPool.cs.html#c63b09b0603442c7" class="t constructor">TransportProducerPool</a>(<span id="r27 rd" class="r27 r">partitionId</span> =&gt; <span class="r25 r">transportProducer</span>);
 
            <b>if</b> (<a href="#5dddcdf10cf22840" class="i method">RequiresStatefulPartitions</a>(<a href="#086ff8df84f0af37" class="i property">Options</a>))
            {
                <a href="#dbd7b33e45213fb5" class="i property">PartitionState</a> = <b>new</b> <a href="@1@netstandard/A.html#abc35f3c19fa0290" class="t constructor">ConcurrentDictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a>&gt;();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>protected</b> <a id="9803f1d8e53c9c81" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">EventHubProducerClient</a>()
        {
            <a href="#b3dcd4d204e256f4" class="i property">OwnsConnection</a> = <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Event Hubs namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">eventHubName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the specific Event Hub to associate the producer with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The credential to use for authorization.  This may be of any type supported by the public constructors.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">clientOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the producer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private</b> <a id="c38fee62062ba547" href="../R/c38fee62062ba547.html" target="n" data-glyph="76,1" class="t constructor">EventHubProducerClient</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r28 rd" class="r28 r">fullyQualifiedNamespace</span>,
                                       <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r29 rd" class="r29 r">eventHubName</span>,
                                       <b>object</b> <span id="r30 rd" class="r30 r">credential</span>,
                                       <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r31 rd" class="r31 r">clientOptions</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Core/Argument.cs.html#4b3e3f504d747537" class="i method">AssertWellFormedEventHubsNamespace</a>(<span class="r28 r">fullyQualifiedNamespace</span>, <b>nameof</b>(<span class="r28 r">fullyQualifiedNamespace</span>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#6f15f042abe7f96a" class="i method">AssertNotNullOrEmpty</a>(<span class="r29 r">eventHubName</span>, <b>nameof</b>(<span class="r29 r">eventHubName</span>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r30 r">credential</span>, <b>nameof</b>(<span class="r30 r">credential</span>));
 
            <span class="r31 r">clientOptions</span> = <span class="r31 r">clientOptions</span>?.<a href="EventHubProducerClientOptions.cs.html#7423b2f22a851573" class="i method">Clone</a>() ?? <b>new</b> <a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t constructor">EventHubProducerClientOptions</a>();
 
            <a href="#b3dcd4d204e256f4" class="i property">OwnsConnection</a> = <b>true</b>;
            <a href="#303dfa24a25e6f0f" class="i property">Connection</a> = <a href="../EventHubConnection.cs.html#0646809725209998" class="t t">EventHubConnection</a>.<a href="../EventHubConnection.cs.html#c9a5bb4562d8f905" class="i method">CreateWithCredential</a>(<span class="r28 r">fullyQualifiedNamespace</span>, <span class="r29 r">eventHubName</span>, <span class="r30 r">credential</span>, <span class="r31 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#647c846d6842d3b2" class="i property">ConnectionOptions</a>);
            <a href="#086ff8df84f0af37" class="i property">Options</a> = <span class="r31 r">clientOptions</span>;
            <a href="#adccef4568aae506" class="i property">RetryPolicy</a> = <span class="r31 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#18c31e7bf251ae6e" class="i property">RetryOptions</a>.<a href="../SharedSource/Core/EventHubsRetryOptionsExtensions.cs.html#f1a0f56e5cda073f" class="i method">ToRetryPolicy</a>();
 
            <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a> = <b>new</b> <a href="../Core/TransportProducerPool.cs.html#c63b09b0603442c7" class="t constructor">TransportProducerPool</a>(<span id="r32 rd" class="r32 r">partitionId</span> =&gt;
                <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#70206bd0a4e0c7b6" class="i method">CreateTransportProducer</a>(
                    <span class="r32 r">partitionId</span>,
                    <span class="r31 r">clientOptions</span>.<a href="EventHubProducerClientOptions.cs.html#0b1b4ff4bcf0cd40" class="i method">CreateFeatureFlags</a>(),
                    <a href="#086ff8df84f0af37" class="i property">Options</a>.<a href="EventHubProducerClientOptions.cs.html#5f6d257cdcadeeb6" class="i method">GetPublishingOptionsOrDefaultForPartition</a>(<span class="r32 r">partitionId</span>),
                    <a href="#adccef4568aae506" class="i property">RetryPolicy</a>));
 
            <b>if</b> (<a href="#5dddcdf10cf22840" class="i method">RequiresStatefulPartitions</a>(<span class="r31 r">clientOptions</span>))
            {
                <a href="#dbd7b33e45213fb5" class="i property">PartitionState</a> = <b>new</b> <a href="@1@netstandard/A.html#abc35f3c19fa0290" class="t constructor">ConcurrentDictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a>&gt;();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Retrieves information about the Event Hub that the connection is associated with, including</span>
        <span class="c">///</span><span class="c">   the number of partitions present and their identifiers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The set of information for the Event Hub that this client is associated with.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../EventHubProperties.cs.html#6ee60bd5de616192" class="t t">EventHubProperties</a>&gt; <a id="83153b1a778cc1df" href="../R/83153b1a778cc1df.html" target="n" data-glyph="72,1" class="i method">GetEventHubPropertiesAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r33 rd" class="r33 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Core/Argument.cs.html#eda8ff4d51bf8b3e" class="i method">AssertNotClosed</a>(<a href="#c76931ed1332ae9f" class="i property">IsClosed</a>, <b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>));
            <b>return</b> <b>await</b> <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#c5f9ba82a26685ad" class="i method">GetPropertiesAsync</a>(<a href="#adccef4568aae506" class="i property">RetryPolicy</a>, <span class="r33 r">cancellationToken</span>).<a href="@1@netstandard/A.html#07ef75a8fa372c94" class="i method">ConfigureAwait</a>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Retrieves the set of identifiers for the partitions of an Event Hub.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The set of identifiers for the partitions within the Event Hub that this client is associated with.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   This method is synonymous with invoking </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#83153b1a778cc1df" class="i method">GetEventHubPropertiesAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> and reading the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubProperties.cs.html#6ee60bd5de616192" class="t t">EventHubProperties</a>.<a href="../EventHubProperties.cs.html#8f4d5f8630f084c0" class="i property">PartitionIds</a><span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c">   property that is returned. It is offered as a convenience for quick access to the set of partition identifiers for the associated Event Hub.</span>
        <span class="c">///</span><span class="c">   No new or extended information is presented.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>[]&gt; <a id="f7312409582c047e" href="../R/f7312409582c047e.html" target="n" data-glyph="72,1" class="i method">GetPartitionIdsAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r34 rd" class="r34 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Core/Argument.cs.html#eda8ff4d51bf8b3e" class="i method">AssertNotClosed</a>(<a href="#c76931ed1332ae9f" class="i property">IsClosed</a>, <b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>));
            <b>return</b> <b>await</b> <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#44a63294469a3aeb" class="i method">GetPartitionIdsAsync</a>(<a href="#adccef4568aae506" class="i property">RetryPolicy</a>, <span class="r34 r">cancellationToken</span>).<a href="@1@netstandard/A.html#07ef75a8fa372c94" class="i method">ConfigureAwait</a>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Retrieves information about a specific partition for an Event Hub, including elements that describe the available</span>
        <span class="c">///</span><span class="c">   events in the partition event stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">partitionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The unique identifier of a partition associated with the Event Hub.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The set of information for the requested partition under the Event Hub this client is associated with.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../PartitionProperties.cs.html#9311a292681a1af8" class="t t">PartitionProperties</a>&gt; <a id="159043daeb481f1b" href="../R/159043daeb481f1b.html" target="n" data-glyph="72,1" class="i method">GetPartitionPropertiesAsync</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r35 rd" class="r35 r">partitionId</span>,
                                                                                   <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r36 rd" class="r36 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Core/Argument.cs.html#eda8ff4d51bf8b3e" class="i method">AssertNotClosed</a>(<a href="#c76931ed1332ae9f" class="i property">IsClosed</a>, <b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>));
            <b>return</b> <b>await</b> <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#4f1140058a889a72" class="i method">GetPartitionPropertiesAsync</a>(<span class="r35 r">partitionId</span>, <a href="#adccef4568aae506" class="i property">RetryPolicy</a>, <span class="r36 r">cancellationToken</span>).<a href="@1@netstandard/A.html#07ef75a8fa372c94" class="i method">ConfigureAwait</a>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   A set of information about the state of publishing for a partition, as observed by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.  This</span>
        <span class="c">///</span><span class="c">   data can always be read, but will only be populated with information relevant to the active features for the producer client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">partitionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The unique identifier of a partition associated with the Event Hub.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The set of information about the publishing state of the requested partition, within the context of this producer.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The state of a partition is only understood by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> after events have been published to that</span>
        <span class="c">///</span><span class="c">   partition; calling this method for a partition before events have been published to it will return an empty set of properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>internal virtual async</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="PartitionPublishingProperties.cs.html#6fbaf58e86a0ae15" class="t t">PartitionPublishingProperties</a>&gt; <a id="e9f5d381e1ee4811" href="../R/e9f5d381e1ee4811.html" target="n" data-glyph="74,1" class="i method">GetPartitionPublishingPropertiesAsync</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r37 rd" class="r37 r">partitionId</span>,
                                                                                                         <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r38 rd" class="r38 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Core/Argument.cs.html#eda8ff4d51bf8b3e" class="i method">AssertNotClosed</a>(<a href="#c76931ed1332ae9f" class="i property">IsClosed</a>, <b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#6f15f042abe7f96a" class="i method">AssertNotNullOrEmpty</a>(<span class="r37 r">partitionId</span>, <b>nameof</b>(<span class="r37 r">partitionId</span>));
 
            <span class="c">// If the producer does not require stateful partitions, return an empty</span>
            <span class="c">// instance.</span>
 
            <b>if</b> (!<a href="#5dddcdf10cf22840" class="i method">RequiresStatefulPartitions</a>(<a href="#086ff8df84f0af37" class="i property">Options</a>))
            {
                <b>return</b> <a href="PartitionPublishingProperties.cs.html#6fbaf58e86a0ae15" class="t t">PartitionPublishingProperties</a>.<a href="PartitionPublishingProperties.cs.html#e38695608ac26180" class="i property">Empty</a>;
            }
 
            <span class="c">// If the state has not yet been initialized, then do so now.</span>
 
            <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="k">var</a> <span id="r39 rd" class="r39 r">partitionState</span> = <a href="#dbd7b33e45213fb5" class="i property">PartitionState</a>.<a href="@1@netstandard/A.html#d8b8308343be2763" class="i method">GetOrAdd</a>(<span class="r37 r">partitionId</span>, <b>new</b> <a href="PartitionPublishingState.cs.html#df2eaf37e852ffa0" class="t constructor">PartitionPublishingState</a>(<span class="r37 r">partitionId</span>));
            <span class="r38 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
 
            <b>try</b>
            {
                <b>await</b> <span class="r39 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#1546a6a2c4d39bfd" class="i property">PublishingGuard</a>.<a href="@1@netstandard/A.html#7a679e542c73988f" class="i method">WaitAsync</a>(<span class="r38 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
                <b>if</b> (!<span class="r39 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#b69b6c9229ab9ce0" class="i property">IsInitialized</a>)
                {
                    <span class="r38 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
                    <b>await</b> <a href="#a3e70e634d462679" class="i method">InitializePartitionStateAsync</a>(<span class="r39 r">partitionState</span>, <span class="r38 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
                }
 
                <b>return</b> <a href="#1fd72e839f4a1366" class="i method">CreatePublishingPropertiesFromPartitionState</a>(<a href="#086ff8df84f0af37" class="i property">Options</a>, <span class="r39 r">partitionState</span>);
            }
            <b>finally</b>
            {
                <span class="r39 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#1546a6a2c4d39bfd" class="i property">PublishingGuard</a>.<a href="@1@netstandard/A.html#f7527810bcfc0842" class="i method">Release</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Sends a set of events to the associated Event Hub as a single operation.  To avoid the</span>
        <span class="c">///</span><span class="c">   overhead associated with measuring and validating the size in the client, validation will</span>
        <span class="c">///</span><span class="c">   be delegated to the Event Hubs service and is deferred until the operation is invoked.</span>
        <span class="c">///</span><span class="c">   The call will fail if the size of the specified set of events exceeds the maximum allowable</span>
        <span class="c">///</span><span class="c">   size of a single batch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">eventBatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of event data to send.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   A task to be resolved on when the operation has completed; if no exception is thrown when awaited, the</span>
        <span class="c">///</span><span class="c">   Event Hubs service has acknowledge receipt and assumed responsibility for delivery of the set of events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Occurs when the set of events exceeds the maximum size allowed in a single batch, as determined by the Event Hubs service.  The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#efdefeb5416905cd" class="i property">Reason</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> will be set to</span>
        <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#e5210b418cdfe2fd" class="t t">FailureReason</a>.<a href="../EventHubsException.cs.html#1415ac01d4242879" class="i field">MessageSizeExceeded</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in this case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   When published, the result is atomic; either all events that belong to the set were successful or all</span>
        <span class="c">///</span><span class="c">   have failed.  Partial success is not possible.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#23e1f2c34632da0c" class="i method">SendAsync</a>(<a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>{<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>}, <a href="SendEventOptions.cs.html#b41cc3b18fb38fa6" class="t t">SendEventOptions</a>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2daccfec1f33129f" class="i method">SendAsync</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5bdaf0d46659f31f" class="i method">CreateBatchAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5e74a4c1a3d5937f" href="../R/5e74a4c1a3d5937f.html" target="n" data-glyph="72,1" class="i method">SendAsync</a>(<a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r40 rd" class="r40 r">eventBatch</span>,
                                            <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r41 rd" class="r41 r">cancellationToken</span> = <b>default</b>) =&gt; <b>await</b> <a href="#23e1f2c34632da0c" class="i method">SendAsync</a>(<span class="r40 r">eventBatch</span>, <b>null</b>, <span class="r41 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Sends a set of events to the associated Event Hub as a single operation.  To avoid the</span>
        <span class="c">///</span><span class="c">   overhead associated with measuring and validating the size in the client, validation will</span>
        <span class="c">///</span><span class="c">   be delegated to the Event Hubs service and is deferred until the operation is invoked.</span>
        <span class="c">///</span><span class="c">   The call will fail if the size of the specified set of events exceeds the maximum allowable</span>
        <span class="c">///</span><span class="c">   size of a single batch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">eventBatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of event data to send.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of options to consider when sending this batch.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   A task to be resolved on when the operation has completed; if no exception is thrown when awaited, the</span>
        <span class="c">///</span><span class="c">   Event Hubs service has acknowledge receipt and assumed responsibility for delivery of the set of events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Occurs when the set of events exceeds the maximum size allowed in a single batch, as determined by the Event Hubs service.  The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#efdefeb5416905cd" class="i property">Reason</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> will be set to</span>
        <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#e5210b418cdfe2fd" class="t t">FailureReason</a>.<a href="../EventHubsException.cs.html#1415ac01d4242879" class="i field">MessageSizeExceeded</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in this case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   When published, the result is atomic; either all events that belong to the set were successful or all</span>
        <span class="c">///</span><span class="c">   have failed.  Partial success is not possible.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5e74a4c1a3d5937f" class="i method">SendAsync</a>(<a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>{<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>}, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2daccfec1f33129f" class="i method">SendAsync</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#8db1297431894c7a" class="i method">CreateBatchAsync</a>(<a href="CreateBatchOptions.cs.html#efa8982626004b5d" class="t t">CreateBatchOptions</a>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="23e1f2c34632da0c" href="../R/23e1f2c34632da0c.html" target="n" data-glyph="72,1" class="i method">SendAsync</a>(<a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r42 rd" class="r42 r">eventBatch</span>,
                                            <a href="SendEventOptions.cs.html#b41cc3b18fb38fa6" class="t t">SendEventOptions</a> <span id="r43 rd" class="r43 r">options</span>,
                                            <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r44 rd" class="r44 r">cancellationToken</span> = <b>default</b>)
        {
            <span class="r43 r">options</span> = <span class="r43 r">options</span>?.<a href="SendEventOptions.cs.html#c63668aee76073c9" class="i method">Clone</a>() ?? <a href="#821b504168147ec5" class="i field">DefaultSendOptions</a>;
 
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r42 r">eventBatch</span>, <b>nameof</b>(<span class="r42 r">eventBatch</span>));
            <a href="#7291ef53ddc18c44" class="i method">AssertSinglePartitionReference</a>(<span class="r43 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r43 r">options</span>.<a href="SendEventOptions.cs.html#971b0419619f9e72" class="i property">PartitionKey</a>);
 
            <a href="@1@netstandard/A.html#b040fb780bdd59f4" class="k">var</a> <span id="r45 rd" class="r45 r">events</span> = <span class="r42 r">eventBatch</span> <b>switch</b>
            {
                <a href="@1@netstandard/A.html#b040fb780bdd59f4" class="t t">IReadOnlyList</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r46 rd" class="r46 r">eventList</span> =&gt; <span class="r46 r">eventList</span>,
                <b>_</b> =&gt; <span class="r42 r">eventBatch</span>.<a href="@1@netstandard/A.html#e276d6892241255b" class="i method">ToList</a>()
            };
 
            <b>if</b> (<span class="r45 r">events</span>.<a href="@1@netstandard/A.html#6f182bb82f68780e" class="i property">Count</a> == 0)
            {
                <b>return</b>;
            }
 
            <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="k">var</a> <span id="r47 rd" class="r47 r">sendTask</span> = (<a href="#086ff8df84f0af37" class="i property">Options</a>.<a href="EventHubProducerClientOptions.cs.html#f34456dcb257b744" class="i property">EnableIdempotentPartitions</a>)
                ? <a href="#91ae86a9c35b9c33" class="i method">SendIdempotentAsync</a>(<span class="r45 r">events</span>, <span class="r43 r">options</span>, <span class="r44 r">cancellationToken</span>)
                : <a href="#391f7f501b060c97" class="i method">SendInternalAsync</a>(<span class="r45 r">events</span>, <span class="r43 r">options</span>, <span class="r44 r">cancellationToken</span>);
 
            <b>await</b> <span class="r47 r">sendTask</span>.<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Sends a set of events to the associated Event Hub using a batched approach.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">eventBatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of event data to send. A batch may be created using </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5bdaf0d46659f31f" class="i method">CreateBatchAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   A task to be resolved on when the operation has completed; if no exception is thrown when awaited, the</span>
        <span class="c">///</span><span class="c">   Event Hubs service has acknowledge receipt and assumed responsibility for delivery of the batch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   When published, the result is atomic; either all events that belong to the batch were successful or all</span>
        <span class="c">///</span><span class="c">   have failed.  Partial success is not possible.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5bdaf0d46659f31f" class="i method">CreateBatchAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="2daccfec1f33129f" href="../R/2daccfec1f33129f.html" target="n" data-glyph="72,1" class="i method">SendAsync</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a> <span id="r48 rd" class="r48 r">eventBatch</span>,
                                            <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r49 rd" class="r49 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r48 r">eventBatch</span>, <b>nameof</b>(<span class="r48 r">eventBatch</span>));
            <a href="#7291ef53ddc18c44" class="i method">AssertSinglePartitionReference</a>(<span class="r48 r">eventBatch</span>.<a href="EventDataBatch.cs.html#2e9e35fbafdda2c7" class="i property">SendOptions</a>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r48 r">eventBatch</span>.<a href="EventDataBatch.cs.html#2e9e35fbafdda2c7" class="i property">SendOptions</a>.<a href="SendEventOptions.cs.html#971b0419619f9e72" class="i property">PartitionKey</a>);
 
            <b>if</b> (<span class="r48 r">eventBatch</span>.<a href="EventDataBatch.cs.html#529a3bc3bdf5f8c5" class="i property">Count</a> == 0)
            {
                <b>return</b>;
            }
 
            <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="k">var</a> <span id="r50 rd" class="r50 r">sendTask</span> = (<a href="#086ff8df84f0af37" class="i property">Options</a>.<a href="EventHubProducerClientOptions.cs.html#f34456dcb257b744" class="i property">EnableIdempotentPartitions</a>)
                ? <a href="#ff92eddb9e380fb7" class="i method">SendIdempotentAsync</a>(<span class="r48 r">eventBatch</span>, <span class="r49 r">cancellationToken</span>)
                : <a href="#73f6390fc79e9620" class="i method">SendInternalAsync</a>(<span class="r48 r">eventBatch</span>, <span class="r49 r">cancellationToken</span>);
 
            <b>await</b> <span class="r50 r">sendTask</span>.<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Creates a size-constraint batch to which </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> may be added using a try-based pattern.  If an event would</span>
        <span class="c">///</span><span class="c">   exceed the maximum allowable size of the batch, the batch will not allow adding the event and signal that scenario using its</span>
        <span class="c">///</span><span class="c">   return value.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">   Because events that would violate the size constraint cannot be added, publishing a batch will not trigger an exception when</span>
        <span class="c">///</span><span class="c">   attempting to send the events to the Event Hubs service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> with the default batch options.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#8db1297431894c7a" class="i method">CreateBatchAsync</a>(<a href="CreateBatchOptions.cs.html#efa8982626004b5d" class="t t">CreateBatchOptions</a>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2daccfec1f33129f" class="i method">SendAsync</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <span class="t t">ValueTask</span>&lt;<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a>&gt; <a id="5bdaf0d46659f31f" href="../R/5bdaf0d46659f31f.html" target="n" data-glyph="72,1" class="i method">CreateBatchAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r51 rd" class="r51 r">cancellationToken</span> = <b>default</b>) =&gt; <b>await</b> <a href="#8db1297431894c7a" class="i method">CreateBatchAsync</a>(<b>null</b>, <span class="r51 r">cancellationToken</span>).<span class="i method">ConfigureAwait</span>(<b>false</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Creates a size-constraint batch to which </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> may be added using a try-based pattern.  If an event would</span>
        <span class="c">///</span><span class="c">   exceed the maximum allowable size of the batch, the batch will not allow adding the event and signal that scenario using its</span>
        <span class="c">///</span><span class="c">   return value.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">   Because events that would violate the size constraint cannot be added, publishing a batch will not trigger an exception when</span>
        <span class="c">///</span><span class="c">   attempting to send the events to the Event Hubs service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of options to consider when creating this batch.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> with the requested </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">options</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5bdaf0d46659f31f" class="i method">CreateBatchAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2daccfec1f33129f" class="i method">SendAsync</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <span class="t t">ValueTask</span>&lt;<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a>&gt; <a id="8db1297431894c7a" href="../R/8db1297431894c7a.html" target="n" data-glyph="72,1" class="i method">CreateBatchAsync</a>(<a href="CreateBatchOptions.cs.html#efa8982626004b5d" class="t t">CreateBatchOptions</a> <span id="r52 rd" class="r52 r">options</span>,
                                                                        <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r53 rd" class="r53 r">cancellationToken</span> = <b>default</b>)
        {
            <span class="r52 r">options</span> = <span class="r52 r">options</span>?.<a href="CreateBatchOptions.cs.html#9ebdd05d656a8449" class="i method">Clone</a>() ?? <b>new</b> <a href="CreateBatchOptions.cs.html#efa8982626004b5d" class="t constructor">CreateBatchOptions</a>();
            <a href="#7291ef53ddc18c44" class="i method">AssertSinglePartitionReference</a>(<span class="r52 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r52 r">options</span>.<a href="SendEventOptions.cs.html#971b0419619f9e72" class="i property">PartitionKey</a>);
 
            <a href="../Core/TransportEventBatch.cs.html#d626c58b5be68e2d" class="t t">TransportEventBatch</a> <span id="r54 rd" class="r54 r">transportBatch</span> = <b>await</b> <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#26daf10c99a37c15" class="i property">EventHubProducer</a>.<a href="../Core/TransportProducer.cs.html#ce36db5f11df79e6" class="i method">CreateBatchAsync</a>(<span class="r52 r">options</span>, <span class="r53 r">cancellationToken</span>).<span class="i method">ConfigureAwait</span>(<b>false</b>);
            <b>return</b> <b>new</b> <a href="EventDataBatch.cs.html#d227769487dc876f" class="t constructor">EventDataBatch</a>(<span class="r54 r">transportBatch</span>, <a href="#22b20f2db40d78c1" class="i property">FullyQualifiedNamespace</a>, <a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r52 r">options</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Closes the producer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task to be resolved on when the operation has completed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="2eb79cfef4719809" href="../R/2eb79cfef4719809.html" target="n" data-glyph="72,1" class="i method">CloseAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r55 rd" class="r55 r">cancellationToken</span> = <b>default</b>)
        {
            <span class="r55 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
 
            <b>if</b> (<a href="#c76931ed1332ae9f" class="i property">IsClosed</a>)
            {
                <b>return</b>;
            }
 
            <a href="#c76931ed1332ae9f" class="i property">IsClosed</a> = <b>true</b>;
 
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r56 rd" class="r56 r">identifier</span> = <a href="#35dd94cfbec55f95" class="i method">GetHashCode</a>().<a href="@1@netstandard/A.html#2b1c2bd27f3489eb" class="i method">ToString</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
            <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#56966cf73c9a3478" class="i method">ClientCloseStart</a>(<b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>), <a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r56 r">identifier</span>);
 
            <span class="c">// Attempt to close the pool of producers.  In the event that an exception is encountered,</span>
            <span class="c">// it should not impact the attempt to close the connection, assuming ownership.</span>
 
            <a href="@1@netstandard/A.html#f092fb2b893a0162" class="k">var</a> <span id="r57 rd" class="r57 r">transportProducerPoolException</span> = <b>default</b>(<a href="@1@netstandard/A.html#f092fb2b893a0162" class="t t">Exception</a>);
 
            <b>try</b>
            {
                <b>await</b> <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#f9c50ea52da5d25b" class="i method">CloseAsync</a>(<span class="r55 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
            }
            <b>catch</b> (<a href="@1@netstandard/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r58 rd" class="r58 r">ex</span>)
            {
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#5f1a3e62e8b77661" class="i method">ClientCloseError</a>(<b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>), <a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r56 r">identifier</span>, <span class="r58 r">ex</span>.<a href="@1@netstandard/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                <span class="r57 r">transportProducerPoolException</span> = <span class="r58 r">ex</span>;
            }
 
            <span class="c">// An exception when closing the connection supersedes one observed when closing the</span>
            <span class="c">// individual transport clients.</span>
 
            <b>try</b>
            {
                <b>if</b> (<a href="#b3dcd4d204e256f4" class="i property">OwnsConnection</a>)
                {
                    <b>await</b> <a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#d0606e64a963d0b5" class="i method">CloseAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>.<a href="@1@netstandard/A.html#ec32c41597007382" class="i property">None</a>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
                }
            }
            <b>catch</b> (<a href="@1@netstandard/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r59 rd" class="r59 r">ex</span>)
            {
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#5f1a3e62e8b77661" class="i method">ClientCloseError</a>(<b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>), <a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r56 r">identifier</span>, <span class="r59 r">ex</span>.<a href="@1@netstandard/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                <b>throw</b>;
            }
            <b>finally</b>
            {
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#001d1b45b857f69e" class="i method">ClientCloseComplete</a>(<b>nameof</b>(<a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a>), <a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r56 r">identifier</span>);
            }
 
            <span class="c">// If there was an active exception pending from closing the</span>
            <span class="c">// transport producer pool, surface it now.</span>
 
            <b>if</b> (<span class="r57 r">transportProducerPoolException</span> != <b>default</b>)
            {
                <a href="@1@netstandard/A.html#1443447025759846" class="t t">ExceptionDispatchInfo</a>.<a href="@1@netstandard/A.html#139923899a417d5a" class="i method">Capture</a>(<span class="r57 r">transportProducerPoolException</span>).<a href="@1@netstandard/A.html#fc3b312e2d0ab87a" class="i method">Throw</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Performs the task needed to clean up resources used by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7beffbdf44e79fc" class="t t">EventHubProducerClient</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c">   including ensuring that the client itself has been closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task to be resolved on when the operation has completed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#5e00de6576fb9ce7" class="t constructor">SuppressMessage</a>(<span class="s">&quot;Usage&quot;</span>, <span class="s">&quot;AZC0002:Ensure all service methods take an optional CancellationToken parameter.&quot;</span>, <a href="@1@netstandard/A.html#ce02a652a479502a" class="i property">Justification</a> = <span class="s">&quot;This signature must match the IAsyncDisposable interface.&quot;</span>)]
        <b>public virtual async</b> <span class="t t">ValueTask</span> <a id="5234a099c0472763" href="../R/5234a099c0472763.html" target="n" data-glyph="72,1" class="i method">DisposeAsync</a>()
        {
            <b>await</b> <a href="#2eb79cfef4719809" class="i method">CloseAsync</a>().<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
            <a href="@1@netstandard/A.html#25d9c1e022317a99" class="t t">GC</a>.<a href="@1@netstandard/A.html#2673f5220a565bf2" class="i method">SuppressFinalize</a>(<a href="#b7beffbdf44e79fc" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Determines whether the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#d9262ceecc1719ab" class="t t">Object</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is equal to this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#d9262ceecc1719ab" class="t t">Object</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> to compare with this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#d9262ceecc1719ab" class="t t">Object</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is equal to this instance; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@1@netstandard/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@1@netstandard/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public override bool</b> <a id="1ec6cd5deeac1bd1" href="../R/1ec6cd5deeac1bd1.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r60 rd" class="r60 r">obj</span>) =&gt; <a href="@1@netstandard/A.html#d9262ceecc1719ab" class="k">base</a>.<a href="@1@netstandard/A.html#517682d5f6f4f8b4" class="i method">Equals</a>(<span class="r60 r">obj</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Returns a hash code for this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A hash code for this instance, suitable for use in hashing algorithms and data structures like a hash table.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@1@netstandard/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@1@netstandard/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public override int</b> <a id="35dd94cfbec55f95" href="../R/35dd94cfbec55f95.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>() =&gt; <a href="@1@netstandard/A.html#d9262ceecc1719ab" class="k">base</a>.<a href="@1@netstandard/A.html#4de9cf234d0d8b16" class="i method">GetHashCode</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Converts the instance to string representation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="t t">String</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> that represents this instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@1@netstandard/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@1@netstandard/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public override string</b> <a id="5202439b1a235c9e" href="../R/5202439b1a235c9e.html" target="n" data-glyph="72,1" class="i method">ToString</a>() =&gt; <a href="@1@netstandard/A.html#d9262ceecc1719ab" class="k">base</a>.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Sends a set of events to the associated Event Hub using a batched approach.  Because the batch is implicitly created, the size of the event set is not</span>
        <span class="c">///</span><span class="c">   validated until this method is invoked.  The call will fail if the size of the specified set of events exceeds the maximum allowable size of a single batch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">events</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of event data to send.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of options to consider when sending this batch.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="391f7f501b060c97" href="../R/391f7f501b060c97.html" target="n" data-glyph="76,1" class="i method">SendInternalAsync</a>(<a href="@1@netstandard/A.html#b040fb780bdd59f4" class="t t">IReadOnlyList</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r61 rd" class="r61 r">events</span>,
                                             <a href="SendEventOptions.cs.html#b41cc3b18fb38fa6" class="t t">SendEventOptions</a> <span id="r62 rd" class="r62 r">options</span>,
                                             <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r63 rd" class="r63 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r64 rd" class="r64 r">attempts</span> = 0;
            <a href="@1@netstandard/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r65 rd" class="r65 r">diagnosticIdentifiers</span> = <b>new</b> <a href="@1@netstandard/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>&gt;();
 
            <a href="#203962ba66c38fa8" class="i method">InstrumentMessages</a>(<span class="r61 r">events</span>);
 
            <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="k">var</a> <span id="r66 rd" class="r66 r">eventData</span> <b>in</b> <span class="r61 r">events</span>)
            {
                <b>if</b> (<a href="../SharedSource/Diagnostics/EventDataInstrumentation.cs.html#29a2ad8b9661f165" class="t t">EventDataInstrumentation</a>.<a href="../SharedSource/Diagnostics/EventDataInstrumentation.cs.html#443a64f1538af62f" class="i method">TryExtractDiagnosticId</a>(<span class="r66 r">eventData</span>, <b>out</b> <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r67 rd" class="r67 r">identifier</span>))
                {
                    <span class="r65 r">diagnosticIdentifiers</span>.<a href="@1@netstandard/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r67 r">identifier</span>);
                }
            }
 
            <b>using</b> <a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#df3fc9a09421f052" class="t t">DiagnosticScope</a> <span id="r68 rd" class="r68 r">scope</span> = <a href="#150264dd30ed83ad" class="i method">CreateDiagnosticScope</a>(<span class="r65 r">diagnosticIdentifiers</span>);
            <a href="../Core/TransportProducerPool.cs.html#6f70293ef8e7152c" class="k">var</a> <span id="r69 rd" class="r69 r">pooledProducer</span> = <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#2fcf6bab33a7b033" class="i method">GetPooledProducer</a>(<span class="r62 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <a href="#074c4d935365654e" class="i field">PartitionProducerLifespan</a>);
 
            <b>while</b> (!<span class="r63 r">cancellationToken</span>.<a href="@1@netstandard/A.html#f32abbe8e2f1f6c1" class="i property">IsCancellationRequested</a>)
            {
                <b>try</b>
                {
                    <b>await using</b> <b>var</b> <span id="r70 rd" class="r70 r">_</span> = <span class="r69 r">pooledProducer</span>.<span class="i method">ConfigureAwait</span>(<b>false</b>);
                    <b>await</b> <span class="r69 r">pooledProducer</span>.<a href="../Core/TransportProducerPool.cs.html#22fd7595026be5e3" class="i property">TransportProducer</a>.<a href="../Core/TransportProducer.cs.html#020a8f380b84b899" class="i method">SendAsync</a>(<span class="r61 r">events</span>, <span class="r62 r">options</span>, <span class="r63 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
                    <b>return</b>;
                }
                <b>catch</b> (<a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a> <span id="r71 rd" class="r71 r">eventHubException</span>)
                    <b>when</b> (<span class="r71 r">eventHubException</span>.<a href="../EventHubsException.cs.html#efdefeb5416905cd" class="i property">Reason</a> == <a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#e5210b418cdfe2fd" class="t t">FailureReason</a>.<a href="../EventHubsException.cs.html#6a47ff45e3ab3874" class="i field">ClientClosed</a>
                        &amp;&amp; <a href="#a4f2ecb5070439af" class="i method">ShouldRecreateProducer</a>(<span class="r69 r">pooledProducer</span>.<a href="../Core/TransportProducerPool.cs.html#22fd7595026be5e3" class="i property">TransportProducer</a>, <span class="r62 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>))
                {
                    <b>if</b> (++<span class="r64 r">attempts</span> &gt;= <a href="#dc87c93644a34960" class="i field">MaximumCreateProducerAttempts</a>)
                    {
                        <span class="r68 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#3d6de3437ae4c961" class="i method">Failed</a>(<span class="r71 r">eventHubException</span>);
                        <b>throw</b>;
                    }
 
                    <span class="r69 r">pooledProducer</span> = <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#2fcf6bab33a7b033" class="i method">GetPooledProducer</a>(<span class="r62 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <a href="#074c4d935365654e" class="i field">PartitionProducerLifespan</a>);
                }
                <b>catch</b> (<a href="@1@netstandard/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r72 rd" class="r72 r">ex</span>)
                {
                    <span class="r68 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#3d6de3437ae4c961" class="i method">Failed</a>(<span class="r72 r">ex</span>);
                    <b>throw</b>;
                }
            }
 
            <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#60da317efa09fc04" class="t constructor">TaskCanceledException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Sends a set of events to the associated Event Hub using a batched approach.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">eventBatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of event data to send. A batch may be created using </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5bdaf0d46659f31f" class="i method">CreateBatchAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="73f6390fc79e9620" href="../R/73f6390fc79e9620.html" target="n" data-glyph="76,1" class="i method">SendInternalAsync</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a> <span id="r73 rd" class="r73 r">eventBatch</span>,
                                             <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r74 rd" class="r74 r">cancellationToken</span> = <b>default</b>)
        {
            <b>using</b> <a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#df3fc9a09421f052" class="t t">DiagnosticScope</a> <span id="r75 rd" class="r75 r">scope</span> = <a href="#150264dd30ed83ad" class="i method">CreateDiagnosticScope</a>(<span class="r73 r">eventBatch</span>.<a href="EventDataBatch.cs.html#ad20e621d6e5ad11" class="i method">GetEventDiagnosticIdentifiers</a>());
 
            <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r76 rd" class="r76 r">attempts</span> = 0;
            <a href="../Core/TransportProducerPool.cs.html#6f70293ef8e7152c" class="k">var</a> <span id="r77 rd" class="r77 r">pooledProducer</span> = <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#2fcf6bab33a7b033" class="i method">GetPooledProducer</a>(<span class="r73 r">eventBatch</span>.<a href="EventDataBatch.cs.html#2e9e35fbafdda2c7" class="i property">SendOptions</a>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <a href="#074c4d935365654e" class="i field">PartitionProducerLifespan</a>);
 
            <b>try</b>
            {
                <b>while</b> (!<span class="r74 r">cancellationToken</span>.<a href="@1@netstandard/A.html#f32abbe8e2f1f6c1" class="i property">IsCancellationRequested</a>)
                {
                    <b>try</b>
                    {
                        <b>await using</b> <b>var</b> <span id="r78 rd" class="r78 r">_</span> = <span class="r77 r">pooledProducer</span>.<span class="i method">ConfigureAwait</span>(<b>false</b>);
 
                        <span class="r73 r">eventBatch</span>.<a href="EventDataBatch.cs.html#f8f379af3d34fe26" class="i method">Lock</a>();
                        <b>await</b> <span class="r77 r">pooledProducer</span>.<a href="../Core/TransportProducerPool.cs.html#22fd7595026be5e3" class="i property">TransportProducer</a>.<a href="../Core/TransportProducer.cs.html#0d6991905ae69cf6" class="i method">SendAsync</a>(<span class="r73 r">eventBatch</span>, <span class="r74 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
                        <b>return</b>;
                    }
                    <b>catch</b> (<a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a> <span id="r79 rd" class="r79 r">eventHubException</span>)
                        <b>when</b> (<span class="r79 r">eventHubException</span>.<a href="../EventHubsException.cs.html#efdefeb5416905cd" class="i property">Reason</a> == <a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#e5210b418cdfe2fd" class="t t">FailureReason</a>.<a href="../EventHubsException.cs.html#6a47ff45e3ab3874" class="i field">ClientClosed</a> &amp;&amp; <a href="#a4f2ecb5070439af" class="i method">ShouldRecreateProducer</a>(<span class="r77 r">pooledProducer</span>.<a href="../Core/TransportProducerPool.cs.html#22fd7595026be5e3" class="i property">TransportProducer</a>, <span class="r73 r">eventBatch</span>.<a href="EventDataBatch.cs.html#2e9e35fbafdda2c7" class="i property">SendOptions</a>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>))
                    {
                        <b>if</b> (++<span class="r76 r">attempts</span> &gt;= <a href="#dc87c93644a34960" class="i field">MaximumCreateProducerAttempts</a>)
                        {
                            <span class="r75 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#3d6de3437ae4c961" class="i method">Failed</a>(<span class="r79 r">eventHubException</span>);
                            <b>throw</b>;
                        }
 
                        <span class="r77 r">pooledProducer</span> = <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#2fcf6bab33a7b033" class="i method">GetPooledProducer</a>(<span class="r73 r">eventBatch</span>.<a href="EventDataBatch.cs.html#2e9e35fbafdda2c7" class="i property">SendOptions</a>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <a href="#074c4d935365654e" class="i field">PartitionProducerLifespan</a>);
                    }
                    <b>catch</b> (<a href="@1@netstandard/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r80 rd" class="r80 r">ex</span>)
                    {
                        <span class="r75 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#3d6de3437ae4c961" class="i method">Failed</a>(<span class="r80 r">ex</span>);
                        <b>throw</b>;
                    }
                }
            }
            <b>finally</b>
            {
                <span class="r73 r">eventBatch</span>.<a href="EventDataBatch.cs.html#ae1f6cb9af8be5e6" class="i method">Unlock</a>();
            }
 
            <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#60da317efa09fc04" class="t constructor">TaskCanceledException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Sends a set of events to the associated Event Hub using a batched approach.  Because the batch is implicitly created, the size of the event set is not</span>
        <span class="c">///</span><span class="c">   validated until this method is invoked.  The call will fail if the size of the specified set of events exceeds the maximum allowable size of a single batch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">eventSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of event data to send.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of options to consider when sending this batch.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="91ae86a9c35b9c33" href="../R/91ae86a9c35b9c33.html" target="n" data-glyph="76,1" class="i method">SendIdempotentAsync</a>(<a href="@1@netstandard/A.html#b040fb780bdd59f4" class="t t">IReadOnlyList</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r81 rd" class="r81 r">eventSet</span>,
                                               <a href="SendEventOptions.cs.html#b41cc3b18fb38fa6" class="t t">SendEventOptions</a> <span id="r82 rd" class="r82 r">options</span>,
                                               <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r83 rd" class="r83 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="#a639250ec22cdf06" class="i method">AssertPartitionIsReferenced</a>(<span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
            <a href="#c09cbc30faa275da" class="i method">AssertIdempotentEventsNotPublished</a>(<span class="r81 r">eventSet</span>);
 
            <b>try</b>
            {
                <span class="r83 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#8dd24db007001890" class="i method">IdempotentPublishStart</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
 
                <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="k">var</a> <span id="r84 rd" class="r84 r">partitionState</span> = <a href="#dbd7b33e45213fb5" class="i property">PartitionState</a>.<a href="@1@netstandard/A.html#d8b8308343be2763" class="i method">GetOrAdd</a>(<span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <b>new</b> <a href="PartitionPublishingState.cs.html#df2eaf37e852ffa0" class="t constructor">PartitionPublishingState</a>(<span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>));
 
                <b>try</b>
                {
                    <span class="r83 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
 
                    <b>await</b> <span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#1546a6a2c4d39bfd" class="i property">PublishingGuard</a>.<a href="@1@netstandard/A.html#7a679e542c73988f" class="i method">WaitAsync</a>(<span class="r83 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#0f46b9863a0263ae" class="i method">IdempotentSynchronizationAcquire</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
 
                    <span class="c">// Ensure that the partition state has been initialized.</span>
 
                    <b>if</b> (!<span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#b69b6c9229ab9ce0" class="i property">IsInitialized</a>)
                    {
                        <span class="r83 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
                        <b>await</b> <a href="#a3e70e634d462679" class="i method">InitializePartitionStateAsync</a>(<span class="r84 r">partitionState</span>, <span class="r83 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
                    }
 
                    <span class="c">// Sequence the events for publishing.</span>
 
                    <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r85 rd" class="r85 r">lastSequence</span> = <span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7b38d1fa76071c95" class="i property">Value</a>;
                    <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r86 rd" class="r86 r">firstSequence</span> = <span class="r85 r">lastSequence</span>;
 
                    <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="k">var</a> <span id="r87 rd" class="r87 r">eventData</span> <b>in</b> <span class="r81 r">eventSet</span>)
                    {
                        <span class="r85 r">lastSequence</span> = <a href="#a0c2f3960a1d8221" class="i method">NextSequence</a>(<span class="r85 r">lastSequence</span>);
                        <span class="r87 r">eventData</span>.<a href="../EventData.cs.html#505046d1fa2e7e55" class="i property">PendingPublishSequenceNumber</a> = <span class="r85 r">lastSequence</span>;
                        <span class="r87 r">eventData</span>.<a href="../EventData.cs.html#e9d0a727951ec4ed" class="i property">PendingProducerGroupId</a> = <span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#121002e64f73f307" class="i property">ProducerGroupId</a>;
                        <span class="r87 r">eventData</span>.<a href="../EventData.cs.html#555cc5e6b915f091" class="i property">PendingProducerOwnerLevel</a> = <span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#28e20d3dd3215739" class="i property">OwnerLevel</a>;
                    }
 
                    <span class="c">// Publish the events.</span>
 
                    <span class="r83 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
 
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#57466ca2034fcc45" class="i method">IdempotentSequencePublish</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r86 r">firstSequence</span>, <span class="r85 r">lastSequence</span>);
                    <b>await</b> <a href="#391f7f501b060c97" class="i method">SendInternalAsync</a>(<span class="r81 r">eventSet</span>, <span class="r82 r">options</span>, <span class="r83 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
                    <span class="c">// Update state and commit the state.</span>
 
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#cebffe5f6341bad3" class="i method">IdempotentSequenceUpdate</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7b38d1fa76071c95" class="i property">Value</a>, <span class="r85 r">lastSequence</span>);
                    <span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a> = <span class="r85 r">lastSequence</span>;
 
                    <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="k">var</a> <span id="r88 rd" class="r88 r">eventData</span> <b>in</b> <span class="r81 r">eventSet</span>)
                    {
                        <span class="r88 r">eventData</span>.<a href="../EventData.cs.html#f6889594592838de" class="i method">CommitPublishingState</a>();
                    }
                }
                <b>catch</b>
                {
                    <span class="c">// Clear the pending state in the face of an exception.</span>
 
                    <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="k">var</a> <span id="r89 rd" class="r89 r">eventData</span> <b>in</b> <span class="r81 r">eventSet</span>)
                    {
                        <span class="r89 r">eventData</span>.<a href="../EventData.cs.html#3527cb400f3f18a9" class="i method">ClearPublishingState</a>();
                    }
 
                    <b>throw</b>;
                }
                <b>finally</b>
                {
                    <span class="r84 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#1546a6a2c4d39bfd" class="i property">PublishingGuard</a>.<a href="@1@netstandard/A.html#f7527810bcfc0842" class="i method">Release</a>();
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#35ac14c01bda5b51" class="i method">IdempotentSynchronizationRelease</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
                }
            }
            <b>catch</b> (<a href="@1@netstandard/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r90 rd" class="r90 r">ex</span>)
            {
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#208b565bdf57a710" class="i method">IdempotentPublishError</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r90 r">ex</span>.<a href="@1@netstandard/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                <b>throw</b>;
            }
            <b>finally</b>
            {
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#b715b0088aee9ba0" class="i method">IdempotentPublishComplete</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r82 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Sends a set of events to the associated Event Hub using a batched approach.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">eventBatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of event data to send. A batch may be created using </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5bdaf0d46659f31f" class="i method">CreateBatchAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>)<span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="ff92eddb9e380fb7" href="../R/ff92eddb9e380fb7.html" target="n" data-glyph="76,1" class="i method">SendIdempotentAsync</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a> <span id="r91 rd" class="r91 r">eventBatch</span>,
                                               <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r92 rd" class="r92 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="SendEventOptions.cs.html#b41cc3b18fb38fa6" class="k">var</a> <span id="r93 rd" class="r93 r">options</span> = <span class="r91 r">eventBatch</span>.<a href="EventDataBatch.cs.html#2e9e35fbafdda2c7" class="i property">SendOptions</a>;
 
            <a href="#a639250ec22cdf06" class="i method">AssertPartitionIsReferenced</a>(<span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
            <a href="#cf38e6e872b36f9d" class="i method">AssertIdempotentBatchNotPublished</a>(<span class="r91 r">eventBatch</span>);
 
            <b>try</b>
            {
                <span class="r92 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#8dd24db007001890" class="i method">IdempotentPublishStart</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
 
                <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="k">var</a> <span id="r94 rd" class="r94 r">partitionState</span> = <a href="#dbd7b33e45213fb5" class="i property">PartitionState</a>.<a href="@1@netstandard/A.html#d8b8308343be2763" class="i method">GetOrAdd</a>(<span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <b>new</b> <a href="PartitionPublishingState.cs.html#df2eaf37e852ffa0" class="t constructor">PartitionPublishingState</a>(<span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>));
 
                <a href="@1@netstandard/A.html#b040fb780bdd59f4" class="k">var</a> <span id="r95 rd" class="r95 r">eventSet</span> = <span class="r91 r">eventBatch</span>.<a href="EventDataBatch.cs.html#ce1a601fff7086d5" class="i method">AsEnumerable</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt;() <b>switch</b>
                {
                    <a href="@1@netstandard/A.html#b040fb780bdd59f4" class="t t">IReadOnlyList</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r96 rd" class="r96 r">eventList</span> =&gt; <span class="r96 r">eventList</span>,
                    <a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r97 rd" class="r97 r">eventEnumerable</span> =&gt; <span class="r97 r">eventEnumerable</span>.<a href="@1@netstandard/A.html#e276d6892241255b" class="i method">ToList</a>()
                };
 
                <b>try</b>
                {
                    <span class="r92 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
 
                    <b>await</b> <span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#1546a6a2c4d39bfd" class="i property">PublishingGuard</a>.<a href="@1@netstandard/A.html#7a679e542c73988f" class="i method">WaitAsync</a>(<span class="r92 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#0f46b9863a0263ae" class="i method">IdempotentSynchronizationAcquire</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
 
                    <span class="c">// Ensure that the partition state has been initialized.</span>
 
                    <b>if</b> (!<span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#b69b6c9229ab9ce0" class="i property">IsInitialized</a>)
                    {
                        <span class="r92 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
                        <b>await</b> <a href="#a3e70e634d462679" class="i method">InitializePartitionStateAsync</a>(<span class="r94 r">partitionState</span>, <span class="r92 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
                    }
 
                    <span class="c">// Sequence the events for publishing.</span>
 
                    <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r98 rd" class="r98 r">lastSequence</span> = <span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7b38d1fa76071c95" class="i property">Value</a>;
                    <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r99 rd" class="r99 r">firstSequence</span> = <a href="#a0c2f3960a1d8221" class="i method">NextSequence</a>(<span class="r98 r">lastSequence</span>);
 
                    <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="k">var</a> <span id="r100 rd" class="r100 r">eventData</span> <b>in</b> <span class="r95 r">eventSet</span>)
                    {
                        <span class="r98 r">lastSequence</span> = <a href="#a0c2f3960a1d8221" class="i method">NextSequence</a>(<span class="r98 r">lastSequence</span>);
                        <span class="r100 r">eventData</span>.<a href="../EventData.cs.html#505046d1fa2e7e55" class="i property">PendingPublishSequenceNumber</a> = <span class="r98 r">lastSequence</span>;
                        <span class="r100 r">eventData</span>.<a href="../EventData.cs.html#e9d0a727951ec4ed" class="i property">PendingProducerGroupId</a> = <span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#121002e64f73f307" class="i property">ProducerGroupId</a>;
                        <span class="r100 r">eventData</span>.<a href="../EventData.cs.html#555cc5e6b915f091" class="i property">PendingProducerOwnerLevel</a> = <span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#28e20d3dd3215739" class="i property">OwnerLevel</a>;
                    }
 
                    <span class="c">// Publish the events.</span>
 
                    <span class="r92 r">cancellationToken</span>.<a href="../SharedSource/Core/CancellationTokenExtensions.cs.html#48bae066cbca26c9" class="i method">ThrowIfCancellationRequested</a>&lt;<a href="@1@netstandard/A.html#30edb7a318d221fa" class="t t">TaskCanceledException</a>&gt;();
 
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#57466ca2034fcc45" class="i method">IdempotentSequencePublish</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r99 r">firstSequence</span>, <span class="r98 r">lastSequence</span>);
                    <b>await</b> <a href="#73f6390fc79e9620" class="i method">SendInternalAsync</a>(<span class="r91 r">eventBatch</span>, <span class="r92 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
                    <span class="c">// Update state and commit the sequencing.  This needs only to happen at the batch level, as the contained</span>
                    <span class="c">// events are not accessible by callers.</span>
 
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#cebffe5f6341bad3" class="i method">IdempotentSequenceUpdate</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7b38d1fa76071c95" class="i property">Value</a>, <span class="r98 r">lastSequence</span>);
                    <span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a> = <span class="r98 r">lastSequence</span>;
                    <span class="r91 r">eventBatch</span>.<a href="EventDataBatch.cs.html#5ddf6ed597765ae4" class="i property">StartingPublishedSequenceNumber</a> = <span class="r99 r">firstSequence</span>;
                }
                <b>catch</b>
                {
                    <span class="c">// Clear the pending sequence numbers in the face of an exception.</span>
 
                    <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="k">var</a> <span id="r101 rd" class="r101 r">eventData</span> <b>in</b> <span class="r95 r">eventSet</span>)
                    {
                        <span class="r101 r">eventData</span>.<a href="../EventData.cs.html#3527cb400f3f18a9" class="i method">ClearPublishingState</a>();
                    }
 
                    <b>throw</b>;
                }
                <b>finally</b>
                {
                    <span class="r94 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#1546a6a2c4d39bfd" class="i property">PublishingGuard</a>.<a href="@1@netstandard/A.html#f7527810bcfc0842" class="i method">Release</a>();
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#35ac14c01bda5b51" class="i method">IdempotentSynchronizationRelease</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
                }
            }
            <b>catch</b> (<a href="@1@netstandard/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r102 rd" class="r102 r">ex</span>)
            {
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#208b565bdf57a710" class="i method">IdempotentPublishError</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>, <span class="r102 r">ex</span>.<a href="@1@netstandard/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                <b>throw</b>;
            }
            <b>finally</b>
            {
                <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#b715b0088aee9ba0" class="i method">IdempotentPublishComplete</a>(<a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <span class="r93 r">options</span>.<a href="SendEventOptions.cs.html#628257b063016f0c" class="i property">PartitionId</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes state instance for a given partition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">partitionState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The state of the partition to be initialized.  This parameter will be mutated by this call.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">partitionState</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter will be mutated by this call.  To avoid duplicate initialization or state corruption, this</span>
        <span class="c">///</span><span class="c">   method should only be called while the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a>.<a href="PartitionPublishingState.cs.html#1546a6a2c4d39bfd" class="i property">PublishingGuard</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> primitive of the state instance is held.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="a3e70e634d462679" href="../R/a3e70e634d462679.html" target="n" data-glyph="76,1" class="i method">InitializePartitionStateAsync</a>(<a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a> <span id="r103 rd" class="r103 r">partitionState</span>,
                                                         <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r104 rd" class="r104 r">cancellationToken</span> = <b>default</b>)
        {
            <b>if</b> (<span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#b69b6c9229ab9ce0" class="i property">IsInitialized</a>)
            {
                <b>return</b>;
            }
 
            <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r105 rd" class="r105 r">attempts</span> = 0;
            <a href="../Core/TransportProducerPool.cs.html#6f70293ef8e7152c" class="k">var</a> <span id="r106 rd" class="r106 r">pooledProducer</span> = <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#2fcf6bab33a7b033" class="i method">GetPooledProducer</a>(<span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#713daa174df21aed" class="i property">PartitionId</a>, <a href="#074c4d935365654e" class="i field">PartitionProducerLifespan</a>);
 
            <b>while</b> (!<span class="r104 r">cancellationToken</span>.<a href="@1@netstandard/A.html#f32abbe8e2f1f6c1" class="i property">IsCancellationRequested</a>)
            {
                <b>try</b>
                {
                    <b>await using</b> <b>var</b> <span id="r107 rd" class="r107 r">_</span> = <span class="r106 r">pooledProducer</span>.<span class="i method">ConfigureAwait</span>(<b>false</b>);
                    <a href="PartitionPublishingProperties.cs.html#6fbaf58e86a0ae15" class="k">var</a> <span id="r108 rd" class="r108 r">properties</span> = <b>await</b> <span class="r106 r">pooledProducer</span>.<a href="../Core/TransportProducerPool.cs.html#22fd7595026be5e3" class="i property">TransportProducer</a>.<a href="../Core/TransportProducer.cs.html#be61ff088809021c" class="i method">ReadInitializationPublishingPropertiesAsync</a>(<span class="r104 r">cancellationToken</span>).<span class="i method">ConfigureAwait</span>(<b>false</b>);
 
                    <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#121002e64f73f307" class="i property">ProducerGroupId</a> = <span class="r108 r">properties</span>.<a href="PartitionPublishingProperties.cs.html#07e585fe2345ce85" class="i property">ProducerGroupId</a>;
                    <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#28e20d3dd3215739" class="i property">OwnerLevel</a> = <span class="r108 r">properties</span>.<a href="PartitionPublishingProperties.cs.html#d5551406373e4742" class="i property">OwnerLevel</a>;
                    <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a> = <span class="r108 r">properties</span>.<a href="PartitionPublishingProperties.cs.html#0e8716acd3c0a7db" class="i property">LastPublishedSequenceNumber</a>;
 
                    <span class="c">// If the state was not initialized and no exception has occurred, then the service is behaving</span>
                    <span class="c">// unexpectedly and the client should be considered invalid.</span>
 
                    <b>if</b> (!<span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#b69b6c9229ab9ce0" class="i property">IsInitialized</a>)
                    {
                        <b>throw</b> <b>new</b> <a href="../EventHubsException.cs.html#0ec223ddb2f37c69" class="t constructor">EventHubsException</a>(<b>false</b>, <a href="#bb3c308a01df058d" class="i property">EventHubName</a>, <a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#e5210b418cdfe2fd" class="t t">FailureReason</a>.<a href="../EventHubsException.cs.html#8bb47c8e62df4e40" class="i field">InvalidClientState</a>);
                    }
 
                    <a href="../Diagnostics/EventHubsEventSource.cs.html#88bca2b6f3cfd5f2" class="t t">EventHubsEventSource</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#c960e5896e4dd589" class="i property">Log</a>.<a href="../Diagnostics/EventHubsEventSource.cs.html#4f3d7ea0ada387de" class="i method">IdempotentPublishInitializeState</a>(
                        <a href="#bb3c308a01df058d" class="i property">EventHubName</a>,
                        <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#713daa174df21aed" class="i property">PartitionId</a>,
                        <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#121002e64f73f307" class="i property">ProducerGroupId</a>.<a href="@1@netstandard/A.html#7b38d1fa76071c95" class="i property">Value</a>,
                        <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#28e20d3dd3215739" class="i property">OwnerLevel</a>.<a href="@1@netstandard/A.html#7b38d1fa76071c95" class="i property">Value</a>,
                        <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7b38d1fa76071c95" class="i property">Value</a>);
 
                    <b>return</b>;
                }
                <b>catch</b> (<a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a> <span id="r109 rd" class="r109 r">eventHubException</span>)
                    <b>when</b> (<span class="r109 r">eventHubException</span>.<a href="../EventHubsException.cs.html#efdefeb5416905cd" class="i property">Reason</a> == <a href="../EventHubsException.cs.html#fe9b3d9ffc64177d" class="t t">EventHubsException</a>.<a href="../EventHubsException.cs.html#e5210b418cdfe2fd" class="t t">FailureReason</a>.<a href="../EventHubsException.cs.html#6a47ff45e3ab3874" class="i field">ClientClosed</a> &amp;&amp; <a href="#a4f2ecb5070439af" class="i method">ShouldRecreateProducer</a>(<span class="r106 r">pooledProducer</span>.<a href="../Core/TransportProducerPool.cs.html#22fd7595026be5e3" class="i property">TransportProducer</a>, <span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#713daa174df21aed" class="i property">PartitionId</a>))
                {
                    <b>if</b> (++<span class="r105 r">attempts</span> &gt;= <a href="#dc87c93644a34960" class="i field">MaximumCreateProducerAttempts</a>)
                    {
                        <b>throw</b>;
                    }
 
                    <span class="r106 r">pooledProducer</span> = <a href="#3ca7484d6d1e808c" class="i property">PartitionProducerPool</a>.<a href="../Core/TransportProducerPool.cs.html#2fcf6bab33a7b033" class="i method">GetPooledProducer</a>(<span class="r103 r">partitionState</span>.<a href="PartitionPublishingState.cs.html#713daa174df21aed" class="i property">PartitionId</a>, <a href="#074c4d935365654e" class="i field">PartitionProducerLifespan</a>);
                }
            }
 
            <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#60da317efa09fc04" class="t constructor">TaskCanceledException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Creates and configures a diagnostics scope to be used for instrumenting</span>
        <span class="c">///</span><span class="c">   events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">diagnosticIdentifiers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of diagnostic identifiers to which the scope will be linked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The requested </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#df3fc9a09421f052" class="t t">DiagnosticScope</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private</b> <a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#df3fc9a09421f052" class="t t">DiagnosticScope</a> <a id="150264dd30ed83ad" href="../R/150264dd30ed83ad.html" target="n" data-glyph="76,1" class="i method">CreateDiagnosticScope</a>(<a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r110 rd" class="r110 r">diagnosticIdentifiers</span>)
        {
            <a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#df3fc9a09421f052" class="t t">DiagnosticScope</a> <span id="r111 rd" class="r111 r">scope</span> = <a href="../SharedSource/Diagnostics/EventDataInstrumentation.cs.html#29a2ad8b9661f165" class="t t">EventDataInstrumentation</a>.<a href="../SharedSource/Diagnostics/EventDataInstrumentation.cs.html#c97c98c65f7ca1ea" class="i property">ScopeFactory</a>.<a href="../SharedSource/Azure.Core/DiagnosticScopeFactory.cs.html#74f1bd8b1f1143c8" class="i method">CreateScope</a>(<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#291e06d56b1b9d57" class="t t">DiagnosticProperty</a>.<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#6d3920d42ab2bb46" class="i property">ProducerActivityName</a>);
            <span class="r111 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#de8c555385928780" class="i method">AddAttribute</a>(<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#291e06d56b1b9d57" class="t t">DiagnosticProperty</a>.<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#db1f99aa4b272c1b" class="i field">KindAttribute</a>, <a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#291e06d56b1b9d57" class="t t">DiagnosticProperty</a>.<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#dcca529aeac6733f" class="i field">ClientKind</a>);
            <span class="r111 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#de8c555385928780" class="i method">AddAttribute</a>(<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#291e06d56b1b9d57" class="t t">DiagnosticProperty</a>.<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#3dc29346ebd86613" class="i field">ServiceContextAttribute</a>, <a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#291e06d56b1b9d57" class="t t">DiagnosticProperty</a>.<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#c112954cf7a14759" class="i field">EventHubsServiceContext</a>);
            <span class="r111 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#de8c555385928780" class="i method">AddAttribute</a>(<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#291e06d56b1b9d57" class="t t">DiagnosticProperty</a>.<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#4aaa8d131d71f3b6" class="i field">EventHubAttribute</a>, <a href="#bb3c308a01df058d" class="i property">EventHubName</a>);
            <span class="r111 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#de8c555385928780" class="i method">AddAttribute</a>(<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#291e06d56b1b9d57" class="t t">DiagnosticProperty</a>.<a href="../SharedSource/Diagnostics/DiagnosticProperty.cs.html#a647f64c774b9985" class="i field">EndpointAttribute</a>, <a href="#22b20f2db40d78c1" class="i property">FullyQualifiedNamespace</a>);
 
            <b>if</b> (<span class="r111 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#75babd7c7d588dd8" class="i property">IsEnabled</a>)
            {
                <b>foreach</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r112 rd" class="r112 r">identifier</span> <b>in</b> <span class="r110 r">diagnosticIdentifiers</span>)
                {
                    <span class="r111 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#d367e83961d030cd" class="i method">AddLink</a>(<span class="r112 r">identifier</span>);
                }
            }
 
            <span class="r111 r">scope</span>.<a href="../SharedSource/Azure.Core/DiagnosticScope.cs.html#687cad18b595ff81" class="i method">Start</a>();
 
            <b>return</b> <span class="r111 r">scope</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Performs the actions needed to instrument a set of events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">events</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The events to instrument.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private void</b> <a id="203962ba66c38fa8" href="../R/203962ba66c38fa8.html" target="n" data-glyph="76,1" class="i method">InstrumentMessages</a>(<a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r113 rd" class="r113 r">events</span>)
        {
            <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a> <span id="r114 rd" class="r114 r">eventData</span> <b>in</b> <span class="r113 r">events</span>)
            {
                <a href="../SharedSource/Diagnostics/EventDataInstrumentation.cs.html#29a2ad8b9661f165" class="t t">EventDataInstrumentation</a>.<a href="../SharedSource/Diagnostics/EventDataInstrumentation.cs.html#748c053c38d7d350" class="i method">InstrumentEvent</a>(<span class="r114 r">eventData</span>, <a href="#22b20f2db40d78c1" class="i property">FullyQualifiedNamespace</a>, <a href="#bb3c308a01df058d" class="i property">EventHubName</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Checks if the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> returned by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducerPool.cs.html#06f35c4320e1620b" class="t t">TransportProducerPool</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is still open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">producer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> that has being checked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">partitionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The unique identifier of a partition associated with the Event Hub.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is closed; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private bool</b> <a id="a4f2ecb5070439af" href="../R/a4f2ecb5070439af.html" target="n" data-glyph="76,1" class="i method">ShouldRecreateProducer</a>(<a href="../Core/TransportProducer.cs.html#3e8bff2a200aca1e" class="t t">TransportProducer</a> <span id="r115 rd" class="r115 r">producer</span>,
                                            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r116 rd" class="r116 r">partitionId</span>) =&gt; !<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r116 r">partitionId</span>)
                                                                   &amp;&amp; <span class="r115 r">producer</span>.<a href="../Core/TransportProducer.cs.html#32f4580a64bafe20" class="i property">IsClosed</a>
                                                                   &amp;&amp; !<a href="#c76931ed1332ae9f" class="i property">IsClosed</a>
                                                                   &amp;&amp; !<a href="#303dfa24a25e6f0f" class="i property">Connection</a>.<a href="../EventHubConnection.cs.html#cb0e6dd6cd986dab" class="i property">IsClosed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Ensures that no more than a single partition reference is active.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">partitionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The identifier of the partition to which the producer is bound.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">partitionKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The hash key for partition routing that was requested for a publish operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private static void</b> <a id="7291ef53ddc18c44" href="../R/7291ef53ddc18c44.html" target="n" data-glyph="76,1" class="i method">AssertSinglePartitionReference</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r117 rd" class="r117 r">partitionId</span>,
                                                           <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r118 rd" class="r118 r">partitionKey</span>)
        {
            <b>if</b> ((!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r117 r">partitionId</span>)) &amp;&amp; (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r118 r">partitionKey</span>)))
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#9726f19207b91186" class="i method">Format</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <a href="../Resources.Designer.cs.html#0f60eafa1a3b4f36" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#9ea1e26094a40c9e" class="i property">CannotSendWithPartitionIdAndPartitionKey</a>, <span class="r118 r">partitionKey</span>, <span class="r117 r">partitionId</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Ensures that a partition reference is active and the request is not for publishing</span>
        <span class="c">///</span><span class="c">   to the Event Hubs gateway.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">partitionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The identifier of the partition to which the producer is bound.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private static void</b> <a id="a639250ec22cdf06" href="../R/a639250ec22cdf06.html" target="n" data-glyph="76,1" class="i method">AssertPartitionIsReferenced</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r119 rd" class="r119 r">partitionId</span>)
        {
            <b>if</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r119 r">partitionId</span>))
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#c07c3772222caaff" class="i method">Format</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <a href="../Resources.Designer.cs.html#0f60eafa1a3b4f36" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#7c212339f597fdee" class="i property">CannotPublishToGateway</a>, <span class="r119 r">partitionId</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Ensures that a batch of events has not been previously acknowledged by the Event Hubs</span>
        <span class="c">///</span><span class="c">   service as having been successfully published.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">batch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> to consider.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private static void</b> <a id="cf38e6e872b36f9d" href="../R/cf38e6e872b36f9d.html" target="n" data-glyph="76,1" class="i method">AssertIdempotentBatchNotPublished</a>(<a href="EventDataBatch.cs.html#c992a211bbcf6874" class="t t">EventDataBatch</a> <span id="r120 rd" class="r120 r">batch</span>)
        {
            <b>if</b> ((<span class="r120 r">batch</span>.<a href="EventDataBatch.cs.html#5ddf6ed597765ae4" class="i property">StartingPublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7bbe60e33e857298" class="i property">HasValue</a>)
                || (<span class="r120 r">batch</span>.<a href="EventDataBatch.cs.html#ce1a601fff7086d5" class="i method">AsEnumerable</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt;().<a href="@1@netstandard/A.html#6a1af7c3d17845e3" class="i method">Any</a>(<span id="r121 rd" class="r121 r">eventData</span> =&gt; <span class="r121 r">eventData</span>.<a href="../EventData.cs.html#9298b0d6a5ddc198" class="i property">PublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7bbe60e33e857298" class="i property">HasValue</a>)))
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#691a34e179b91fdb" class="i method">Format</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <a href="../Resources.Designer.cs.html#0f60eafa1a3b4f36" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#ac16f870fc03f49e" class="i property">IdempotentAlreadyPublished</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Ensures that a batch of events has not been previously acknowledged by the Event Hubs</span>
        <span class="c">///</span><span class="c">   service as having been successfully published.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">eventSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> to consider.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private static void</b> <a id="c09cbc30faa275da" href="../R/c09cbc30faa275da.html" target="n" data-glyph="76,1" class="i method">AssertIdempotentEventsNotPublished</a>(<a href="@1@netstandard/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="../EventData.cs.html#557aa370d1369b89" class="t t">EventData</a>&gt; <span id="r122 rd" class="r122 r">eventSet</span>)
        {
            <b>foreach</b> (<a href="../EventData.cs.html#557aa370d1369b89" class="k">var</a> <span id="r123 rd" class="r123 r">eventData</span> <b>in</b> <span class="r122 r">eventSet</span>)
            {
                <b>if</b> (<span class="r123 r">eventData</span>.<a href="../EventData.cs.html#9298b0d6a5ddc198" class="i property">PublishedSequenceNumber</a>.<a href="@1@netstandard/A.html#7bbe60e33e857298" class="i property">HasValue</a>)
                {
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#691a34e179b91fdb" class="i method">Format</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <a href="../Resources.Designer.cs.html#0f60eafa1a3b4f36" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#ac16f870fc03f49e" class="i property">IdempotentAlreadyPublished</a>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Calculates the next sequence number based on the current sequence number.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">currentSequence</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current sequence number to consider.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The next sequence number, in proper order.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#b2f5af2558f436d5" class="t constructor">MethodImpl</a>(<a href="@1@netstandard/A.html#4159f5c528de6ee8" class="t t">MethodImplOptions</a>.<a href="@1@netstandard/A.html#1e79a2c84795aaa0" class="i field">AggressiveInlining</a>)]
        <b>private static int</b> <a id="a0c2f3960a1d8221" href="../R/a0c2f3960a1d8221.html" target="n" data-glyph="76,1" class="i method">NextSequence</a>(<b>int</b> <span id="r124 rd" class="r124 r">currentSequence</span>)
        {
            <b>if</b> (<b>unchecked</b>(++<span class="r124 r">currentSequence</span>) &lt; 0)
            {
                <span class="r124 r">currentSequence</span> = 0;
            }
 
            <b>return</b> <span class="r124 r">currentSequence</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Indicates whether publishing requires stateful partitions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r125 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of options to consider for making the determination.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if publishing is stateful; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#b2f5af2558f436d5" class="t constructor">MethodImpl</a>(<a href="@1@netstandard/A.html#4159f5c528de6ee8" class="t t">MethodImplOptions</a>.<a href="@1@netstandard/A.html#1e79a2c84795aaa0" class="i field">AggressiveInlining</a>)]
        <b>private static bool</b> <a id="5dddcdf10cf22840" href="../R/5dddcdf10cf22840.html" target="n" data-glyph="76,1" class="i method">RequiresStatefulPartitions</a>(<a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r125 rd" class="r125 r">options</span>) =&gt; <span class="r125 r">options</span>.<a href="EventHubProducerClientOptions.cs.html#f34456dcb257b744" class="i property">EnableIdempotentPartitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Creates a set of publishing properties based on the configuration of a producer and the current</span>
        <span class="c">///</span><span class="c">   partition publishing state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The options that describe the configuration of the producer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current state of publishing for the partition, as observed by the producer..</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The set of properties that represents the current state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#b2f5af2558f436d5" class="t constructor">MethodImpl</a>(<a href="@1@netstandard/A.html#4159f5c528de6ee8" class="t t">MethodImplOptions</a>.<a href="@1@netstandard/A.html#1e79a2c84795aaa0" class="i field">AggressiveInlining</a>)]
        <b>private static</b> <a href="PartitionPublishingProperties.cs.html#6fbaf58e86a0ae15" class="t t">PartitionPublishingProperties</a> <a id="1fd72e839f4a1366" href="../R/1fd72e839f4a1366.html" target="n" data-glyph="76,1" class="i method">CreatePublishingPropertiesFromPartitionState</a>(<a href="EventHubProducerClientOptions.cs.html#6a81d5ff04d4e581" class="t t">EventHubProducerClientOptions</a> <span id="r126 rd" class="r126 r">options</span>,
                                                                                                  <a href="PartitionPublishingState.cs.html#f9afafccf59e75d3" class="t t">PartitionPublishingState</a> <span id="r127 rd" class="r127 r">state</span>) =&gt;
                    <b>new</b> <a href="PartitionPublishingProperties.cs.html#7d670b69d1d2863b" class="t constructor">PartitionPublishingProperties</a>(<span class="r126 r">options</span>.<a href="EventHubProducerClientOptions.cs.html#f34456dcb257b744" class="i property">EnableIdempotentPartitions</a>,
                                                      <span class="r127 r">state</span>.<a href="PartitionPublishingState.cs.html#121002e64f73f307" class="i property">ProducerGroupId</a>,
                                                      <span class="r127 r">state</span>.<a href="PartitionPublishingState.cs.html#28e20d3dd3215739" class="i property">OwnerLevel</a>,
                                                      <span class="r127 r">state</span>.<a href="PartitionPublishingState.cs.html#52f30bf1aa588426" class="i property">LastPublishedSequenceNumber</a>);
    }
}
</pre></td></tr></table></div></body></html>
