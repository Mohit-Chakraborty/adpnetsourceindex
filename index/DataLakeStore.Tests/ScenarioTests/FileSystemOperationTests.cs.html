<!DOCTYPE html>
<html><head><title>FileSystemOperationTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1232);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#DataLakeStore.Tests/ScenarioTests/FileSystemOperationTests.cs" target="_top">ScenarioTests\FileSystemOperationTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#DataLakeStore.Tests" target="_top">Microsoft.Azure.Management.DataLakeStore.Tests.csproj</a> (DataLakeStore.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Net</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>.<span class="i">Azure</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>.<span class="i">ClientRuntime</span>.<span class="i">Azure</span>.<span class="i">TestFramework</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">DataLake</span>.<span class="i n">Store</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">DataLake</span>.<span class="i n">Store</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i">Xunit</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i">Test</span>.<span class="i">HttpRecorder</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Diagnostics</span>;
 
<b>namespace</b> <span class="i n">DataLakeStore</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="a1e23dd9bc47a70a" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="9e81b18e5767ae27">FileSystemOperationTests</span></a> : <span class="i">TestBase</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal constants
 
        <b>internal const string</b> <a id="efdc1e2f4f392693" href="../R/efdc1e2f4f392693.html" target="n" data-glyph="8,1" class="i field">folderToCreate</a> = <span class="s">&quot;SDKTestFolder01&quot;</span>;
        <b>internal const string</b> <a id="486c68c60ba33c09" href="../R/486c68c60ba33c09.html" target="n" data-glyph="8,1" class="i field">folderToMove</a> = <span class="s">&quot;SDKTestMoveFolder01&quot;</span>;
        <b>internal const string</b> <a id="622c84d1f3e0dbbc" href="../R/622c84d1f3e0dbbc.html" target="n" data-glyph="8,1" class="i field">fileToCreate</a> = <span class="s">&quot;SDKTestFile01.txt&quot;</span>;
        <b>internal const string</b> <a id="ec356e71dbb3df39" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">fileToCreateWithContents</a> = <span class="s">&quot;SDKTestFile02.txt&quot;</span>;
        <b>internal const string</b> <a id="34a25a5d5cb2bc49" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">fileToCopy</a> = <span class="s">&quot;SDKTestCopyFile01.txt&quot;</span>;
        <b>internal const string</b> <a id="f8ed69c0a09fb09d" href="../R/f8ed69c0a09fb09d.html" target="n" data-glyph="8,1" class="i field">fileToConcatTo</a> = <span class="s">&quot;SDKTestConcatFile01.txt&quot;</span>;
        <b>internal const string</b> <a id="209e4ad9be15c039" href="../R/209e4ad9be15c039.html" target="n" data-glyph="8,1" class="i field">fileToMove</a> = <span class="s">&quot;SDKTestMoveFile01.txt&quot;</span>;
 
        <b>internal const string</b> <a id="8c8ae589891dce95" href="../R/8c8ae589891dce95.html" target="n" data-glyph="8,1" class="i field">fileContentsToAdd</a> = <span class="s">&quot;These are some random test contents 1234!@&quot;</span>;
        <b>internal const string</b> <a id="d370ffef31749944" href="../R/d370ffef31749944.html" target="n" data-glyph="8,1" class="i field">fileContentsToAppend</a> = <span class="s">&quot;More test contents, that were appended!&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        <b>private</b> <a href="../TestHelpers/CommonTestFixture.cs.html#5c502c093f7101ef" class="t t">CommonTestFixture</a> <a id="ab9f3ee2ac68b70d" href="../R/ab9f3ee2ac68b70d.html" target="n" data-glyph="46,1" class="i field">commonData</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> SDK Tests
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="f396b3a7757472f4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemValidateDefaultTimeout</a>()
        {
            <b>using</b> (<b>var</b> <span id="r0 rd" class="r0 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r0 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r0 r">context</span>))
                {
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">TimeSpan</span>.<span class="i">FromMinutes</span>(5), <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">HttpClient</span>.<span class="i">Timeout</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="743cfd9e2e340c46" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemFolderCreate</a>()
        {
            <b>using</b> (<b>var</b> <span id="r1 rd" class="r1 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r1 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r1 r">context</span>))
                {
                    <b>var</b> <span id="r2 rd" class="r2 r">folderPath</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r2 r">folderPath</span>,
                        <span class="i">FileType</span>.<span class="i">DIRECTORY</span>, 0);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="39a0e4076b6448f1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemSetAndRemoveExpiry</a>()
        {
            <b>const long</b> <span id="r3 rd" class="r3 r">maxTimeInMilliseconds</span> = 253402300800000;
            <b>using</b> (<b>var</b> <span id="r4 rd" class="r4 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r4 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r4 r">context</span>))
                {
                    
                    <b>var</b> <span id="r5 rd" class="r5 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, 0);
 
                    <span class="c">// verify it does not have an expiration</span>
                    <b>var</b> <span id="r6 rd" class="r6 r">fileInfo</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> &lt;= 0 || <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> == <span class="r3 r">maxTimeInMilliseconds</span>, <span class="s">&quot;Expiration time was not equal to 0 or DateTime.MaxValue.Ticks! Actual value reported: &quot;</span> + <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span>);
 
                    <span class="c">// set the expiration time as an absolute value</span>
                    
                    <b>var</b> <span id="r7 rd" class="r7 r">toSetAbsolute</span> = <span class="i">ToUnixTimeStampMs</span>(<span class="i">HttpMockServer</span>.<span class="i">GetVariable</span>(<span class="s">&quot;absoluteTime&quot;</span>, <span class="i">DateTime</span>.<span class="i">UtcNow</span>.<span class="i">AddSeconds</span>(120).<span class="i">ToString</span>()));
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetFileExpiry</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>, <span class="i">ExpiryOptionType</span>.<span class="i">Absolute</span>, <span class="r7 r">toSetAbsolute</span>);
                    <span class="r6 r">fileInfo</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>);
                    <span class="i">VerifyTimeInAcceptableRange</span>(<span class="r7 r">toSetAbsolute</span>, <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span>.<span class="i">Value</span>);
 
                    <span class="c">// set the expiration time relative to now</span>
                    <b>var</b> <span id="r8 rd" class="r8 r">toSetRelativeToNow</span> = <span class="i">ToUnixTimeStampMs</span>(<span class="i">HttpMockServer</span>.<span class="i">GetVariable</span>(<span class="s">&quot;relativeTime&quot;</span>, <span class="i">DateTime</span>.<span class="i">UtcNow</span>.<span class="i">AddSeconds</span>(120).<span class="i">ToString</span>()));
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetFileExpiry</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>, <span class="i">ExpiryOptionType</span>.<span class="i">RelativeToNow</span>, 120 * 1000);
                    <span class="r6 r">fileInfo</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>);
                    <span class="i">VerifyTimeInAcceptableRange</span>(<span class="r8 r">toSetRelativeToNow</span>, <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span>.<span class="i">Value</span>);
 
                    <span class="c">// set expiration time relative to the creation time</span>
                    <b>var</b> <span id="r9 rd" class="r9 r">toSetRelativeCreationTime</span> = <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ModificationTime</span>.<span class="i">Value</span> + (120 * 1000);
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetFileExpiry</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>, <span class="i">ExpiryOptionType</span>.<span class="i">RelativeToCreationDate</span>, 120 * 1000);
                    <span class="r6 r">fileInfo</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>);
                    <span class="i">VerifyTimeInAcceptableRange</span>(<span class="r9 r">toSetRelativeCreationTime</span>, <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span>.<span class="i">Value</span>);
 
                    <span class="c">// reset expiration time to never</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetFileExpiry</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>, <span class="i">ExpiryOptionType</span>.<span class="i">NeverExpire</span>);
                    <span class="r6 r">fileInfo</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r5 r">filePath</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> &lt;= 0 || <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> == <span class="r3 r">maxTimeInMilliseconds</span>, <span class="s">&quot;Expiration time was not equal to 0 or DateTime.MaxValue.Ticks! Actual value reported: &quot;</span> + <span class="r6 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="d4ec97efe9e47d96" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemNegativeExpiry</a>()
        {
            <b>const long</b> <span id="r10 rd" class="r10 r">maxTimeInMilliseconds</span> = 253402300800000;
            <b>using</b> (<b>var</b> <span id="r11 rd" class="r11 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r11 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r11 r">context</span>))
                {
                    <b>var</b> <span id="r12 rd" class="r12 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r12 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, 0);
 
                    <span class="c">// verify it does not have an expiration</span>
                    <b>var</b> <span id="r13 rd" class="r13 r">fileInfo</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r12 r">filePath</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r13 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> &lt;= 0 || <span class="r13 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> == <span class="r10 r">maxTimeInMilliseconds</span>, <span class="s">&quot;Expiration time was not equal to 0 or DateTime.MaxValue.Ticks! Actual value reported: &quot;</span> + <span class="r13 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span>);
 
                    <span class="c">// set the expiration time as an absolute value that is less than the creation time</span>
                    <b>var</b> <span id="r14 rd" class="r14 r">toSetAbsolute</span> = <span class="i">ToUnixTimeStampMs</span>(<span class="i">HttpMockServer</span>.<span class="i">GetVariable</span>(<span class="s">&quot;absoluteNegativeTime&quot;</span>, <span class="i">DateTime</span>.<span class="i">UtcNow</span>.<span class="i">AddSeconds</span>(-120).<span class="i">ToString</span>()));
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt; <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetFileExpiry</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r12 r">filePath</span>, <span class="i">ExpiryOptionType</span>.<span class="i">Absolute</span>, <span class="r14 r">toSetAbsolute</span>));
 
                    <span class="c">// set the expiration time as an absolute value that is greater than max allowed time</span>
                    <span class="r14 r">toSetAbsolute</span> = <span class="i">ToUnixTimeStampMs</span>(<span class="i">DateTime</span>.<span class="i">MaxValue</span>.<span class="i">ToString</span>()) + 1000;
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt; <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetFileExpiry</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r12 r">filePath</span>, <span class="i">ExpiryOptionType</span>.<span class="i">Absolute</span>, <span class="r14 r">toSetAbsolute</span>));
 
                    <span class="c">// reset expiration time to never with a value and confirm the value is not honored</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetFileExpiry</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r12 r">filePath</span>, <span class="i">ExpiryOptionType</span>.<span class="i">NeverExpire</span>, 400);
                    <span class="r13 r">fileInfo</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r12 r">filePath</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r13 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> &lt;= 0 || <span class="r13 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span> == <span class="r10 r">maxTimeInMilliseconds</span>, <span class="s">&quot;Expiration time was not equal to 0 or DateTime.MaxValue.Ticks! Actual value reported: &quot;</span> + <span class="r13 r">fileInfo</span>.<span class="i">FileStatus</span>.<span class="i">ExpirationTime</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="8b97fa1804a34b65" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemListFolderContents</a>()
        {
            <b>using</b> (<b>var</b> <span id="r15 rd" class="r15 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r15 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r15 r">context</span>))
                {
                    <b>var</b> <span id="r16 rd" class="r16 r">folderPath</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r16 r">folderPath</span>,
                        <span class="i">FileType</span>.<span class="i">DIRECTORY</span>, 0);
 
                    <b>var</b> <span id="r17 rd" class="r17 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>, <span class="r16 r">folderPath</span>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r17 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, 0);
 
                    <span class="c">// List all the contents in the folder</span>
                    <b>var</b> <span id="r18 rd" class="r18 r">listFolderResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ListFileStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="r16 r">folderPath</span>);
 
                    <span class="c">// We know that this directory is brand new, so the contents should only be the one file.</span>
                    <span class="i">Assert</span>.<span class="i">Equal</span>(1, <span class="r18 r">listFolderResponse</span>.<span class="i">FileStatuses</span>.<span class="i">FileStatus</span>.<span class="i">Count</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">FileType</span>.<span class="i">FILE</span>, <span class="r18 r">listFolderResponse</span>.<span class="i">FileStatuses</span>.<span class="i">FileStatus</span>[0].<span class="i">Type</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="a6e6bc194157ecf6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemGetNonExistentFile</a>()
        {
            <b>using</b> (<b>var</b> <span id="r19 rd" class="r19 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r19 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r19 r">context</span>))
                {
                    <b>try</b>
                    {
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/nonexistentfile001.txt&quot;</span>);
                    }
                    <b>catch</b> (<span class="i">AdlsErrorException</span> <span id="r20 rd" class="r20 r">e</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<b>typeof</b>(<span class="i">AdlsFileNotFoundException</span>), <span class="r20 r">e</span>.<span class="i">Body</span>.<span class="i">RemoteException</span>.<span class="i">GetType</span>());
                    }
                }
            }
        }
 
        [<span class="i">Fact</span>(<span class="i">Skip</span> = <span class="s">&quot;skipping this out until we have a good test for validating access denied within the same tenant&quot;</span>)] 
        <b>public void</b> <a id="c1a1c0d1d402e1d5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemTestAccessDenied</a>()
        {
            <b>using</b> (<b>var</b> <span id="r21 rd" class="r21 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r21 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r21 r">context</span>))
                {
                    <b>try</b>
                    {
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#0a75d5f953a7438b" class="i property">NoPermissionDataLakeStoreAccountName</a>, <span class="s">&quot;/&quot;</span>);
                    }
                    <b>catch</b> (<span class="i">AdlsErrorException</span> <span id="r22 rd" class="r22 r">e</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<b>typeof</b>(<span class="i">AdlsAccessControlException</span>), <span class="r22 r">e</span>.<span class="i">Body</span>.<span class="i">RemoteException</span>.<span class="i">GetType</span>());
                    }
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="f0f85f5bfd1d0b86" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemEmptyFileCreate</a>()
        {
            <b>using</b> (<b>var</b> <span id="r23 rd" class="r23 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r23 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r23 r">context</span>))
                {
                    <b>var</b> <span id="r24 rd" class="r24 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r24 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, 0);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="47cd6e79a316667d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemTestFile</a>()
        {
            <b>using</b> (<b>var</b> <span id="r25 rd" class="r25 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r25 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r25 r">context</span>))
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">PathExists</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;nonexistentfile&quot;</span>));
                    <b>var</b> <span id="r26 rd" class="r26 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">PathExists</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r26 r">filePath</span>));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="3a1bd981e359e38c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemFileAlreadyExists</a>()
        {
            <b>using</b> (<b>var</b> <span id="r27 rd" class="r27 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r27 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r27 r">context</span>))
                {
                    <b>var</b> <span id="r28 rd" class="r28 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r28 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, 0);
                    <span class="c">// now try to recreate the file</span>
                    <b>try</b>
                    {
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Create</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r28 r">filePath</span>, <b>new</b> <span class="i">MemoryStream</span>());
                        <span class="i">Assert</span>.<span class="i">True</span>(<b>false</b>, <span class="s">&quot;Recreation of an existing file without overwrite should have failed and did not.&quot;</span>);
                    }
                    <b>catch</b> (<span class="i">AdlsErrorException</span> <span id="r29 rd" class="r29 r">ex</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<b>typeof</b>(<span class="i">AdlsFileAlreadyExistsException</span>), <span class="r29 r">ex</span>.<span class="i">Body</span>.<span class="i">RemoteException</span>.<span class="i">GetType</span>());
                    }
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="2a74690c50c9f71c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemFileCreateWithContents</a>()
        {
            <b>using</b> (<b>var</b> <span id="r30 rd" class="r30 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r30 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r30 r">context</span>))
                {
                    <b>var</b> <span id="r31 rd" class="r31 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r31 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
                    <a href="#636c5cc2f4e15109" class="i method">CompareFileContents</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r31 r">filePath</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="30fcd173443f28fe" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemGetContentSummaryForFileAndFolder</a>()
        {
            <b>using</b> (<b>var</b> <span id="r32 rd" class="r32 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r32 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r32 r">context</span>))
                {
                    <b>var</b> <span id="r33 rd" class="r33 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r33 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
                    <a href="#636c5cc2f4e15109" class="i method">CompareFileContents</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r33 r">filePath</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>);
 
                    <span class="c">// get content summary for the root folder, which should contain the file and directory created</span>
                    <span class="c">// it should also have at least one more directory.</span>
                    <b>var</b> <span id="r34 rd" class="r34 r">contentSummary</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetContentSummary</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">FileCount</span> &gt;= 1);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">DirectoryCount</span> &gt;= 2);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">Length</span> &gt;= <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">SpaceConsumed</span> &gt;= <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <span class="c">// get content summary for the folder</span>
                    <span class="r34 r">contentSummary</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetContentSummary</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <a href="#efdc1e2f4f392693" class="i field">folderToCreate</a>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(1, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">FileCount</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(1, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">DirectoryCount</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">Length</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">SpaceConsumed</span>);
 
                    <span class="c">// get the content summary for the file</span>
                    <span class="r34 r">contentSummary</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetContentSummary</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="r33 r">filePath</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(1, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">FileCount</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(0, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">DirectoryCount</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">Length</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>, <span class="r34 r">contentSummary</span>.<span class="i">ContentSummary</span>.<span class="i">SpaceConsumed</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="6fd4889a2db68bee" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemAppendToFile</a>()
        {
            <b>using</b> (<b>var</b> <span id="r35 rd" class="r35 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r35 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r35 r">context</span>))
                {
                    <b>var</b> <span id="r36 rd" class="r36 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r36 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, 0);
 
                    <span class="c">// Append to the file that we created</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Append</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r36 r">filePath</span>,
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>)));
 
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r36 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>.<span class="i">Length</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="b1f01764a214fb76" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemAppendToFileWithOffset</a>()
        {
            <b>using</b> (<b>var</b> <span id="r37 rd" class="r37 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r37 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r37 r">context</span>))
                {
                    <b>var</b> <span id="r38 rd" class="r38 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r38 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <span class="c">// Append to the file that we created, but starting at the beginning of the file, which should wipe out the data.</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Append</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r38 r">filePath</span>,
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>)), <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r38 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>*2);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="3df70c8c8dd07ead" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemAppendToFileWithBadOffset</a>()
        {
            <b>using</b> (<b>var</b> <span id="r39 rd" class="r39 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r39 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r39 r">context</span>))
                {
                    <b>var</b> <span id="r40 rd" class="r40 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r40 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>try</b>
                    {
                        <span class="c">// Append to the file that we created, but starting at the beginning of the file, which should wipe out the data.</span>
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Append</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r40 r">filePath</span>,
                            <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>)), 0);
                        <span class="i">Assert</span>.<span class="i">True</span>(<b>false</b>, <span class="s">&quot;Successfully appended content at an offset where content already exists. This should have thrown.&quot;</span>);
                    }
                    <b>catch</b> (<span class="i">AdlsErrorException</span> <span id="r41 rd" class="r41 r">ex</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<b>typeof</b>(<span class="i">AdlsBadOffsetException</span>), <span class="r41 r">ex</span>.<span class="i">Body</span>.<span class="i">RemoteException</span>.<span class="i">GetType</span>());
                    }
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="e2447307d278df0a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemConcurrentAppendToFile</a>()
        {
            <b>using</b> (<b>var</b> <span id="r42 rd" class="r42 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r42 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r42 r">context</span>))
                {
                    <b>var</b> <span id="r43 rd" class="r43 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>false</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r43 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, 0);
 
                    <span class="c">// Append to the file that we created</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ConcurrentAppend</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r43 r">filePath</span>,
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>)));
 
                    <a href="#636c5cc2f4e15109" class="i method">CompareFileContents</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r43 r">filePath</span>, <a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>);
 
                    <span class="c">//compare length</span>
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r43 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, <a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>.<span class="i">Length</span>);
 
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="26442e608f461e65" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemNegativeConcurrentAppend</a>()
        {
            <b>using</b> (<b>var</b> <span id="r44 rd" class="r44 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r44 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r44 r">context</span>))
                {
                    <b>var</b> <span id="r45 rd" class="r45 r">filePath</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <a href="#efdc1e2f4f392693" class="i field">folderToCreate</a>, <a href="#622c84d1f3e0dbbc" class="i field">fileToCreate</a>));
 
                    <span class="c">// Concurrent append to the file that we will create during the concurrent append call.</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ConcurrentAppend</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r45 r">filePath</span>,
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>)), <span class="i">AppendModeType</span>.<span class="i">Autocreate</span>);
 
                    <span class="i">CompareFileContents</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r45 r">filePath</span>, <a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>);
 
                    <span class="c">// attempt to append after concurrently appending (should fail)</span>
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt; <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Append</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, 
                        <span class="r45 r">filePath</span>, 
                        <b>new</b> <span class="i">MemoryStream</span>()));
 
                    <span class="c">// Now create a file with contents and attempt to concurrent append onto it.</span>
                    <span class="r45 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
 
                    <span class="c">// Append to the file that we created</span>
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt; <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ConcurrentAppend</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, 
                        <span class="r45 r">filePath</span>,
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>))));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="6502ff41dd0e3c5a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemConcurrentAppendCreateFile</a>()
        {
            <b>using</b> (<b>var</b> <span id="r46 rd" class="r46 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r46 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r46 r">context</span>))
                {
                    <b>var</b> <span id="r47 rd" class="r47 r">filePath</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <a href="#efdc1e2f4f392693" class="i field">folderToCreate</a>, <a href="#622c84d1f3e0dbbc" class="i field">fileToCreate</a>));
 
                    <span class="c">// Concurrent append to the file that we will create during the concurrent append call.</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ConcurrentAppend</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r47 r">filePath</span>,
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>)), <span class="i">AppendModeType</span>.<span class="i">Autocreate</span>);
 
                    <span class="i">CompareFileContents</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r47 r">filePath</span>, <a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>);
 
                    <span class="c">// compare length to ensure metadata is updated.</span>
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r47 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>, <a href="#d370ffef31749944" class="i field">fileContentsToAppend</a>.<span class="i">Length</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="25c475bbeead359d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemConcatenateFiles</a>()
        {
            <b>using</b> (<b>var</b> <span id="r48 rd" class="r48 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r48 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r48 r">context</span>))
                {
                    <b>var</b> <span id="r49 rd" class="r49 r">filePath1</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r49 r">filePath1</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>var</b> <span id="r50 rd" class="r50 r">filePath2</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r50 r">filePath2</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>var</b> <span id="r51 rd" class="r51 r">targetFolder</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
 
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Concat</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r51 r">targetFolder</span>, <a href="#f8ed69c0a09fb09d" class="i field">fileToConcatTo</a>),
                        <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt; { <span class="r49 r">filePath1</span>, <span class="r50 r">filePath2</span> });
 
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r51 r">targetFolder</span>, <a href="#f8ed69c0a09fb09d" class="i field">fileToConcatTo</a>),
                        <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>*2);
 
                    <span class="c">// Attempt to get the files that were concatted together, which should fail and throw</span>
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r49 r">filePath1</span>));
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r50 r">filePath2</span>));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="0107ab8f8f2d7a1f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemMsConcatenateFiles</a>()
        {
            <b>using</b> (<b>var</b> <span id="r52 rd" class="r52 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r52 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r52 r">context</span>))
                {
                    <b>var</b> <span id="r53 rd" class="r53 r">filePath1</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r53 r">filePath1</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>var</b> <span id="r54 rd" class="r54 r">filePath2</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r54 r">filePath2</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>var</b> <span id="r55 rd" class="r55 r">targetFolder</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
 
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">MsConcat</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r55 r">targetFolder</span>, <a href="#f8ed69c0a09fb09d" class="i field">fileToConcatTo</a>),
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;sources={0},{1}&quot;</span>, <span class="r53 r">filePath1</span>, <span class="r54 r">filePath2</span>))));
 
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r55 r">targetFolder</span>, <a href="#f8ed69c0a09fb09d" class="i field">fileToConcatTo</a>),
                        <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>*2);
 
                    <span class="c">// Attempt to get the files that were concatted together, which should fail and throw</span>
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r53 r">filePath1</span>));
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r54 r">filePath2</span>));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="13e92b2b9d394d73" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemMsConcatDeleteDir</a>()
        {
            <b>using</b> (<b>var</b> <span id="r56 rd" class="r56 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r56 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r56 r">context</span>))
                {
                    <b>var</b> <span id="r57 rd" class="r57 r">concatFolderPath</span> = <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <a href="#efdc1e2f4f392693" class="i field">folderToCreate</a>,
                        <span class="s">&quot;msconcatFolder&quot;</span>);
                    <b>var</b> <span id="r58 rd" class="r58 r">filePath1</span> = <span class="i">CreateFile</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>,
                        <span class="r57 r">concatFolderPath</span>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r58 r">filePath1</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>var</b> <span id="r59 rd" class="r59 r">filePath2</span> = <span class="i">CreateFile</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>,
                        <span class="r57 r">concatFolderPath</span>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r59 r">filePath2</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>var</b> <span id="r60 rd" class="r60 r">targetFolder</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
 
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">MsConcat</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r60 r">targetFolder</span>, <a href="#f8ed69c0a09fb09d" class="i field">fileToConcatTo</a>),
                        <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;sources={0},{1}&quot;</span>, <span class="r58 r">filePath1</span>, <span class="r59 r">filePath2</span>))),
                        <span class="i">deleteSourceDirectory</span>: <b>true</b>);
 
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r60 r">targetFolder</span>, <a href="#f8ed69c0a09fb09d" class="i field">fileToConcatTo</a>),
                        <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>*2);
 
                    <span class="c">// Attempt to get the files that were concatted together, which should fail and throw</span>
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r58 r">filePath1</span>));
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r59 r">filePath2</span>));
 
                    <span class="c">// Attempt to get the folder that was created for concat, which should fail and be deleted.</span>
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r57 r">concatFolderPath</span>));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="ba36b1c97871f933" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemMoveFileAndFolder</a>()
        {
            <b>using</b> (<b>var</b> <span id="r61 rd" class="r61 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r61 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r61 r">context</span>))
                {
                    <b>var</b> <span id="r62 rd" class="r62 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r62 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <b>var</b> <span id="r63 rd" class="r63 r">targetFolder1</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
                    <b>var</b> <span id="r64 rd" class="r64 r">targetFolder2</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<a href="#486c68c60ba33c09" class="i field">folderToMove</a>);
 
                    <span class="c">// Move file first</span>
                    <b>var</b> <span id="r65 rd" class="r65 r">moveFileResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Rename</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="r62 r">filePath</span>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r63 r">targetFolder1</span>, <a href="#209e4ad9be15c039" class="i field">fileToMove</a>));
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r65 r">moveFileResponse</span>.<span class="i">OperationResult</span>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r63 r">targetFolder1</span>, <a href="#209e4ad9be15c039" class="i field">fileToMove</a>),
                        <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <span class="c">// Ensure the old file is gone</span>
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r62 r">filePath</span>));
 
                    <span class="c">// Now move folder completely.</span>
                    <b>var</b> <span id="r66 rd" class="r66 r">moveFolderResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Rename</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="r63 r">targetFolder1</span>,
                        <span class="r64 r">targetFolder2</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r66 r">moveFolderResponse</span>.<span class="i">OperationResult</span>);
 
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r64 r">targetFolder2</span>,
                        <span class="i">FileType</span>.<span class="i">DIRECTORY</span>, 0);
 
                    <span class="c">// ensure all the contents of the folder moved</span>
                    <span class="c">// List all the contents in the folder</span>
                    <b>var</b> <span id="r67 rd" class="r67 r">listFolderResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ListFileStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="r64 r">targetFolder2</span>);
 
                    <span class="c">// We know that this directory is brand new, so the contents should only be the one file.</span>
                    <span class="i">Assert</span>.<span class="i">Equal</span>(1, <span class="r67 r">listFolderResponse</span>.<span class="i">FileStatuses</span>.<span class="i">FileStatus</span>.<span class="i">Count</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">FileType</span>.<span class="i">FILE</span>, <span class="r67 r">listFolderResponse</span>.<span class="i">FileStatuses</span>.<span class="i">FileStatus</span>[0].<span class="i">Type</span>);
 
                    <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<span class="i">AdlsErrorException</span>&gt;(() =&gt;
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                                <span class="r63 r">targetFolder1</span>));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="2aa2c59c2f0545a3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemDeleteFolder</a>()
        {
            <b>using</b> (<b>var</b> <span id="r68 rd" class="r68 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r68 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r68 r">context</span>))
                {
                    <b>var</b> <span id="r69 rd" class="r69 r">folderPath</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r69 r">folderPath</span>,
                        <span class="i">FileType</span>.<span class="i">DIRECTORY</span>, 0);
                    <a href="#883716acef3dc7c3" class="i method">DeleteFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r69 r">folderPath</span>, <b>true</b>, <b>false</b>);
                    <span class="c">//WORK AROUND: Bug 4717659 makes it so even empty folders have contents.</span>
 
                    <span class="c">// delete again expecting failure.</span>
                    <a href="#883716acef3dc7c3" class="i method">DeleteFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r69 r">folderPath</span>, <b>false</b>, <b>true</b>);
 
                    <span class="c">// delete a folder with contents</span>
                    <b>var</b> <span id="r70 rd" class="r70 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>, <span class="r69 r">folderPath</span>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r70 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
 
                    <span class="c">// should fail if recurse is not set</span>
                    <a href="#883716acef3dc7c3" class="i method">DeleteFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r69 r">folderPath</span>, <b>false</b>, <b>true</b>);
 
                    <span class="c">// Now actually delete</span>
                    <a href="#883716acef3dc7c3" class="i method">DeleteFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r69 r">folderPath</span>, <b>true</b>, <b>false</b>);
 
                    <span class="c">// delete again expecting failure.</span>
                    <a href="#883716acef3dc7c3" class="i method">DeleteFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r69 r">folderPath</span>, <b>true</b>, <b>true</b>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9fe93855b545faea" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemDeleteFile</a>()
        {
            <b>using</b> (<b>var</b> <span id="r71 rd" class="r71 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r71 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r71 r">context</span>))
                {
                    <b>var</b> <span id="r72 rd" class="r72 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <span class="i">GetAndCompareFileOrFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r72 r">filePath</span>, <span class="i">FileType</span>.<span class="i">FILE</span>,
                        <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
                    <a href="#c4f67c50ee61a698" class="i method">DeleteFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r72 r">filePath</span>, <b>false</b>);
 
                    <span class="c">// try to delete it again, which should fail</span>
                    <a href="#c4f67c50ee61a698" class="i method">DeleteFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r72 r">filePath</span>, <b>true</b>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="0ea953d0dea77601" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemGetAndSetAcl</a>()
        {
            <b>using</b> (<b>var</b> <span id="r73 rd" class="r73 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r73 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r73 r">context</span>))
                {
                    <b>var</b> <span id="r74 rd" class="r74 r">currentAcl</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/&quot;</span>));
                    <b>var</b> <span id="r75 rd" class="r75 r">originalPermission</span> = <span class="r74 r">currentAcl</span>.<span class="i">AclStatus</span>.<span class="i">Permission</span>;
                    <b>var</b> <span id="r76 rd" class="r76 r">aclToReplaceWith</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r74 r">currentAcl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
                    <b>var</b> <span id="r77 rd" class="r77 r">originalOther</span> = <b>string</b>.<span class="i">Empty</span>;
                    <b>var</b> <span id="r78 rd" class="r78 r">toReplace</span> = <span class="s">&quot;other::rwx&quot;</span>;
                    <b>for</b> (<b>var</b> <span id="r79 rd" class="r79 r">i</span> = 0; <span class="r79 r">i</span> &lt; <span class="r76 r">aclToReplaceWith</span>.<span class="i">Count</span>; <span class="r79 r">i</span>++)
                    {
                        <b>if</b> (<span class="r76 r">aclToReplaceWith</span>[<span class="r79 r">i</span>].<span class="i">StartsWith</span>(<span class="s">&quot;other&quot;</span>))
                        {
                            <span class="r77 r">originalOther</span> = <span class="r76 r">aclToReplaceWith</span>[<span class="r79 r">i</span>];
                            <span class="r76 r">aclToReplaceWith</span>[<span class="r79 r">i</span>] = <span class="r78 r">toReplace</span>;
                            <b>break</b>;
                        }
                    }
 
                    <span class="i">Assert</span>.<span class="i">False</span>(<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r77 r">originalOther</span>));
 
                    <span class="c">// Set the other acl to RWX</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetAcl</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>,
                        <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;,&quot;</span>, <span class="r76 r">aclToReplaceWith</span>));
 
                    <b>var</b> <span id="r80 rd" class="r80 r">newAcl</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/&quot;</span>));
 
                    <span class="c">// verify the ACL actually changed</span>
                    <span class="c">// Check the access first and assert that it returns OK (note: this is currently only for the user making the request, so it is not testing &quot;other&quot;)</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">CheckAccess</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/&quot;</span>, <span class="s">&quot;rwx&quot;</span>);
 
                    <b>var</b> <span id="r81 rd" class="r81 r">foundIt</span> = <b>false</b>;
                    <b>foreach</b> (<b>var</b> <span id="r82 rd" class="r82 r">entry</span> <b>in</b> <span class="r80 r">newAcl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Where</span>(<span id="r83 rd" class="r83 r">entry</span> =&gt; <span class="r83 r">entry</span>.<span class="i">StartsWith</span>(<span class="s">&quot;other&quot;</span>)))
                    {
                        <span class="r81 r">foundIt</span> = <b>true</b>;
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r78 r">toReplace</span>, <span class="r82 r">entry</span>);
                        <b>break</b>;
                    }
 
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r81 r">foundIt</span>);
                    <span class="i">Assert</span>.<span class="i">NotEqual</span>(<span class="r75 r">originalPermission</span>, <span class="r80 r">newAcl</span>.<span class="i">AclStatus</span>.<span class="i">Permission</span>);
 
                    <span class="c">// Set it back using specific entry</span>
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ModifyAclEntries</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/&quot;</span>,
                        <span class="r77 r">originalOther</span>);
 
                    <span class="c">// Now confirm that it equals the original ACL</span>
                    <b>var</b> <span id="r84 rd" class="r84 r">finalAclStatus</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/&quot;</span>))
                        .<span class="i">AclStatus</span>;
                    <b>var</b> <span id="r85 rd" class="r85 r">finalEntries</span> = <span class="r84 r">finalAclStatus</span>.<span class="i">Entries</span>;
                    <b>foreach</b> (<b>var</b> <span id="r86 rd" class="r86 r">entry</span> <b>in</b> <span class="r85 r">finalEntries</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="r74 r">currentAcl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>, <span id="r87 rd" class="r87 r">original</span> =&gt; <span class="r87 r">original</span>.<span class="i">Equals</span>(<span class="r86 r">entry</span>, <span class="i">StringComparison</span>.<span class="i">CurrentCultureIgnoreCase</span>));
                    }
 
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r85 r">finalEntries</span>.<span class="i">Count</span>, <span class="r74 r">currentAcl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Count</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r75 r">originalPermission</span>, <span class="r84 r">finalAclStatus</span>.<span class="i">Permission</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="025031a01b2d80fa" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemSetFileProperties</a>()
        {
            <span class="c">// This test simply tests that all bool/empty return actions return successfully</span>
            <b>using</b> (<b>var</b> <span id="r88 rd" class="r88 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r88 r">context</span>);
                <b>using</b> (
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r88 r">context</span>))
                {
                    <b>var</b> <span id="r89 rd" class="r89 r">filePath</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>);
                    <b>var</b> <span id="r90 rd" class="r90 r">originalFileStatus</span> =
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                            <span class="r89 r">filePath</span>
                            )
                            .<span class="i">FileStatus</span>;
                    <span class="c">// TODO: Set replication on file, this has been removed until it is confirmed as a supported API.</span>
                    <span class="c">/*
                    var replicationResponse = commonData.DataLakeStoreFileSystemClient.FileSystem.SetReplication(filePath,
                        commonData.DataLakeStoreFileSystemAccountName, 3);
                    Assert.True(replicationResponse.Boolean);
                    */</span>
 
                    <span class="c">/*
                 * This API is available but all values put into it are ignored. Commenting this out until this API is fully functional.
                Assert.Equal(3,
                    dataLakeFileSystemClient.FileSystem.GetFileStatus(filePath, commonData.DataLakeStoreFileSystemAccountName)
                        .FileStatus.Replication);
                */</span>
 
                    <span class="c">// set the time on the file</span>
                    <span class="c">// We use a static date for now since we aren&#39;t interested in whether the value is set properly, only that the method returns a 200.</span>
                    <span class="c">/* TODO: Re enable once supported.
                    var timeToSet = new DateTime(2015, 10, 26, 14, 30, 0).Ticks;
                    commonData.DataLakeStoreFileSystemClient.FileSystem.SetTimes(filePath,
                        commonData.DataLakeStoreFileSystemAccountName, timeToSet, timeToSet);
 
                    var fileStatusAfterTime =
                        commonData.DataLakeStoreFileSystemClient.FileSystem.GetFileStatus(filePath,
                            commonData.DataLakeStoreFileSystemAccountName)
                            .FileStatus;
                    */</span>
 
                    <span class="c">/*
                 * This API is available but all values put into it are ignored. Commenting this out until this API is fully functional.
                Assert.True(
                    fileStatusAfterTime.ModificationTime == timeToSet &amp;&amp; fileStatusAfterTime.AccessTime == timeToSet);
                */</span>
 
                    <span class="c">// TODO: Symlink creation is explicitly not supported, but when it is this should be enabled.</span>
                    <span class="c">/*
                    var symLinkName = TestUtilities.GenerateName(&quot;testPath/symlinktest1&quot;);
                    Assert.Throws&lt;AdlsErrorException&gt;(() =&gt; commonData.DataLakeStoreFileSystemClient.FileSystem.CreateSymLink(filePath,
                        commonData.DataLakeStoreFileSystemAccountName, symLinkName, true));
                    */</span>
 
                    <span class="c">// Once symlinks are available, remove the throws test and uncomment out this code.</span>
                    <span class="c">// Assert.True(createSymLinkResponse.StatusCode == HttpStatusCode.OK);</span>
                    <span class="c">// Assert.DoesNotThrow(() =&gt; dataLakeFileSystemClient.FileSystem.GetFileStatus(symLinkName, commonData.DataLakeStoreFileSystemAccountName));</span>
                }
 
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="ae83c7d9ede35cd7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemGetAcl</a>()
        {
            <b>using</b> (<b>var</b> <span id="r91 rd" class="r91 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r91 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r91 r">context</span>))
                {
                    <b>var</b> <span id="r92 rd" class="r92 r">aclGetResponse</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/&quot;</span>));
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r92 r">aclGetResponse</span>.<span class="i">AclStatus</span>);
                    <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r92 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r92 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Owner</span>));
                    <span class="i">Assert</span>.<span class="i">True</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r92 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Group</span>));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="d10fd73fc64d40fa" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemSetAcl</a>()
        {
            <b>using</b> (<b>var</b> <span id="r93 rd" class="r93 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r93 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r93 r">context</span>))
                {
                    <b>var</b> <span id="r94 rd" class="r94 r">aclGetResponse</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>));
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>);
                    <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
 
                    <b>var</b> <span id="r95 rd" class="r95 r">currentCount</span> = <span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Count</span>;
                    <span class="c">// add an entry to the ACL Entries</span>
                    <b>var</b> <span id="r96 rd" class="r96 r">newAcls</span> = <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;,&quot;</span>, <span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
                    <span class="r96 r">newAcls</span> += <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;,user:{0}:rwx&quot;</span>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#de8f515d201adeaf" class="i field">AclUserId</a>);
 
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">SetAcl</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>,
                        <span class="r96 r">newAcls</span>);
                    
                    <span class="c">// retrieve the ACL again and confirm the new entry is present</span>
                    <span class="r94 r">aclGetResponse</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="s">&quot;/&quot;</span>));
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>);
                    <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
                    
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r95 r">currentCount</span> + 1, <span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Count</span>);
                    <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="r94 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>, <span id="r97 rd" class="r97 r">entry</span> =&gt; <span class="r97 r">entry</span>.<span class="i">Contains</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#de8f515d201adeaf" class="i field">AclUserId</a>));
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="712f29f809881521" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreFileSystemSetDeleteAclEntry</a>()
        {
            <b>using</b> (<b>var</b> <span id="r98 rd" class="r98 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r98 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r98 r">context</span>))
                {
                    <b>var</b> <span id="r99 rd" class="r99 r">aclGetResponse</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>));
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>);
                    <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
 
                    <b>var</b> <span id="r100 rd" class="r100 r">currentCount</span> = <span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Count</span>;
                    <span class="c">// add an entry to the ACL Entries</span>
                    <b>var</b> <span id="r101 rd" class="r101 r">newAce</span> = <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;user:{0}:rwx&quot;</span>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#de8f515d201adeaf" class="i field">AclUserId</a>);
 
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ModifyAclEntries</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>,
                         <span class="r101 r">newAce</span>);
 
                    <span class="c">// retrieve the ACL again and confirm the new entry is present</span>
                    <span class="r99 r">aclGetResponse</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>));
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>);
                    <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
 
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r100 r">currentCount</span> + 1, <span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Count</span>);
                    <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>, <span id="r102 rd" class="r102 r">entry</span> =&gt; <span class="r102 r">entry</span>.<span class="i">Contains</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#de8f515d201adeaf" class="i field">AclUserId</a>));
 
                    <span class="c">// now remove the entry</span>
                    <b>var</b> <span id="r103 rd" class="r103 r">aceToRemove</span> = <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;,user:{0}&quot;</span>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#de8f515d201adeaf" class="i field">AclUserId</a>);
                    <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">RemoveAclEntries</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>,
                        <span class="r103 r">aceToRemove</span>);
 
                    <span class="c">// retrieve the ACL again and confirm the new entry is gone</span>
                    <span class="r99 r">aclGetResponse</span> = <span class="i">GetFullAcl</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetAclStatus</span>(
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                        <span class="s">&quot;/&quot;</span>));
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>);
                    <span class="i">Assert</span>.<span class="i">NotEmpty</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>);
                    
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r100 r">currentCount</span>, <span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Count</span>);
                    <span class="i">Assert</span>.<span class="i">DoesNotContain</span>(<span class="r99 r">aclGetResponse</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>, <span id="r104 rd" class="r104 r">entry</span> =&gt; <span class="r104 r">entry</span>.<span class="i">Contains</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#de8f515d201adeaf" class="i field">AclUserId</a>));
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> upload download tests
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="c798bacb61240e29" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DataLakeStoreDownloadUploadFileAndFolder</a>()
        {
            <b>using</b> (<b>var</b> <span id="r105 rd" class="r105 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#a1e23dd9bc47a70a" class="k">this</a>.<span class="i">GetType</span>()))
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a> = <b>new</b> <span class="t">CommonTestFixture</span>(<span class="r105 r">context</span>);
                <b>using</b> (<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<span class="i">GetDataLakeStoreFileSystemManagementClient</span>(<span class="r105 r">context</span>))
                {
                    <span class="c">// create a folder and two files with content. Then download the folder and files, then re-upload the folder and files</span>
                    <b>var</b> <span id="r106 rd" class="r106 r">folderName</span> = <a href="#b3400ec07d2c29c7" class="i method">CreateFolder</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>);
                    <b>var</b> <span id="r107 rd" class="r107 r">file1</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>, <span class="r106 r">folderName</span>);
                    <b>var</b> <span id="r108 rd" class="r108 r">file2</span> = <a href="#59aa4463eba07451" class="i method">CreateFile</a>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>, <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <b>true</b>, <b>true</b>, <span class="r106 r">folderName</span>);
                    <b>var</b> <span id="r109 rd" class="r109 r">localTargetFolder</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">Path</span>.<span class="i">GetTempPath</span>(), <span class="r106 r">folderName</span>);
                    <b>try</b>
                    {
                        <span class="c">// download the folder</span>
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">DownloadFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r106 r">folderName</span>, <span class="r109 r">localTargetFolder</span>);
 
                        <span class="c">// verify the downloaded contents</span>
                        <b>var</b> <span id="r110 rd" class="r110 r">localDir</span> = <b>new</b> <span class="i">DirectoryInfo</span>(<span class="r109 r">localTargetFolder</span>);
                        <span class="i">Assert</span>.<span class="i">True</span>(<span class="r110 r">localDir</span>.<span class="i">Exists</span>);
                        <b>var</b> <span id="r111 rd" class="r111 r">localFiles</span> = <span class="r110 r">localDir</span>.<span class="i">GetFiles</span>();
                        <span class="i">Assert</span>.<span class="i">Equal</span>(2, <span class="r111 r">localFiles</span>.<span class="i">Count</span>());
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span> * 2, <span class="r111 r">localFiles</span>.<span class="i">Sum</span>(<span id="r112 rd" class="r112 r">f</span> =&gt; <span class="r112 r">f</span>.<span class="i">Length</span>));
 
                        <span class="c">// download just one file</span>
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">DownloadFile</span>(
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                            <span class="r107 r">file1</span>,
                            <span class="i">Path</span>.<span class="i">Combine</span>(
                                <span class="r109 r">localTargetFolder</span>,
                                <span class="s">&quot;specificFileDownload.out&quot;</span>));
                        <b>var</b> <span id="r113 rd" class="r113 r">newFile</span> = <b>new</b> <span class="i">FileInfo</span>(
                            <span class="i">Path</span>.<span class="i">Combine</span>(
                                <span class="r109 r">localTargetFolder</span>,
                                <span class="s">&quot;specificFileDownload.out&quot;</span>));
                        <span class="i">Assert</span>.<span class="i">True</span>(<span class="r113 r">newFile</span>.<span class="i">Exists</span>);
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>, <span class="r113 r">newFile</span>.<span class="i">Length</span>);
 
                        <b>var</b> <span id="r114 rd" class="r114 r">targetFolder</span> = <span class="r106 r">folderName</span> + <span class="s">&quot;/upload&quot;</span>;
                        <span class="c">// Upload the folder with these files, then upload a single file</span>
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">UploadFolder</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r109 r">localTargetFolder</span>, <span class="r114 r">targetFolder</span>);
                        <b>var</b> <span id="r115 rd" class="r115 r">folderStatus</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">ListFileStatus</span>(
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                            <span class="r114 r">targetFolder</span>);
                        <span class="i">Assert</span>.<span class="i">Equal</span>(3, <span class="r115 r">folderStatus</span>.<span class="i">FileStatuses</span>.<span class="i">FileStatus</span>.<span class="i">Count</span>());
                        <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span> * 3, <span class="r115 r">folderStatus</span>.<span class="i">FileStatuses</span>.<span class="i">FileStatus</span>.<span class="i">Sum</span>(<span id="r116 rd" class="r116 r">f</span> =&gt; <span class="r116 r">f</span>.<span class="i">Length</span>));
 
                        <span class="c">// upload one more file</span>
                        <b>var</b> <span id="r117 rd" class="r117 r">targetFile</span> = <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}.new&quot;</span>, <span class="r114 r">targetFolder</span>, <span class="r113 r">newFile</span>.<span class="i">Name</span>);
                        <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">UploadFile</span>(<a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>, <span class="r113 r">newFile</span>.<span class="i">FullName</span>, <span class="r117 r">targetFile</span>);
                        <span class="i">GetAndCompareFileOrFolder</span>(
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>,
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                            <span class="r117 r">targetFile</span>,
                            <span class="i">FileType</span>.<span class="i">FILE</span>,
                            <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>.<span class="i">Length</span>);
                        <span class="i">CompareFileContents</span>(
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>,
                            <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#f5ad8e05512b9299" class="i property">DataLakeStoreFileSystemAccountName</a>,
                            <span class="r117 r">targetFile</span>,
                            <a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>);
                    }
                    <b>finally</b>
                    {
                        <b>if</b> (<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r109 r">localTargetFolder</span>))
                        {
                            <span class="i">Directory</span>.<span class="i">Delete</span>(<span class="r109 r">localTargetFolder</span>, <b>true</b>);
                        }
                    }
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> helpers
        <b>internal</b> <span class="i">AclStatusResult</span> <a id="2afbd6fe1bd6f7d0" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetFullAcl</a>(<span class="i">AclStatusResult</span> <span id="r118 rd" class="r118 r">acl</span>)
        {
            <b>if</b> (<span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Permission</span>) &amp;&amp; <span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Permission</span>.<span class="i">Length</span> &gt;= 3)
            {
                <b>var</b> <span id="r119 rd" class="r119 r">permissionString</span> = <span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Permission</span>;
                <b>var</b> <span id="r120 rd" class="r120 r">permissionLength</span> = <span class="r119 r">permissionString</span>.<span class="i">Length</span>;
                <b>var</b> <span id="r121 rd" class="r121 r">ownerOctal</span> = <span class="r119 r">permissionString</span>.<span class="i">ElementAt</span>(<span class="r120 r">permissionLength</span> - 3).<span class="i">ToString</span>();
                <b>var</b> <span id="r122 rd" class="r122 r">groupOctal</span> = <span class="r119 r">permissionString</span>.<span class="i">ElementAt</span>(<span class="r120 r">permissionLength</span> - 2).<span class="i">ToString</span>();
                <b>var</b> <span id="r123 rd" class="r123 r">otherOctal</span> = <span class="r119 r">permissionString</span>.<span class="i">ElementAt</span>(<span class="r120 r">permissionLength</span> - 1).<span class="i">ToString</span>();
 
                <span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;user::{0}&quot;</span>, <span class="i">octalToPermission</span>(<b>int</b>.<span class="i">Parse</span>(<span class="r121 r">ownerOctal</span>))));
                <span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;other::{0}&quot;</span>, <span class="i">octalToPermission</span>(<b>int</b>.<span class="i">Parse</span>(<span class="r123 r">otherOctal</span>))));
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">First</span>(<span id="r124 rd" class="r124 r">e</span> =&gt; <span class="r124 r">e</span>.<span class="i">StartsWith</span>(<span class="s">&quot;group::&quot;</span>))))
                {
                    <span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;mask::{0}&quot;</span>, <span class="i">octalToPermission</span>(<b>int</b>.<span class="i">Parse</span>(<span class="r122 r">groupOctal</span>))));
                }
                <b>else</b>
                {
                    <span class="r118 r">acl</span>.<span class="i">AclStatus</span>.<span class="i">Entries</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;group::{0}&quot;</span>, <span class="i">octalToPermission</span>(<b>int</b>.<span class="i">Parse</span>(<span class="r122 r">groupOctal</span>))));
                }
            }
 
            <b>return</b> <span class="r118 r">acl</span>;
        }
 
        <b>private string</b> <a id="49303142c08a35d0" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">octalToPermission</a>(<b>int</b> <span id="r125 rd" class="r125 r">octal</span>)
        {
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}{1}{2}&quot;</span>, 
                (<span class="r125 r">octal</span> &amp; 4) &gt; 0 ? <span class="s">&quot;r&quot;</span> : <span class="s">&quot;-&quot;</span>,
                (<span class="r125 r">octal</span> &amp; 2) &gt; 0 ? <span class="s">&quot;w&quot;</span> : <span class="s">&quot;-&quot;</span>,
                (<span class="r125 r">octal</span> &amp; 1) &gt; 0 ? <span class="s">&quot;x&quot;</span> : <span class="s">&quot;-&quot;</span>);
        }
 
        <b>internal string</b> <a id="b3400ec07d2c29c7" href="../R/b3400ec07d2c29c7.html" target="n" data-glyph="74,1" class="i method">CreateFolder</a>(<a href="/Microsoft.Azure.Management.DataLake.Store/A.html#adb83a44424a752e" class="t t">DataLakeStoreFileSystemManagementClient</a> <span id="r126 rd" class="r126 r">dataLakeStoreFileSystemClient</span>, <b>string</b> <span id="r127 rd" class="r127 r">caboAccountName</span>, <b>bool</b> <span id="r128 rd" class="r128 r">randomName</span> = <b>false</b>)
        {
            <span class="c">// Create a folder</span>
            <b>var</b> <span id="r129 rd" class="r129 r">folderPath</span> = <span class="r128 r">randomName</span>
                ? <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<a href="#efdc1e2f4f392693" class="i field">folderToCreate</a>)
                : <a href="#efdc1e2f4f392693" class="i field">folderToCreate</a>;
 
            <b>var</b> <span id="r130 rd" class="r130 r">response</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Mkdirs</span>(<span class="r127 r">caboAccountName</span>, <span class="r129 r">folderPath</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r130 r">response</span>.<span class="i">OperationResult</span>);
 
            <b>return</b> <span class="r129 r">folderPath</span>;
        }
 
        <b>internal string</b> <a id="59aa4463eba07451" href="../R/59aa4463eba07451.html" target="n" data-glyph="74,1" class="i method">CreateFile</a>(<a href="/Microsoft.Azure.Management.DataLake.Store/A.html#adb83a44424a752e" class="t t">DataLakeStoreFileSystemManagementClient</a> <span id="r131 rd" class="r131 r">dataLakeStoreFileSystemClient</span>, <b>string</b> <span id="r132 rd" class="r132 r">caboAccountName</span>, <b>bool</b> <span id="r133 rd" class="r133 r">withContents</span>, <b>bool</b> <span id="r134 rd" class="r134 r">randomName</span> = <b>false</b>, <b>string</b> <span id="r135 rd" class="r135 r">folderName</span> = <a href="#efdc1e2f4f392693" class="i field">folderToCreate</a>)
        {
            <b>var</b> <span id="r136 rd" class="r136 r">filePath</span> = <span class="r134 r">randomName</span> ? <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r135 r">folderName</span>, <a href="#622c84d1f3e0dbbc" class="i field">fileToCreate</a>)) : <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0}/{1}&quot;</span>, <span class="r135 r">folderName</span>, <a href="#622c84d1f3e0dbbc" class="i field">fileToCreate</a>);
 
            <b>if</b> (!<span class="r133 r">withContents</span>)
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Create</span>(
                    <span class="r132 r">caboAccountName</span>,
                    <span class="r136 r">filePath</span>,
                    <b>new</b> <span class="i">MemoryStream</span>(),
                    <span class="i">syncFlag</span>: <span class="i">SyncFlag</span>.<span class="i">DATA</span>);
            }
            <b>else</b>
            {
                <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Create</span>(
                    <span class="r132 r">caboAccountName</span>,
                    <span class="r136 r">filePath</span>,
                    <b>new</b> <span class="i">MemoryStream</span>(<span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<a href="#8c8ae589891dce95" class="i field">fileContentsToAdd</a>)));
            }
 
            <b>return</b> <span class="r136 r">filePath</span>;
        }
 
        <b>internal</b> <span class="i">FileStatusResult</span> <a id="283c5c32d06bc60a" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetAndCompareFileOrFolder</a>(<a href="/Microsoft.Azure.Management.DataLake.Store/A.html#adb83a44424a752e" class="t t">DataLakeStoreFileSystemManagementClient</a> <span id="r137 rd" class="r137 r">dataLakeStoreFileSystemClient</span>, <b>string</b> <span id="r138 rd" class="r138 r">caboAccountName</span>, <b>string</b> <span id="r139 rd" class="r139 r">fileOrFolderPath</span>, <span class="i">FileType</span> <span id="r140 rd" class="r140 r">expectedType</span>, <b>long</b> <span id="r141 rd" class="r141 r">expectedLength</span>)
        {
            <b>var</b> <span id="r142 rd" class="r142 r">getResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">GetFileStatus</span>(<span class="r138 r">caboAccountName</span>, <span class="r139 r">fileOrFolderPath</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r141 r">expectedLength</span>, <span class="r142 r">getResponse</span>.<span class="i">FileStatus</span>.<span class="i">Length</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r140 r">expectedType</span>, <span class="r142 r">getResponse</span>.<span class="i">FileStatus</span>.<span class="i">Type</span>);
 
            <b>return</b> <span class="r142 r">getResponse</span>;
        }
 
        <b>internal void</b> <a id="636c5cc2f4e15109" href="../R/636c5cc2f4e15109.html" target="n" data-glyph="74,1" class="i method">CompareFileContents</a>(<a href="/Microsoft.Azure.Management.DataLake.Store/A.html#adb83a44424a752e" class="t t">DataLakeStoreFileSystemManagementClient</a> <span id="r143 rd" class="r143 r">dataLakeStoreFileSystemClient</span>, <b>string</b> <span id="r144 rd" class="r144 r">caboAccountName</span>, <b>string</b> <span id="r145 rd" class="r145 r">filePath</span>, <b>string</b> <span id="r146 rd" class="r146 r">expectedContents</span>)
        {
            <span class="c">// download a file and ensure they are equal</span>
            <b>try</b>
            {
                <span class="i">Stream</span> <span id="r147 rd" class="r147 r">openResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Open</span>(<span class="r144 r">caboAccountName</span>, <span class="r145 r">filePath</span>, <b>null</b>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r147 r">openResponse</span>);
                <b>string</b> <span id="r148 rd" class="r148 r">toCompare</span> = <b>new</b> <span class="i">StreamReader</span>(<span class="r147 r">openResponse</span>).<span class="i">ReadToEnd</span>();
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r146 r">expectedContents</span>, <span class="r148 r">toCompare</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r149 rd" class="r149 r">e</span>)
            {
                <b>throw</b> <span class="r149 r">e</span>;
            }
        }
 
        <b>internal void</b> <a id="883716acef3dc7c3" href="../R/883716acef3dc7c3.html" target="n" data-glyph="74,1" class="i method">DeleteFolder</a>(<a href="/Microsoft.Azure.Management.DataLake.Store/A.html#adb83a44424a752e" class="t t">DataLakeStoreFileSystemManagementClient</a> <span id="r150 rd" class="r150 r">dataLakeStoreFileSystemClient</span>, <b>string</b> <span id="r151 rd" class="r151 r">caboAccountName</span>, <b>string</b> <span id="r152 rd" class="r152 r">folderPath</span>, <b>bool</b> <span id="r153 rd" class="r153 r">recursive</span>, <b>bool</b> <span id="r154 rd" class="r154 r">failureExpected</span>)
        {
            <b>if</b> (<span class="r154 r">failureExpected</span>)
            {
                <span class="c">// try to delete a folder that doesn&#39;t exist or should fail</span>
                <b>try</b>
                {
                    <b>var</b> <span id="r155 rd" class="r155 r">deleteFolderResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Delete</span>(<span class="r151 r">caboAccountName</span>, <span class="r152 r">folderPath</span>, <span class="r153 r">recursive</span>);
                    <span class="i">Assert</span>.<span class="i">True</span>(!<span class="r155 r">deleteFolderResponse</span>.<span class="i">OperationResult</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r156 rd" class="r156 r">e</span>)
                {
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<b>typeof</b>(<span class="i">AdlsErrorException</span>), <span class="r156 r">e</span>.<span class="i">GetType</span>());
                }
            }
            <b>else</b>
            {
                <span class="c">// Delete a folder</span>
                <b>var</b> <span id="r157 rd" class="r157 r">deleteFolderResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Delete</span>(<span class="r151 r">caboAccountName</span>, <span class="r152 r">folderPath</span>, <span class="r153 r">recursive</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r157 r">deleteFolderResponse</span>.<span class="i">OperationResult</span>);
            }
        }
 
        <b>internal void</b> <a id="c4f67c50ee61a698" href="../R/c4f67c50ee61a698.html" target="n" data-glyph="74,1" class="i method">DeleteFile</a>(<a href="/Microsoft.Azure.Management.DataLake.Store/A.html#adb83a44424a752e" class="t t">DataLakeStoreFileSystemManagementClient</a> <span id="r158 rd" class="r158 r">dataLakeStoreFileSystemClient</span>, <b>string</b> <span id="r159 rd" class="r159 r">caboAccountName</span>, <b>string</b> <span id="r160 rd" class="r160 r">filePath</span>, <b>bool</b> <span id="r161 rd" class="r161 r">failureExpected</span>)
        {
            <b>if</b> (<span class="r161 r">failureExpected</span>)
            {
                <span class="c">// try to delete a file that doesn&#39;t exist</span>
                <b>try</b>
                {
                    <b>var</b> <span id="r162 rd" class="r162 r">deleteFileResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Delete</span>(<span class="r159 r">caboAccountName</span>, <span class="r160 r">filePath</span>, <b>false</b>);
                    <span class="i">Assert</span>.<span class="i">True</span>(!<span class="r162 r">deleteFileResponse</span>.<span class="i">OperationResult</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r163 rd" class="r163 r">e</span>)
                {
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<b>typeof</b>(<span class="i">AdlsErrorException</span>), <span class="r163 r">e</span>.<span class="i">GetType</span>());
                }
            }
            <b>else</b>
            {
                <span class="c">// Delete a file</span>
                <b>var</b> <span id="r164 rd" class="r164 r">deleteFileResponse</span> = <a href="#ab9f3ee2ac68b70d" class="i field">commonData</a>.<a href="../TestHelpers/CommonTestFixture.cs.html#fea5034223554d19" class="i property">DataLakeStoreFileSystemClient</a>.<span class="i">FileSystem</span>.<span class="i">Delete</span>(<span class="r159 r">caboAccountName</span>, <span class="r160 r">filePath</span>, <b>false</b>);
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r164 r">deleteFileResponse</span>.<span class="i">OperationResult</span>);
            }
        }
 
        <b>internal long</b> <a id="ee732ff25ce9f944" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ToUnixTimeStampMs</a>(<b>string</b> <span id="r165 rd" class="r165 r">date</span>)
        {
            <b>var</b> <span id="r166 rd" class="r166 r">convertedDate</span> = <span class="i">Convert</span>.<span class="i">ToDateTime</span>(<span class="r165 r">date</span>);
            <span class="c">// NOTE: This assumes the date being passed in is already UTC.</span>
            <b>return</b> (<b>long</b>)(<span class="r166 r">convertedDate</span> - <b>new</b> <span class="i">DateTime</span>(1970, 1, 1, 0, 0, 0, 0, <span class="i">DateTimeKind</span>.<span class="i">Utc</span>)).<span class="i">TotalMilliseconds</span>;
        }
 
        <b>internal</b> <span class="i">DateTime</span> <a id="1d70919f8468482b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">FromUnixTimestampMs</a>(<b>long</b> <span id="r167 rd" class="r167 r">unixTimestampInMs</span>)
        {
            <b>return</b> <b>new</b> <span class="i">DateTime</span>(1970, 1, 1, 0, 0, 0, 0, <span class="i">DateTimeKind</span>.<span class="i">Utc</span>).<span class="i">AddMilliseconds</span>(<span class="r167 r">unixTimestampInMs</span>);
        }
 
        <b>internal void</b> <a id="e75460cb91ced8a6" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">VerifyTimeInAcceptableRange</a>(<b>long</b> <span id="r168 rd" class="r168 r">expected</span>, <b>long</b> <span id="r169 rd" class="r169 r">actual</span>)
        {
            <span class="c">// We give a +- 100 ticks range due to timing constraints in the service.</span>
            <span class="i">Assert</span>.<span class="i">InRange</span>&lt;<b>long</b>&gt;(<span class="r169 r">actual</span>, <span class="r168 r">expected</span> - 5000, <span class="r168 r">expected</span> + 5000);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
 
</pre></td></tr></table></div></body></html>
