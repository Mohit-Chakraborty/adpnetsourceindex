<!DOCTYPE html>
<html><head><title>SearchResources.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(538);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Search.Documents.Tests/Utilities/SearchResources.cs" target="_top">Utilities\SearchResources.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/search/Azure.Search.Documents/tests/Utilities/SearchResources.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Search.Documents.Tests" target="_top">Azure.Search.Documents.Tests.csproj</a> (Azure.Search.Documents.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">Json</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i n">Documents</span>.<span class="i n">Indexes</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i n">Documents</span>.<span class="i n">Indexes</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i n">Documents</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Blobs</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Search</span>.<span class="i n">Documents</span>.<span class="i n">Tests</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Manage the creation and deletion of live test resources.  This uses the</span>
    <span class="c">///</span><span class="c"> Track 1 management libraries to create the Search Service and</span>
    <span class="c">///</span><span class="c"> (temporarily) the Track 1 data plane libraries to create and populate</span>
    <span class="c">///</span><span class="c"> the Hotels index.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public</b> <a href="../P/b3fb40182671ea0a.html" target="s" class="k">partial</a> <b>class</b> <a id="b3fb40182671ea0a" href="../R/b3fb40182671ea0a.html" target="n" data-glyph="0,0" class="t t">SearchResources</a> : <span class="t t">IAsyncDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A source of randomness for creating live test resources.  This</span>
        <span class="c">///</span><span class="c"> should not be tied into test recordings because live resource</span>
        <span class="c">///</span><span class="c"> creation is independent and not recorded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <a href="@0@mscorlib/A.html#bb77e610694e64ca" class="t t">Random</a> <a id="7a3a6bb54443d28c" href="../R/7a3a6bb54443d28c.html" target="n" data-glyph="102,1" class="i property">Random</a> { <b>get</b>; } = <b>new</b> <a href="@0@mscorlib/A.html#92e3cf6e56571d5a" class="t constructor">Random</a>(<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#39a839e5e9ca1f3f" class="i property">TickCount</a>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The timeout for cancellation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="9d27c3eb6fba07cb" href="../R/9d27c3eb6fba07cb.html" target="n" data-glyph="102,1" class="i property">Timeout</a> =&gt; <a href="@0@mscorlib/A.html#0652ef6f5bf8d78b" class="t t">Debugger</a>.<a href="@0@mscorlib/A.html#c70d3a0fb6f77726" class="i property">IsAttached</a> ?
            <span class="i n">System</span>.<span class="i n">Threading</span>.<a href="@0@mscorlib/A.html#6b53654d3452a8df" class="t t">Timeout</a>.<a href="@0@mscorlib/A.html#c679290f50556e4e" class="i field">InfiniteTimeSpan</a> :
            <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(2);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the Search service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="10940367c42e61c2" href="../R/10940367c42e61c2.html" target="n" data-glyph="102,1" class="i property">SearchServiceName</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="SearchTestEnvironment.cs.html#396d98f6f4b15be5" class="i property">SearchServiceName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The storage account name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="c90909298a09d6c1" href="../R/c90909298a09d6c1.html" target="n" data-glyph="102,1" class="i property">StorageAccountName</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="SearchTestEnvironment.cs.html#3b8e6753ec8cce75" class="i property">SearchStorageName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The storage account key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="f10513b88b1a3ab9" href="../R/f10513b88b1a3ab9.html" target="n" data-glyph="102,1" class="i property">StorageAccountKey</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="SearchTestEnvironment.cs.html#085f8671846d5636" class="i property">SearchStorageKey</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The storage endpoint suffix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4a725f085263da13" href="../R/4a725f085263da13.html" target="n" data-glyph="102,1" class="i property">StorageEndpointSuffix</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="/Azure.Core.TestFramework/A.html#bd57f64a1b0c633a" class="i property">StorageEndpointSuffix</a> ?? <span class="s">&quot;core.windows.net&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The storage account connection string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="799f11dd63580561" href="../R/799f11dd63580561.html" target="n" data-glyph="102,1" class="i property">StorageAccountConnectionString</a> =&gt; <span class="s">$&quot;</span><span class="s">DefaultEndpointsProtocol=https;AccountName=</span>{<a href="#c90909298a09d6c1" class="i property">StorageAccountName</a>}<span class="s">;AccountKey=</span>{<a href="#f10513b88b1a3ab9" class="i property">StorageAccountKey</a>}<span class="s">;EndpointSuffix=</span>{<a href="#4a725f085263da13" class="i property">StorageEndpointSuffix</a>}<span class="s">&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Cognitive Services key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4d1f963654e587fb" href="../R/4d1f963654e587fb.html" target="n" data-glyph="102,1" class="i property">CognitiveServicesKey</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="SearchTestEnvironment.cs.html#dc75421a1b2e2970" class="i property">SearchCognitiveKey</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the blob container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="0b7cada889ca549c" href="../R/0b7cada889ca549c.html" target="n" data-glyph="102,1" class="i property">BlobContainerName</a>
        {
            <b>get</b> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#89ed8eba7a7ce6c2" class="i method">GetVariable</a>(<span class="s">&quot;BlobContainerName&quot;</span>, <a href="#5a0cb96afcb44edd" class="i field">_blobContainerName</a>);
            <b>set</b>
            {
                <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#9ee432907b11d245" class="i method">SetVariable</a>(<span class="s">&quot;BlobContainerName&quot;</span>, <b>value</b>);
                <a href="#5a0cb96afcb44edd" class="i field">_blobContainerName</a> = <b>value</b>;
            }
        }
        <b>private string</b> <a id="5a0cb96afcb44edd" href="../R/5a0cb96afcb44edd.html" target="n" data-glyph="46,1" class="i field">_blobContainerName</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the index created for test data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="f6a1ff138f46d373" href="../R/f6a1ff138f46d373.html" target="n" data-glyph="102,1" class="i property">IndexName</a>
        {
            <b>get</b> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#89ed8eba7a7ce6c2" class="i method">GetVariable</a>(<span class="s">&quot;SearchIndexName&quot;</span>, <a href="#19674f2a22b0c677" class="i field">_indexName</a>);
            <b>set</b>
            {
                <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#9ee432907b11d245" class="i method">SetVariable</a>(<span class="s">&quot;SearchIndexName&quot;</span>, <b>value</b>);
                <a href="#19674f2a22b0c677" class="i field">_indexName</a> = <b>value</b>;
            }
        }
        <b>private string</b> <a id="19674f2a22b0c677" href="../R/19674f2a22b0c677.html" target="n" data-glyph="46,1" class="i field">_indexName</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The search endpoint suffix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b0d8eae2ae3079dd" href="../R/b0d8eae2ae3079dd.html" target="n" data-glyph="102,1" class="i property">SearchEndpointSuffix</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="SearchTestEnvironment.cs.html#feeb0a0484941dbb" class="i property">SearchEndpointSuffix</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The URI of the Search service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <a id="284d4899a7a27f74" href="../R/284d4899a7a27f74.html" target="n" data-glyph="102,1" class="i property">Endpoint</a> =&gt; <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<a href="#10940367c42e61c2" class="i property">SearchServiceName</a>}<span class="s">.</span>{<a href="#b0d8eae2ae3079dd" class="i property">SearchEndpointSuffix</a>}<span class="s">&quot;</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Primary or Admin API key to authenticate requests to the</span>
        <span class="c">///</span><span class="c"> service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4c4d44d32b60c7e7" href="../R/4c4d44d32b60c7e7.html" target="n" data-glyph="102,1" class="i property">PrimaryApiKey</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="SearchTestEnvironment.cs.html#a01b74ac574dbaea" class="i property">SearchAdminKey</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Query API key to authenticate requests to the service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ec7b2fc3a4883066" href="../R/ec7b2fc3a4883066.html" target="n" data-glyph="102,1" class="i property">QueryApiKey</a> =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="SearchTestEnvironment.cs.html#f947ab3d36fc47dd" class="i property">SearchQueryKey</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flag indicating whether these resources need to be cleaned up.</span>
        <span class="c">///</span><span class="c"> This is true for any resources that we created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b29974910b5bbccd" href="../R/b29974910b5bbccd.html" target="n" data-glyph="102,1" class="i property">RequiresCleanup</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flag indicating whether these storage resources need to be cleaned up.</span>
        <span class="c">///</span><span class="c"> This is true for any storage resources that we created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="a26e61fee2219dcb" href="../R/a26e61fee2219dcb.html" target="n" data-glyph="102,1" class="i property">RequiresBlobContainerCleanup</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <a id="53fe8fe5c2362e23" href="../R/53fe8fe5c2362e23.html" target="n" data-glyph="102,1" class="i property">TestFixture</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Create Test Resources
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Direct folks toward the static helpers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a id="8e9c69f745c298a5" href="../R/8e9c69f745c298a5.html" target="n" data-glyph="76,1" class="t constructor">SearchResources</a>(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r0 rd" class="r0 r">fixture</span>) =&gt; <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a> = <span class="r0 r">fixture</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new Search Service resource with no indexes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new TestResources context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a> <a id="ec235778da14e83b" href="../R/ec235778da14e83b.html" target="n" data-glyph="72,1" class="i method">CreateWithNoIndexes</a>(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r1 rd" class="r1 r">fixture</span>)
        {
            <b>return</b> <b>new</b> <a href="#8e9c69f745c298a5" class="t constructor">SearchResources</a>(<span class="r1 r">fixture</span>)
            {
                <span class="c">// We created no index, but others tests might. We&#39;ll check when cleaning up.</span>
                <a href="#b29974910b5bbccd" class="i property">RequiresCleanup</a> = <span class="r1 r">fixture</span>.<a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#f12245cbae0b56da" class="i property">Mode</a> != <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#bde4663b03b59b85" class="i field">Playback</a>,
            };
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new Search Service resource with an empty index for a</span>
        <span class="c">///</span><span class="c"> given model type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new TestResources context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="05477d926cba4f34" href="../R/05477d926cba4f34.html" target="n" data-glyph="72,1" class="i method">CreateWithEmptyIndexAsync</a>&lt;<span id="r3 rd t" class="r3 r t">T</span>&gt;(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r2 rd" class="r2 r">fixture</span>)
        {
            <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">var</a> <span id="r4 rd" class="r4 r">resources</span> = <b>new</b> <a href="#8e9c69f745c298a5" class="t constructor">SearchResources</a>(<span class="r2 r">fixture</span>);
            <b>await</b> <span class="r4 r">resources</span>.<a href="#2b83d02d94e613ee" class="i method">CreateSearchServiceAndIndexAsync</a>(<span id="r5 rd" class="r5 r">name</span> =&gt;
                <b>new</b> <a href="/Azure.Search.Documents/A.html#8606cdb84e224b8f" class="t constructor">SearchIndex</a>(<span class="r5 r">name</span>)
                {
                    <a href="/Azure.Search.Documents/A.html#c94063e669ad413a" class="i property">Fields</a> = <b>new</b> <a href="/Azure.Search.Documents/A.html#1a4c560ad5a2ed3c" class="t constructor">FieldBuilder</a>().<a href="/Azure.Search.Documents/A.html#e64edb5d47422e51" class="i method">Build</a>(<b>typeof</b>(<span class="r3 r t">T</span>))
                });
            <b>return</b> <span class="r4 r">resources</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new Search Service resource with an empty Hotel index.</span>
        <span class="c">///</span><span class="c"> See TestResources.Data.cs for the index schema.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new TestResources context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="ceff0bd522f0fd56" href="../R/ceff0bd522f0fd56.html" target="n" data-glyph="72,1" class="i method">CreateWithEmptyHotelsIndexAsync</a>(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r6 rd" class="r6 r">fixture</span>)
        {
            <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">var</a> <span id="r7 rd" class="r7 r">resources</span> = <b>new</b> <a href="#8e9c69f745c298a5" class="t constructor">SearchResources</a>(<span class="r6 r">fixture</span>);
            <b>await</b> <span class="r7 r">resources</span>.<a href="#2b83d02d94e613ee" class="i method">CreateSearchServiceAndIndexAsync</a>();
            <b>return</b> <span class="r7 r">resources</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new Search Service resource a Hotel index and sample data</span>
        <span class="c">///</span><span class="c"> set.  See TestResources.Data.cs for the index schema and data set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new TestResources context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="787208e12f9cb8bb" href="../R/787208e12f9cb8bb.html" target="n" data-glyph="72,1" class="i method">CreateWithHotelsIndexAsync</a>(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r8 rd" class="r8 r">fixture</span>)
        {
            <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">var</a> <span id="r9 rd" class="r9 r">resources</span> = <b>new</b> <a href="#8e9c69f745c298a5" class="t constructor">SearchResources</a>(<span class="r8 r">fixture</span>);
            <b>await</b> <span class="r9 r">resources</span>.<a href="#622719a7815fe08e" class="i method">CreateSearchServiceIndexAndDocumentsAsync</a>();
            <b>return</b> <span class="r9 r">resources</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new Search service resources with sample data</span>
        <span class="c">///</span><span class="c"> loaded into a new blob container but no index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">populate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether to populate the container with Hotel documents. The default is false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="aab785794fad918f" href="../R/aab785794fad918f.html" target="n" data-glyph="72,1" class="i method">CreateWithBlobStorageAsync</a>(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r10 rd" class="r10 r">fixture</span>, <b>bool</b> <span id="r11 rd" class="r11 r">populate</span> = <b>false</b>)
        {
            <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">var</a> <span id="r12 rd" class="r12 r">resources</span> = <b>new</b> <a href="#8e9c69f745c298a5" class="t constructor">SearchResources</a>(<span class="r10 r">fixture</span>);
            <b>await</b> <span class="r12 r">resources</span>.<a href="#a1352e273344e881" class="i method">CreateHotelsBlobContainerAsync</a>(<span class="r11 r">populate</span>);
            <b>return</b> <span class="r12 r">resources</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new Search service resources with a Hotel index and sample data</span>
        <span class="c">///</span><span class="c"> loaded into a new blob container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">populate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether to populate the container with Hotel documents. The default is false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="8d8312667fdc60d2" href="../R/8d8312667fdc60d2.html" target="n" data-glyph="72,1" class="i method">CreateWithBlobStorageAndIndexAsync</a>(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r13 rd" class="r13 r">fixture</span>, <b>bool</b> <span id="r14 rd" class="r14 r">populate</span> = <b>false</b>)
        {
            <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">var</a> <span id="r15 rd" class="r15 r">resources</span> = <b>new</b> <a href="#8e9c69f745c298a5" class="t constructor">SearchResources</a>(<span class="r13 r">fixture</span>);
 
            <span class="c">// Keep them ordered or records may not match seeded random names.</span>
            <b>await</b> <span class="r15 r">resources</span>.<a href="#2b83d02d94e613ee" class="i method">CreateSearchServiceAndIndexAsync</a>();
            <b>await</b> <span class="r15 r">resources</span>.<a href="#a1352e273344e881" class="i method">CreateHotelsBlobContainerAsync</a>(<span class="r14 r">populate</span>);
 
            <b>return</b> <span class="r15 r">resources</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a shared Search Service resource with a Hotel index and sample</span>
        <span class="c">///</span><span class="c"> data set.  See TestResources.Data.cs for the index schema and data</span>
        <span class="c">///</span><span class="c"> set.  This resource is shared across the entire test run and should</span>
        <span class="c">///</span><span class="c"> not be mutated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">fixture</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TestFixture with context about our current test run,</span>
        <span class="c">///</span><span class="c"> recordings, instrumentation, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The shared TestResources context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="657911178887f020" href="../R/657911178887f020.html" target="n" data-glyph="72,1" class="i method">GetSharedHotelsIndexAsync</a>(<a href="SearchTestBase.cs.html#26e65f5e616a8732" class="t t">SearchTestBase</a> <span id="r16 rd" class="r16 r">fixture</span>)
        {
            <b>await</b> <a href="SharedSearchResources.cs.html#8005461bcacd9f2b" class="t t">SharedSearchResources</a>.<a href="SharedSearchResources.cs.html#fd2005b555a52e43" class="i method">EnsureInitialized</a>(<b>async</b> () =&gt; <b>await</b> <a href="#787208e12f9cb8bb" class="i method">CreateWithHotelsIndexAsync</a>(<span class="r16 r">fixture</span>));
 
            <span class="c">// Clone it for the current fixture (note that setting these values</span>
            <span class="c">// will create the recording ServiceName/IndexName/etc. variables)</span>
            <b>return</b> <b>new</b> <a href="#8e9c69f745c298a5" class="t constructor">SearchResources</a>(<span class="r16 r">fixture</span>)
            {
                <a href="#f6a1ff138f46d373" class="i property">IndexName</a> = <a href="SharedSearchResources.cs.html#8005461bcacd9f2b" class="t t">SharedSearchResources</a>.<a href="SharedSearchResources.cs.html#07b272e93006907c" class="i property">Search</a>.<a href="#f6a1ff138f46d373" class="i property">IndexName</a>,
            };
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Create Test Resources
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Get Clients
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#a345935bc4c27d00" class="t t">SearchIndexClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to use for testing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional client options.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#a345935bc4c27d00" class="t t">SearchIndexClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="/Azure.Search.Documents/A.html#a345935bc4c27d00" class="t t">SearchIndexClient</a> <a id="c3ae2bf669d51091" href="../R/c3ae2bf669d51091.html" target="n" data-glyph="72,1" class="i method">GetIndexClient</a>(<a href="/Azure.Search.Documents/A.html#b9c00cf06282d775" class="t t">SearchClientOptions</a> <span id="r17 rd" class="r17 r">options</span> = <b>null</b>) =&gt;
            <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <b>new</b> <a href="/Azure.Search.Documents/A.html#9fc8172acd8d29b1" class="t constructor">SearchIndexClient</a>(
                    <a href="#284d4899a7a27f74" class="i property">Endpoint</a>,
                    <b>new</b> <a href="/Azure.Core/A.html#015df0c4993644fe" class="t constructor">AzureKeyCredential</a>(<a href="#4c4d44d32b60c7e7" class="i property">PrimaryApiKey</a>),
                    <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#75eec36c3ae80a0c" class="i method">GetSearchClientOptions</a>(<span class="r17 r">options</span>)));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#b83292fff0406ffc" class="t t">SearchIndexerClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to use for testing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional client options.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#b83292fff0406ffc" class="t t">SearchIndexerClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="/Azure.Search.Documents/A.html#b83292fff0406ffc" class="t t">SearchIndexerClient</a> <a id="f15e185dd03115fc" href="../R/f15e185dd03115fc.html" target="n" data-glyph="72,1" class="i method">GetIndexerClient</a>(<a href="/Azure.Search.Documents/A.html#b9c00cf06282d775" class="t t">SearchClientOptions</a> <span id="r18 rd" class="r18 r">options</span> = <b>null</b>) =&gt;
            <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <b>new</b> <a href="/Azure.Search.Documents/A.html#e6f3e55521f56dbe" class="t constructor">SearchIndexerClient</a>(
                    <a href="#284d4899a7a27f74" class="i property">Endpoint</a>,
                    <b>new</b> <a href="/Azure.Core/A.html#015df0c4993644fe" class="t constructor">AzureKeyCredential</a>(<a href="#4c4d44d32b60c7e7" class="i property">PrimaryApiKey</a>),
                    <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#75eec36c3ae80a0c" class="i method">GetSearchClientOptions</a>(<span class="r18 r">options</span>)));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#4a8a1a9e2cf03b3c" class="t t">SearchClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to use for testing with an Admin API key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional client options.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#4a8a1a9e2cf03b3c" class="t t">SearchClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="/Azure.Search.Documents/A.html#4a8a1a9e2cf03b3c" class="t t">SearchClient</a> <a id="d4f2d9ebb83b1397" href="../R/d4f2d9ebb83b1397.html" target="n" data-glyph="72,1" class="i method">GetSearchClient</a>(<a href="/Azure.Search.Documents/A.html#b9c00cf06282d775" class="t t">SearchClientOptions</a> <span id="r19 rd" class="r19 r">options</span> = <b>null</b>)
        {
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<a href="#f6a1ff138f46d373" class="i property">IndexName</a>, <span class="s">&quot;No index was created for these TestResources!&quot;</span>);
            <b>return</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <a href="#c3ae2bf669d51091" class="i method">GetIndexClient</a>(<span class="r19 r">options</span>).<a href="/Azure.Search.Documents/A.html#83cef14be3804fec" class="i method">GetSearchClient</a>(<a href="#f6a1ff138f46d373" class="i property">IndexName</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#4a8a1a9e2cf03b3c" class="t t">SearchClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to use for testing with a query API key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional client options.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Search.Documents/A.html#4a8a1a9e2cf03b3c" class="t t">SearchClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="/Azure.Search.Documents/A.html#4a8a1a9e2cf03b3c" class="t t">SearchClient</a> <a id="385b0434cda23f09" href="../R/385b0434cda23f09.html" target="n" data-glyph="72,1" class="i method">GetQueryClient</a>(<a href="/Azure.Search.Documents/A.html#b9c00cf06282d775" class="t t">SearchClientOptions</a> <span id="r20 rd" class="r20 r">options</span> = <b>null</b>)
        {
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<a href="#f6a1ff138f46d373" class="i property">IndexName</a>, <span class="s">&quot;No index was created for these TestResources!&quot;</span>);
            <b>return</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <b>new</b> <a href="/Azure.Search.Documents/A.html#74e2dc1a01a6e394" class="t constructor">SearchClient</a>(
                    <a href="#284d4899a7a27f74" class="i property">Endpoint</a>,
                    <a href="#f6a1ff138f46d373" class="i property">IndexName</a>,
                    <b>new</b> <a href="/Azure.Core/A.html#015df0c4993644fe" class="t constructor">AzureKeyCredential</a>(<a href="#ec7b2fc3a4883066" class="i property">QueryApiKey</a>),
                    <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#75eec36c3ae80a0c" class="i method">GetSearchClientOptions</a>(<span class="r20 r">options</span>)));
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Get Clients
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Service Management
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Automatically delete the Search Service when the resources are no</span>
        <span class="c">///</span><span class="c"> longer needed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public async</b> <span class="t t">ValueTask</span> <a id="ce76ffc479599745" href="../R/ce76ffc479599745.html" target="n" data-glyph="72,1" class="i method">DisposeAsync</a>() =&gt; <b>await</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#929d1a3d98d89901" class="i method">WhenAll</a>(
            <a href="#cb54534a929da4d3" class="i method">DeleteIndexAsync</a>(),
            <a href="#f54f8418295cf94c" class="i method">DeleteBlobContainerAsync</a>());
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deletes the index created as a test resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="cb54534a929da4d3" href="../R/cb54534a929da4d3.html" target="n" data-glyph="76,1" class="i method">DeleteIndexAsync</a>()
        {
            <b>if</b> (<a href="#b29974910b5bbccd" class="i property">RequiresCleanup</a> &amp;&amp; !<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<a href="#f6a1ff138f46d373" class="i property">IndexName</a>))
            {
                <a href="/Azure.Search.Documents/A.html#a345935bc4c27d00" class="t t">SearchIndexClient</a> <span id="r21 rd" class="r21 r">client</span> = <a href="#c3ae2bf669d51091" class="i method">GetIndexClient</a>();
                <b>await</b> <span class="r21 r">client</span>.<a href="/Azure.Search.Documents/A.html#2ce48f46c72812a1" class="i method">DeleteIndexAsync</a>(<a href="#f6a1ff138f46d373" class="i property">IndexName</a>);
                <a href="#b29974910b5bbccd" class="i property">RequiresCleanup</a> = <b>false</b>;
 
                <b>await</b> <a href="#7bd857c77626feaf" class="i method">WaitForIndexDeletionAsync</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Delete the Storage blob container created as a test resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f54f8418295cf94c" href="../R/f54f8418295cf94c.html" target="n" data-glyph="76,1" class="i method">DeleteBlobContainerAsync</a>()
        {
            <b>if</b> (<a href="#a26e61fee2219dcb" class="i property">RequiresBlobContainerCleanup</a>)
            {
                <a href="/Azure.Storage.Blobs/A.html#6bb2c165ee95c7d4" class="t t">BlobContainerClient</a> <span id="r22 rd" class="r22 r">client</span> = <b>new</b> <a href="/Azure.Storage.Blobs/A.html#a8fabb3df558cea1" class="t constructor">BlobContainerClient</a>(<a href="#799f11dd63580561" class="i property">StorageAccountConnectionString</a>, <a href="#0b7cada889ca549c" class="i property">BlobContainerName</a>);
                <b>await</b> <span class="r22 r">client</span>.<a href="/Azure.Storage.Blobs/A.html#a1e9093d91c6ec6c" class="i method">DeleteIfExistsAsync</a>();
                <a href="#a26e61fee2219dcb" class="i property">RequiresBlobContainerCleanup</a> = <b>false</b>;
 
                <b>await</b> <a href="#209a3b9045061a4e" class="i method">WaitForBlobContainerDeletionAsync</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new Search Service and empty Hotels Index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">getIndex</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Function to get an index definition using the provided name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">This TestResources context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="2b83d02d94e613ee" href="../R/2b83d02d94e613ee.html" target="n" data-glyph="76,1" class="i method">CreateSearchServiceAndIndexAsync</a>(
            <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="/Azure.Search.Documents/A.html#4ddfbec02f9471fa" class="t t">SearchIndex</a>&gt; <span id="r23 rd" class="r23 r">getIndex</span> = <b>null</b>)
        {
            <span class="r23 r">getIndex</span> ??= <a href="SearchResources.Data.cs.html#ec2554f5cbb10174" class="i method">GetHotelIndex</a>;
 
            <span class="c">// Create the index</span>
            <b>if</b> (<a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> != <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#bde4663b03b59b85" class="i field">Playback</a>)
            {
                <span class="c">// Generate a random Index Name</span>
                <a href="#f6a1ff138f46d373" class="i property">IndexName</a> = <a href="#7a3a6bb54443d28c" class="i property">Random</a>.<a href="TestExtensions.cs.html#3a8107aee82d17c9" class="i method">GetName</a>(8);
 
                <a href="/Azure.Search.Documents/A.html#a345935bc4c27d00" class="t t">SearchIndexClient</a> <span id="r24 rd" class="r24 r">client</span> = <b>new</b> <a href="/Azure.Search.Documents/A.html#97b779652eecbfe4" class="t constructor">SearchIndexClient</a>(<a href="#284d4899a7a27f74" class="i property">Endpoint</a>, <b>new</b> <a href="/Azure.Core/A.html#015df0c4993644fe" class="t constructor">AzureKeyCredential</a>(<a href="#4c4d44d32b60c7e7" class="i property">PrimaryApiKey</a>));
                <b>await</b> <span class="r24 r">client</span>.<a href="/Azure.Search.Documents/A.html#98899ddc899c2521" class="i method">CreateIndexAsync</a>(<span class="r23 r">getIndex</span>(<a href="#f6a1ff138f46d373" class="i property">IndexName</a>));
 
                <a href="#b29974910b5bbccd" class="i property">RequiresCleanup</a> = <b>true</b>;
 
                <span class="c">// Give the index time to stabilize before running tests.</span>
                <b>await</b> <a href="#c132652c5f0be0c8" class="i method">WaitForIndexCreationAsync</a>();
            }
 
            <b>return</b> <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new Search Service, Hotels Index, and fill it with</span>
        <span class="c">///</span><span class="c"> test documents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">This TestResources context.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="622719a7815fe08e" href="../R/622719a7815fe08e.html" target="n" data-glyph="76,1" class="i method">CreateSearchServiceIndexAndDocumentsAsync</a>()
        {
            <span class="c">// Create the Search Service and Index first</span>
            <b>await</b> <a href="#2b83d02d94e613ee" class="i method">CreateSearchServiceAndIndexAsync</a>();
 
            <span class="c">// Upload the documents</span>
            <b>if</b> (<a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> != <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#bde4663b03b59b85" class="i field">Playback</a>)
            {
                <a href="/Azure.Search.Documents/A.html#4a8a1a9e2cf03b3c" class="t t">SearchClient</a> <span id="r25 rd" class="r25 r">client</span> = <b>new</b> <a href="/Azure.Search.Documents/A.html#c6d93fa3b249494d" class="t constructor">SearchClient</a>(<a href="#284d4899a7a27f74" class="i property">Endpoint</a>, <a href="#f6a1ff138f46d373" class="i property">IndexName</a>, <b>new</b> <a href="/Azure.Core/A.html#015df0c4993644fe" class="t constructor">AzureKeyCredential</a>(<a href="#4c4d44d32b60c7e7" class="i property">PrimaryApiKey</a>));
                <a href="/Azure.Search.Documents/A.html#0534ae1a265b0c36" class="t t">IndexDocumentsBatch</a>&lt;<a href="SearchResources.Data.cs.html#e793040a76751146" class="t t">Hotel</a>&gt; <span id="r26 rd" class="r26 r">batch</span> = <a href="/Azure.Search.Documents/A.html#929ca9fa6d8c4027" class="t t">IndexDocumentsBatch</a>.<a href="/Azure.Search.Documents/A.html#e6cde39f818940b1" class="i method">Upload</a>(<a href="SearchResources.Data.cs.html#2445f7fadcedd253" class="i field">TestDocuments</a>);
                <b>await</b> <span class="r25 r">client</span>.<a href="/Azure.Search.Documents/A.html#e9473f2341aadaa1" class="i method">IndexDocumentsAsync</a>(<span class="r26 r">batch</span>);
 
                <b>await</b> <a href="#1ca384228589c2da" class="i method">WaitForIndexingAsync</a>();
            }
 
            <b>return</b> <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Upload </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="SearchResources.Data.cs.html#2445f7fadcedd253" class="i field">TestDocuments</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to a new blob storage container identified by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0b7cada889ca549c" class="i property">BlobContainerName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The current </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="t t">SearchResources</a>&gt; <a id="a1352e273344e881" href="../R/a1352e273344e881.html" target="n" data-glyph="76,1" class="i method">CreateHotelsBlobContainerAsync</a>(<b>bool</b> <span id="r27 rd" class="r27 r">populate</span>)
        {
            <b>if</b> (<a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> != <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#bde4663b03b59b85" class="i field">Playback</a>)
            {
                <a href="#0b7cada889ca549c" class="i property">BlobContainerName</a> = <a href="#7a3a6bb54443d28c" class="i property">Random</a>.<a href="TestExtensions.cs.html#3a8107aee82d17c9" class="i method">GetName</a>(8);
 
                <b>using</b> <a href="@0@mscorlib/A.html#130a9536ac96b392" class="t t">CancellationTokenSource</a> <span id="r28 rd" class="r28 r">cts</span> = <b>new</b> <a href="@0@mscorlib/A.html#2f4ad148fd857d6f" class="t constructor">CancellationTokenSource</a>(<a href="#9d27c3eb6fba07cb" class="i property">Timeout</a>);
 
                <a href="/Azure.Storage.Blobs/A.html#6bb2c165ee95c7d4" class="t t">BlobContainerClient</a> <span id="r29 rd" class="r29 r">client</span> = <b>new</b> <a href="/Azure.Storage.Blobs/A.html#a8fabb3df558cea1" class="t constructor">BlobContainerClient</a>(<a href="#799f11dd63580561" class="i property">StorageAccountConnectionString</a>, <a href="#0b7cada889ca549c" class="i property">BlobContainerName</a>);
                <b>await</b> <span class="r29 r">client</span>.<a href="/Azure.Storage.Blobs/A.html#bc2496fa7483427d" class="i method">CreateIfNotExistsAsync</a>(<span class="r30 r">cancellationToken</span>: <span class="r28 r">cts</span>.<a href="@0@mscorlib/A.html#9e22b9c8995bf195" class="i property">Token</a>);
 
                <a href="#a26e61fee2219dcb" class="i property">RequiresBlobContainerCleanup</a> = <b>true</b>;
 
                <b>if</b> (<span class="r27 r">populate</span>)
                {
                    <a href="SearchResources.Data.cs.html#e793040a76751146" class="t t">Hotel</a>[] <span id="r31 rd" class="r31 r">hotels</span> = <a href="SearchResources.Data.cs.html#2445f7fadcedd253" class="i field">TestDocuments</a>;
                    <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>&gt; <span id="r32 rd" class="r32 r">tasks</span> = <b>new</b> <a href="@0@mscorlib/A.html#b65c1a07c4e5b13a" class="t constructor">List</a>&lt;<a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>&gt;(<span class="r31 r">hotels</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
 
                    <b>foreach</b> (<a href="SearchResources.Data.cs.html#e793040a76751146" class="t t">Hotel</a> <span id="r33 rd" class="r33 r">hotel</span> <b>in</b> <span class="r31 r">hotels</span>)
                    {
                        <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <span id="r34 rd" class="r34 r">task</span> = <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#101f1757fbbf2575" class="i method">Run</a>(<b>async</b> () =&gt;
                        {
                            <b>using</b> <a href="@0@mscorlib/A.html#1a4dcb744a23ba6f" class="t t">MemoryStream</a> <span id="r35 rd" class="r35 r">stream</span> = <b>new</b> <a href="@0@mscorlib/A.html#d308091cc690e78d" class="t constructor">MemoryStream</a>();
                            <b>await</b> <span class="t t">JsonSerializer</span>
                                .<span class="i method">SerializeAsync</span>(<span class="r35 r">stream</span>, <span class="r33 r">hotel</span>, <a href="/Azure.Search.Documents/A.html#514dfe35bc742fe6" class="t t">JsonSerialization</a>.<a href="/Azure.Search.Documents/A.html#ee91d1f5680f4af5" class="i property">SerializerOptions</a>, <span class="r28 r">cts</span>.<a href="@0@mscorlib/A.html#9e22b9c8995bf195" class="i property">Token</a>)
                                .<a href="@0@mscorlib/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
                            <span class="r35 r">stream</span>.<a href="@0@mscorlib/A.html#30f00da49c798fe1" class="i method">Seek</a>(0, <a href="@0@mscorlib/A.html#2cc1cf6635f00a52" class="t t">SeekOrigin</a>.<a href="@0@mscorlib/A.html#c29481af7c617299" class="i field">Begin</a>);
 
                            <b>await</b> <span class="r29 r">client</span>
                                .<a href="/Azure.Storage.Blobs/A.html#2f248434db2a0df9" class="i method">UploadBlobAsync</a>(<span class="r33 r">hotel</span>.<a href="SearchResources.Data.cs.html#299bbe8bdd362511" class="i property">HotelId</a>, <span class="r35 r">stream</span>, <span class="r28 r">cts</span>.<a href="@0@mscorlib/A.html#9e22b9c8995bf195" class="i property">Token</a>)
                                .<a href="@0@mscorlib/A.html#07ef75a8fa372c94" class="i method">ConfigureAwait</a>(<b>false</b>);
                        });
 
                        <span class="r32 r">tasks</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r34 r">task</span>);
                    }
 
                    <b>await</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#69351c6da968e5d1" class="i method">WhenAll</a>(<span class="r32 r">tasks</span>);
                }
            }
 
            <b>return</b> <a href="../P/b3fb40182671ea0a.html#b3fb40182671ea0a" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait for the index to stabilize.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The default delay is 20s, but can be configured by setting the </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">AZURE_SEARCH_CREATE_DELAY</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> environment variable to the number of seconds you want to wait otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A Task to await.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c132652c5f0be0c8" href="../R/c132652c5f0be0c8.html" target="n" data-glyph="72,1" class="i method">WaitForIndexCreationAsync</a>()
        {
            <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <span id="r36 rd" class="r36 r">delay</span> = <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(20);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r37 rd" class="r37 r">value</span> = <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#3956c71d4fc09576" class="i method">GetEnvironmentVariable</a>(<span class="s">&quot;AZURE_SEARCH_CREATE_DELAY&quot;</span>);
            <b>if</b> (<b>int</b>.<a href="@0@mscorlib/A.html#325507e509229dbc" class="i method">TryParse</a>(<span class="r37 r">value</span>, <b>out int</b> <span id="r38 rd" class="r38 r">numValue</span>))
            {
                <span class="r36 r">delay</span> = <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(<span class="r38 r">numValue</span>);
            }
 
            <b>await</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#939ca4758a3b25ea" class="i method">DelayAsync</a>(<span class="r36 r">delay</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait for the index to be deleted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A Task to await.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7bd857c77626feaf" href="../R/7bd857c77626feaf.html" target="n" data-glyph="72,1" class="i method">WaitForIndexDeletionAsync</a>() =&gt;
            <b>await</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#939ca4758a3b25ea" class="i method">DelayAsync</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(2));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait for blob containers to be deleted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A Task to await.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="209a3b9045061a4e" href="../R/209a3b9045061a4e.html" target="n" data-glyph="72,1" class="i method">WaitForBlobContainerDeletionAsync</a>() =&gt;
            <b>await</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#939ca4758a3b25ea" class="i method">DelayAsync</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(2));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait for uploaded documents to be indexed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A Task to await.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="1ca384228589c2da" href="../R/1ca384228589c2da.html" target="n" data-glyph="72,1" class="i method">WaitForIndexingAsync</a>() =&gt;
            <b>await</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#939ca4758a3b25ea" class="i method">DelayAsync</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(2));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait for the synonym map to be updated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A Task to await.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="690c6573c09bf22e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WaitForSynonymMapUpdateAsync</a>() =&gt;
            <b>await</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#939ca4758a3b25ea" class="i method">DelayAsync</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(5));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait for the Search Service to be provisioned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A Task to await.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="4a78c658e336b90a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WaitForServiceProvisioningAsync</a>() =&gt;
            <b>await</b> <a href="#53fe8fe5c2362e23" class="i property">TestFixture</a>.<a href="SearchTestBase.cs.html#939ca4758a3b25ea" class="i method">DelayAsync</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(10));
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Service Management
    }
}
</pre></td></tr></table></div></body></html>
