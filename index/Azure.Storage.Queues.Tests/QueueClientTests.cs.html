<!DOCTYPE html>
<html><head><title>QueueClientTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(1855);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Storage.Queues.Tests/QueueClientTests.cs" target="_top">QueueClientTests.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/storage/Azure.Storage.Queues/tests/QueueClientTests.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Storage.Queues.Tests" target="_top">Azure.Storage.Queues.Tests.csproj</a> (Azure.Storage.Queues.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Test</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Queues</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Queues</span>.<span class="i n">Tests</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Sas</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">Moq</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Queues</span>.<span class="i n">Specialized</span>;
<b>using</b> <span class="i n">Moq</span>.<span class="i n">Protected</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Queues</span>.<span class="i n">Test</span>
{
    <b>public class</b> <a id="651a1dc094691910" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">QueueClientTests</a> : <a href="QueueTestBase.cs.html#cc17b89e76175d3e" class="t t">QueueTestBase</a>
    {
        <b>public</b> <a id="cce66ec161c4254f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">QueueClientTests</a>(<b>bool</b> <span id="r0 rd" class="r0 r">async</span>)
            : <a href="QueueTestBase.cs.html#c88df3be81d1d002" class="k">base</a>(<span class="r0 r">async</span>, <b>null</b> <span class="c">/* RecordedTestMode.Record /* to re-record */</span>)
        {
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="0fa743c1f20c6471" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Ctor_ConnectionString</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r1 rd" class="r1 r">accountName</span> = <span class="s">&quot;accountName&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r2 rd" class="r2 r">accountKey</span> = <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#f9e5bd7b69c5f334" class="i method">ToBase64String</a>(<b>new</b> <b>byte</b>[] { 0, 1, 2, 3, 4, 5 });
 
            <a href="/Azure.Storage.Common/A.html#6b51bf09188ec1c0" class="k">var</a> <span id="r3 rd" class="r3 r">credentials</span> = <b>new</b> <a href="/Azure.Storage.Common/A.html#5886b33715fef501" class="t constructor">StorageSharedKeyCredential</a>(<span class="r1 r">accountName</span>, <span class="r2 r">accountKey</span>);
            <a href="@0@System/A.html#991565dd25f47c90" class="k">var</a> <span id="r4 rd" class="r4 r">queueEndpoint</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;http://127.0.0.1/&quot;</span> + <span class="r1 r">accountName</span>);
            <a href="@0@System/A.html#991565dd25f47c90" class="k">var</a> <span id="r5 rd" class="r5 r">queueSecondaryEndpoint</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;http://127.0.0.1/&quot;</span> + <span class="r1 r">accountName</span> + <span class="s">&quot;-secondary&quot;</span>);
 
            <a href="/Azure.Storage.Queues/A.html#7ccfb159d18cf63e" class="k">var</a> <span id="r6 rd" class="r6 r">connectionString</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#4eec574b9d8c7b03" class="t constructor">StorageConnectionString</a>(<span class="r3 r">credentials</span>, (<b>default</b>, <b>default</b>), (<span class="r4 r">queueEndpoint</span>, <span class="r5 r">queueSecondaryEndpoint</span>), (<b>default</b>, <b>default</b>));
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r7 rd" class="r7 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r8 rd" class="r8 r">client1</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#0c3055894e828c76" class="t constructor">QueueClient</a>(<span class="r6 r">connectionString</span>.<a href="Shared/TestExtensions.cs.html#87d23cce92a2a26b" class="i method">ToString</a>(<b>true</b>), <span class="r7 r">queueName</span>, <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r9 rd" class="r9 r">client2</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#607c1f6ebd194e83" class="t constructor">QueueClient</a>(<span class="r6 r">connectionString</span>.<a href="Shared/TestExtensions.cs.html#87d23cce92a2a26b" class="i method">ToString</a>(<b>true</b>), <span class="r7 r">queueName</span>));
 
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="k">var</a> <span id="r10 rd" class="r10 r">builder1</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r8 r">client1</span>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>);
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="k">var</a> <span id="r11 rd" class="r11 r">builder2</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r9 r">client2</span>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>);
 
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r7 r">queueName</span>, <span class="r10 r">builder1</span>.<a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r7 r">queueName</span>, <span class="r11 r">builder2</span>.<a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a>);
 
            <span class="c">//Assert.AreEqual(&quot;accountName&quot;, builder.AccountName);</span>
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="b80a914adb3152ae" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Ctor_ConnectionString_Sas</a>()
        {
            <span class="c">// Arrange</span>
            <a href="/Azure.Storage.Queues/A.html#f41ea190d83f57ce" class="t t">SharedAccessSignatureCredentials</a> <span id="r12 rd" class="r12 r">sasCred</span> = <a href="Shared/StorageTestBase.cs.html#5f7b2e9a765531b7" class="i method">GetAccountSasCredentials</a>(
                <a href="/Azure.Storage.Common/A.html#0a5d24da836f2db6" class="t t">AccountSasServices</a>.<a href="/Azure.Storage.Common/A.html#a89597092c8f735f" class="i field">All</a>,
                <a href="/Azure.Storage.Common/A.html#1e2952f573dd64b0" class="t t">AccountSasResourceTypes</a>.<a href="/Azure.Storage.Common/A.html#fb06b0ba251e75ec" class="i field">All</a>,
                <a href="/Azure.Storage.Common/A.html#ac762c6c5829d9cc" class="t t">AccountSasPermissions</a>.<a href="/Azure.Storage.Common/A.html#dec433cd96ddae14" class="i field">All</a>);
 
            <a href="/Azure.Storage.Queues/A.html#7ccfb159d18cf63e" class="t t">StorageConnectionString</a> <span id="r13 rd" class="r13 r">conn1</span> = <a href="QueueTestBase.cs.html#ad1516c8be94dde2" class="i method">GetConnectionString</a>(
                <span class="r14 r">credentials</span>: <span class="r12 r">sasCred</span>,
                <span class="r15 r">includeEndpoint</span>: <b>true</b>);
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r16 rd" class="r16 r">queueClient1</span> = <a href="#872dbf88aaae0fbc" class="i method">GetClient</a>(<span class="r13 r">conn1</span>.<a href="Shared/TestExtensions.cs.html#87d23cce92a2a26b" class="i method">ToString</a>(<span class="r17 r">exportSecrets</span>: <b>true</b>));
 
            <span class="c">// Also test with a connection string not containing the blob endpoint.</span>
            <span class="c">// This should still work provided account name and Sas credential are present.</span>
            <a href="/Azure.Storage.Queues/A.html#7ccfb159d18cf63e" class="t t">StorageConnectionString</a> <span id="r18 rd" class="r18 r">conn2</span> = <a href="QueueTestBase.cs.html#ad1516c8be94dde2" class="i method">GetConnectionString</a>(
                <span class="r14 r">credentials</span>: <span class="r12 r">sasCred</span>,
                <span class="r15 r">includeEndpoint</span>: <b>false</b>);
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r19 rd" class="r19 r">queueClient2</span> = <a href="#872dbf88aaae0fbc" class="i method">GetClient</a>(<span class="r18 r">conn2</span>.<a href="Shared/TestExtensions.cs.html#87d23cce92a2a26b" class="i method">ToString</a>(<span class="r17 r">exportSecrets</span>: <b>true</b>));
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <a id="872dbf88aaae0fbc" href="R/872dbf88aaae0fbc.html" target="n" data-glyph="76,2" class="i method">GetClient</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">connectionString</span>) =&gt;
                <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                    <b>new</b> <a href="/Azure.Storage.Queues/A.html#0c3055894e828c76" class="t constructor">QueueClient</a>(
                        <span class="r20 r">connectionString</span>,
                        <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>(),
                        <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <b>try</b>
            {
                <span class="c">// Act</span>
                <b>await</b> <span class="r16 r">queueClient1</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
                <b>await</b> <span class="r19 r">queueClient2</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
                <b>var</b> <span id="r21 rd" class="r21 r">data</span> = <a href="Shared/StorageTestBase.cs.html#0e277537c03074a3" class="i method">GetRandomBuffer</a>(<a href="/Azure.Storage.Queues/A.html#732c01506b3b1b85" class="t t">Constants</a>.<a href="/Azure.Storage.Queues/A.html#4240fd6a2382c38e" class="i field">KB</a>);
 
                <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a>&gt; <span id="r22 rd" class="r22 r">prop1</span> = <b>await</b> <span class="r16 r">queueClient1</span>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>();
                <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a>&gt; <span id="r23 rd" class="r23 r">prop2</span> = <b>await</b> <span class="r19 r">queueClient2</span>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>();
 
                <span class="c">// Assert</span>
                <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r22 r">prop1</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#b6a26a5901b43ec3" class="i property">Metadata</a>);
                <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r23 r">prop2</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#b6a26a5901b43ec3" class="i property">Metadata</a>);
            }
            <b>finally</b>
            {
                <span class="c">// Clean up</span>
                <b>await</b> <span class="r16 r">queueClient1</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
                <b>await</b> <span class="r19 r">queueClient2</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
            }
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="e8673616c93e9b1a" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Ctor_Uri</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r24 rd" class="r24 r">accountName</span> = <span class="s">&quot;accountName&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r25 rd" class="r25 r">accountKey</span> = <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#f9e5bd7b69c5f334" class="i method">ToBase64String</a>(<b>new</b> <b>byte</b>[] { 0, 1, 2, 3, 4, 5 });
            <a href="@0@System/A.html#991565dd25f47c90" class="k">var</a> <span id="r26 rd" class="r26 r">queueEndpoint</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;http://127.0.0.1/&quot;</span> + <span class="r24 r">accountName</span>);
            <a href="/Azure.Storage.Common/A.html#6b51bf09188ec1c0" class="k">var</a> <span id="r27 rd" class="r27 r">credentials</span> = <b>new</b> <a href="/Azure.Storage.Common/A.html#5886b33715fef501" class="t constructor">StorageSharedKeyCredential</a>(<span class="r24 r">accountName</span>, <span class="r25 r">accountKey</span>);
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r28 rd" class="r28 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#4b28f0c625ebac1f" class="t constructor">QueueClient</a>(<span class="r26 r">queueEndpoint</span>, <span class="r27 r">credentials</span>));
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="k">var</a> <span id="r29 rd" class="r29 r">builder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r28 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>);
 
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r24 r">accountName</span>, <span class="r29 r">builder</span>.<a href="/Azure.Storage.Queues/A.html#5ed050b3df02d6bf" class="i property">AccountName</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="db26b8a5bba7d068" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Ctor_TokenCredential_Http</a>()
        {
            <span class="c">// Arrange</span>
            <a href="/Azure.Core/A.html#d93a9ffee404e938" class="t t">TokenCredential</a> <span id="r30 rd" class="r30 r">tokenCredential</span> = <a href="Shared/StorageTestBase.cs.html#208f01e6ed6a7f0c" class="i method">GetOAuthCredential</a>(<a href="Shared/StorageTestBase.cs.html#cc52c33c34e7c8bb" class="i property">TestConfigHierarchicalNamespace</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r31 rd" class="r31 r">uri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<a href="Shared/StorageTestBase.cs.html#81939be707283e42" class="i property">TestConfigPremiumBlob</a>.<a href="Shared/TenantConfiguration.cs.html#9c094343c57a64fb" class="i property">BlobServiceEndpoint</a>).<a href="Shared/TestExtensions.cs.html#ce2911231dec4691" class="i method">ToHttp</a>();
 
            <span class="c">// Act</span>
            <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#631bb3deb06304ab" class="i method">AssertExpectedException</a>(
                () =&gt; <b>new</b> <a href="/Azure.Storage.Queues/A.html#b76274e23a80bb90" class="t constructor">QueueClient</a>(<span class="r31 r">uri</span>, <span class="r30 r">tokenCredential</span>),
                <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>(<span class="s">&quot;Cannot use TokenCredential without HTTPS.&quot;</span>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="ba886f760eeeeec7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Ctor_AzureSasCredential</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r32 rd" class="r32 r">sas</span> = <a href="QueueTestBase.cs.html#8ec88dfd053a4e4b" class="i method">GetNewAccountSasCredentials</a>().<a href="/Azure.Storage.Common/A.html#8ceacb8907eb221e" class="i method">ToString</a>();
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r33 rd" class="r33 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r34 rd" class="r34 r">uri</span> = <span class="r33 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>;
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r35 rd" class="r35 r">sasClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#083beb2080c6eee0" class="t constructor">QueueClient</a>(<span class="r34 r">uri</span>, <b>new</b> <a href="/Azure.Core/A.html#7c49a23f7592174a" class="t constructor">AzureSasCredential</a>(<span class="r32 r">sas</span>), <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
            <a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a> <span id="r36 rd" class="r36 r">properties</span> = <b>await</b> <span class="r35 r">sasClient</span>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r36 r">properties</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="891ccb2f2ab143a7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Ctor_AzureSasCredential_VerifyNoSasInUri</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r37 rd" class="r37 r">sas</span> = <a href="QueueTestBase.cs.html#8ec88dfd053a4e4b" class="i method">GetNewAccountSasCredentials</a>().<a href="/Azure.Storage.Common/A.html#8ceacb8907eb221e" class="i method">ToString</a>();
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r38 rd" class="r38 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r39 rd" class="r39 r">uri</span> = <span class="r38 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>;
            <span class="r39 r">uri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="r39 r">uri</span>.<a href="@0@System/A.html#bf3caa11ab73e433" class="i method">ToString</a>() + <span class="s">&quot;?&quot;</span> + <span class="r37 r">sas</span>);
 
            <span class="c">// Act</span>
            <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#97823387bdf80bda" class="i method">AssertExpectedException</a>&lt;<a href="@0@mscorlib/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a>&gt;(
                () =&gt; <b>new</b> <a href="/Azure.Storage.Queues/A.html#083beb2080c6eee0" class="t constructor">QueueClient</a>(<span class="r39 r">uri</span>, <b>new</b> <a href="/Azure.Core/A.html#7c49a23f7592174a" class="t constructor">AzureSasCredential</a>(<span class="r37 r">sas</span>)),
                <span id="r40 rd" class="r40 r">e</span> =&gt; <span class="r40 r">e</span>.<a href="@0@mscorlib/A.html#71cfcd61786aa2d8" class="i property">Message</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">$&quot;</span><span class="s">You cannot use </span>{<b>nameof</b>(<a href="/Azure.Core/A.html#77bc7924ac000276" class="t t">AzureSasCredential</a>)}<span class="s"> when the resource URI also contains a Shared Access Signature</span><span class="s">&quot;</span>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5b07836c4d0896af" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateAsync_WithSharedKey</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r41 rd" class="r41 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r42 rd" class="r42 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r43 rd" class="r43 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r42 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r41 r">queueName</span>));
 
            <b>try</b>
            {
                <span class="c">// Act</span>
                <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r44 rd" class="r44 r">result</span> = <b>await</b> <span class="r43 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#6b9a6e3c658e8575" class="i method">CreateAsync</a>();
 
                <span class="c">// Assert</span>
                <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r44 r">result</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>, <span class="s">$&quot;</span>{<b>nameof</b>(<span class="r44 r">result</span>)}<span class="s"> may not be populated</span><span class="s">&quot;</span>);
            }
            <b>finally</b>
            {
                <b>await</b> <span class="r43 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
            }
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="562356dbee7ce987" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateAsync_FromService</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r45 rd" class="r45 r">name</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r46 rd" class="r46 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <b>try</b>
            {
                <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt; <span id="r47 rd" class="r47 r">result</span> = <b>await</b> <span class="r46 r">service</span>.<a href="/Azure.Storage.Queues/A.html#dca7671f117d5fa4" class="i method">CreateQueueAsync</a>(<span class="r45 r">name</span>);
                <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r48 rd" class="r48 r">queue</span> = <span class="r47 r">result</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
                <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a>&gt; <span id="r49 rd" class="r49 r">properties</span> = <b>await</b> <span class="r48 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>();
                <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(0, <span class="r49 r">properties</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#500a3d711e07d8c4" class="i property">ApproximateMessagesCount</a>);
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r50 rd" class="r50 r">accountName</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r46 r">service</span>.<a href="/Azure.Storage.Queues/A.html#9936b3bc2c6e271d" class="i property">Uri</a>).<a href="/Azure.Storage.Queues/A.html#5ed050b3df02d6bf" class="i property">AccountName</a>;
                <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#717ca6fe9aa5647e" class="i method">AssertCacheableProperty</a>(<span class="r50 r">accountName</span>, () =&gt; <span class="r48 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#a0bd3939fd4bdd76" class="i property">AccountName</a>);
                <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#717ca6fe9aa5647e" class="i method">AssertCacheableProperty</a>(<span class="r45 r">name</span>, () =&gt; <span class="r48 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>);
            }
            <b>finally</b>
            {
                <b>await</b> <span class="r46 r">service</span>.<a href="/Azure.Storage.Queues/A.html#15e39e34c52340ef" class="i method">DeleteQueueAsync</a>(<span class="r45 r">name</span>);
            }
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="42a9517a7cb85621" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateAsync_WithOauth</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r51 rd" class="r51 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r52 rd" class="r52 r">service</span> = <a href="QueueTestBase.cs.html#b82afee593879879" class="i method">GetServiceClient_OauthAccount</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r53 rd" class="r53 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r52 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r51 r">queueName</span>));
 
            <b>try</b>
            {
                <span class="c">// Act</span>
                <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r54 rd" class="r54 r">result</span> = <b>await</b> <span class="r53 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#6b9a6e3c658e8575" class="i method">CreateAsync</a>();
 
                <span class="c">// Assert</span>
                <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r54 r">result</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>, <span class="s">$&quot;</span>{<b>nameof</b>(<span class="r54 r">result</span>)}<span class="s"> may not be populated</span><span class="s">&quot;</span>);
            }
            <b>finally</b>
            {
                <b>await</b> <span class="r53 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
            }
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c537e1f61ec953a3" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateAsync_WithAccountSas</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r55 rd" class="r55 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r56 rd" class="r56 r">service</span> = <a href="QueueTestBase.cs.html#ec79ca98dab5e4f5" class="i method">GetServiceClient_AccountSas</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r57 rd" class="r57 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r56 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r55 r">queueName</span>));
 
            <b>try</b>
            {
                <span class="c">// Act</span>
                <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r58 rd" class="r58 r">result</span> = <b>await</b> <span class="r57 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#6b9a6e3c658e8575" class="i method">CreateAsync</a>();
 
                <span class="c">// Assert</span>
                <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r58 r">result</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>, <span class="s">$&quot;</span>{<b>nameof</b>(<span class="r58 r">result</span>)}<span class="s"> may not be populated</span><span class="s">&quot;</span>);
            }
            <b>finally</b>
            {
                <b>await</b> <span class="r57 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
            }
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="a8c10a31ff85e35b" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateAsync_WithQueueServiceSas</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r59 rd" class="r59 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r60 rd" class="r60 r">service</span> = <a href="QueueTestBase.cs.html#a9ef5a9df538c3eb" class="i method">GetServiceClient_QueueServiceSas</a>(<span class="r59 r">queueName</span>);
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r61 rd" class="r61 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r60 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r59 r">queueName</span>));
            <a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r62 rd" class="r62 r">pass</span> = <b>false</b>;
 
            <b>try</b>
            {
                <span class="c">// Act</span>
                <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r63 rd" class="r63 r">result</span> = <b>await</b> <span class="r61 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#6b9a6e3c658e8575" class="i method">CreateAsync</a>();
 
                <span class="c">// Assert</span>
                <span class="t t">Assert</span>.<span class="i method">Fail</span>(<span class="s">&quot;CreateAsync unexpected success: queue service SAS should not be usable to create queue&quot;</span>);
            }
            <b>catch</b> (<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a> <span id="r64 rd" class="r64 r">ex</span>) <b>when</b> (<span class="r64 r">ex</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a> == <span class="s">&quot;AuthorizationFailure&quot;</span>) <span class="c">// TODO verify if this is a missing service code</span>
            {
                <span class="r62 r">pass</span> = <b>true</b>;
            }
            <b>finally</b>
            {
                <b>if</b> (!<span class="r62 r">pass</span>)
                {
                    <b>await</b> <span class="r61 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
                }
            }
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5be7e560570b5ad8" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r65 rd" class="r65 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r66 rd" class="r66 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r67 rd" class="r67 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r66 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r65 r">queueName</span>));
            <b>await</b> <span class="r67 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r67 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#6b9a6e3c658e8575" class="i method">CreateAsync</a>(<span class="r68 r">metadata</span>: <b>new</b> <a href="@0@mscorlib/A.html#05d4a216235a779c" class="t constructor">Dictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;(<a href="@0@mscorlib/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@0@mscorlib/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>) { { <span class="s">&quot;key&quot;</span>, <span class="s">&quot;value&quot;</span> } }),
                <span id="r69 rd" class="r69 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueAlreadyExists&quot;</span>, <span class="r69 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="6922b9953e07452c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateIfNotExistsAsync_NotExists</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r70 rd" class="r70 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r71 rd" class="r71 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r72 rd" class="r72 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r71 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r70 r">queueName</span>));
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r73 rd" class="r73 r">response</span> = <b>await</b> <span class="r72 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r73 r">response</span>);
 
            <span class="c">// Cleanup</span>
            <b>await</b> <span class="r72 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="bcf10c02d1a91726" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateIfNotExistsAsync_Exists</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r74 rd" class="r74 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r75 rd" class="r75 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r76 rd" class="r76 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r75 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r74 r">queueName</span>));
            <b>await</b> <span class="r76 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r77 rd" class="r77 r">response</span> = <b>await</b> <span class="r76 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNull</span>(<span class="r77 r">response</span>);
 
            <span class="c">// Cleanup</span>
            <b>await</b> <span class="r76 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="8b127077b822fc3c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateIfNotExistsAsync_ExistsDifferentMetadata</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r78 rd" class="r78 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r79 rd" class="r79 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r80 rd" class="r80 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r79 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r78 r">queueName</span>));
 
            <b>await</b> <span class="r80 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>(<a href="Shared/StorageTestBase.cs.html#9bbe73e9e1c28539" class="i method">BuildMetadata</a>());
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r81 rd" class="r81 r">response</span> = <b>await</b> <span class="r80 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNull</span>(<span class="r81 r">response</span>);
 
            <span class="c">// Cleanup</span>
            <b>await</b> <span class="r80 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="eb37f0915d9357bd" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateIfNotExistsAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r82 rd" class="r82 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r83 rd" class="r83 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r84 rd" class="r84 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r83 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r82 r">queueName</span>));
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r85 rd" class="r85 r">unauthorizedQueueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#c7a82ca99d6f80de" class="t constructor">QueueClient</a>(<span class="r84 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>, <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r85 r">unauthorizedQueueClient</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>(),
                <span id="r86 rd" class="r86 r">e</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;ResourceNotFound&quot;</span>, <span class="r86 r">e</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c8bbac0c846abc87" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ExistsAsync_Exists</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r87 rd" class="r87 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r88 rd" class="r88 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r89 rd" class="r89 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r88 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r87 r">queueName</span>));
            <b>await</b> <span class="r89 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<b>bool</b>&gt; <span id="r90 rd" class="r90 r">response</span> = <b>await</b> <span class="r89 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#031135805fb4ff15" class="i method">ExistsAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r90 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
 
            <span class="c">// Cleanup</span>
            <b>await</b> <span class="r89 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="ecd1b76f009fef02" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ExistsAsync_NotExists</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r91 rd" class="r91 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r92 rd" class="r92 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r93 rd" class="r93 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r92 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r91 r">queueName</span>));
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<b>bool</b>&gt; <span id="r94 rd" class="r94 r">response</span> = <b>await</b> <span class="r93 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#031135805fb4ff15" class="i method">ExistsAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsFalse</span>(<span class="r94 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="a370efd0388f5598" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ExistsAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r95 rd" class="r95 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r96 rd" class="r96 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r97 rd" class="r97 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r96 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r95 r">queueName</span>));
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r98 rd" class="r98 r">unauthorizedQueueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#c7a82ca99d6f80de" class="t constructor">QueueClient</a>(<span class="r97 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>, <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r98 r">unauthorizedQueueClient</span>.<a href="/Azure.Storage.Queues/A.html#031135805fb4ff15" class="i method">ExistsAsync</a>(),
                <span id="r99 rd" class="r99 r">e</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;ResourceNotFound&quot;</span>, <span class="r99 r">e</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="86806362301255ca" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteIfExistsAsync_Exists</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r100 rd" class="r100 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r101 rd" class="r101 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r102 rd" class="r102 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r101 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r100 r">queueName</span>));
            <b>await</b> <span class="r102 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<b>bool</b>&gt; <span id="r103 rd" class="r103 r">response</span> = <b>await</b> <span class="r102 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r103 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="32426c43e23cad2f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteIfExistsAsync_NotExists</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r104 rd" class="r104 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r105 rd" class="r105 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r106 rd" class="r106 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r105 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r104 r">queueName</span>));
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<b>bool</b>&gt; <span id="r107 rd" class="r107 r">response</span> = <b>await</b> <span class="r106 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsFalse</span>(<span class="r107 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="68018b7715108be0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteIfExistsAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r108 rd" class="r108 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r109 rd" class="r109 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r110 rd" class="r110 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r109 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r108 r">queueName</span>));
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r111 rd" class="r111 r">unauthorizedQueueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#c7a82ca99d6f80de" class="t constructor">QueueClient</a>(<span class="r110 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>, <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r111 r">unauthorizedQueueClient</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>(),
                <span id="r112 rd" class="r112 r">e</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;ResourceNotFound&quot;</span>, <span class="r112 r">e</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="9444767691fd07fd" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetPropertiesAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r113 rd" class="r113 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a>&gt; <span id="r114 rd" class="r114 r">queueProperties</span> = <b>await</b> <span class="r113 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r114 r">queueProperties</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="e9fa3608f7ab5ff2" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetPropertiesAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r115 rd" class="r115 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r116 rd" class="r116 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r117 rd" class="r117 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r116 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r115 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r117 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>(),
                <span id="r118 rd" class="r118 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r118 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Secondary Storage
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="ba405fce3753b078" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetPropertiesAsync_SecondaryStorage</a>()
        {
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r119 rd" class="r119 r">queueClient</span> = <a href="QueueTestBase.cs.html#18ff86e8da38cf82" class="i method">GetQueueClient_SecondaryAccount_ReadEnabledOnRetry</a>(1, <b>out</b> <a href="Shared/TestExceptionPolicy.cs.html#0d68b3a20bb1a76e" class="t t">TestExceptionPolicy</a> <span id="r120 rd" class="r120 r">testExceptionPolicy</span>);
            <b>await</b> <span class="r119 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a>&gt; <span id="r121 rd" class="r121 r">properties</span> = <b>await</b> <a href="Shared/StorageTestBase.cs.html#6e32d03176ec7912" class="i method">EnsurePropagatedAsync</a>(
                <b>async</b> () =&gt; <b>await</b> <span class="r119 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>(),
                <span id="r122 rd" class="r122 r">properties</span> =&gt; <span class="r122 r">properties</span>.<a href="/Azure.Core/A.html#959994a72d6ef38a" class="i method">GetRawResponse</a>().<a href="/Azure.Core/A.html#53e6401c580f9719" class="i property">Status</a> != 404);
 
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r121 r">properties</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(200, <span class="r121 r">properties</span>.<a href="/Azure.Core/A.html#959994a72d6ef38a" class="i method">GetRawResponse</a>().<a href="/Azure.Core/A.html#53e6401c580f9719" class="i property">Status</a>);
 
            <b>await</b> <span class="r119 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#9c52c6a65a32e218" class="i method">DeleteIfExistsAsync</a>();
            <a href="Shared/StorageTestBase.cs.html#c888f4d8064210c7" class="i method">AssertSecondaryStorageFirstRetrySuccessful</a>(<a href="QueueTestBase.cs.html#7e3c27764ed75f85" class="i method">SecondaryStorageTenantPrimaryHost</a>(), <a href="QueueTestBase.cs.html#088aa659845b6193" class="i method">SecondaryStorageTenantSecondaryHost</a>(), <span class="r120 r">testExceptionPolicy</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d7a26755222c4199" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetMetadataAsync_OnCreate</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r123 rd" class="r123 r">metadata</span> = <a href="Shared/StorageTestBase.cs.html#9bbe73e9e1c28539" class="i method">BuildMetadata</a>();
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r124 rd" class="r124 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>(<span class="r125 r">metadata</span>: <span class="r123 r">metadata</span>);
 
            <span class="c">// Assert</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a>&gt; <span id="r126 rd" class="r126 r">result</span> = <b>await</b> <span class="r124 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;bar&quot;</span>, <span class="r126 r">result</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#b6a26a5901b43ec3" class="i property">Metadata</a><a href="@0@mscorlib/A.html#86884956b17e491a">[</a><span class="s">&quot;foo&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;data&quot;</span>, <span class="r126 r">result</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#b6a26a5901b43ec3" class="i property">Metadata</a><a href="@0@mscorlib/A.html#86884956b17e491a">[</a><span class="s">&quot;meta&quot;</span>]);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="430553d9202a4f7b" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetMetadataAsync_Metadata</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r127 rd" class="r127 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <a href="@0@mscorlib/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r128 rd" class="r128 r">metadata</span> = <a href="Shared/StorageTestBase.cs.html#9bbe73e9e1c28539" class="i method">BuildMetadata</a>();
            <b>await</b> <span class="r127 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#5fdcd8460b425b5f" class="i method">SetMetadataAsync</a>(<span class="r128 r">metadata</span>);
 
            <span class="c">// Assert</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a96be88bfc5ec2b4" class="t t">QueueProperties</a>&gt; <span id="r129 rd" class="r129 r">result</span> = <b>await</b> <span class="r127 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;bar&quot;</span>, <span class="r129 r">result</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#b6a26a5901b43ec3" class="i property">Metadata</a><a href="@0@mscorlib/A.html#86884956b17e491a">[</a><span class="s">&quot;foo&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;data&quot;</span>, <span class="r129 r">result</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#b6a26a5901b43ec3" class="i property">Metadata</a><a href="@0@mscorlib/A.html#86884956b17e491a">[</a><span class="s">&quot;meta&quot;</span>]);
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="68f1aadde36cd6a4" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetMetadataAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r130 rd" class="r130 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r131 rd" class="r131 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r132 rd" class="r132 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r131 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r130 r">queueName</span>));
            <a href="@0@mscorlib/A.html#20343df0c96b629b" class="t t">IDictionary</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r133 rd" class="r133 r">metadata</span> = <a href="Shared/StorageTestBase.cs.html#9bbe73e9e1c28539" class="i method">BuildMetadata</a>();
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r132 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#5fdcd8460b425b5f" class="i method">SetMetadataAsync</a>(<span class="r133 r">metadata</span>),
                <span id="r134 rd" class="r134 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r134 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="b92845c48eb67f68" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetAccessPolicyAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r135 rd" class="r135 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="/Azure.Storage.Queues/A.html#a3d741a69cd850f9" class="t t">QueueSignedIdentifier</a>[] <span id="r136 rd" class="r136 r">signedIdentifiers</span> = <a href="QueueTestBase.cs.html#1048899087ac716e" class="i method">BuildSignedIdentifiers</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r137 rd" class="r137 r">setResult</span> = <b>await</b> <span class="r135 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#f9d3b2e01ddc79e0" class="i method">SetAccessPolicyAsync</a>(<span class="r136 r">signedIdentifiers</span>);
 
            <span class="c">// Assert</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a3d741a69cd850f9" class="t t">QueueSignedIdentifier</a>&gt;&gt; <span id="r138 rd" class="r138 r">result</span> = <b>await</b> <span class="r135 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#5da73821da538994" class="i method">GetAccessPolicyAsync</a>();
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a3d741a69cd850f9" class="t t">QueueSignedIdentifier</a> <span id="r139 rd" class="r139 r">acl</span> = <span class="r138 r">result</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <span class="r138 r">result</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r136 r">signedIdentifiers</span>[0].<a href="/Azure.Storage.Queues/A.html#cbc743db12f3b43e" class="i property">Id</a>, <span class="r139 r">acl</span>.<a href="/Azure.Storage.Queues/A.html#cbc743db12f3b43e" class="i property">Id</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r136 r">signedIdentifiers</span>[0].<a href="/Azure.Storage.Queues/A.html#2f4f4061795efd11" class="i property">AccessPolicy</a>.<a href="/Azure.Storage.Queues/A.html#3f944b5b6d21163f" class="i property">StartsOn</a>, <span class="r139 r">acl</span>.<a href="/Azure.Storage.Queues/A.html#2f4f4061795efd11" class="i property">AccessPolicy</a>.<a href="/Azure.Storage.Queues/A.html#3f944b5b6d21163f" class="i property">StartsOn</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r136 r">signedIdentifiers</span>[0].<a href="/Azure.Storage.Queues/A.html#2f4f4061795efd11" class="i property">AccessPolicy</a>.<a href="/Azure.Storage.Queues/A.html#f1e12dfe18c836b2" class="i property">ExpiresOn</a>, <span class="r139 r">acl</span>.<a href="/Azure.Storage.Queues/A.html#2f4f4061795efd11" class="i property">AccessPolicy</a>.<a href="/Azure.Storage.Queues/A.html#f1e12dfe18c836b2" class="i property">ExpiresOn</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r136 r">signedIdentifiers</span>[0].<a href="/Azure.Storage.Queues/A.html#2f4f4061795efd11" class="i property">AccessPolicy</a>.<a href="/Azure.Storage.Queues/A.html#7deaf4874e53aede" class="i property">Permissions</a>, <span class="r139 r">acl</span>.<a href="/Azure.Storage.Queues/A.html#2f4f4061795efd11" class="i property">AccessPolicy</a>.<a href="/Azure.Storage.Queues/A.html#7deaf4874e53aede" class="i property">Permissions</a>);
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="97ca17d044cbc0c9" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetAccessPolicyAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r140 rd" class="r140 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r141 rd" class="r141 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r142 rd" class="r142 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r141 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r140 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r142 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#5da73821da538994" class="i method">GetAccessPolicyAsync</a>(),
                <span id="r143 rd" class="r143 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r143 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="522674a412dd7f55" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAccessPolicyAsync</a>()
        {
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r144 rd" class="r144 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a3d741a69cd850f9" class="t t">QueueSignedIdentifier</a>[] <span id="r145 rd" class="r145 r">signedIdentifiers</span> = <a href="QueueTestBase.cs.html#1048899087ac716e" class="i method">BuildSignedIdentifiers</a>();
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r146 rd" class="r146 r">result</span> = <b>await</b> <span class="r144 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#f9d3b2e01ddc79e0" class="i method">SetAccessPolicyAsync</a>(<span class="r145 r">signedIdentifiers</span>);
            <span class="t t">Assert</span>.<span class="i method">IsFalse</span>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r146 r">result</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>));
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d6299a9d497c39c9" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAccessPolicyAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r147 rd" class="r147 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r148 rd" class="r148 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r149 rd" class="r149 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r148 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r147 r">queueName</span>));
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a3d741a69cd850f9" class="t t">QueueSignedIdentifier</a>[] <span id="r150 rd" class="r150 r">signedIdentifiers</span> = <a href="QueueTestBase.cs.html#1048899087ac716e" class="i method">BuildSignedIdentifiers</a>();
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r149 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#f9d3b2e01ddc79e0" class="i method">SetAccessPolicyAsync</a>(<span class="r150 r">signedIdentifiers</span>),
                <span id="r151 rd" class="r151 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r151 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f6c36c70e84cc6a9" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteAsync</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r152 rd" class="r152 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r153 rd" class="r153 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r154 rd" class="r154 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r153 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r152 r">queueName</span>));
            <b>await</b> <span class="r154 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#29f4bf7a8bda13c8" class="i method">CreateIfNotExistsAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r155 rd" class="r155 r">result</span> = <b>await</b> <span class="r154 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#2c450d242b1f17a0" class="i method">DeleteAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreNotEqual</span>(<b>default</b>, <span class="r155 r">result</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>, <span class="s">$&quot;</span>{<b>nameof</b>(<span class="r155 r">result</span>)}<span class="s"> may not be populated</span><span class="s">&quot;</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="cce016dfe8927230" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteAsync_FromService</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r156 rd" class="r156 r">name</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r157 rd" class="r157 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <b>try</b>
            {
                <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r158 rd" class="r158 r">queue</span> = (<b>await</b> <span class="r157 r">service</span>.<a href="/Azure.Storage.Queues/A.html#dca7671f117d5fa4" class="i method">CreateQueueAsync</a>(<span class="r156 r">name</span>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
                <b>await</b> <span class="r157 r">service</span>.<a href="/Azure.Storage.Queues/A.html#15e39e34c52340ef" class="i method">DeleteQueueAsync</a>(<span class="r156 r">name</span>);
 
                <span class="c">// Ensure the queue no longer returns values</span>
                <span class="t t">Assert</span>.<span class="i method">ThrowsAsync</span>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                    <b>async</b> () =&gt; <b>await</b> <span class="r158 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#f04f4517c6be0e6f" class="i method">GetPropertiesAsync</a>());
            }
            <b>finally</b>
            {
            }
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="bb21973897184bc1" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r159 rd" class="r159 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r160 rd" class="r160 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r161 rd" class="r161 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r160 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r159 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r161 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#2c450d242b1f17a0" class="i method">DeleteAsync</a>(),
                <span id="r162 rd" class="r162 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r162 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="9f5b1c6841a6172f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendMessageAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r163 rd" class="r163 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r164 rd" class="r164 r">response</span> = <b>await</b> <span class="r163 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#2421b75c770559db" class="i method">SendMessageAsync</a>(
                <span class="r165 r">messageText</span>: <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>(),
                <span class="r166 r">visibilityTimeout</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(0, 0, 1),
                <span class="r167 r">timeToLive</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(1, 0, 0));
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r164 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="0adbfdac7416b30b" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendReceiveNullMessageAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r168 rd" class="r168 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r169 rd" class="r169 r">response</span> = <b>await</b> <span class="r168 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r170 r">messageText</span>: <b>null</b>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r169 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r171 rd" class="r171 r">receivedMessage</span> = (<b>await</b> <span class="r168 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>()).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <span class="r171 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="bc061bc973065bcf" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EncodesOutgoingMessage</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r172 rd" class="r172 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r173 rd" class="r173 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(<span class="r172 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>, <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r174 rd" class="r174 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r175 rd" class="r175 r">encodedText</span> = <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#f9e5bd7b69c5f334" class="i method">ToBase64String</a>(<a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@0@mscorlib/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r174 r">messageText</span>));
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r176 rd" class="r176 r">response</span> = <b>await</b> <span class="r173 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r170 r">messageText</span>: <span class="r174 r">messageText</span>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r176 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r177 rd" class="r177 r">receivedMessage</span> = (<b>await</b> <span class="r172 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>()).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r175 r">encodedText</span>, <span class="r177 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="be56d96fac48718c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EncodesOutgoingMessageAndRespectsSegmentBoundaries</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r178 rd" class="r178 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r179 rd" class="r179 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(<span class="r178 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>, <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r180 rd" class="r180 r">payload</span> = <span class="s">&quot;pre payload post&quot;</span>;
            <b>var</b> <span id="r181 rd" class="r181 r">bytes</span> = <a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@0@mscorlib/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r180 r">payload</span>);
            <a href="@0@mscorlib/A.html#d2e9d465e1639af7" class="k">var</a> <span id="r182 rd" class="r182 r">segment</span> = <b>new</b> <a href="@0@mscorlib/A.html#7439abe3fdaec1c7" class="t constructor">ArraySegment</a>&lt;<b>byte</b>&gt;(<span class="r181 r">bytes</span>, 4, 7);
            <a href="/System.Memory.Data/A.html#b41210c71e293f88" class="k">var</a> <span id="r183 rd" class="r183 r">data</span> = <a href="/System.Memory.Data/A.html#b41210c71e293f88" class="t t">BinaryData</a>.<a href="/System.Memory.Data/A.html#b8a6501d68ff32ea" class="i method">FromBytes</a>(<span class="r182 r">segment</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r184 rd" class="r184 r">response</span> = <b>await</b> <span class="r179 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#7d1ac25a2f64e94d" class="i method">SendMessageAsync</a>(<span class="r183 r">data</span>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r184 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r185 rd" class="r185 r">receivedMessage</span> = (<b>await</b> <span class="r179 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>()).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;payload&quot;</span>, <span class="r185 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#ca6ccb0de2843484" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#cab71e7b2240cb5c" class="i method">ToString</a>());
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="ff6ed25c4825c129" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DecodesReceivedMessage</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r186 rd" class="r186 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r187 rd" class="r187 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(<span class="r186 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>, <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r188 rd" class="r188 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r189 rd" class="r189 r">encodedText</span> = <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#f9e5bd7b69c5f334" class="i method">ToBase64String</a>(<a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@0@mscorlib/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r188 r">messageText</span>));
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r190 rd" class="r190 r">response</span> = <b>await</b> <span class="r186 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r170 r">messageText</span>: <span class="r189 r">encodedText</span>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r190 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r191 rd" class="r191 r">receivedMessage</span> = (<b>await</b> <span class="r187 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>()).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r188 r">messageText</span>, <span class="r191 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f907522cb831cf62" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DecodesPeekedMessage</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r192 rd" class="r192 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r193 rd" class="r193 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(<span class="r192 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>, <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r194 rd" class="r194 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r195 rd" class="r195 r">encodedText</span> = <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#f9e5bd7b69c5f334" class="i method">ToBase64String</a>(<a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@0@mscorlib/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r194 r">messageText</span>));
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r196 rd" class="r196 r">response</span> = <b>await</b> <span class="r192 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r170 r">messageText</span>: <span class="r195 r">encodedText</span>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r196 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a> <span id="r197 rd" class="r197 r">receivedMessage</span> = (<b>await</b> <span class="r193 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>()).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r194 r">messageText</span>, <span class="r197 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c779212e518d15f7" class="i property">MessageText</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="e1d13252b893de7c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">FailsOnInvalidPeekedMessageIfNoHandlerIsProvided</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r198 rd" class="r198 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r199 rd" class="r199 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(<span class="r198 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>, <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r200 rd" class="r200 r">nonEncodedContent</span> = <span class="s">&quot;test_content&quot;</span>;
 
            <b>await</b> <span class="r198 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r200 r">nonEncodedContent</span>);
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="@0@mscorlib/A.html#80a470d64a9b80ef" class="t t">FormatException</a>&gt;(
                <span class="r199 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>(),
                <span id="r201 rd" class="r201 r">e</span> =&gt;
                {
                    <span class="t t">StringAssert</span>.<span class="i method">Contains</span>(<span class="s">&quot;The input is not a valid Base-64 string&quot;</span>, <span class="r201 r">e</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                });
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3a0318a83f753318" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanHandleInvalidPeekedMessageAndReturnValid</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r202 rd" class="r202 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a> <span id="r203 rd" class="r203 r">badMessage</span> = <b>null</b>;
            <a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a> <span id="r204 rd" class="r204 r">badMessage2</span> = <b>null</b>;
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r205 rd" class="r205 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(
                <span class="r202 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>,
                <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>,
                <span id="r206 rd" class="r206 r">arg</span> =&gt;
                {
                    <span class="r203 r">badMessage</span> = <span class="r206 r">arg</span>.<a href="/Azure.Storage.Queues/A.html#150e6793799ae537" class="i property">PeekedMessage</a>;
                    <b>return</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
                },
                <span id="r207 rd" class="r207 r">arg</span> =&gt;
                {
                    <span class="r204 r">badMessage2</span> = <span class="r207 r">arg</span>.<a href="/Azure.Storage.Queues/A.html#150e6793799ae537" class="i property">PeekedMessage</a>;
                    <b>return</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
                });
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r208 rd" class="r208 r">nonEncodedContent</span> = <span class="s">&quot;test_content&quot;</span>;
 
            <b>await</b> <span class="r202 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r208 r">nonEncodedContent</span>);
            <b>await</b> <span class="r205 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r208 r">nonEncodedContent</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a>[] <span id="r209 rd" class="r209 r">peekedMessages</span> = <b>await</b> <span class="r205 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>(10);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <span class="r209 r">peekedMessages</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r203 r">badMessage</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r208 r">nonEncodedContent</span>, <span class="r203 r">badMessage</span>.<a href="/Azure.Storage.Queues/A.html#0b732ef703c38876" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#cab71e7b2240cb5c" class="i method">ToString</a>());
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r204 r">badMessage2</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r208 r">nonEncodedContent</span>, <span class="r204 r">badMessage2</span>.<a href="/Azure.Storage.Queues/A.html#0b732ef703c38876" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#cab71e7b2240cb5c" class="i method">ToString</a>());
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="da38ddcfbb3b7e93" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PropagatesExceptionIfInvalidPeekedMessageAndHandlerThrows</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r210 rd" class="r210 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r211 rd" class="r211 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(
                <span class="r210 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>,
                <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>,
                <span id="r212 rd" class="r212 r">arg</span> =&gt;
                {
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>(<span class="s">&quot;KABOOM1&quot;</span>);
                },
                <span id="r213 rd" class="r213 r">arg</span> =&gt;
                {
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>(<span class="s">&quot;KABOOM2&quot;</span>);
                });
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r214 rd" class="r214 r">nonEncodedContent</span> = <span class="s">&quot;test_content&quot;</span>;
 
            <b>await</b> <span class="r210 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r214 r">nonEncodedContent</span>);
            <b>await</b> <span class="r211 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r214 r">nonEncodedContent</span>);
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="@0@mscorlib/A.html#be77e0a7fbc110e6" class="t t">AggregateException</a>&gt;(
                <span class="r211 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>(10),
                <span id="r215 rd" class="r215 r">e</span> =&gt;
                {
                    <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(2, <span class="r215 r">e</span>.<a href="@0@mscorlib/A.html#e9d864767768da2b" class="i property">InnerExceptions</a>.<a href="@0@mscorlib/A.html#7e2071514968aca1" class="i property">Count</a>);
                    <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;KABOOM1&quot;</span>, <span class="r215 r">e</span>.<a href="@0@mscorlib/A.html#e9d864767768da2b" class="i property">InnerExceptions</a>[0].<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                    <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;KABOOM2&quot;</span>, <span class="r215 r">e</span>.<a href="@0@mscorlib/A.html#e9d864767768da2b" class="i property">InnerExceptions</a>[1].<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                });
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="352d499a59f76a70" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanSendAndReceiveNonUTFBytes</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r216 rd" class="r216 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r217 rd" class="r217 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(<span class="r216 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>, <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>);
            <b>byte</b>[] <span id="r218 rd" class="r218 r">content</span> = <b>new</b> <b>byte</b>[] { 0xFF, 0x00 }; <span class="c">// Not a valid UTF-8 byte sequence.</span>
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r219 rd" class="r219 r">response</span> = <b>await</b> <span class="r217 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#7d1ac25a2f64e94d" class="i method">SendMessageAsync</a>(<span class="r220 r">message</span>: <a href="/System.Memory.Data/A.html#b41210c71e293f88" class="t t">BinaryData</a>.<a href="/System.Memory.Data/A.html#b8726154d793cf41" class="i method">FromBytes</a>(<span class="r218 r">content</span>));
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r219 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r221 rd" class="r221 r">receivedMessage</span> = (<b>await</b> <span class="r217 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>()).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">CollectionAssert</span>.<span class="i method">AreEqual</span>(<span class="r218 r">content</span>, <span class="r221 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#ca6ccb0de2843484" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#288a77b70eac3839" class="i method">ToArray</a>());
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7edc6eb7bc29ab2b" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">FailsOnInvalidQueueMessageIfNoHandlerIsProvided</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r222 rd" class="r222 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r223 rd" class="r223 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(<span class="r222 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>, <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r224 rd" class="r224 r">nonEncodedContent</span> = <span class="s">&quot;test_content&quot;</span>;
 
            <b>await</b> <span class="r222 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r224 r">nonEncodedContent</span>);
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="@0@mscorlib/A.html#80a470d64a9b80ef" class="t t">FormatException</a>&gt;(
                <span class="r223 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>(),
                <span id="r225 rd" class="r225 r">e</span> =&gt;
                {
                    <span class="t t">StringAssert</span>.<span class="i method">Contains</span>(<span class="s">&quot;The input is not a valid Base-64 string&quot;</span>, <span class="r225 r">e</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                });
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="af98884839e52fbd" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanHandleInvalidMessageAndReturnValid</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r226 rd" class="r226 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r227 rd" class="r227 r">badMessage</span> = <b>null</b>;
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r228 rd" class="r228 r">badMessage2</span> = <b>null</b>;
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r229 rd" class="r229 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(
                <span class="r226 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>,
                <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>,
                <span id="r230 rd" class="r230 r">arg</span> =&gt;
                {
                    <span class="r227 r">badMessage</span> = <span class="r230 r">arg</span>.<a href="/Azure.Storage.Queues/A.html#61cd5764bea354be" class="i property">ReceivedMessage</a>;
                    <b>return</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
                },
                <span id="r231 rd" class="r231 r">arg</span> =&gt;
                {
                    <span class="r228 r">badMessage2</span> = <span class="r231 r">arg</span>.<a href="/Azure.Storage.Queues/A.html#61cd5764bea354be" class="i property">ReceivedMessage</a>;
                    <b>return</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
                });
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r232 rd" class="r232 r">nonEncodedContent</span> = <span class="s">&quot;test_content&quot;</span>;
 
            <b>await</b> <span class="r226 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r232 r">nonEncodedContent</span>);
            <b>await</b> <span class="r229 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r232 r">nonEncodedContent</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a>[] <span id="r233 rd" class="r233 r">queueMessages</span> = <b>await</b> <span class="r229 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#efe8df42c9757b27" class="i method">ReceiveMessagesAsync</a>(10);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <span class="r233 r">queueMessages</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r227 r">badMessage</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r232 r">nonEncodedContent</span>, <span class="r227 r">badMessage</span>.<a href="/Azure.Storage.Queues/A.html#ca6ccb0de2843484" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#cab71e7b2240cb5c" class="i method">ToString</a>());
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r228 r">badMessage2</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r232 r">nonEncodedContent</span>, <span class="r228 r">badMessage2</span>.<a href="/Azure.Storage.Queues/A.html#ca6ccb0de2843484" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#cab71e7b2240cb5c" class="i method">ToString</a>());
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f459f857538854f0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TakesSnapshotOfMessageDecodingFailedHandlersAtConstruction</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r234 rd" class="r234 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r235 rd" class="r235 r">badMessage</span> = <b>null</b>;
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r236 rd" class="r236 r">badMessage2</span> = <b>null</b>;
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r237 rd" class="r237 r">badMessage3</span> = <b>null</b>;
            <a href="/Azure.Storage.Queues/A.html#48312bf7853b9721" class="k">var</a> <span id="r238 rd" class="r238 r">options</span> = <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>();
            <span class="r238 r">options</span>.<a href="/Azure.Storage.Queues/A.html#33a1ecead0c6514e" class="i property">MessageEncoding</a> = <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>;
            <span class="r238 r">options</span>.<a href="/Azure.Storage.Queues/A.html#6c409fbfc9540560" class="i">MessageDecodingFailed</a> += <span id="r239 rd" class="r239 r">arg</span> =&gt;
            {
                <span class="r235 r">badMessage</span> = <span class="r239 r">arg</span>.<a href="/Azure.Storage.Queues/A.html#61cd5764bea354be" class="i property">ReceivedMessage</a>;
                <b>return</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
            };
            <span class="r238 r">options</span>.<a href="/Azure.Storage.Queues/A.html#6c409fbfc9540560" class="i">MessageDecodingFailed</a> += <span id="r240 rd" class="r240 r">arg</span> =&gt;
            {
                <span class="r236 r">badMessage2</span> = <span class="r240 r">arg</span>.<a href="/Azure.Storage.Queues/A.html#61cd5764bea354be" class="i property">ReceivedMessage</a>;
                <b>return</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
            };
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r241 rd" class="r241 r">encodingClient</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>(<span class="r238 r">options</span>).<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r234 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>);
 
            <span class="c">// add third handler after client creation</span>
            <span class="r238 r">options</span>.<a href="/Azure.Storage.Queues/A.html#6c409fbfc9540560" class="i">MessageDecodingFailed</a> += <span id="r242 rd" class="r242 r">arg</span> =&gt;
            {
                <span class="r237 r">badMessage3</span> = <span class="r242 r">arg</span>.<a href="/Azure.Storage.Queues/A.html#61cd5764bea354be" class="i property">ReceivedMessage</a>;
                <b>return</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
            };
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r243 rd" class="r243 r">nonEncodedContent</span> = <span class="s">&quot;test_content&quot;</span>;
 
            <b>await</b> <span class="r234 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r243 r">nonEncodedContent</span>);
            <b>await</b> <span class="r241 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r243 r">nonEncodedContent</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a>[] <span id="r244 rd" class="r244 r">queueMessages</span> = <b>await</b> <span class="r241 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#efe8df42c9757b27" class="i method">ReceiveMessagesAsync</a>(10);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <span class="r244 r">queueMessages</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r235 r">badMessage</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r243 r">nonEncodedContent</span>, <span class="r235 r">badMessage</span>.<a href="/Azure.Storage.Queues/A.html#ca6ccb0de2843484" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#cab71e7b2240cb5c" class="i method">ToString</a>());
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r236 r">badMessage2</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r243 r">nonEncodedContent</span>, <span class="r236 r">badMessage2</span>.<a href="/Azure.Storage.Queues/A.html#ca6ccb0de2843484" class="i property">Body</a>.<a href="/System.Memory.Data/A.html#cab71e7b2240cb5c" class="i method">ToString</a>());
            <span class="t t">Assert</span>.<span class="i method">Null</span>(<span class="r237 r">badMessage3</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="32e0af215490e37f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PropagatesExceptionIfInvalidQueueMessageAndHandlerThrows</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r245 rd" class="r245 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r246 rd" class="r246 r">encodingClient</span> = <a href="QueueTestBase.cs.html#2ea313dbc9b4f61f" class="i method">GetEncodingClient</a>(
                <span class="r245 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>,
                <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>,
                <span id="r247 rd" class="r247 r">arg</span> =&gt;
                {
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>(<span class="s">&quot;KABOOM1&quot;</span>);
                },
                <span id="r248 rd" class="r248 r">arg</span> =&gt;
                {
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#eb98012a74461437" class="t constructor">ArgumentException</a>(<span class="s">&quot;KABOOM2&quot;</span>);
                });
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r249 rd" class="r249 r">nonEncodedContent</span> = <span class="s">&quot;test_content&quot;</span>;
 
            <b>await</b> <span class="r245 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r249 r">nonEncodedContent</span>);
            <b>await</b> <span class="r246 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r249 r">nonEncodedContent</span>);
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="@0@mscorlib/A.html#be77e0a7fbc110e6" class="t t">AggregateException</a>&gt;(
                <span class="r246 r">encodingClient</span>.<a href="/Azure.Storage.Queues/A.html#efe8df42c9757b27" class="i method">ReceiveMessagesAsync</a>(10),
                <span id="r250 rd" class="r250 r">e</span> =&gt;
                {
                    <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(2, <span class="r250 r">e</span>.<a href="@0@mscorlib/A.html#e9d864767768da2b" class="i property">InnerExceptions</a>.<a href="@0@mscorlib/A.html#7e2071514968aca1" class="i property">Count</a>);
                    <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;KABOOM1&quot;</span>, <span class="r250 r">e</span>.<a href="@0@mscorlib/A.html#e9d864767768da2b" class="i property">InnerExceptions</a>[0].<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                    <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;KABOOM2&quot;</span>, <span class="r250 r">e</span>.<a href="@0@mscorlib/A.html#e9d864767768da2b" class="i property">InnerExceptions</a>[1].<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                });
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f4e14cf2caad9046" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendMessageAsync_SAS</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r251 rd" class="r251 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r252 rd" class="r252 r">sasBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#c7db3c53f55a8158" class="t constructor">QueueSasBuilder</a>
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <span class="r251 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>,
                <a href="/Azure.Storage.Queues/A.html#5373251792a93b2f" class="i property">StartsOn</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(-1),
                <a href="/Azure.Storage.Queues/A.html#dd34a722229bc765" class="i property">ExpiresOn</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(1)
            };
            <span class="r252 r">sasBuilder</span>.<a href="/Azure.Storage.Queues/A.html#52e7cbd2a76c3f42" class="i method">SetPermissions</a>(<span class="s">&quot;a&quot;</span>);
            <a href="/Azure.Storage.Common/A.html#6d8135d9673080f5" class="t t">SasQueryParameters</a> <span id="r253 rd" class="r253 r">sasQueryParameters</span> = <span class="r252 r">sasBuilder</span>.<a href="/Azure.Storage.Queues/A.html#0c343076ae2443c2" class="i method">ToSasQueryParameters</a>(<a href="QueueTestBase.cs.html#f3c3b3850ed2fe8e" class="i method">GetNewSharedKeyCredentials</a>());
 
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r254 rd" class="r254 r">uriBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r251 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>)
            {
                <a href="/Azure.Storage.Queues/A.html#737d84241f87a194" class="i property">Sas</a> = <span class="r253 r">sasQueryParameters</span>
            };
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r255 rd" class="r255 r">queueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#c7a82ca99d6f80de" class="t constructor">QueueClient</a>(
                <span class="r254 r">uriBuilder</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(),
                <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r256 rd" class="r256 r">response</span> = <b>await</b> <span class="r255 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#2421b75c770559db" class="i method">SendMessageAsync</a>(
                <span class="r165 r">messageText</span>: <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>(),
                <span class="r166 r">visibilityTimeout</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(0, 0, 1),
                <span class="r167 r">timeToLive</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(1, 0, 0));
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r256 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="6b13dfc94d284763" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendMessageAsync_SasWithIdentifier</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r257 rd" class="r257 r">signedIdentifierId</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r258 rd" class="r258 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="/Azure.Storage.Queues/A.html#a3d741a69cd850f9" class="t t">QueueSignedIdentifier</a> <span id="r259 rd" class="r259 r">signedIdentifier</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#73892b867fb05c47" class="t constructor">QueueSignedIdentifier</a>
            {
                <a href="/Azure.Storage.Queues/A.html#cbc743db12f3b43e" class="i property">Id</a> = <span class="r257 r">signedIdentifierId</span>,
                <a href="/Azure.Storage.Queues/A.html#2f4f4061795efd11" class="i property">AccessPolicy</a> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#aca7ab604a204f64" class="t constructor">QueueAccessPolicy</a>
                {
                    <a href="/Azure.Storage.Queues/A.html#3f944b5b6d21163f" class="i property">StartsOn</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(-1),
                    <a href="/Azure.Storage.Queues/A.html#f1e12dfe18c836b2" class="i property">ExpiresOn</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(1),
                    <a href="/Azure.Storage.Queues/A.html#7deaf4874e53aede" class="i property">Permissions</a> = <span class="s">&quot;a&quot;</span>
                }
            };
            <b>await</b> <span class="r258 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#f9d3b2e01ddc79e0" class="i method">SetAccessPolicyAsync</a>(<span class="r260 r">permissions</span>: <b>new</b> <a href="/Azure.Storage.Queues/A.html#a3d741a69cd850f9" class="t t">QueueSignedIdentifier</a>[] { <span class="r259 r">signedIdentifier</span> });
 
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r261 rd" class="r261 r">sasBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#c7db3c53f55a8158" class="t constructor">QueueSasBuilder</a>
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <span class="r258 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#d1847b1478db81e4" class="i property">Name</a>,
                <a href="/Azure.Storage.Queues/A.html#f76dbd930fa57a10" class="i property">Identifier</a> = <span class="r257 r">signedIdentifierId</span>
            };
 
            <a href="/Azure.Storage.Common/A.html#6d8135d9673080f5" class="t t">SasQueryParameters</a> <span id="r262 rd" class="r262 r">sasQueryParameters</span> = <span class="r261 r">sasBuilder</span>.<a href="/Azure.Storage.Queues/A.html#0c343076ae2443c2" class="i method">ToSasQueryParameters</a>(<a href="QueueTestBase.cs.html#f3c3b3850ed2fe8e" class="i method">GetNewSharedKeyCredentials</a>());
 
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r263 rd" class="r263 r">uriBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r258 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#b66c9564ab86b303" class="i property">Uri</a>)
            {
                <a href="/Azure.Storage.Queues/A.html#737d84241f87a194" class="i property">Sas</a> = <span class="r262 r">sasQueryParameters</span>
            };
 
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r264 rd" class="r264 r">queueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#c7a82ca99d6f80de" class="t constructor">QueueClient</a>(
                <span class="r263 r">uriBuilder</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(),
                <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r265 rd" class="r265 r">response</span> = <b>await</b> <span class="r264 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#2421b75c770559db" class="i method">SendMessageAsync</a>(
                <span class="r165 r">messageText</span>: <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>(),
                <span class="r166 r">visibilityTimeout</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(0, 0, 1),
                <span class="r167 r">timeToLive</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(1, 0, 0));
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r265 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="6425acb1a3adc4b2" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendMessageAsync_Min</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r266 rd" class="r266 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a>&gt; <span id="r267 rd" class="r267 r">response</span> = <b>await</b> <span class="r266 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r267 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="6fcae21cba4e6470" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendMessageAsync_ExtendedExceptionMessage</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r268 rd" class="r268 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r268 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#2421b75c770559db" class="i method">SendMessageAsync</a>(
                    <span class="r165 r">messageText</span>: <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>,
                    <span class="r166 r">visibilityTimeout</span>: <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(10),
                    <span class="r167 r">timeToLive</span>: <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#c24437e069f958f9" class="i method">FromSeconds</a>(7)),
                <span id="r269 rd" class="r269 r">e</span> =&gt;
                {
                    <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="/Azure.Storage.Queues/A.html#82b5e4e9bf27f08c" class="t t">QueueErrorCode</a>.<a href="/Azure.Storage.Queues/A.html#d84900b2cf521e7d" class="i property">InvalidQueryParameterValue</a>.<a href="/Azure.Storage.Queues/A.html#494da3eb4a9dcf65" class="i method">ToString</a>(), <span class="r269 r">e</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>);
                    <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r269 r">e</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">$&quot;</span><span class="s">Additional Information:</span>{<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#63a04833d43dd9d3" class="i property">NewLine</a>}<span class="s">QueryParameterName: visibilitytimeout</span>{<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#63a04833d43dd9d3" class="i property">NewLine</a>}<span class="s">QueryParameterValue: 10</span>{<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#63a04833d43dd9d3" class="i property">NewLine</a>}<span class="s">Reason: messagettl must be greater than visibilitytimeout</span><span class="s">&quot;</span>));
                });
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="71b0fa4365618039" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendMessageAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r270 rd" class="r270 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r271 rd" class="r271 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r272 rd" class="r272 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r271 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r270 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r272 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>),
                <span id="r273 rd" class="r273 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r273 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5e492f6851ed9c8f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessagesAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r274 rd" class="r274 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <b>await</b> <span class="r274 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r274 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r274 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a>[]&gt; <span id="r275 rd" class="r275 r">response</span> = <b>await</b> <span class="r274 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#efe8df42c9757b27" class="i method">ReceiveMessagesAsync</a>(
                <span class="r276 r">maxMessages</span>: 2,
                <span class="r277 r">visibilityTimeout</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(1, 0, 0));
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(2, <span class="r275 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5e69d13bcae6bc21" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessagesAsync_Min</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r278 rd" class="r278 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <b>await</b> <span class="r278 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r278 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r278 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a>[]&gt; <span id="r279 rd" class="r279 r">response</span> = <b>await</b> <span class="r278 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <span class="r279 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5288cbbb23e0420c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessagesAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r280 rd" class="r280 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r281 rd" class="r281 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r282 rd" class="r282 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r281 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r280 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r282 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>(),
                <span id="r283 rd" class="r283 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r283 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="12e5da2767707f36" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessageAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r284 rd" class="r284 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r285 rd" class="r285 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
            <b>await</b> <span class="r284 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r285 r">messageText</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a>&gt; <span id="r286 rd" class="r286 r">response</span> = <b>await</b> <span class="r284 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#26083aa3cde50da2" class="i method">ReceiveMessageAsync</a>(
                <span class="r287 r">visibilityTimeout</span>: <b>new</b> <a href="@0@mscorlib/A.html#22fd9aa3d49cf498" class="t constructor">TimeSpan</a>(1, 0, 0));
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r285 r">messageText</span>, <span class="r286 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="a5fbb020c2f8933f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessageAsync_Min</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r288 rd" class="r288 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r289 rd" class="r289 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
            <b>await</b> <span class="r288 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r289 r">messageText</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a>&gt; <span id="r290 rd" class="r290 r">response</span> = <b>await</b> <span class="r288 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#26083aa3cde50da2" class="i method">ReceiveMessageAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r289 r">messageText</span>, <span class="r290 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="14dafae97909e125" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessageAsync_EmptyQueue</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r291 rd" class="r291 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r292 rd" class="r292 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a>&gt; <span id="r293 rd" class="r293 r">response</span> = <b>await</b> <span class="r291 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#26083aa3cde50da2" class="i method">ReceiveMessageAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNull</span>(<span class="r293 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="1091d1d3bc8a6936" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessageAsync_EmptyQueue_With_ResponseCast</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r294 rd" class="r294 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r295 rd" class="r295 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
 
            <span class="c">// Act</span>
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r296 rd" class="r296 r">message</span> = <b>await</b> <span class="r294 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#26083aa3cde50da2" class="i method">ReceiveMessageAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNull</span>(<span class="r296 r">message</span>);
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7d75da35558d4cbc" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ReceiveMessageAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r297 rd" class="r297 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r298 rd" class="r298 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r299 rd" class="r299 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r298 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r297 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r299 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#edff5f7a2bb79f42" class="i method">ReceiveMessagesAsync</a>(),
                <span id="r300 rd" class="r300 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r300 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="0331c597162a101a" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeekMessagesAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r301 rd" class="r301 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <b>await</b> <span class="r301 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r301 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r301 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a>[]&gt; <span id="r302 rd" class="r302 r">response</span> = <b>await</b> <span class="r301 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>(<span class="r303 r">maxMessages</span>: 2);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(2, <span class="r302 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="8423261e7c01046f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeekMessagesAsync_Min</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r304 rd" class="r304 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <b>await</b> <span class="r304 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r304 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r304 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a>[]&gt; <span id="r305 rd" class="r305 r">response</span> = <b>await</b> <span class="r304 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <span class="r305 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5ba9ad62f206ead3" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeekMessagesAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r306 rd" class="r306 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r307 rd" class="r307 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r308 rd" class="r308 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r307 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r306 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r308 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>(),
                <span id="r309 rd" class="r309 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r309 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="83ed282cd2303441" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeekMessageAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r310 rd" class="r310 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r311 rd" class="r311 r">messageText</span> = <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>();
            <b>await</b> <span class="r310 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r311 r">messageText</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a>&gt; <span id="r312 rd" class="r312 r">response</span> = <b>await</b> <span class="r310 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1062d6200f80327f" class="i method">PeekMessageAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r311 r">messageText</span>, <span class="r312 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#c779212e518d15f7" class="i property">MessageText</a>);
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="6fb7571c19afb83f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeekMessageAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r313 rd" class="r313 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r314 rd" class="r314 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r315 rd" class="r315 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r314 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r313 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r315 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#1062d6200f80327f" class="i method">PeekMessageAsync</a>(),
                <span id="r316 rd" class="r316 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r316 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="84ef0925b7724c37" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeekMessageAsync_EmptyQueue</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r317 rd" class="r317 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a>&gt; <span id="r318 rd" class="r318 r">response</span> = <b>await</b> <span class="r317 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1062d6200f80327f" class="i method">PeekMessageAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNull</span>(<span class="r318 r">response</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="14eb132344a90520" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeekMessageAsync_EmptyQueue_WithResponseCast</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r319 rd" class="r319 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a> <span id="r320 rd" class="r320 r">message</span> = <b>await</b> <span class="r319 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1062d6200f80327f" class="i method">PeekMessageAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNull</span>(<span class="r320 r">message</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="b1fd1df6b7e2158f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ClearMessagesAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r321 rd" class="r321 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <b>await</b> <span class="r321 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r321 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
            <b>await</b> <span class="r321 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>());
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r322 rd" class="r322 r">response</span> = <b>await</b> <span class="r321 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#b3dbd53bb6081404" class="i method">ClearMessagesAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r322 r">response</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>);
        }
 
        <span class="c">// Note that this test intentionally does not call queue.CreateAsync()</span>
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="fad54c86595a3119" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ClearMessagesAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r323 rd" class="r323 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a> <span id="r324 rd" class="r324 r">service</span> = <a href="QueueTestBase.cs.html#59f13234264af78d" class="i method">GetServiceClient_SharedKey</a>();
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r325 rd" class="r325 r">queue</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r324 r">service</span>.<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<span class="r323 r">queueName</span>));
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r325 r">queue</span>.<a href="/Azure.Storage.Queues/A.html#b3dbd53bb6081404" class="i method">ClearMessagesAsync</a>(),
                <span id="r326 rd" class="r326 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;QueueNotFound&quot;</span>, <span class="r326 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="b780f3320a8881c9" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteMessageAsync</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r327 rd" class="r327 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a> <span id="r328 rd" class="r328 r">enqueuedMessage</span> = (<b>await</b> <span class="r327 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r329 rd" class="r329 r">result</span> = <b>await</b> <span class="r327 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c6b0763cbcb3d73" class="i method">DeleteMessageAsync</a>(<span class="r328 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c686ab9806c9424c" class="i property">MessageId</a>, <span class="r328 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c5cad9605cb922ab" class="i property">PopReceipt</a>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r329 r">result</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="95ee05e831fbb7ba" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteMessagAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r330 rd" class="r330 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r330 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c6b0763cbcb3d73" class="i method">DeleteMessageAsync</a>(<a href="QueueTestBase.cs.html#89038256c1d1c263" class="i method">GetNewMessageId</a>(), <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>()),
                <span id="r331 rd" class="r331 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;MessageNotFound&quot;</span>, <span class="r331 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f7dda9aafaef549c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DeleteMessageAsync_DeletePeek</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r332 rd" class="r332 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a> <span id="r333 rd" class="r333 r">enqueuedMessage</span> = (<b>await</b> <span class="r332 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a> <span id="r334 rd" class="r334 r">result</span> = <b>await</b> <span class="r332 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c6b0763cbcb3d73" class="i method">DeleteMessageAsync</a>(<span class="r333 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c686ab9806c9424c" class="i property">MessageId</a>, <span class="r333 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c5cad9605cb922ab" class="i property">PopReceipt</a>);
 
            <span class="c">// Assert</span>
            <b>await</b> <span class="r332 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r334 r">result</span>.<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3c15cdf176630e50" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateMessageAsync_Update</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r335 rd" class="r335 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r336 rd" class="r336 r">message0</span> = <span class="s">&quot;foo&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r337 rd" class="r337 r">message1</span> = <span class="s">&quot;bar&quot;</span>;
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a> <span id="r338 rd" class="r338 r">enqueuedMessage</span> = (<b>await</b> <span class="r335 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r336 r">message0</span>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a622bf5746390785" class="t t">UpdateReceipt</a>&gt; <span id="r339 rd" class="r339 r">result</span> = <b>await</b> <span class="r335 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1cda8562b50d466f" class="i method">UpdateMessageAsync</a>(
                <span class="r338 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c686ab9806c9424c" class="i property">MessageId</a>,
                <span class="r338 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c5cad9605cb922ab" class="i property">PopReceipt</a>,
                <span class="r337 r">message1</span>,
                <b>new</b> <a href="@0@mscorlib/A.html#9cf98f5e237ce8fb" class="t constructor">TimeSpan</a>(100));
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r339 r">result</span>.<a href="/Azure.Core/A.html#959994a72d6ef38a" class="i method">GetRawResponse</a>().<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="89b866d76dd6dd02" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateMessageAsync_Min</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r340 rd" class="r340 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r341 rd" class="r341 r">message0</span> = <span class="s">&quot;foo&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r342 rd" class="r342 r">message1</span> = <span class="s">&quot;bar&quot;</span>;
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a> <span id="r343 rd" class="r343 r">enqueuedMessage</span> = (<b>await</b> <span class="r340 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r341 r">message0</span>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a622bf5746390785" class="t t">UpdateReceipt</a>&gt; <span id="r344 rd" class="r344 r">result</span> = <b>await</b> <span class="r340 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1cda8562b50d466f" class="i method">UpdateMessageAsync</a>(
                <span class="r343 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c686ab9806c9424c" class="i property">MessageId</a>,
                <span class="r343 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c5cad9605cb922ab" class="i property">PopReceipt</a>,
                <span class="r342 r">message1</span>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r344 r">result</span>.<a href="/Azure.Core/A.html#959994a72d6ef38a" class="i method">GetRawResponse</a>().<a href="/Azure.Core/A.html#9f6adbd7e81f8000" class="i property">Headers</a>.<a href="/Azure.Core/A.html#aba3f088b3595483" class="i property">RequestId</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="af4414920bc41195" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateMessageAsync_UpdateDequeuedMessage</a>()
        {
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r345 rd" class="r345 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r346 rd" class="r346 r">message0</span> = <span class="s">&quot;foo&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r347 rd" class="r347 r">message1</span> = <span class="s">&quot;bar&quot;</span>;
 
            <b>await</b> <span class="r345 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r346 r">message0</span>);
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r348 rd" class="r348 r">message</span> = (<b>await</b> <span class="r345 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#efe8df42c9757b27" class="i method">ReceiveMessagesAsync</a>(1)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a622bf5746390785" class="t t">UpdateReceipt</a>&gt; <span id="r349 rd" class="r349 r">update</span> = <b>await</b> <span class="r345 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1cda8562b50d466f" class="i method">UpdateMessageAsync</a>(
                <span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#19218602eec807e8" class="i property">MessageId</a>,
                <span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#93c530edee4e3735" class="i property">PopReceipt</a>,
                <span class="r347 r">message1</span>);
 
            <span class="t t">Assert</span>.<span class="i method">AreNotEqual</span>(<span class="r349 r">update</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#c439ab70394a1fa4" class="i property">PopReceipt</a>, <span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#93c530edee4e3735" class="i property">PopReceipt</a>);
            <span class="t t">Assert</span>.<span class="i method">AreNotEqual</span>(<span class="r349 r">update</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#edfc0e2ef0e58885" class="i property">NextVisibleOn</a>, <span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#5c82b93fd556def9" class="i property">NextVisibleOn</a>);
 
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="t t">QueueMessage</a> <span id="r350 rd" class="r350 r">newMessage</span> = <span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#e388df0e9215a081" class="i method">Update</a>(<span class="r349 r">update</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#19218602eec807e8" class="i property">MessageId</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#19218602eec807e8" class="i property">MessageId</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#1f9426556caa5c65" class="i property">InsertedOn</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#1f9426556caa5c65" class="i property">InsertedOn</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#9d9724981fbc93c3" class="i property">ExpiresOn</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#9d9724981fbc93c3" class="i property">ExpiresOn</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#6ee72fbe81e89533" class="i property">DequeueCount</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#6ee72fbe81e89533" class="i property">DequeueCount</a>);
            <span class="t t">Assert</span>.<span class="i method">AreNotEqual</span>(<span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#93c530edee4e3735" class="i property">PopReceipt</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#93c530edee4e3735" class="i property">PopReceipt</a>);
            <span class="t t">Assert</span>.<span class="i method">AreNotEqual</span>(<span class="r348 r">message</span>.<a href="/Azure.Storage.Queues/A.html#5c82b93fd556def9" class="i property">NextVisibleOn</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#5c82b93fd556def9" class="i property">NextVisibleOn</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r349 r">update</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#c439ab70394a1fa4" class="i property">PopReceipt</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#93c530edee4e3735" class="i property">PopReceipt</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r349 r">update</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Storage.Queues/A.html#edfc0e2ef0e58885" class="i property">NextVisibleOn</a>, <span class="r350 r">newMessage</span>.<a href="/Azure.Storage.Queues/A.html#5c82b93fd556def9" class="i property">NextVisibleOn</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="25bd45e242c1b6b7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateMessageAsync_UpdatePeek</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r351 rd" class="r351 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r352 rd" class="r352 r">message0</span> = <span class="s">&quot;foo&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r353 rd" class="r353 r">message1</span> = <span class="s">&quot;bar&quot;</span>;
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a> <span id="r354 rd" class="r354 r">enqueuedMessage</span> = (<b>await</b> <span class="r351 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r352 r">message0</span>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
 
            <span class="c">// Act</span>
            <b>await</b> <span class="r351 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1cda8562b50d466f" class="i method">UpdateMessageAsync</a>(<span class="r354 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c686ab9806c9424c" class="i property">MessageId</a>, <span class="r354 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c5cad9605cb922ab" class="i property">PopReceipt</a>, <span class="r353 r">message1</span>);
 
            <span class="c">// Assert</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a>[]&gt; <span id="r355 rd" class="r355 r">peekedMessages</span> = <b>await</b> <span class="r351 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1025de7ead38d12f" class="i method">PeekMessagesAsync</a>(1);
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#e32155654252c9e5" class="t t">PeekedMessage</a> <span id="r356 rd" class="r356 r">peekedMessage</span> = <span class="r355 r">peekedMessages</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(1, <span class="r355 r">peekedMessages</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r353 r">message1</span>, <span class="r356 r">peekedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c779212e518d15f7" class="i property">MessageText</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c3499fbb1790ce88" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateMessageAsync_Error</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r357 rd" class="r357 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <b>await</b> <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#7820952ec9aec2d6" class="i method">AssertExpectedExceptionAsync</a>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(
                <span class="r357 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1cda8562b50d466f" class="i method">UpdateMessageAsync</a>(<a href="QueueTestBase.cs.html#89038256c1d1c263" class="i method">GetNewMessageId</a>(), <a href="Shared/StorageTestBase.cs.html#afa2e83b31a1aec6" class="i method">GetNewString</a>(), <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>),
                <span id="r358 rd" class="r358 r">actualException</span> =&gt; <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;MessageNotFound&quot;</span>, <span class="r358 r">actualException</span>.<a href="/Azure.Core/A.html#0f8d8760e8ec9460" class="i property">ErrorCode</a>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="93660a9aefc01810" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdateMessageAsync_UpdateVisibilityTimeoutOnlyPreservesContent</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r359 rd" class="r359 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r360 rd" class="r360 r">message</span> = <span class="s">&quot;foo&quot;</span>;
            <span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#63efa6bef1993d8b" class="t t">SendReceipt</a> <span id="r361 rd" class="r361 r">enqueuedMessage</span> = (<b>await</b> <span class="r359 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#8c21fc372cc81608" class="i method">SendMessageAsync</a>(<span class="r360 r">message</span>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
 
            <span class="c">// Act</span>
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="t t">Response</a>&lt;<span class="i n">Models</span>.<a href="/Azure.Storage.Queues/A.html#a622bf5746390785" class="t t">UpdateReceipt</a>&gt; <span id="r362 rd" class="r362 r">result</span> = <b>await</b> <span class="r359 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#1cda8562b50d466f" class="i method">UpdateMessageAsync</a>(
                <span class="r361 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c686ab9806c9424c" class="i property">MessageId</a>,
                <span class="r361 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c5cad9605cb922ab" class="i property">PopReceipt</a>,
                <span class="r363 r">visibilityTimeout</span>: <b>new</b> <a href="@0@mscorlib/A.html#9cf98f5e237ce8fb" class="t constructor">TimeSpan</a>(100));
            <a href="/Azure.Storage.Queues/A.html#eb02c418d8194406" class="k">var</a> <span id="r364 rd" class="r364 r">receivedMessage</span> = (<b>await</b> <span class="r359 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#efe8df42c9757b27" class="i method">ReceiveMessagesAsync</a>(1)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r361 r">enqueuedMessage</span>.<a href="/Azure.Storage.Queues/A.html#c686ab9806c9424c" class="i property">MessageId</a>, <span class="r364 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#19218602eec807e8" class="i property">MessageId</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r360 r">message</span>, <span class="r364 r">receivedMessage</span>.<a href="/Azure.Storage.Queues/A.html#f7062071be05bc4d" class="i property">MessageText</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> GenerateSasTests
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="de9bdc0a3f7bd66f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanGenerateSas_ClientConstructors</a>()
        {
            <span class="c">// Arrange</span>
            <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="k">var</a> <span id="r365 rd" class="r365 r">constants</span> = <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a>.<a href="Shared/TestConstants.cs.html#203c7c99dba2deba" class="i method">Create</a>(<a href="#651a1dc094691910" class="k">this</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="k">var</a> <span id="r366 rd" class="r366 r">blobEndpoint</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;https://127.0.0.1/&quot;</span> + <span class="r365 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#734b131b05a1072a" class="i property">Account</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="k">var</a> <span id="r367 rd" class="r367 r">blobSecondaryEndpoint</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;https://127.0.0.1/&quot;</span> + <span class="r365 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#734b131b05a1072a" class="i property">Account</a> + <span class="s">&quot;-secondary&quot;</span>);
            <a href="/Azure.Storage.Queues/A.html#7ccfb159d18cf63e" class="k">var</a> <span id="r368 rd" class="r368 r">storageConnectionString</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#4eec574b9d8c7b03" class="t constructor">StorageConnectionString</a>(<span class="r365 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>, <span class="r369 r">queueStorageUri</span>: (<span class="r366 r">blobEndpoint</span>, <span class="r367 r">blobSecondaryEndpoint</span>));
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r370 rd" class="r370 r">connectionString</span> = <span class="r368 r">storageConnectionString</span>.<a href="Shared/TestExtensions.cs.html#87d23cce92a2a26b" class="i method">ToString</a>(<b>true</b>);
 
            <span class="c">// Act - QueueClient(string connectionString, string blobContainerName)</span>
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r371 rd" class="r371 r">container</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#607c1f6ebd194e83" class="t constructor">QueueClient</a>(
                <span class="r370 r">connectionString</span>,
                <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>()));
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r371 r">container</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>);
 
            <span class="c">// Act - QueueClient(string connectionString, string blobContainerName, BlobClientOptions options)</span>
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r372 rd" class="r372 r">container2</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#0c3055894e828c76" class="t constructor">QueueClient</a>(
                <span class="r370 r">connectionString</span>,
                <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>(),
                <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r372 r">container2</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>);
 
            <span class="c">// Act - QueueClient(Uri blobContainerUri, BlobClientOptions options = default)</span>
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r373 rd" class="r373 r">container3</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#c7a82ca99d6f80de" class="t constructor">QueueClient</a>(
                <span class="r366 r">blobEndpoint</span>,
                <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
            <span class="t t">Assert</span>.<span class="i method">IsFalse</span>(<span class="r373 r">container3</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>);
 
            <span class="c">// Act - QueueClient(Uri blobContainerUri, StorageSharedKeyCredential credential, BlobClientOptions options = default)</span>
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r374 rd" class="r374 r">container4</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#4b28f0c625ebac1f" class="t constructor">QueueClient</a>(
                <span class="r366 r">blobEndpoint</span>,
                <span class="r365 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>,
                <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r374 r">container4</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="684efead909d3862" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanGenerateSas_Mockable</a>()
        {
            <span class="c">// Act</span>
            <b>var</b> <span id="r375 rd" class="r375 r">directory</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;();
            <span class="r375 r">directory</span>.<span class="i method">Setup</span>(<span id="r376 rd" class="r376 r">x</span> =&gt; <span class="r376 r">x</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>).<span class="i method">Returns</span>(<b>false</b>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsFalse</span>(<span class="r375 r">directory</span>.<span class="i property">Object</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>);
 
            <span class="c">// Act</span>
            <span class="r375 r">directory</span>.<span class="i method">Setup</span>(<span id="r377 rd" class="r377 r">x</span> =&gt; <span class="r377 r">x</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>).<span class="i method">Returns</span>(<b>true</b>);
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r375 r">directory</span>.<span class="i property">Object</span>.<a href="/Azure.Storage.Queues/A.html#a2bdd307365c03c8" class="i property">CanGenerateSasUri</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="2861ef2843de03e1" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateSas_RequiredParameters</a>()
        {
            <span class="c">// Arrange</span>
            <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a> <span id="r378 rd" class="r378 r">constants</span> = <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a>.<a href="Shared/TestConstants.cs.html#203c7c99dba2deba" class="i method">Create</a>(<a href="#651a1dc094691910" class="k">this</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r379 rd" class="r379 r">serviceUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<span class="r378 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#734b131b05a1072a" class="i property">Account</a>}<span class="s">.queue.core.windows.net</span><span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r380 rd" class="r380 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r381 rd" class="r381 r">queueUriBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r379 r">serviceUri</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a> = <span class="r380 r">queueName</span>
            };
 
            <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a> <span id="r382 rd" class="r382 r">permissions</span> = <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a>.<a href="/Azure.Storage.Queues/A.html#a6fde8ebe280b5d1" class="i field">Read</a>;
            <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <span id="r383 rd" class="r383 r">expiresOn</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(+1);
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r384 rd" class="r384 r">queueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <b>new</b> <a href="/Azure.Storage.Queues/A.html#4b28f0c625ebac1f" class="t constructor">QueueClient</a>(
                    <span class="r381 r">queueUriBuilder</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(),
                    <span class="r378 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>,
                    <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <span class="c">// Act</span>
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r385 rd" class="r385 r">sasUri</span> =  <span class="r384 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#dcf22b5901720d1f" class="i method">GenerateSasUri</a>(<span class="r382 r">permissions</span>, <span class="r383 r">expiresOn</span>);
 
            <span class="c">// Assert</span>
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r386 rd" class="r386 r">sasBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#d0e66ccefa0d899b" class="t constructor">QueueSasBuilder</a>(<span class="r382 r">permissions</span>, <span class="r383 r">expiresOn</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <span class="r380 r">queueName</span>
            };
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r387 rd" class="r387 r">expectedUri</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r379 r">serviceUri</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a> = <span class="r380 r">queueName</span>,
                <a href="/Azure.Storage.Queues/A.html#737d84241f87a194" class="i property">Sas</a> = <span class="r386 r">sasBuilder</span>.<a href="/Azure.Storage.Queues/A.html#0c343076ae2443c2" class="i method">ToSasQueryParameters</a>(<span class="r378 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>)
            };
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r387 r">expectedUri</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(), <span class="r385 r">sasUri</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="460497c5a80a9869" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateSas_Builder</a>()
        {
            <span class="c">// Arrange</span>
            <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a> <span id="r388 rd" class="r388 r">constants</span> = <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a>.<a href="Shared/TestConstants.cs.html#203c7c99dba2deba" class="i method">Create</a>(<a href="#651a1dc094691910" class="k">this</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r389 rd" class="r389 r">serviceUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<span class="r388 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#734b131b05a1072a" class="i property">Account</a>}<span class="s">.queue.core.windows.net</span><span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r390 rd" class="r390 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r391 rd" class="r391 r">queueUriBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r389 r">serviceUri</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a> = <span class="r390 r">queueName</span>
            };
            <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a> <span id="r392 rd" class="r392 r">permissions</span> = <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a>.<a href="/Azure.Storage.Queues/A.html#a6fde8ebe280b5d1" class="i field">Read</a>;
            <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <span id="r393 rd" class="r393 r">expiresOn</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(+1);
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r394 rd" class="r394 r">queueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <b>new</b> <a href="/Azure.Storage.Queues/A.html#4b28f0c625ebac1f" class="t constructor">QueueClient</a>(
                    <span class="r391 r">queueUriBuilder</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(),
                    <span class="r388 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>,
                    <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r395 rd" class="r395 r">sasBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#d0e66ccefa0d899b" class="t constructor">QueueSasBuilder</a>(<span class="r392 r">permissions</span>, <span class="r393 r">expiresOn</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <span class="r390 r">queueName</span>
            };
 
            <span class="c">// Act</span>
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r396 rd" class="r396 r">sasUri</span> = <span class="r394 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#6e9809277cdeee55" class="i method">GenerateSasUri</a>(<span class="r395 r">sasBuilder</span>);
 
            <span class="c">// Assert</span>
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r397 rd" class="r397 r">sasBuilder2</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#d0e66ccefa0d899b" class="t constructor">QueueSasBuilder</a>(<span class="r392 r">permissions</span>, <span class="r393 r">expiresOn</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <span class="r390 r">queueName</span>
            };
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r398 rd" class="r398 r">expectedUri</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r389 r">serviceUri</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a> = <span class="r390 r">queueName</span>,
                <a href="/Azure.Storage.Queues/A.html#737d84241f87a194" class="i property">Sas</a> = <span class="r397 r">sasBuilder2</span>.<a href="/Azure.Storage.Queues/A.html#0c343076ae2443c2" class="i method">ToSasQueryParameters</a>(<span class="r388 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>)
            };
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r398 r">expectedUri</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(), <span class="r396 r">sasUri</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="58fc672300bebcdd" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateSas_BuilderNullName</a>()
        {
            <span class="c">// Arrange</span>
            <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a> <span id="r399 rd" class="r399 r">constants</span> = <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a>.<a href="Shared/TestConstants.cs.html#203c7c99dba2deba" class="i method">Create</a>(<a href="#651a1dc094691910" class="k">this</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r400 rd" class="r400 r">serviceUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<span class="r399 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#734b131b05a1072a" class="i property">Account</a>}<span class="s">.queue.core.windows.net</span><span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r401 rd" class="r401 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r402 rd" class="r402 r">queueUriBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r400 r">serviceUri</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a> = <span class="r401 r">queueName</span>
            };
            <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a> <span id="r403 rd" class="r403 r">permissions</span> = <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a>.<a href="/Azure.Storage.Queues/A.html#a6fde8ebe280b5d1" class="i field">Read</a>;
            <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <span id="r404 rd" class="r404 r">expiresOn</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(+1);
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r405 rd" class="r405 r">queueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <b>new</b> <a href="/Azure.Storage.Queues/A.html#4b28f0c625ebac1f" class="t constructor">QueueClient</a>(
                    <span class="r402 r">queueUriBuilder</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(),
                    <span class="r399 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>,
                    <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r406 rd" class="r406 r">sasBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#d0e66ccefa0d899b" class="t constructor">QueueSasBuilder</a>(<span class="r403 r">permissions</span>, <span class="r404 r">expiresOn</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <b>null</b>
            };
 
            <span class="c">// Act</span>
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r407 rd" class="r407 r">sasUri</span> = <span class="r405 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#6e9809277cdeee55" class="i method">GenerateSasUri</a>(<span class="r406 r">sasBuilder</span>);
 
            <span class="c">// Assert</span>
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r408 rd" class="r408 r">sasBuilder2</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#d0e66ccefa0d899b" class="t constructor">QueueSasBuilder</a>(<span class="r403 r">permissions</span>, <span class="r404 r">expiresOn</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <span class="r401 r">queueName</span>
            };
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r409 rd" class="r409 r">expectedUri</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r400 r">serviceUri</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a> = <span class="r401 r">queueName</span>,
                <a href="/Azure.Storage.Queues/A.html#737d84241f87a194" class="i property">Sas</a> = <span class="r408 r">sasBuilder2</span>.<a href="/Azure.Storage.Queues/A.html#0c343076ae2443c2" class="i method">ToSasQueryParameters</a>(<span class="r399 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>)
            };
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r409 r">expectedUri</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(), <span class="r407 r">sasUri</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="6893a12efdf68724" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GenerateSas_BuilderWrongName</a>()
        {
            <span class="c">// Arrange</span>
            <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a> <span id="r410 rd" class="r410 r">constants</span> = <a href="Shared/TestConstants.cs.html#9775587e7faf076b" class="t t">TestConstants</a>.<a href="Shared/TestConstants.cs.html#203c7c99dba2deba" class="i method">Create</a>(<a href="#651a1dc094691910" class="k">this</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r411 rd" class="r411 r">serviceUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<span class="r410 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#734b131b05a1072a" class="i property">Account</a>}<span class="s">.queue.core.windows.net</span><span class="s">&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r412 rd" class="r412 r">queueName</span> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>();
            <a href="/Azure.Storage.Queues/A.html#5c8aad0964098081" class="t t">QueueUriBuilder</a> <span id="r413 rd" class="r413 r">queueUriBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#7af07e836c49ff3a" class="t constructor">QueueUriBuilder</a>(<span class="r411 r">serviceUri</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#e10f0eef6795b775" class="i property">QueueName</a> = <span class="r412 r">queueName</span>
            };
            <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a> <span id="r414 rd" class="r414 r">permissions</span> = <a href="/Azure.Storage.Queues/A.html#db563dfe865850c5" class="t t">QueueSasPermissions</a>.<a href="/Azure.Storage.Queues/A.html#a6fde8ebe280b5d1" class="i field">Read</a>;
            <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a> <span id="r415 rd" class="r415 r">expiresOn</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(+1);
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r416 rd" class="r416 r">queueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<b>new</b> <a href="/Azure.Storage.Queues/A.html#4b28f0c625ebac1f" class="t constructor">QueueClient</a>(
                <span class="r413 r">queueUriBuilder</span>.<a href="/Azure.Storage.Queues/A.html#341ef28856ee18cb" class="i method">ToUri</a>(),
                <span class="r410 r">constants</span>.<a href="Shared/TestConstants.cs.html#268d664916096044" class="i property">Sas</a>.<a href="Shared/TestConstants.cs.html#5e7d6f6cb2ad8ffd" class="i property">SharedKeyCredential</a>,
                <a href="QueueTestBase.cs.html#3dd8e777495eb276" class="i method">GetOptions</a>()));
 
            <a href="/Azure.Storage.Queues/A.html#423350091c2ef69d" class="t t">QueueSasBuilder</a> <span id="r417 rd" class="r417 r">sasBuilder</span> = <b>new</b> <a href="/Azure.Storage.Queues/A.html#d0e66ccefa0d899b" class="t constructor">QueueSasBuilder</a>(<span class="r414 r">permissions</span>, <span class="r415 r">expiresOn</span>)
            {
                <a href="/Azure.Storage.Queues/A.html#618d46a6b8bdc59b" class="i property">QueueName</a> = <a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>() <span class="c">//different queueName</span>
            };
 
            <span class="c">// Act</span>
            <a href="Shared/TestHelper.cs.html#1425737f2a386c6e" class="t t">TestHelper</a>.<a href="Shared/TestHelper.cs.html#631bb3deb06304ab" class="i method">AssertExpectedException</a>(
                () =&gt; <span class="r416 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#6e9809277cdeee55" class="i method">GenerateSasUri</a>(<span class="r417 r">sasBuilder</span>),
                <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>(<span class="s">&quot;SAS Uri cannot be generated. QueueSasBuilder.QueueName does not match Name in the Client. QueueSasBuilder.QueueName must either be left empty or match the Name in the Client&quot;</span>));
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="7958e071cd990d74" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanMockQueueServiceClientRetrieval</a>()
        {
            <span class="c">// Arrange</span>
            <span class="t t">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt; <span id="r418 rd" class="r418 r">queueClientMock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;();
            <span class="t t">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a>&gt; <span id="r419 rd" class="r419 r">queueServiceClientMock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a>&gt;();
            <span class="r418 r">queueClientMock</span>.<span class="i method">Protected</span>().<span class="i method">Setup</span>&lt;<a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="t t">QueueServiceClient</a>&gt;(<span class="s">&quot;GetParentQueueServiceClientCore&quot;</span>).<span class="i method">Returns</span>(<span class="r419 r">queueServiceClientMock</span>.<span class="i property">Object</span>);
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="k">var</a> <span id="r420 rd" class="r420 r">queueServiceClient</span> = <span class="r418 r">queueClientMock</span>.<span class="i property">Object</span>.<a href="/Azure.Storage.Queues/A.html#de3a5ff818bfad27" class="i method">GetParentQueueServiceClient</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r420 r">queueServiceClient</span>);
            <span class="t t">Assert</span>.<span class="i method">AreSame</span>(<span class="r419 r">queueServiceClientMock</span>.<span class="i property">Object</span>, <span class="r420 r">queueServiceClient</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="769d4a16044998b8" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanGetParentQueueServiceClient</a>()
        {
            <span class="c">// Arrange</span>
            <b>await using</b> <a href="QueueTestBase.cs.html#10b5c934dcfcbc2b" class="t t">DisposingQueue</a> <span id="r421 rd" class="r421 r">test</span> = <b>await</b> <a href="QueueTestBase.cs.html#822c81052dde60b6" class="i method">GetTestQueueAsync</a>();
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="k">var</a> <span id="r422 rd" class="r422 r">queueServiceClient</span> = <span class="r421 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#de3a5ff818bfad27" class="i method">GetParentQueueServiceClient</a>();
            <span class="c">// make sure that client is functional</span>
            <a href="/Azure.Storage.Queues/A.html#de8096e721564ca0" class="t t">QueueServiceProperties</a> <span id="r423 rd" class="r423 r">queueServiceProperties</span> = <b>await</b> <span class="r422 r">queueServiceClient</span>.<a href="/Azure.Storage.Queues/A.html#4eab194b87422f57" class="i method">GetPropertiesAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r421 r">test</span>.<a href="QueueTestBase.cs.html#87dad09a2b1aafba" class="i property">Queue</a>.<a href="/Azure.Storage.Queues/A.html#a0bd3939fd4bdd76" class="i property">AccountName</a>, <span class="r422 r">queueServiceClient</span>.<a href="/Azure.Storage.Queues/A.html#ba9ee9e29cb743c5" class="i property">AccountName</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="eee926c6ea7e3368" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanGetParentQueueServiceClient_WithAccountSAS</a>()
        {
            <span class="c">// Arrange</span>
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a> <span id="r424 rd" class="r424 r">queueClient</span> = <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(
                <a href="QueueTestBase.cs.html#ec79ca98dab5e4f5" class="i method">GetServiceClient_AccountSas</a>(
                    <span class="r425 r">sasCredentials</span>: <a href="QueueTestBase.cs.html#8ec88dfd053a4e4b" class="i method">GetNewAccountSasCredentials</a>(<span class="r426 r">resourceTypes</span>: <a href="/Azure.Storage.Common/A.html#1e2952f573dd64b0" class="t t">AccountSasResourceTypes</a>.<a href="/Azure.Storage.Common/A.html#fb06b0ba251e75ec" class="i field">All</a>))
                .<a href="/Azure.Storage.Queues/A.html#3691ef0a47344425" class="i method">GetQueueClient</a>(<a href="QueueTestBase.cs.html#6bcc4c72b16eaa5c" class="i method">GetNewQueueName</a>()));
 
            <span class="c">// Act</span>
            <a href="/Azure.Storage.Queues/A.html#ef0f353b721b0444" class="k">var</a> <span id="r427 rd" class="r427 r">queueServiceClient</span> = <span class="r424 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#de3a5ff818bfad27" class="i method">GetParentQueueServiceClient</a>();
            <span class="c">// make sure that client is functional</span>
            <a href="/Azure.Storage.Queues/A.html#de8096e721564ca0" class="t t">QueueServiceProperties</a> <span id="r428 rd" class="r428 r">queueServiceProperties</span> = <b>await</b> <span class="r427 r">queueServiceClient</span>.<a href="/Azure.Storage.Queues/A.html#4eab194b87422f57" class="i method">GetPropertiesAsync</a>();
 
            <span class="c">// Assert</span>
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r424 r">queueClient</span>.<a href="/Azure.Storage.Queues/A.html#a0bd3939fd4bdd76" class="i property">AccountName</a>, <span class="r427 r">queueServiceClient</span>.<a href="/Azure.Storage.Queues/A.html#ba9ee9e29cb743c5" class="i property">AccountName</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="398f7abe81fb6e0d" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CanMockClientConstructors</a>()
        {
            <span class="c">// One has to call .Object to trigger constructor. It&#39;s lazy.</span>
            <a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="k">var</a> <span id="r429 rd" class="r429 r">mock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;(<a href="Shared/StorageTestBase.cs.html#407034e8b138a893" class="i property">TestConfigDefault</a>.<a href="Shared/TenantConfiguration.cs.html#c138650c6d983a3c" class="i property">ConnectionString</a>, <span class="s">&quot;queuename&quot;</span>, <b>new</b> <a href="/Azure.Storage.Queues/A.html#caf635c5e2c31a14" class="t constructor">QueueClientOptions</a>()).<span class="i property">Object</span>;
            <span class="r429 r">mock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;(<a href="Shared/StorageTestBase.cs.html#407034e8b138a893" class="i property">TestConfigDefault</a>.<a href="Shared/TenantConfiguration.cs.html#c138650c6d983a3c" class="i property">ConnectionString</a>, <span class="s">&quot;queuename&quot;</span>).<span class="i property">Object</span>;
            <span class="r429 r">mock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;(<b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;https://test/test&quot;</span>), <b>new</b> <a href="/Azure.Storage.Queues/A.html#caf635c5e2c31a14" class="t constructor">QueueClientOptions</a>()).<span class="i property">Object</span>;
            <span class="r429 r">mock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;(<b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;https://test/test&quot;</span>), <a href="QueueTestBase.cs.html#f3c3b3850ed2fe8e" class="i method">GetNewSharedKeyCredentials</a>(), <b>new</b> <a href="/Azure.Storage.Queues/A.html#caf635c5e2c31a14" class="t constructor">QueueClientOptions</a>()).<span class="i property">Object</span>;
            <span class="r429 r">mock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;(<b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;https://test/test&quot;</span>), <b>new</b> <a href="/Azure.Core/A.html#7c49a23f7592174a" class="t constructor">AzureSasCredential</a>(<span class="s">&quot;foo&quot;</span>), <b>new</b> <a href="/Azure.Storage.Queues/A.html#caf635c5e2c31a14" class="t constructor">QueueClientOptions</a>()).<span class="i property">Object</span>;
            <span class="r429 r">mock</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Storage.Queues/A.html#9deade59b6175965" class="t t">QueueClient</a>&gt;(<b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">&quot;https://test/test&quot;</span>), <a href="Shared/StorageTestBase.cs.html#208f01e6ed6a7f0c" class="i method">GetOAuthCredential</a>(<a href="Shared/StorageTestBase.cs.html#cc52c33c34e7c8bb" class="i property">TestConfigHierarchicalNamespace</a>), <b>new</b> <a href="/Azure.Storage.Queues/A.html#caf635c5e2c31a14" class="t constructor">QueueClientOptions</a>()).<span class="i property">Object</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
