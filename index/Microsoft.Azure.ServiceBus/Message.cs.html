<!DOCTYPE html>
<html><head><title>Message.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(528);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.ServiceBus/Message.cs" target="_top">Message.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.ServiceBus" target="_top">Microsoft.Azure.ServiceBus.csproj</a> (Microsoft.Azure.ServiceBus)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft. All rights reserved.</span>
<span class="c">// Licensed under the MIT license. See LICENSE file in the project root for full license information.</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">ServiceBus</span>
{
    <b>using</b> <span class="i">System</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Globalization</span>;
    <b>using</b> <span class="i n">Primitives</span>;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The message object used to communicate and transfer data with Service Bus.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The message structure is discussed in detail in the </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messages-payloads</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">product documentation.</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>public class</b> <a id="74fc1aa4fea2b013" href="R/74fc1aa4fea2b013.html" target="n" data-glyph="0,0" class="t t">Message</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User property key representing deadletter reason, when a message is received from a deadletter subqueue of an entity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="f8337eba84cf2718" href="R/f8337eba84cf2718.html" target="n" data-glyph="42,1" class="i field">DeadLetterReasonHeader</a> = <span class="s">&quot;DeadLetterReason&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User property key representing detailed error description, when a message is received from a deadletter subqueue of an entity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="77490be2b6436241" href="R/77490be2b6436241.html" target="n" data-glyph="42,1" class="i field">DeadLetterErrorDescriptionHeader</a> = <span class="s">&quot;DeadLetterErrorDescription&quot;</span>;
 
        <b>private string</b> <a id="2e974252a25e4352" href="R/2e974252a25e4352.html" target="n" data-glyph="46,1" class="i field">messageId</a>;
        <b>private string</b> <a id="fe107431d575ba33" href="R/fe107431d575ba33.html" target="n" data-glyph="46,1" class="i field">sessionId</a>;
        <b>private string</b> <a id="3ce0bd897119e86a" href="R/3ce0bd897119e86a.html" target="n" data-glyph="46,1" class="i field">replyToSessionId</a>;
        <b>private string</b> <a id="729eeef32075aea0" href="R/729eeef32075aea0.html" target="n" data-glyph="46,1" class="i field">partitionKey</a>;
        <b>private string</b> <a id="018b273095556409" href="R/018b273095556409.html" target="n" data-glyph="46,1" class="i field">viaPartitionKey</a>;
        <b>private</b> <span class="i">TimeSpan</span> <a id="702d2222005de1a9" href="R/702d2222005de1a9.html" target="n" data-glyph="46,1" class="i field">timeToLive</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new Message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="379f568509e4e751" href="R/379f568509e4e751.html" target="n" data-glyph="72,1" class="t constructor">Message</a>()
            : <a href="#34ffdc4ca7851379" class="k">this</a>(<b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new message from the specified payload.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The payload of the message in bytes</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="34ffdc4ca7851379" href="R/34ffdc4ca7851379.html" target="n" data-glyph="72,1" class="t constructor">Message</a>(<b>byte</b>[] <span id="r0 rd" class="r0 r">body</span>)
        {
            <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#9112b84aac32afc0" class="i property">Body</a> = <span class="r0 r">body</span>;
            <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#5b973fca03337aea" class="i property">SystemProperties</a> = <b>new</b> <span class="t">SystemPropertiesCollection</span>();
            <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#f726ec22859aa013" class="i property">UserProperties</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the body of the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The easiest way to create a new message from a string is the following:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> message.Body = System.Text.Encoding.UTF8.GetBytes(&quot;Message1&quot;);</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public byte</b>[] <a id="9112b84aac32afc0" href="R/9112b84aac32afc0.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the MessageId to identify the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    The message identifier is an application-defined value that uniquely identifies the</span>
        <span class="c">///</span><span class="c">    message and its payload. The identifier is a free-form string and can reflect a GUID</span>
        <span class="c">///</span><span class="c">    or an identifier derived from the application context. If enabled, the</span>
        <span class="c">///</span><span class="c">    </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">duplicate detection</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    feature identifies and removes second and further submissions of messages with the</span>
        <span class="c">///</span><span class="c">    same MessageId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="6b02c9ff5b03ba9c" href="R/6b02c9ff5b03ba9c.html" target="n" data-glyph="102,1" class="i property">MessageId</a>
        {
            <b>get</b> =&gt; <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#2e974252a25e4352" class="i field">messageId</a>;
 
            <b>set</b>
            {
                <a href="#74fc1aa4fea2b013" class="t t">Message</a>.<a href="#f5b1f2f06794b23f" class="i method">ValidateMessageId</a>(<b>value</b>);
                <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#2e974252a25e4352" class="i field">messageId</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets a partition key for sending a message to a partitioned entity.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The partition key. Maximum length is 128 characters.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    For </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">partitioned entities</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c">    setting this value enables assigning related messages to the same internal partition, so that submission sequence</span>
        <span class="c">///</span><span class="c">    order is correctly recorded. The partition is chosen by a hash function over this value and cannot be chosen</span>
        <span class="c">///</span><span class="c">    directly. For session-aware entities, the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#688c80d5d9a7e2b3" class="i property">SessionId</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> property overrides this value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="99fb27efd92a94d4" href="R/99fb27efd92a94d4.html" target="n" data-glyph="102,1" class="i property">PartitionKey</a>
        {
            <b>get</b> =&gt; <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#729eeef32075aea0" class="i field">partitionKey</a>;
 
            <b>set</b>
            {
                <b>if</b> (<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#fe107431d575ba33" class="i field">sessionId</a> != <b>null</b> &amp;&amp; <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#fe107431d575ba33" class="i field">sessionId</a> != <b>value</b>)
                {
                    <span class="c">// SessionId is set. Then partition key must be same as session id.</span>
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">$&quot;</span><span class="s">PartitionKey:</span>{<b>value</b>}<span class="s"> is not same as SessionId:</span>{<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#fe107431d575ba33" class="i field">sessionId</a>}<span class="s">&quot;</span>);
                }
 
                <a href="#74fc1aa4fea2b013" class="t t">Message</a>.<a href="#2042dba6907c2cb5" class="i method">ValidatePartitionKey</a>(<b>nameof</b>(<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#99fb27efd92a94d4" class="i property">PartitionKey</a>), <b>value</b>);
                <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#729eeef32075aea0" class="i field">partitionKey</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets a partition key for sending a message into an entity via a partitioned transfer queue.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The partition key. Maximum length is 128 characters. </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    If a message is sent via a transfer queue in the scope of a transaction, this value selects the</span>
        <span class="c">///</span><span class="c">    transfer queue partition: This is functionally equivalent to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#99fb27efd92a94d4" class="i property">PartitionKey</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and ensures that</span>
        <span class="c">///</span><span class="c">    messages are kept together and in order as they are transferred.</span>
        <span class="c">///</span><span class="c">    See </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions#transfers-and-send-via</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Transfers and Send Via</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="187ce45c7e8dca5c" href="R/187ce45c7e8dca5c.html" target="n" data-glyph="102,1" class="i property">ViaPartitionKey</a>
        {
            <b>get</b> =&gt; <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#018b273095556409" class="i field">viaPartitionKey</a>;
 
            <b>set</b>
            {
                <a href="#74fc1aa4fea2b013" class="t t">Message</a>.<a href="#2042dba6907c2cb5" class="i method">ValidatePartitionKey</a>(<b>nameof</b>(<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#187ce45c7e8dca5c" class="i property">ViaPartitionKey</a>), <b>value</b>);
                <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#018b273095556409" class="i field">viaPartitionKey</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the session identifier for a session-aware entity.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The session identifier. Maximum length is 128 characters.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    For session-aware entities, this application-defined value specifies the session</span>
        <span class="c">///</span><span class="c">    affiliation of the message. Messages with the same session identifier are subject</span>
        <span class="c">///</span><span class="c">    to summary locking and enable exact in-order processing and demultiplexing.</span>
        <span class="c">///</span><span class="c">    For session-unaware entities, this value is ignored.</span>
        <span class="c">///</span><span class="c">    See </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/message-sessions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Message Sessions</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="688c80d5d9a7e2b3" href="R/688c80d5d9a7e2b3.html" target="n" data-glyph="102,1" class="i property">SessionId</a>
        {
            <b>get</b> =&gt; <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#fe107431d575ba33" class="i field">sessionId</a>;
 
            <b>set</b>
            {
                <a href="#74fc1aa4fea2b013" class="t t">Message</a>.<a href="#9c3b6b8cfd9ba46e" class="i method">ValidateSessionId</a>(<b>nameof</b>(<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#688c80d5d9a7e2b3" class="i property">SessionId</a>), <b>value</b>);
                <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#fe107431d575ba33" class="i field">sessionId</a> = <b>value</b>;
                <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#99fb27efd92a94d4" class="i property">PartitionKey</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets a session identifier augmenting the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#8c13af32acaa929e" class="i property">ReplyTo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> address.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Session identifier. Maximum length is 128 characters.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    This value augments the ReplyTo information and specifies which SessionId should be set</span>
        <span class="c">///</span><span class="c">    for the reply when sent to the reply entity. See </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messages-payloads?#message-routing-and-correlation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Message Routing and Correlation</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4a2665cd09957cda" href="R/4a2665cd09957cda.html" target="n" data-glyph="102,1" class="i property">ReplyToSessionId</a>
        {
            <b>get</b> =&gt; <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#3ce0bd897119e86a" class="i field">replyToSessionId</a>;
 
            <b>set</b>
            {
                <a href="#74fc1aa4fea2b013" class="t t">Message</a>.<a href="#9c3b6b8cfd9ba46e" class="i method">ValidateSessionId</a>(<b>nameof</b>(<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#4a2665cd09957cda" class="i property">ReplyToSessionId</a>), <b>value</b>);
                <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#3ce0bd897119e86a" class="i field">replyToSessionId</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets the date and time in UTC at which the message is set to expire.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The message expiration time in UTC. This property is read-only.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the message has not been received. For example if a new message was created but not yet sent and received.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">  The UTC instant at which the message is marked for removal and no longer available for retrieval</span>
        <span class="c">///</span><span class="c">  from the entity due to expiration. Expiry is controlled by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2cbf67727511a1ad" class="i property">TimeToLive</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> property</span>
        <span class="c">///</span><span class="c">  and this property is computed from </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#9fe6ce8ee2f258bb" class="t t">SystemPropertiesCollection</a>.<a href="#38b823078b10edb6" class="i property">EnqueuedTimeUtc</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">+</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2cbf67727511a1ad" class="i property">TimeToLive</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span> <a id="38424ead5055b882" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ExpiresAtUtc</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#2cbf67727511a1ad" class="i property">TimeToLive</a> &gt;= <span class="i">DateTime</span>.<span class="i">MaxValue</span>.<span class="i">Subtract</span>(<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#5b973fca03337aea" class="i property">SystemProperties</a>.<a href="#38b823078b10edb6" class="i property">EnqueuedTimeUtc</a>))
                {
                    <b>return</b> <span class="i">DateTime</span>.<span class="i">MaxValue</span>;
                }
 
                <b>return</b> <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#5b973fca03337aea" class="i property">SystemProperties</a>.<a href="#38b823078b10edb6" class="i property">EnqueuedTimeUtc</a>.<span class="i">Add</span>(<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#2cbf67727511a1ad" class="i property">TimeToLive</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the message’s &quot;time to live&quot; value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The message’s time to live value.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     This value is the relative duration after which the message expires, starting from the instant</span>
        <span class="c">///</span><span class="c">      the message has been accepted and stored by the broker, as captured in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#9fe6ce8ee2f258bb" class="t t">SystemPropertiesCollection</a>.<a href="#38b823078b10edb6" class="i property">EnqueuedTimeUtc</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c">      When not set explicitly, the assumed value is the DefaultTimeToLive for the respective queue or topic.</span>
        <span class="c">///</span><span class="c">      A message-level </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2cbf67727511a1ad" class="i property">TimeToLive</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> value cannot be longer than the entity&#39;s DefaultTimeToLive</span>
        <span class="c">///</span><span class="c">      setting and it is silently adjusted if it does.</span>
        <span class="c">///</span><span class="c">      See </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/message-expiration</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Expiration</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeSpan</span> <a id="2cbf67727511a1ad" href="R/2cbf67727511a1ad.html" target="n" data-glyph="102,1" class="i property">TimeToLive</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#702d2222005de1a9" class="i field">timeToLive</a> == <span class="i">TimeSpan</span>.<span class="i">Zero</span>)
                {
                    <b>return</b> <span class="i">TimeSpan</span>.<span class="i">MaxValue</span>;
                }
 
                <b>return</b> <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#702d2222005de1a9" class="i field">timeToLive</a>;
            }
 
            <b>set</b>
            {
                <a href="Primitives/TimeoutHelper.cs.html#a61b449000b5ed05" class="t t">TimeoutHelper</a>.<a href="Primitives/TimeoutHelper.cs.html#b36475a753c8ebc1" class="i method">ThrowIfNonPositiveArgument</a>(<b>value</b>);
                <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#702d2222005de1a9" class="i field">timeToLive</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the a correlation identifier.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Correlation identifier.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    Allows an application to specify a context for the message for the purposes of correlation,</span>
        <span class="c">///</span><span class="c">    for example reflecting the MessageId of a message that is being replied to.</span>
        <span class="c">///</span><span class="c">    See </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messages-payloads?#message-routing-and-correlation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Message Routing and Correlation</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="650c824825def993" href="R/650c824825def993.html" target="n" data-glyph="102,1" class="i property">CorrelationId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets an application specific label.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The application specific label</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   This property enables the application to indicate the purpose of the message to the receiver in a standardized</span>
        <span class="c">///</span><span class="c">   fashion, similar to an email subject line. The mapped AMQP property is &quot;subject&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="754634e7bae5f519" href="R/754634e7bae5f519.html" target="n" data-glyph="102,1" class="i property">Label</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the &quot;to&quot; address.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The &quot;to&quot; address.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    This property is reserved for future use in routing scenarios and presently ignored by the broker itself.</span>
        <span class="c">///</span><span class="c">     Applications can use this value in rule-driven</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/service-bus-auto-forwarding</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">auto-forward chaining</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c"> scenarios to indicate the</span>
        <span class="c">///</span><span class="c">     intended logical destination of the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="968d4b82bf35f6fa" href="R/968d4b82bf35f6fa.html" target="n" data-glyph="102,1" class="i property">To</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the content type descriptor.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">RFC2045 Content-Type descriptor.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Optionally describes the payload of the message, with a descriptor following the format of</span>
        <span class="c">///</span><span class="c">   RFC2045, Section 5, for example &quot;application/json&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b7770525137dd253" href="R/b7770525137dd253.html" target="n" data-glyph="102,1" class="i property">ContentType</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the address of an entity to send replies to.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The reply entity address.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    This optional and application-defined value is a standard way to express a reply path</span>
        <span class="c">///</span><span class="c">    to the receiver of the message. When a sender expects a reply, it sets the value to the</span>
        <span class="c">///</span><span class="c">    absolute or relative path of the queue or topic it expects the reply to be sent to.</span>
        <span class="c">///</span><span class="c">    See </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messages-payloads?#message-routing-and-correlation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Message Routing and Correlation</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="8c13af32acaa929e" href="R/8c13af32acaa929e.html" target="n" data-glyph="102,1" class="i property">ReplyTo</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the date and time in UTC at which the message will be enqueued. This</span>
        <span class="c">///</span><span class="c"> property returns the time in UTC; when setting the property, the supplied DateTime value must also be in UTC.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The scheduled enqueue time in UTC. This value is for delayed message sending.</span>
        <span class="c">///</span><span class="c"> It is utilized to delay messages sending to a specific time in the future.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c"> Message enqueuing time does not mean that the message will be sent at the same time. It will get enqueued, but the actual sending time</span>
        <span class="c">///</span><span class="c"> depends on the queue&#39;s workload and its state.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span> <a id="aacdc857896898c5" href="R/aacdc857896898c5.html" target="n" data-glyph="102,1" class="i property">ScheduledEnqueueTimeUtc</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">// TODO: Calculate the size of the properties and body</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the total size of the message body in bytes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public long</b> <a id="45d65b4f9d0e1317" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Size</a> =&gt; <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#9112b84aac32afc0" class="i property">Body</a> != <b>null</b> ? <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#9112b84aac32afc0" class="i property">Body</a>.<span class="i">Length</span> : 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the &quot;user properties&quot; bag, which can be used for custom message metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Only following value types are supported:</span>
        <span class="c">///</span><span class="c"> byte, sbyte, char, short, ushort, int, uint, long, ulong, float, double, decimal,</span>
        <span class="c">///</span><span class="c"> bool, Guid, string, Uri, DateTime, DateTimeOffset, TimeSpan</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IDictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <a id="f726ec22859aa013" href="R/f726ec22859aa013.html" target="n" data-glyph="102,1" class="i property">UserProperties</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#9fe6ce8ee2f258bb" class="t t">SystemPropertiesCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, which is used to store properties that are set by the system.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#9fe6ce8ee2f258bb" class="t t">SystemPropertiesCollection</a> <a id="5b973fca03337aea" href="R/5b973fca03337aea.html" target="n" data-glyph="102,1" class="i property">SystemProperties</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Returns a string that represents the current message.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the current message.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="2d97a64dd7d84825" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;{{MessageId:{0}}}&quot;</span>, <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#6b02c9ff5b03ba9c" class="i property">MessageId</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Clones a message, so that it is possible to send a clone of an already received</span>
        <span class="c">///</span><span class="c"> message as a new message. The system properties of original message</span>
        <span class="c">///</span><span class="c"> are not copied.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A cloned </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#74fc1aa4fea2b013" class="t t">Message</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#74fc1aa4fea2b013" class="t t">Message</a> <a id="4fdb95a2114fe941" href="R/4fdb95a2114fe941.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#74fc1aa4fea2b013" class="k">var</a> <span id="r1 rd" class="r1 r">clone</span> = (<a href="#74fc1aa4fea2b013" class="t t">Message</a>)<a href="#74fc1aa4fea2b013" class="k">this</a>.<span class="i">MemberwiseClone</span>();
            <span class="r1 r">clone</span>.<a href="#5b973fca03337aea" class="i property">SystemProperties</a> = <b>new</b> <span class="t">SystemPropertiesCollection</span>();
 
            <b>if</b> (<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#9112b84aac32afc0" class="i property">Body</a> != <b>null</b>)
            {
                <b>var</b> <span id="r2 rd" class="r2 r">clonedBody</span> = <b>new</b> <b>byte</b>[<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#9112b84aac32afc0" class="i property">Body</a>.<span class="i">Length</span>];
                <span class="i">Array</span>.<span class="i">Copy</span>(<a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#9112b84aac32afc0" class="i property">Body</a>, <span class="r2 r">clonedBody</span>, <a href="#74fc1aa4fea2b013" class="k">this</a>.<a href="#9112b84aac32afc0" class="i property">Body</a>.<span class="i">Length</span>);
                <span class="r1 r">clone</span>.<a href="#9112b84aac32afc0" class="i property">Body</a> = <span class="r2 r">clonedBody</span>;
            }
            <b>return</b> <span class="r1 r">clone</span>;
        }
 
        <b>private static void</b> <a id="f5b1f2f06794b23f" href="R/f5b1f2f06794b23f.html" target="n" data-glyph="76,1" class="i method">ValidateMessageId</a>(<b>string</b> <span id="r3 rd" class="r3 r">messageId</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r3 r">messageId</span>) ||
                <span class="r3 r">messageId</span>.<span class="i">Length</span> &gt; <a href="Constants.cs.html#6e9a057faa1690df" class="t t">Constants</a>.<a href="Constants.cs.html#cfdb79b88d4cf5ec" class="i field">MaxMessageIdLength</a>)
            {
                <span class="c">// TODO: throw FxTrace.Exception.Argument(&quot;messageId&quot;, SRClient.MessageIdIsNullOrEmptyOrOverMaxValue(Constants.MaxMessageIdLength));</span>
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="s">&quot;MessageIdIsNullOrEmptyOrOverMaxValue&quot;</span>);
            }
        }
 
        <b>private static void</b> <a id="9c3b6b8cfd9ba46e" href="R/9c3b6b8cfd9ba46e.html" target="n" data-glyph="76,1" class="i method">ValidateSessionId</a>(<b>string</b> <span id="r4 rd" class="r4 r">sessionIdPropertyName</span>, <b>string</b> <span id="r5 rd" class="r5 r">sessionId</span>)
        {
            <b>if</b> (<span class="r5 r">sessionId</span> != <b>null</b> &amp;&amp; <span class="r5 r">sessionId</span>.<span class="i">Length</span> &gt; <a href="Constants.cs.html#6e9a057faa1690df" class="t t">Constants</a>.<a href="Constants.cs.html#5039ea7522d7ce69" class="i field">MaxSessionIdLength</a>)
            {
                <span class="c">// TODO: throw FxTrace.Exception.Argument(&quot;sessionId&quot;, SRClient.SessionIdIsOverMaxValue(Constants.MaxSessionIdLength));</span>
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="s">&quot;SessionIdIsOverMaxValue&quot;</span>);
            }
        }
 
        <b>private static void</b> <a id="2042dba6907c2cb5" href="R/2042dba6907c2cb5.html" target="n" data-glyph="76,1" class="i method">ValidatePartitionKey</a>(<b>string</b> <span id="r6 rd" class="r6 r">partitionKeyPropertyName</span>, <b>string</b> <span id="r7 rd" class="r7 r">partitionKey</span>)
        {
            <b>if</b> (<span class="r7 r">partitionKey</span> != <b>null</b> &amp;&amp; <span class="r7 r">partitionKey</span>.<span class="i">Length</span> &gt; <a href="Constants.cs.html#6e9a057faa1690df" class="t t">Constants</a>.<a href="Constants.cs.html#c2820ef5da6e51a8" class="i field">MaxPartitionKeyLength</a>)
            {
                <span class="c">// TODO: throw FxTrace.Exception.Argument(partitionKeyPropertyName, SRClient.PropertyOverMaxValue(partitionKeyPropertyName, Constants.MaxPartitionKeyLength));</span>
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="s">&quot;PropertyValueOverMaxValue&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection used to store properties which are set by the Service Bus service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public sealed class</b> <a id="9fe6ce8ee2f258bb" href="R/9fe6ce8ee2f258bb.html" target="n" data-glyph="0,1" class="t t"><span id="d28a04bed5f05958">SystemPropertiesCollection</span></a>
        {
            <b>int</b> <a id="3f87ce6167b77175" href="R/3f87ce6167b77175.html" target="n" data-glyph="46,2" class="i field">deliveryCount</a>;
            <span class="i">DateTime</span> <a id="adae74e9e274ce56" href="R/adae74e9e274ce56.html" target="n" data-glyph="46,2" class="i field">lockedUntilUtc</a>;
            <b>long</b> <a id="bfde116f8decf61a" href="R/bfde116f8decf61a.html" target="n" data-glyph="46,2" class="i field">sequenceNumber</a> = -1;
            <b>short</b> <a id="ed3094d7d9a9efa9" href="R/ed3094d7d9a9efa9.html" target="n" data-glyph="46,2" class="i field">partitionId</a>;
            <b>long</b> <a id="6d4d183d376a23f3" href="R/6d4d183d376a23f3.html" target="n" data-glyph="46,2" class="i field">enqueuedSequenceNumber</a>;
            <span class="i">DateTime</span> <a id="b905bd8337d63222" href="R/b905bd8337d63222.html" target="n" data-glyph="46,2" class="i field">enqueuedTimeUtc</a>;
            <span class="i">Guid</span> <a id="76db843a60b01b22" href="R/76db843a60b01b22.html" target="n" data-glyph="46,2" class="i field">lockTokenGuid</a>;
            <b>string</b> <a id="4539f6d2f6c75ac3" href="R/4539f6d2f6c75ac3.html" target="n" data-glyph="46,2" class="i field">deadLetterSource</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Specifies whether or not there is a lock token set on the current message.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">A lock token will only be specified if the message was received using </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ReceiveMode.cs.html#103867a98d0233a8" class="t t">ReceiveMode</a>.<a href="ReceiveMode.cs.html#d43dbf05f584f89c" class="i field">PeekLock</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public bool</b> <a id="b123973da7ab0969" href="R/b123973da7ab0969.html" target="n" data-glyph="102,2" class="i property">IsLockTokenSet</a> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#76db843a60b01b22" class="i field">lockTokenGuid</a> != <b>default</b>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the lock token for the current message.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c">   The lock token is a reference to the lock that is being held by the broker in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ReceiveMode.cs.html#103867a98d0233a8" class="t t">ReceiveMode</a>.<a href="ReceiveMode.cs.html#d43dbf05f584f89c" class="i field">PeekLock</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> mode.</span>
            <span class="c">///</span><span class="c">   Locks are used to explicitly settle messages as explained in the </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/message-transfers-locks-settlement</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">product documentation in more detail</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c">.</span>
            <span class="c">///</span><span class="c">   The token can also be used to pin the lock permanently through the </span><span class="c">&lt;</span><span class="c">a</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/azure/service-bus-messaging/message-deferral</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Deferral API</span><span class="c">&lt;/</span><span class="c">a</span><span class="c">&gt;</span><span class="c"> and, with that, take the message out of the</span>
            <span class="c">///</span><span class="c">   regular delivery state flow. This property is read-only.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public string</b> <a id="df44fd4ab3d58bb5" href="R/df44fd4ab3d58bb5.html" target="n" data-glyph="102,2" class="i property">LockToken</a> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#d355cdb91572a232" class="i property">LockTokenGuid</a>.<span class="i">ToString</span>();
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Specifies if the message has been obtained from the broker.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public bool</b> <a id="b5e0f773ff3adb20" href="R/b5e0f773ff3adb20.html" target="n" data-glyph="102,2" class="i property">IsReceived</a> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#bfde116f8decf61a" class="i field">sequenceNumber</a> &gt; -1;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Get the current delivery count.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">This value starts at 1.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c">    Number of deliveries that have been attempted for this message. The count is incremented when a message lock expires,</span>
            <span class="c">///</span><span class="c">    or the message is explicitly abandoned by the receiver. This property is read-only.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public int</b> <a id="622acff6cf015d07" href="R/622acff6cf015d07.html" target="n" data-glyph="102,2" class="i property">DeliveryCount</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#3f87ce6167b77175" class="i field">deliveryCount</a>;
                }
 
                <b>internal set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#3f87ce6167b77175" class="i field">deliveryCount</a> = <b>value</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets the date and time in UTC until which the message will be locked in the queue/subscription.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The date and time until which the message will be locked in the queue/subscription.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> 	For messages retrieved under a lock (peek-lock receive mode, not pre-settled) this property reflects the UTC</span>
            <span class="c">///</span><span class="c">     instant until which the message is held locked in the queue/subscription. When the lock expires, the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#622acff6cf015d07" class="i property">DeliveryCount</a><span class="c">&quot;</span><span class="c">/&gt;</span>
            <span class="c">///</span><span class="c">     is incremented and the message is again available for retrieval. This property is read-only.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public</b> <span class="i">DateTime</span> <a id="0acddd863bcf3023" href="R/0acddd863bcf3023.html" target="n" data-glyph="102,2" class="i property">LockedUntilUtc</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#adae74e9e274ce56" class="i field">lockedUntilUtc</a>;
                }
 
                <b>internal set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#adae74e9e274ce56" class="i field">lockedUntilUtc</a> = <b>value</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets the unique number assigned to a message by Service Bus.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c">     The sequence number is a unique 64-bit integer assigned to a message as it is accepted</span>
            <span class="c">///</span><span class="c">     and stored by the broker and functions as its true identifier. For partitioned entities,</span>
            <span class="c">///</span><span class="c">     the topmost 16 bits reflect the partition identifier. Sequence numbers monotonically increase.</span>
            <span class="c">///</span><span class="c">     They roll over to 0 when the 48-64 bit range is exhausted. This property is read-only.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public long</b> <a id="205df32693f7a775" href="R/205df32693f7a775.html" target="n" data-glyph="102,2" class="i property">SequenceNumber</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#bfde116f8decf61a" class="i field">sequenceNumber</a>;
                }
 
                <b>internal set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#bfde116f8decf61a" class="i field">sequenceNumber</a> = <b>value</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the name of the queue or subscription that this message was enqueued on, before it was deadlettered.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> 	Only set in messages that have been dead-lettered and subsequently auto-forwarded from the dead-letter queue</span>
            <span class="c">///</span><span class="c">     to another entity. Indicates the entity in which the message was dead-lettered. This property is read-only.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public string</b> <a id="feca7bb28a0bab7a" href="R/feca7bb28a0bab7a.html" target="n" data-glyph="102,2" class="i property">DeadLetterSource</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#4539f6d2f6c75ac3" class="i field">deadLetterSource</a>;
                }
 
                <b>internal set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#4539f6d2f6c75ac3" class="i field">deadLetterSource</a> = <b>value</b>;
            }
 
            <b>internal short</b> <a id="965b70f6b1b8b3a8" href="R/965b70f6b1b8b3a8.html" target="n" data-glyph="104,2" class="i property">PartitionId</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#ed3094d7d9a9efa9" class="i field">partitionId</a>;
                }
 
                <b>set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#ed3094d7d9a9efa9" class="i field">partitionId</a> = <b>value</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the original sequence number of the message.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The enqueued sequence number of the message.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> For messages that have been auto-forwarded, this property reflects the sequence number</span>
            <span class="c">///</span><span class="c"> that had first been assigned to the message at its original point of submission. This property is read-only.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public long</b> <a id="738529f92d545a99" href="R/738529f92d545a99.html" target="n" data-glyph="102,2" class="i property">EnqueuedSequenceNumber</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#6d4d183d376a23f3" class="i field">enqueuedSequenceNumber</a>;
                }
 
                <b>internal set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#6d4d183d376a23f3" class="i field">enqueuedSequenceNumber</a> = <b>value</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Gets or sets the date and time of the sent time in UTC.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The enqueue time in UTC. </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c">    The UTC instant at which the message has been accepted and stored in the entity.</span>
            <span class="c">///</span><span class="c">    This value can be used as an authoritative and neutral arrival time indicator when</span>
            <span class="c">///</span><span class="c">    the receiver does not want to trust the sender&#39;s clock. This property is read-only.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>public</b> <span class="i">DateTime</span> <a id="38b823078b10edb6" href="R/38b823078b10edb6.html" target="n" data-glyph="102,2" class="i property">EnqueuedTimeUtc</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#b905bd8337d63222" class="i field">enqueuedTimeUtc</a>;
                }
 
                <b>internal set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#b905bd8337d63222" class="i field">enqueuedTimeUtc</a> = <b>value</b>;
            }
 
            <b>internal</b> <span class="i">Guid</span> <a id="d355cdb91572a232" href="R/d355cdb91572a232.html" target="n" data-glyph="104,2" class="i property">LockTokenGuid</a>
            {
                <b>get</b>
                {
                    <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#9350bbe778d7818f" class="i method">ThrowIfNotReceived</a>();
                    <b>return</b> <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#76db843a60b01b22" class="i field">lockTokenGuid</a>;
                }
 
                <b>set</b> =&gt; <a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#76db843a60b01b22" class="i field">lockTokenGuid</a> = <b>value</b>;
            }
 
            <b>internal object</b> <a id="58017714256a1c78" href="R/58017714256a1c78.html" target="n" data-glyph="104,2" class="i property">BodyObject</a>
            {
                <b>get</b>;
                <b>set</b>;
            }
 
            <b>void</b> <a id="9350bbe778d7818f" href="R/9350bbe778d7818f.html" target="n" data-glyph="76,2" class="i method">ThrowIfNotReceived</a>()
            {
                <b>if</b> (!<a href="#9fe6ce8ee2f258bb" class="k">this</a>.<a href="#b5e0f773ff3adb20" class="i property">IsReceived</a>)
                {
                    <b>throw</b> <a href="Primitives/Fx.cs.html#c01e8844709e19c1" class="t t">Fx</a>.<a href="Primitives/Fx.cs.html#0793cb830fb5b201" class="i property">Exception</a>.<span class="i">AsError</span>(<b>new</b> <span class="i">InvalidOperationException</span>());
                }
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
