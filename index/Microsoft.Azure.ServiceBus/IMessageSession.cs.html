<!DOCTYPE html>
<html><head><title>IMessageSession.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(66);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.ServiceBus/IMessageSession.cs" target="_top">IMessageSession.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.ServiceBus" target="_top">Microsoft.Azure.ServiceBus.csproj</a> (Microsoft.Azure.ServiceBus)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft. All rights reserved.</span>
<span class="c">// Licensed under the MIT license. See LICENSE file in the project root for full license information.</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">ServiceBus</span>
{
    <b>using</b> <span class="i">System</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
    <b>using</b> <span class="i n">Core</span>;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Describes a Session object. IMessageSession can be used to perform operations on sessions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Service Bus Sessions, also called &#39;Groups&#39; in the AMQP 1.0 protocol, are unbounded sequences of related messages. ServiceBus guarantees ordering of messages in a session.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Any sender can create a session when submitting messages into a Topic or Queue by setting the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Message.cs.html#74fc1aa4fea2b013" class="t t">Message</a>.<a href="Message.cs.html#688c80d5d9a7e2b3" class="i property">SessionId</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> property on Message to some</span>
    <span class="c">///</span><span class="c"> application defined unique identifier. At the AMQP 1.0 protocol level, this value maps to the group-id property.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Sessions come into existence when there is at least one message with the session&#39;s SessionId in the Queue or Topic subscription.</span>
    <span class="c">///</span><span class="c"> Once a Session exists, there is no defined moment or gesture for when the session expires or disappears.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>public interface</b> <a id="c8efbd26d5c7c9bd" href="R/c8efbd26d5c7c9bd.html" target="n" data-glyph="48,0" class="t t">IMessageSession</a> : <a href="Core/IMessageReceiver.cs.html#d29af89efe5d7233" class="t t">IMessageReceiver</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the SessionId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b> <a id="f8d2be0dbd369bb5" href="R/f8d2be0dbd369bb5.html" target="n" data-glyph="102,1" class="i property">SessionId</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the time that the session identified by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f8d2be0dbd369bb5" class="i property">SessionId</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is locked until for this client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i">DateTime</span> <a id="9ce489c350b9d969" href="R/9ce489c350b9d969.html" target="n" data-glyph="102,1" class="i property">LockedUntilUtc</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The session state as byte array.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="i">Task</span>&lt;<b>byte</b>[]&gt; <a id="0d0532098d7e00bb" href="R/0d0532098d7e00bb.html" target="n" data-glyph="72,1" class="i method">GetStateAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set a custom state on the session which can be later retrieved using </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0d0532098d7e00bb" class="i method">GetStateAsync</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">sessionState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A byte array of session state</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This state is stored on Service Bus forever unless you set an empty state on it.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="i">Task</span> <a id="94b5c6ac28b490dd" href="R/94b5c6ac28b490dd.html" target="n" data-glyph="72,1" class="i method">SetStateAsync</a>(<b>byte</b>[] <span id="r0 rd" class="r0 r">sessionState</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Renews the lock on the session specified by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f8d2be0dbd369bb5" class="i property">SessionId</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">. The lock will be renewed based on the setting specified on the entity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When you accept a session, the session is locked for this client instance by the service for a duration as specified during the Queue/Subscription creation.</span>
        <span class="c">///</span><span class="c"> If processing of the session requires longer than this duration, the session-lock needs to be renewed. </span>
        <span class="c">///</span><span class="c"> For each renewal, it resets the time the session is locked by the LockDuration set on the Entity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Renewal of session renews all the messages in the session as well. Each individual message need not be renewed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="i">Task</span> <a id="de5d788979575170" href="R/de5d788979575170.html" target="n" data-glyph="72,1" class="i method">RenewSessionLockAsync</a>();
    }
}</pre></td></tr></table></div></body></html>
