<!DOCTYPE html>
<html><head><title>QueuesOptions.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(199);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.Storage.Blobs/Shared/Queues/QueuesOptions.cs" target="_top">Shared\Queues\QueuesOptions.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.Storage.Blobs" target="_top">Microsoft.Azure.WebJobs.Extensions.Storage.Blobs.csproj</a> (Microsoft.Azure.WebJobs.Extensions.Storage.Blobs)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Storage</span>.<span class="i n">Queues</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Extensions</span>.<span class="i n">Storage</span>.<span class="i n">Common</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Extensions</span>.<span class="i n">Storage</span>.<span class="i n">Common</span>.<span class="i n">Listeners</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Hosting</span>;
<b>using</b> <span class="i n">Newtonsoft</span>.<span class="i n">Json</span>;
<b>using</b> <span class="i n">Newtonsoft</span>.<span class="i n">Json</span>.<span class="i n">Linq</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Host</span>
{
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">STORAGE_WEBJOBS_PUBLIC_QUEUE_PROCESSOR</span>
<span class="e">    /// &lt;summary&gt;
    /// Represents configuration for &lt;see cref=&quot;QueueTriggerAttribute&quot;/&gt;.
    /// &lt;/summary&gt;
    public class QueuesOptions : IOptionsFormatter
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
    <b>internal class</b> <a id="10aa607ae6dd925f" href="../../R/10aa607ae6dd925f.html" target="n" data-glyph="2,0" class="t t">QueuesOptions</a> : <span class="t t">IOptionsFormatter</span>
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
    {
        <b>private const int</b> <a id="75fcdd9bdcc86ea8" href="../../R/75fcdd9bdcc86ea8.html" target="n" data-glyph="10,1" class="i field">DefaultMaxDequeueCount</a> = 5;
        <b>private const int</b> <a id="f18d520237aa632f" href="../../R/f18d520237aa632f.html" target="n" data-glyph="10,1" class="i field">DefaultBatchSize</a> = 16;
 
        <span class="c">// Azure Queues currently limits the number of messages retrieved to 32. We enforce this constraint here because</span>
        <span class="c">// the runtime error message the user would receive from the SDK otherwise is not as helpful.</span>
        <b>internal const int</b> <a id="7569e93fb4455785" href="../../R/7569e93fb4455785.html" target="n" data-glyph="8,1" class="i field">MaxBatchSize</a> = 32;
 
        <b>private int</b> <a id="6285748ce20c1017" href="../../R/6285748ce20c1017.html" target="n" data-glyph="46,1" class="i field">_batchSize</a> = <a href="#f18d520237aa632f" class="i field">DefaultBatchSize</a>;
        <b>private int</b> <a id="255eaf2f30022839" href="../../R/255eaf2f30022839.html" target="n" data-glyph="46,1" class="i field">_newBatchThreshold</a>;
        <b>private int</b> <a id="1c649db1e22aa58a" href="../../R/1c649db1e22aa58a.html" target="n" data-glyph="46,1" class="i field">_processorCount</a> = 1;
        <b>private</b> <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="75e996e6424f6ebd" href="../../R/75e996e6424f6ebd.html" target="n" data-glyph="46,1" class="i field">_maxPollingInterval</a> = <a href="QueuePollingIntervals.cs.html#790f6baff96d05cf" class="t t">QueuePollingIntervals</a>.<a href="QueuePollingIntervals.cs.html#9d6826b071ea2ae0" class="i field">DefaultMaximum</a>;
        <b>private</b> <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="a7b0c6c959404d79" href="../../R/a7b0c6c959404d79.html" target="n" data-glyph="46,1" class="i field">_visibilityTimeout</a> = <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@1@netstandard/A.html#225346b4cd3a8300" class="i field">Zero</a>;
        <b>private int</b> <a id="2235135cb0876529" href="../../R/2235135cb0876529.html" target="n" data-glyph="46,1" class="i field">_maxDequeueCount</a> = <a href="#75fcdd9bdcc86ea8" class="i field">DefaultMaxDequeueCount</a>;
        <b>private</b> <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a> <a id="eafc689f1ac54299" href="../../R/eafc689f1ac54299.html" target="n" data-glyph="46,1" class="i field">_messageEncoding</a> = <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#10aa607ae6dd925f" class="t t">QueuesOptions</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="e2bcbaa6723fbf57" href="../../R/e2bcbaa6723fbf57.html" target="n" data-glyph="72,1" class="t constructor">QueuesOptions</a>()
        {
            <a href="#255eaf2f30022839" class="i field">_newBatchThreshold</a> = -1;
            <a href="#1c649db1e22aa58a" class="i field">_processorCount</a> = <a href="../SkuUtility.cs.html#7e9b60a36e08ee6c" class="t t">SkuUtility</a>.<a href="../SkuUtility.cs.html#55334d65d78921cb" class="i property">ProcessorCount</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the number of queue messages to retrieve and process in parallel (per job method).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="cff646d56d719788" href="../../R/cff646d56d719788.html" target="n" data-glyph="102,1" class="i property">BatchSize</a>
        {
            <b>get</b> { <b>return</b> <a href="#6285748ce20c1017" class="i field">_batchSize</a>; }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> &lt;= 0)
                {
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#5fec5e06371b1f6c" class="t constructor">ArgumentOutOfRangeException</a>(<b>nameof</b>(<b>value</b>));
                }
 
                <b>if</b> (<b>value</b> &gt; <a href="#7569e93fb4455785" class="i field">MaxBatchSize</a>)
                {
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#5fec5e06371b1f6c" class="t constructor">ArgumentOutOfRangeException</a>(<b>nameof</b>(<b>value</b>));
                }
 
                <a href="#6285748ce20c1017" class="i field">_batchSize</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the threshold at which a new batch of messages will be fetched.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="ca82c7161a128734" href="../../R/ca82c7161a128734.html" target="n" data-glyph="102,1" class="i property">NewBatchThreshold</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#255eaf2f30022839" class="i field">_newBatchThreshold</a> == -1)
                {
                    <span class="c">// if this hasn&#39;t been set explicitly, default it</span>
                    <b>return</b> (<a href="#6285748ce20c1017" class="i field">_batchSize</a> / 2) * <a href="#1c649db1e22aa58a" class="i field">_processorCount</a>;
                }
                <b>return</b> <a href="#255eaf2f30022839" class="i field">_newBatchThreshold</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> &lt; 0)
                {
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#5fec5e06371b1f6c" class="t constructor">ArgumentOutOfRangeException</a>(<b>nameof</b>(<b>value</b>));
                }
 
                <a href="#255eaf2f30022839" class="i field">_newBatchThreshold</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the longest period of time to wait before checking for a message to arrive when a queue remains</span>
        <span class="c">///</span><span class="c"> empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="2e3b51f0a9b1856e" href="../../R/2e3b51f0a9b1856e.html" target="n" data-glyph="102,1" class="i property">MaxPollingInterval</a>
        {
            <b>get</b> { <b>return</b> <a href="#75e996e6424f6ebd" class="i field">_maxPollingInterval</a>; }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> &lt; <a href="QueuePollingIntervals.cs.html#790f6baff96d05cf" class="t t">QueuePollingIntervals</a>.<a href="QueuePollingIntervals.cs.html#ea1808363d9222e0" class="i field">Minimum</a>)
                {
                    <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">message</span> = <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@1@netstandard/A.html#c07c3772222caaff" class="i method">Format</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>,
                        <span class="s">&quot;MaxPollingInterval must not be less than {0}.&quot;</span>, <a href="QueuePollingIntervals.cs.html#790f6baff96d05cf" class="t t">QueuePollingIntervals</a>.<a href="QueuePollingIntervals.cs.html#ea1808363d9222e0" class="i field">Minimum</a>);
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>(<span class="r0 r">message</span>, <b>nameof</b>(<b>value</b>));
                }
 
                <a href="#75e996e6424f6ebd" class="i field">_maxPollingInterval</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the number of times to try processing a message before moving it to the poison queue (where</span>
        <span class="c">///</span><span class="c"> possible).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Some queues do not have corresponding poison queues, and this property does not apply to them. Specifically,</span>
        <span class="c">///</span><span class="c"> there are no corresponding poison queues for any queue whose name already ends in &quot;-poison&quot; or any queue</span>
        <span class="c">///</span><span class="c"> whose name is already too long to add a &quot;-poison&quot; suffix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public int</b> <a id="f232ede31d29f8a9" href="../../R/f232ede31d29f8a9.html" target="n" data-glyph="102,1" class="i property">MaxDequeueCount</a>
        {
            <b>get</b> { <b>return</b> <a href="#2235135cb0876529" class="i field">_maxDequeueCount</a>; }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> &lt; 1)
                {
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>(<span class="s">&quot;MaxDequeueCount must not be less than 1.&quot;</span>, <b>nameof</b>(<b>value</b>));
                }
 
                <a href="#2235135cb0876529" class="i field">_maxDequeueCount</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the default message visibility timeout that will be used</span>
        <span class="c">///</span><span class="c"> for messages that fail processing. The default is TimeSpan.Zero. To increase</span>
        <span class="c">///</span><span class="c"> the time delay between retries, increase this value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When message processing fails, the message will remain in the queue and</span>
        <span class="c">///</span><span class="c"> its visibility will be updated with this value. The message will then be</span>
        <span class="c">///</span><span class="c"> available for reprocessing after this timeout expires.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a> <a id="041b8c417212edfa" href="../../R/041b8c417212edfa.html" target="n" data-glyph="102,1" class="i property">VisibilityTimeout</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a7b0c6c959404d79" class="i field">_visibilityTimeout</a>;
            }
            <b>set</b>
            {
                <a href="#a7b0c6c959404d79" class="i field">_visibilityTimeout</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a message encoding that determines how queue message body is represented in HTTP requests and responses.</span>
        <span class="c">///</span><span class="c"> The default is </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a>.<a href="/Azure.Storage.Queues/A.html#b0b65a9398e83424" class="i field">Base64</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="/Azure.Storage.Queues/A.html#31e6b2022ed645e3" class="t t">QueueMessageEncoding</a> <a id="0c6e672b3236b8fe" href="../../R/0c6e672b3236b8fe.html" target="n" data-glyph="102,1" class="i property">MessageEncoding</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#eafc689f1ac54299" class="i field">_messageEncoding</a>;
            }
            <b>set</b>
            {
                <a href="#eafc689f1ac54299" class="i field">_messageEncoding</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">inheritdoc</span><span class="c">/&gt;</span>
        [<a href="@1@netstandard/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@1@netstandard/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@1@netstandard/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span class="t t">IOptionsFormatter</span>.<span class="i method">Format</span>()
        {
            <span class="t t">JObject</span> <span id="r1 rd" class="r1 r">options</span> = <b>new</b> <span class="t constructor">JObject</span>
            {
                { <b>nameof</b>(<a href="#cff646d56d719788" class="i property">BatchSize</a>), <a href="#cff646d56d719788" class="i property">BatchSize</a> },
                { <b>nameof</b>(<a href="#ca82c7161a128734" class="i property">NewBatchThreshold</a>), <a href="#ca82c7161a128734" class="i property">NewBatchThreshold</a> },
                { <b>nameof</b>(<a href="#2e3b51f0a9b1856e" class="i property">MaxPollingInterval</a>), <a href="#2e3b51f0a9b1856e" class="i property">MaxPollingInterval</a> },
                { <b>nameof</b>(<a href="#f232ede31d29f8a9" class="i property">MaxDequeueCount</a>), <a href="#f232ede31d29f8a9" class="i property">MaxDequeueCount</a> },
                { <b>nameof</b>(<a href="#041b8c417212edfa" class="i property">VisibilityTimeout</a>), <a href="#041b8c417212edfa" class="i property">VisibilityTimeout</a> },
                { <b>nameof</b>(<a href="#0c6e672b3236b8fe" class="i property">MessageEncoding</a>), <a href="#0c6e672b3236b8fe" class="i property">MessageEncoding</a>.<a href="@1@netstandard/A.html#1365cfeffd45409d" class="i method">ToString</a>() }
            };
 
            <b>return</b> <span class="r1 r">options</span>.<span class="i method">ToString</span>(<span class="t t">Formatting</span>.<span class="i field">Indented</span>);
        }
    }
}
</pre></td></tr></table></div></body></html>
