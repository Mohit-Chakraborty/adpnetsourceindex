<!DOCTYPE html>
<html><head><title>BlobStorageTest.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(60);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#SmokeTest/BlobStorageTest.cs" target="_top">BlobStorageTest.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#SmokeTest" target="_top">SmokeTest.csproj</a> (SmokeTest)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// ------------------------------------</span>
<span class="c">// Copyright(c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
<span class="c">// ------------------------------------</span>
<b>using</b> <span class="i">Azure</span>.<span class="i">Storage</span>.<span class="i">Blobs</span>;
<b>using</b> <span class="i">Azure</span>.<span class="i">Storage</span>.<span class="i">Blobs</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
 
<b>namespace</b> <span class="i n">SmokeTest</span>
{
    <b>class</b> <a id="4a2d51d52eb4686a" href="R/4a2d51d52eb4686a.html" target="n" data-glyph="2,0" class="t t"><span id="18d13c72266c8fbf">BlobStorageTest</span></a>
    {
        <b>private static</b> <span class="i">BlobServiceClient</span> <a id="45c70c9fcdfea4a9" href="R/45c70c9fcdfea4a9.html" target="n" data-glyph="46,1" class="i field">serviceClient</a>;
        <b>private static</b> <span class="i">BlockBlobClient</span> <a id="19a89d2762b8dd5b" href="R/19a89d2762b8dd5b.html" target="n" data-glyph="46,1" class="i field">blobClient</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Test the Storage Blobs SDK</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static async</b> <span class="i">Task</span> <a id="7b8cbbe3b257c3c7" href="R/7b8cbbe3b257c3c7.html" target="n" data-glyph="72,1" class="i method">RunTests</a>()
        {
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;\n---------------------------------&quot;</span>);
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;STORAGE&quot;</span>);
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;---------------------------------&quot;</span>);
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;Functionalities to test: 2:&quot;</span>);
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;1.- Upload Blob Block&quot;</span>);
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;2.- Delete that Blob Block&quot;</span> + <span class="s">&#39;\n&#39;</span>);
 
            <b>string</b> <span id="r0 rd" class="r0 r">connectionString</span> = <span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;BLOB_CONNECTION_STRING&quot;</span>);
            <b>string</b> <span id="r1 rd" class="r1 r">containerName</span> = <span class="s">&quot;mycontainer&quot;</span>; <span class="c">//The container must exists, this sample is not creating it.</span>
            <b>string</b> <span id="r2 rd" class="r2 r">blobName</span> = <span class="s">$&quot;</span><span class="s">netSmokeTestBlob-</span>{<span class="i">Guid</span>.<span class="i">NewGuid</span>()}<span class="s">.txt</span><span class="s">&quot;</span>;
            <a href="#45c70c9fcdfea4a9" class="i field">serviceClient</a> = <b>new</b> <span class="i">BlobServiceClient</span>(<span class="r0 r">connectionString</span>);
            <a href="#19a89d2762b8dd5b" class="i field">blobClient</a> = <a href="#45c70c9fcdfea4a9" class="i field">serviceClient</a>.<span class="i">GetBlobContainerClient</span>(<span class="r1 r">containerName</span>).<span class="i">GetBlockBlobClient</span>(<span class="r2 r">blobName</span>);
 
            <b>await</b> <a href="#6a1c32ec32dc5f06" class="i method">UploadBlob</a>();
            <b>await</b> <a href="#a2ec8cada1b221a0" class="i method">DeleteBlob</a>();
        }
 
        <b>private static async</b> <span class="i">Task</span> <a id="6a1c32ec32dc5f06" href="R/6a1c32ec32dc5f06.html" target="n" data-glyph="76,1" class="i method">UploadBlob</a>()
        {
            <span class="i">Console</span>.<span class="i">Write</span>(<span class="s">&quot;Uploading blob... &quot;</span>);
 
            <b>const string</b> <span id="r3 rd" class="r3 r">content</span> = <span class="s">&quot;This is the content for the sample blob&quot;</span>;
            <b>byte</b>[] <span id="r4 rd" class="r4 r">byteArray</span> = <span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<span class="r3 r">content</span>);
            <span class="i">MemoryStream</span> <span id="r5 rd" class="r5 r">stream</span> = <b>new</b> <span class="i">MemoryStream</span>(<span class="r4 r">byteArray</span>);
            <b>await</b> <a href="#19a89d2762b8dd5b" class="i field">blobClient</a>.<span class="i">UploadAsync</span>(<span class="r5 r">stream</span>);
 
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;\tdone&quot;</span>);
        }
 
        <b>private static async</b> <span class="i">Task</span> <a id="a2ec8cada1b221a0" href="R/a2ec8cada1b221a0.html" target="n" data-glyph="76,1" class="i method">DeleteBlob</a>()
        {
            <span class="i">Console</span>.<span class="i">Write</span>(<span class="s">&quot;Deleting blob...&quot;</span>);
            <b>await</b> <a href="#19a89d2762b8dd5b" class="i field">blobClient</a>.<span class="i">DeleteAsync</span>();
            <span class="i">Console</span>.<span class="i">WriteLine</span>(<span class="s">&quot;\tdone&quot;</span>);
        }
    }
}</pre></td></tr></table></div></body></html>
