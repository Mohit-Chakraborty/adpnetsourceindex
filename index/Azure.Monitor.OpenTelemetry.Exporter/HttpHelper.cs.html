<!DOCTYPE html>
<html><head><title>HttpHelper.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(280);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Monitor.OpenTelemetry.Exporter/HttpHelper.cs" target="_top">HttpHelper.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/monitor/Azure.Monitor.OpenTelemetry.Exporter/src/HttpHelper.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Monitor.OpenTelemetry.Exporter" target="_top">Azure.Monitor.OpenTelemetry.Exporter.csproj</a> (Azure.Monitor.OpenTelemetry.Exporter)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Monitor</span>.<span class="i n">OpenTelemetry</span>.<span class="i n">Exporter</span>
{
    <b>internal static class</b> <a id="aa0abbb13564ed59" href="R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">HttpHelper</a>
    {
        <b>private const string</b> <a id="739ace811d1183c5" href="R/739ace811d1183c5.html" target="n" data-glyph="10,1" class="i field">SchemePostfix</a> = <span class="s">&quot;://&quot;</span>;
        <b>private const string</b> <a id="fc316ba2ba69d433" href="R/fc316ba2ba69d433.html" target="n" data-glyph="10,1" class="i field">Colon</a> = <span class="s">&quot;:&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method follows OpenTelemetry specification to retrieve http URL.</span>
        <span class="c">///</span><span class="c"> Reference: https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/trace/semantic_conventions/http.md#http-client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">tagObjects</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Activity Tags</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">url</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">URL</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">urlAuthority</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host name or IP address and the port number </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="8885bfb143bc43b2" href="R/8885bfb143bc43b2.html" target="n" data-glyph="221,1" class="i method">GenerateUrlAndAuthority</a>(<b>this</b> <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a> <span id="r0 rd" class="r0 r">tagObjects</span>, <b>out string</b> <span id="r1 rd" class="r1 r">url</span>, <b>out string</b> <span id="r2 rd" class="r2 r">urlAuthority</span>)
        {
            <span class="r2 r">urlAuthority</span> = <b>null</b>;
            <span class="r1 r">url</span> = <b>null</b>;
 
            <a href="@1@netstandard/A.html#d9262ceecc1719ab" class="k">var</a> <span id="r3 rd" class="r3 r">httpurl</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#76a24129b6848e53" class="i field">AttributeHttpUrl</a>);
 
            <b>if</b> (<span class="r3 r">httpurl</span> != <b>null</b> &amp;&amp; <a href="@1@netstandard/A.html#991565dd25f47c90" class="t t">Uri</a>.<a href="@1@netstandard/A.html#49754736d6982eb6" class="i method">TryCreate</a>(<span class="r3 r">httpurl</span>.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>(), <a href="@1@netstandard/A.html#ac43655101ad74be" class="t t">UriKind</a>.<a href="@1@netstandard/A.html#2a5de88dbfa86f1b" class="i field">RelativeOrAbsolute</a>, <b>out</b> <a href="@1@netstandard/A.html#991565dd25f47c90" class="k">var</a> <span id="r4 rd" class="r4 r">uri</span>) &amp;&amp; <span class="r4 r">uri</span>.<a href="@1@netstandard/A.html#2e1f2f7671a40125" class="i property">IsAbsoluteUri</a>)
            {
                <span class="r1 r">url</span> = <span class="r4 r">uri</span>.<a href="@1@netstandard/A.html#e335fec0022465e6" class="i property">AbsoluteUri</a>;
                <span class="r2 r">urlAuthority</span> = <span class="r4 r">uri</span>.<a href="@1@netstandard/A.html#fefd01d5e9e625db" class="i property">Authority</a>;
                <b>return</b>;
            }
 
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r5 rd" class="r5 r">httpScheme</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#baca484892ec2e40" class="i field">AttributeHttpScheme</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
 
            <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r5 r">httpScheme</span>))
            {
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r6 rd" class="r6 r">httpHost</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#57f7978a0ecb1f15" class="i field">AttributeHttpHost</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
 
                <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r6 r">httpHost</span>))
                {
                    <b>var</b> <span id="r7 rd" class="r7 r">httpPortAndTarget</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#cac558cd091b0571" class="i method">GetTagValues</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#80f39dac17b2369a" class="i field">AttributeHttpHostPort</a>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#c95f5fa5c8e2f9a0" class="i field">AttributeHttpTarget</a>);
 
                    <b>if</b> (<span class="r7 r">httpPortAndTarget</span>[0] != <b>null</b> &amp;&amp; <span class="r7 r">httpPortAndTarget</span>[0].<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>() != <span class="s">&quot;80&quot;</span> &amp;&amp; <span class="r7 r">httpPortAndTarget</span>[0].<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>() != <span class="s">&quot;443&quot;</span>)
                    {
                        <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r8 rd" class="r8 r">IsColon</span> = (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r7 r">httpPortAndTarget</span>[0].<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>()) ? <b>null</b> : <a href="#fc316ba2ba69d433" class="i field">Colon</a>);
                        <span class="r1 r">url</span> = <span class="s">$&quot;</span>{<span class="r5 r">httpScheme</span>}<span class="s">://</span>{<span class="r6 r">httpHost</span>}{<span class="r8 r">IsColon</span>}{<span class="r7 r">httpPortAndTarget</span>[0]}{<span class="r7 r">httpPortAndTarget</span>[1]}<span class="s">&quot;</span>;
                        <span class="r2 r">urlAuthority</span> = <span class="s">$&quot;</span>{<span class="r6 r">httpHost</span>}{<span class="r8 r">IsColon</span>}{<span class="r7 r">httpPortAndTarget</span>[0]}<span class="s">&quot;</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r1 r">url</span> = <span class="s">$&quot;</span>{<span class="r5 r">httpScheme</span>}<span class="s">://</span>{<span class="r6 r">httpHost</span>}{<span class="r7 r">httpPortAndTarget</span>[1]}<span class="s">&quot;</span>;
                        <span class="r2 r">urlAuthority</span> = <span class="s">$&quot;</span>{<span class="r6 r">httpHost</span>}<span class="s">&quot;</span>;
                    }
 
                    <b>return</b>;
                }
 
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r9 rd" class="r9 r">netPeerName</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#6c3c9b9d109bb254" class="i field">AttributeNetPeerName</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
 
                <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r9 r">netPeerName</span>))
                {
                    <b>var</b> <span id="r10 rd" class="r10 r">netPeerPortAndTarget</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#cac558cd091b0571" class="i method">GetTagValues</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#a0d135d5c51ad56c" class="i field">AttributeNetPeerPort</a>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#c95f5fa5c8e2f9a0" class="i field">AttributeHttpTarget</a>);
                    <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r11 rd" class="r11 r">IsColon</span> = (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r10 r">netPeerPortAndTarget</span>[0]?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>()) ? <b>null</b> : <a href="#fc316ba2ba69d433" class="i field">Colon</a>);
                    <span class="r1 r">url</span> = <span class="s">$&quot;</span>{<span class="r5 r">httpScheme</span>}{<a href="#739ace811d1183c5" class="i field">SchemePostfix</a>}{<span class="r9 r">netPeerName</span>}{<span class="r11 r">IsColon</span>}{<span class="r10 r">netPeerPortAndTarget</span>[0]}{<span class="r10 r">netPeerPortAndTarget</span>[1]}<span class="s">&quot;</span>;
                    <span class="r2 r">urlAuthority</span> = <span class="s">$&quot;</span>{<span class="r9 r">netPeerName</span>}{<span class="r11 r">IsColon</span>}{<span class="r10 r">netPeerPortAndTarget</span>[0]}<span class="s">&quot;</span>;
                    <b>return</b>;
                }
 
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r12 rd" class="r12 r">netPeerIP</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#d1bd4982f6297ef0" class="i field">AttributeNetPeerIp</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
 
                <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r12 r">netPeerIP</span>))
                {
                    <b>var</b> <span id="r13 rd" class="r13 r">netPeerPortAndTarget</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#cac558cd091b0571" class="i method">GetTagValues</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#a0d135d5c51ad56c" class="i field">AttributeNetPeerPort</a>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#c95f5fa5c8e2f9a0" class="i field">AttributeHttpTarget</a>);
                    <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r14 rd" class="r14 r">IsColon</span> = (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r13 r">netPeerPortAndTarget</span>[0]?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>()) ? <b>null</b> : <a href="#fc316ba2ba69d433" class="i field">Colon</a>);
                    <span class="r1 r">url</span> = <span class="s">$&quot;</span>{<span class="r5 r">httpScheme</span>}{<a href="#739ace811d1183c5" class="i field">SchemePostfix</a>}{<span class="r12 r">netPeerIP</span>}{<span class="r14 r">IsColon</span>}{<span class="r13 r">netPeerPortAndTarget</span>[0]}{<span class="r13 r">netPeerPortAndTarget</span>[1]}<span class="s">&quot;</span>;
                    <span class="r2 r">urlAuthority</span> = <span class="s">$&quot;</span>{<span class="r12 r">netPeerIP</span>}{<span class="r14 r">IsColon</span>}{<span class="r13 r">netPeerPortAndTarget</span>[0]}<span class="s">&quot;</span>;
                    <b>return</b>;
                }
            }
 
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r15 rd" class="r15 r">host</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#57f7978a0ecb1f15" class="i field">AttributeHttpHost</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
 
            <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r15 r">host</span>))
            {
                <b>var</b> <span id="r16 rd" class="r16 r">httpPortAndTarget</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#cac558cd091b0571" class="i method">GetTagValues</a>(<b>ref</b> <span class="r0 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#80f39dac17b2369a" class="i field">AttributeHttpHostPort</a>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#c95f5fa5c8e2f9a0" class="i field">AttributeHttpTarget</a>);
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r17 rd" class="r17 r">IsColon</span> = (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r16 r">httpPortAndTarget</span>[0]?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>()) ? <b>null</b> : <a href="#fc316ba2ba69d433" class="i field">Colon</a>);
                <span class="r1 r">url</span> = <span class="s">$&quot;</span>{<span class="r15 r">host</span>}{<span class="r17 r">IsColon</span>}{<span class="r16 r">httpPortAndTarget</span>[0]}{<span class="r16 r">httpPortAndTarget</span>[1]}<span class="s">&quot;</span>;
                <span class="r2 r">urlAuthority</span> = <span class="s">$&quot;</span>{<span class="r15 r">host</span>}{<span class="r17 r">IsColon</span>}{<span class="r16 r">httpPortAndTarget</span>[0]}<span class="s">&quot;</span>;
                <b>return</b>;
            }
 
            <span class="r1 r">url</span> = <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r1 r">url</span>) ? <b>null</b> : <span class="r1 r">url</span>;
        }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets http request url from activity tag objects.</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="fcf9dc2c0c171da4" href="R/fcf9dc2c0c171da4.html" target="n" data-glyph="221,1" class="i method">GetRequestUrl</a>(<b>this</b> <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a> <span id="r18 rd" class="r18 r">tagObjects</span>)
        {
            <span class="c">// From spec: one of the following combinations is required in case of server spans:</span>
            <span class="c">// https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/trace/semantic_conventions/http.md#http-server-semantic-conventions</span>
            <span class="c">// http.url</span>
            <span class="c">// http.scheme, http.host, http.target</span>
            <span class="c">// http.scheme, http.server_name, net.host.port, http.target</span>
            <span class="c">// http.scheme, net.host.name, net.host.port, http.target</span>
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r19 rd" class="r19 r">url</span> = <b>null</b>;
            <span class="r19 r">url</span> = <span class="r18 r">tagObjects</span>.<a href="#6531dea8fb4980a0" class="i method">GetUrlUsingHttpUrl</a>();
            <b>if</b> (<span class="r19 r">url</span> != <b>null</b>)
            {
                <b>return</b> <span class="r19 r">url</span>;
            }
 
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r20 rd" class="r20 r">httpScheme</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r18 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#baca484892ec2e40" class="i field">AttributeHttpScheme</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
            <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r20 r">httpScheme</span>))
            {
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r21 rd" class="r21 r">defaultPort</span> = <a href="#8edc34f04810bccc" class="i method">GetDefaultPort</a>(<span class="r20 r">httpScheme</span>);
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r22 rd" class="r22 r">httpTarget</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r18 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#c95f5fa5c8e2f9a0" class="i field">AttributeHttpTarget</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                <span class="c">// http.target is required in other three possible combinations</span>
                <span class="c">// If not available then do not proceed.</span>
                <b>if</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r22 r">httpTarget</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r19 r">url</span> = <span class="r18 r">tagObjects</span>.<a href="#0a314a05996b897f" class="i method">GetUrlUsingHttpHost</a>(<span class="r20 r">httpScheme</span>, <span class="r21 r">defaultPort</span>, <span class="r22 r">httpTarget</span>);
                <b>if</b> (<span class="r19 r">url</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r19 r">url</span>;
                }
 
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r23 rd" class="r23 r">httpServerName</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r18 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#ccc2574b2f8ee4b0" class="i field">AttributeHttpServerName</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r24 rd" class="r24 r">host</span>;
                <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r23 r">httpServerName</span>))
                {
                    <span class="r24 r">host</span> = <span class="r23 r">httpServerName</span>;
                }
                <b>else</b>
                {
                    <span class="r24 r">host</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r18 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#79aa2c16024ddd7a" class="i field">AttributeNetHostName</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                }
                <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r24 r">host</span>))
                {
                    <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r25 rd" class="r25 r">netHostPort</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r18 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#50f1b8240aaf5cf4" class="i field">AttributeNetHostPort</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                    <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r25 r">netHostPort</span>))
                    {
                        <span class="r19 r">url</span> = <span class="r18 r">tagObjects</span>.<a href="#a81f50cc5ae3f50b" class="i method">GetUrlUsingHostAndPort</a>(<span class="r20 r">httpScheme</span>, <span class="r24 r">host</span>, <span class="r25 r">netHostPort</span>, <span class="r21 r">defaultPort</span>, <span class="r22 r">httpTarget</span>);
                        <b>return</b> <span class="r19 r">url</span>;
                    }
                }
            }
 
            <b>return</b> <span class="r19 r">url</span>;
        }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets http dependency url from activity tag objects.</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="b3babbc7a458474e" href="R/b3babbc7a458474e.html" target="n" data-glyph="221,1" class="i method">GetDependencyUrl</a>(<b>this</b> <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a> <span id="r26 rd" class="r26 r">tagObjects</span>)
        {
            <span class="c">// From spec: one of the following combinations is required in case of server spans:</span>
            <span class="c">// https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/trace/semantic_conventions/http.md#http-client</span>
            <span class="c">// http.url</span>
            <span class="c">// http.scheme, http.host, http.target</span>
            <span class="c">// http.scheme, net.peer.name, net.peer.port, http.target</span>
            <span class="c">// http.scheme, net.peer.ip, net.peer.port, http.target</span>
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r27 rd" class="r27 r">url</span> = <b>null</b>;
            <span class="r27 r">url</span> = <span class="r26 r">tagObjects</span>.<a href="#6531dea8fb4980a0" class="i method">GetUrlUsingHttpUrl</a>();
            <b>if</b> (<span class="r27 r">url</span> != <b>null</b>)
            {
                <b>return</b> <span class="r27 r">url</span>;
            }
 
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r28 rd" class="r28 r">httpScheme</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r26 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#baca484892ec2e40" class="i field">AttributeHttpScheme</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
            <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r28 r">httpScheme</span>))
            {
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r29 rd" class="r29 r">defaultPort</span> = <a href="#8edc34f04810bccc" class="i method">GetDefaultPort</a>(<span class="r28 r">httpScheme</span>);
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r30 rd" class="r30 r">httpTarget</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r26 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#c95f5fa5c8e2f9a0" class="i field">AttributeHttpTarget</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                <span class="c">// http.target is required in other three possible combinations</span>
                <span class="c">// If not available then do not proceed.</span>
                <b>if</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r30 r">httpTarget</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r27 r">url</span> = <span class="r26 r">tagObjects</span>.<a href="#0a314a05996b897f" class="i method">GetUrlUsingHttpHost</a>(<span class="r28 r">httpScheme</span>, <span class="r29 r">defaultPort</span>, <span class="r30 r">httpTarget</span>);
                <b>if</b> (<span class="r27 r">url</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r27 r">url</span>;
                }
 
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r31 rd" class="r31 r">netPeerName</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r26 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#6c3c9b9d109bb254" class="i field">AttributeNetPeerName</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r32 rd" class="r32 r">host</span>;
                <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r31 r">netPeerName</span>))
                {
                    <span class="r32 r">host</span> = <span class="r31 r">netPeerName</span>;
                }
                <b>else</b>
                {
                    <span class="r32 r">host</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r26 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#d1bd4982f6297ef0" class="i field">AttributeNetPeerIp</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                }
                <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r32 r">host</span>))
                {
                    <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r33 rd" class="r33 r">netPeerPort</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r26 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#a0d135d5c51ad56c" class="i field">AttributeNetPeerPort</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                    <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r33 r">netPeerPort</span>))
                    {
                        <span class="r27 r">url</span> = <span class="r26 r">tagObjects</span>.<a href="#a81f50cc5ae3f50b" class="i method">GetUrlUsingHostAndPort</a>(<span class="r28 r">httpScheme</span>, <span class="r32 r">host</span>, <span class="r33 r">netPeerPort</span>, <span class="r29 r">defaultPort</span>, <span class="r30 r">httpTarget</span>);
                        <b>return</b> <span class="r27 r">url</span>;
                    }
                }
            }
 
            <b>return</b> <span class="r27 r">url</span>;
        }
 
        [<a href="@1@netstandard/A.html#b2f5af2558f436d5" class="t constructor">MethodImpl</a>(<a href="@1@netstandard/A.html#4159f5c528de6ee8" class="t t">MethodImplOptions</a>.<a href="@1@netstandard/A.html#1e79a2c84795aaa0" class="i field">AggressiveInlining</a>)]
        <b>internal static string</b> <a id="8edc34f04810bccc" href="R/8edc34f04810bccc.html" target="n" data-glyph="74,1" class="i method">GetDefaultPort</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r34 rd" class="r34 r">httpScheme</span>)
        {
            <b>if</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#d47c1f57ad1e1e6e" class="i method">Equals</a>(<span class="r34 r">httpScheme</span>, <span class="s">&quot;http&quot;</span>, <a href="@1@netstandard/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@1@netstandard/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
            {
                <b>return</b> <span class="s">&quot;80&quot;</span>;
            }
            <b>else</b>
            {
                <b>return</b> <span class="s">&quot;443&quot;</span>;
            }
        }
 
        [<a href="@1@netstandard/A.html#b2f5af2558f436d5" class="t constructor">MethodImpl</a>(<a href="@1@netstandard/A.html#4159f5c528de6ee8" class="t t">MethodImplOptions</a>.<a href="@1@netstandard/A.html#1e79a2c84795aaa0" class="i field">AggressiveInlining</a>)]
        <b>internal static string</b> <a id="6531dea8fb4980a0" href="R/6531dea8fb4980a0.html" target="n" data-glyph="221,1" class="i method">GetUrlUsingHttpUrl</a>(<b>this</b> <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a> <span id="r35 rd" class="r35 r">tagObjects</span>)
        {
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r36 rd" class="r36 r">url</span> = <b>null</b>;
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r37 rd" class="r37 r">httpUrl</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r35 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#76a24129b6848e53" class="i field">AttributeHttpUrl</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
            <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r37 r">httpUrl</span>))
            {
                <span class="r36 r">url</span> = <span class="r37 r">httpUrl</span>;
            }
 
            <b>return</b> <span class="r36 r">url</span>;
        }
 
        <b>internal static string</b> <a id="0a314a05996b897f" href="R/0a314a05996b897f.html" target="n" data-glyph="221,1" class="i method">GetUrlUsingHttpHost</a>(<b>this</b> <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a> <span id="r38 rd" class="r38 r">tagObjects</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r39 rd" class="r39 r">httpScheme</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r40 rd" class="r40 r">defaultPort</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r41 rd" class="r41 r">httpTarget</span>)
        {
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r42 rd" class="r42 r">url</span> = <b>null</b>;
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r43 rd" class="r43 r">httpHost</span> = <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a>.<a href="AzMonList.cs.html#470556c259872be8" class="i method">GetTagValue</a>(<b>ref</b> <span class="r38 r">tagObjects</span>, <a href="SemanticConventions.cs.html#bd9677aa1f9fc5be" class="t t">SemanticConventions</a>.<a href="SemanticConventions.cs.html#57f7978a0ecb1f15" class="i field">AttributeHttpHost</a>)?.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
            <b>if</b> (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r43 r">httpHost</span>))
            {
                <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r44 rd" class="r44 r">portSection</span> = <span class="s">$&quot;</span><span class="s">:</span>{<span class="r40 r">defaultPort</span>}<span class="s">&quot;</span>;
                <b>if</b> (<span class="r43 r">httpHost</span>.<a href="@1@netstandard/A.html#41a31e4feec3ef41" class="i method">EndsWith</a>(<span class="r44 r">portSection</span>, <a href="@1@netstandard/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@1@netstandard/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
                {
                    <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r45 rd" class="r45 r">truncatedHost</span> = <span class="r43 r">httpHost</span>.<a href="@1@netstandard/A.html#8124961f027d9ac9" class="i method">Substring</a>(0, <span class="r43 r">httpHost</span>.<a href="@1@netstandard/A.html#7d6aed52d875ec59" class="i method">IndexOf</a>(<span class="r44 r">portSection</span>, <a href="@1@netstandard/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@1@netstandard/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>));
                    <span class="r42 r">url</span> = <span class="s">$&quot;</span>{<span class="r39 r">httpScheme</span>}<span class="s">://</span>{<span class="r45 r">truncatedHost</span>}{<span class="r41 r">httpTarget</span>}<span class="s">&quot;</span>;
                }
                <b>else</b>
                {
                    <span class="r42 r">url</span> = <span class="s">$&quot;</span>{<span class="r39 r">httpScheme</span>}<span class="s">://</span>{<span class="r43 r">httpHost</span>}{<span class="r41 r">httpTarget</span>}<span class="s">&quot;</span>;
                }
            }
 
            <b>return</b> <span class="r42 r">url</span>;
        }
 
        <b>internal static string</b> <a id="a81f50cc5ae3f50b" href="R/a81f50cc5ae3f50b.html" target="n" data-glyph="221,1" class="i method">GetUrlUsingHostAndPort</a>(<b>this</b> <a href="AzMonList.cs.html#37e5b984a4ec15a1" class="t t">AzMonList</a> <span id="r46 rd" class="r46 r">tagObjects</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r47 rd" class="r47 r">httpScheme</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r48 rd" class="r48 r">host</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r49 rd" class="r49 r">port</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r50 rd" class="r50 r">defaultPort</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r51 rd" class="r51 r">httpTarget</span>)
        {
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r52 rd" class="r52 r">url</span> = <b>null</b>;
            <b>if</b> (<span class="r49 r">port</span> == <span class="r50 r">defaultPort</span>)
            {
                <span class="r52 r">url</span> = <span class="s">$&quot;</span>{<span class="r47 r">httpScheme</span>}<span class="s">://</span>{<span class="r48 r">host</span>}{<span class="r51 r">httpTarget</span>}<span class="s">&quot;</span>;
            }
            <b>else</b>
            {
                <span class="r52 r">url</span> = <span class="s">$&quot;</span>{<span class="r47 r">httpScheme</span>}<span class="s">://</span>{<span class="r48 r">host</span>}<span class="s">:</span>{<span class="r49 r">port</span>}{<span class="r51 r">httpTarget</span>}<span class="s">&quot;</span>;
            }
 
            <b>return</b> <span class="r52 r">url</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
