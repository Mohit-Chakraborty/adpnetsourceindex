<!DOCTYPE html>
<html><head><title>ClusterOperationTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(771);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Management.HDInsight.Tests/ScenarioTests/ClusterOperationTests.cs" target="_top">ScenarioTests\ClusterOperationTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Management.HDInsight.Tests" target="_top">tests\Microsoft.Azure.Management.HDInsight.Tests.csproj</a> (Microsoft.Azure.Management.HDInsight.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">HDInsight</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">HDInsight</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i">KeyVault</span>.<span class="i">Models</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i">Storage</span>.<span class="i">Models</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>.<span class="i">ClientRuntime</span>.<span class="i">Azure</span>.<span class="i">TestFramework</span>;
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Net</span>;
<b>using</b> <span class="i">Xunit</span>;
<b>using static</b> <span class="i n">Management</span>.<span class="i n">HDInsight</span>.<span class="i n">Tests</span>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#c477825a07e09160" class="t t">HDInsightManagementTestUtilities</a>;
<b>using</b> <span class="i">Permissions</span> = <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i">KeyVault</span>.<span class="i">Models</span>.<span class="i">Permissions</span>;
<b>using</b> <span class="t">StorageAccount</span> = <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">HDInsight</span>.<span class="i n">Models</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#61f443381626ff8d" class="t t">StorageAccount</a>;
 
<b>namespace</b> <span class="i n">Management</span>.<span class="i n">HDInsight</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="bec3d59a6a5cdae4" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="c0e38f5aed253b44">ClusterOperationTests</span></a> : <a href="HDInsightManagementTestBase.cs.html#c30c1c779e7b7348" class="t t">HDInsightManagementTestBase</a>
    {
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="125ef4f0d2e29463" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateHumboldtCluster</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r0 rd" class="r0 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-humboldt&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r1 rd" class="r1 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r2 rd" class="r2 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r0 r">clusterName</span>, <span class="r1 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r0 r">clusterName</span>, <span class="r1 r">createParams</span>, <span class="r2 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="4f65d41ed460e490" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateHumboldtClusterWithPremiumTier</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r3 rd" class="r3 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-premium&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r4 rd" class="r4 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r4 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#00ac3333a180c869" class="i property">Tier</a> = <a href="/Microsoft.Azure.Management.HDInsight/A.html#6328d41e58dc3548" class="t t">Tier</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9f132cdf71acfa91" class="i field">Premium</a>;
            <b>var</b> <span id="r5 rd" class="r5 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r3 r">clusterName</span>, <span class="r4 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r3 r">clusterName</span>, <span class="r4 r">createParams</span>, <span class="r5 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="bdb96c43d69a5e9b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateWithEmptyExtendedParameters</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r6 rd" class="r6 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-cluster&quot;</span>);
            <b>var</b> <span id="r7 rd" class="r7 r">ex</span> = <span class="i">Assert</span>.<span class="i">Throws</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#7244ec914a70326a" class="t t">ErrorResponseException</a>&gt;(() =&gt; <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r6 r">clusterName</span>, <b>new</b> <span class="t">ClusterCreateParametersExtended</span>()));
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">HttpStatusCode</span>.<span class="i">BadRequest</span>, <span class="r7 r">ex</span>.<span class="i">Response</span>.<span class="i">StatusCode</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="43c6e9fae30fda5c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateHumboldtClusterWithCustomVMSizes</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r8 rd" class="r8 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-customvmsizes&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r9 rd" class="r9 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r10 rd" class="r10 r">headNode</span> = <span class="r9 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r11 rd" class="r11 r">role</span> =&gt; <span class="r11 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;headnode&quot;</span>);
            <span class="r10 r">headNode</span>.<span class="i">HardwareProfile</span>.<span class="i">VmSize</span> = <span class="s">&quot;ExtraLarge&quot;</span>;
            <b>var</b> <span id="r12 rd" class="r12 r">zookeeperNode</span> = <span class="r9 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r13 rd" class="r13 r">role</span> =&gt; <span class="r13 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;zookeepernode&quot;</span>);
            <span class="r12 r">zookeeperNode</span>.<span class="i">HardwareProfile</span>.<span class="i">VmSize</span> = <span class="s">&quot;Medium&quot;</span>;
            <b>var</b> <span id="r14 rd" class="r14 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r8 r">clusterName</span>, <span class="r9 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r8 r">clusterName</span>, <span class="r9 r">createParams</span>, <span class="r14 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9e53e9e92735daee" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateLinuxSparkClusterWithComponentVersion</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r15 rd" class="r15 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-sparkcomponentversions&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r16 rd" class="r16 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r16 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#fdbfcdc1fa742ae1" class="i property">Kind</a> = <span class="s">&quot;Spark&quot;</span>;
            <span class="r16 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9ff1d247893a721f" class="i property">ComponentVersion</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;()
            {
                { <span class="s">&quot;Spark&quot;</span>, <span class="s">&quot;2.2&quot;</span> }
            };
 
            <b>var</b> <span id="r17 rd" class="r17 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r15 r">clusterName</span>, <span class="r16 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r15 r">clusterName</span>, <span class="r16 r">createParams</span>, <span class="r17 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="e7e941b81373e66c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateKafkaClusterWithManagedDisks</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r18 rd" class="r18 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-kafka&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r19 rd" class="r19 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r19 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#fdbfcdc1fa742ae1" class="i property">Kind</a> = <span class="s">&quot;Kafka&quot;</span>;
            <b>var</b> <span id="r20 rd" class="r20 r">workerNode</span> = <span class="r19 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r21 rd" class="r21 r">role</span> =&gt; <span class="r21 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;workernode&quot;</span>);
            <span class="r20 r">workerNode</span>.<span class="i">DataDisksGroups</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#7bc67cceb6bec85d" class="t t">DataDisksGroups</a>&gt;
            {
                <b>new</b> <span class="t">DataDisksGroups</span>
                {
                     <a href="/Microsoft.Azure.Management.HDInsight/A.html#2881f7bffd3c9919" class="i property">DisksPerNode</a> = 8
                }
            };
 
            <b>var</b> <span id="r22 rd" class="r22 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r18 r">clusterName</span>, <span class="r19 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r18 r">clusterName</span>, <span class="r19 r">createParams</span>, <span class="r22 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="e9300a0e7f569646" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateKafkaClusterWithDiskEncryption</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r23 rd" class="r23 r">mockedTenantId</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>();
            <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3dd50c3a4cf25fdf" class="i property">TenantId</a> = <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#2f55464eec7ba6e8" class="i method">GetTenantId</a>();
            <a href="#bec3d59a6a5cdae4" class="k">this</a>.<a href="HDInsightManagementTestBase.cs.html#5ed01e6f51c580cd" class="i property">Context</a>.<a href="../TestHelpers/HDInsightMockContext.cs.html#8ac667c68f15237f" class="i method">AddTextReplacementRule</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3dd50c3a4cf25fdf" class="i property">TenantId</a>, <span class="r23 r">mockedTenantId</span>);
 
            <b>string</b> <span id="r24 rd" class="r24 r">mockedClientObjectId</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>();
            <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#4a36949c099612cf" class="i property">ClientObjectId</a> = <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#e2f47667b1a05d11" class="i method">GetServicePrincipalObjectId</a>();
            <a href="#bec3d59a6a5cdae4" class="k">this</a>.<a href="HDInsightManagementTestBase.cs.html#5ed01e6f51c580cd" class="i property">Context</a>.<a href="../TestHelpers/HDInsightMockContext.cs.html#8ac667c68f15237f" class="i method">AddTextReplacementRule</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#4a36949c099612cf" class="i property">ClientObjectId</a>, <span class="r24 r">mockedClientObjectId</span>);
 
            <span class="i">Vault</span> <span id="r25 rd" class="r25 r">vault</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="c">// create key vault with soft delete enabled</span>
                <span class="r25 r">vault</span> = <a href="HDInsightManagementTestBase.cs.html#5b327abbdebadd8d" class="i method">CreateVault</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#5d7ac73d6abfc4e9" class="i property">VaultName</a>, <b>true</b>);
 
                <span class="c">// create managed identities for Azure resources.</span>
                <b>var</b> <span id="r26 rd" class="r26 r">msi</span> = <a href="HDInsightManagementTestBase.cs.html#2ae9fe31f2b1df81" class="i method">CreateMsi</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#ae9653c418bb1123" class="i property">ManagedIdentityName</a>);
 
                <span class="c">// add managed identity to vault</span>
                <b>var</b> <span id="r27 rd" class="r27 r">requiredPermissions</span> = <b>new</b> <span class="i">Permissions</span>
                {
                    <span class="i">Keys</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;() { <span class="i">KeyPermissions</span>.<span class="i">Get</span>, <span class="i">KeyPermissions</span>.<span class="i">WrapKey</span>, <span class="i">KeyPermissions</span>.<span class="i">UnwrapKey</span> },
                    <span class="i">Secrets</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;() { <span class="i">SecretPermissions</span>.<span class="i">Get</span>, <span class="i">SecretPermissions</span>.<span class="i">Set</span>, <span class="i">SecretPermissions</span>.<span class="i">Delete</span> }
                };
 
                <span class="r25 r">vault</span> = <span class="i">SetVaultPermissions</span>(<span class="r25 r">vault</span>, <span class="r26 r">msi</span>.<span class="i">PrincipalId</span>.<span class="i">ToString</span>(), <span class="r27 r">requiredPermissions</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r25 r">vault</span>);
 
                <span class="c">// create key</span>
                <b>string</b> <span id="r28 rd" class="r28 r">keyName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdicsharpkey1&quot;</span>);
                <b>var</b> <span id="r29 rd" class="r29 r">keyIdentifier</span> = <a href="HDInsightManagementTestBase.cs.html#c7238a3a2d803264" class="i method">GenerateVaultKey</a>(<span class="r25 r">vault</span>, <span class="r28 r">keyName</span>);
 
                <span class="c">// create HDInsight cluster with Kafka disk encryption</span>
                <b>string</b> <span id="r30 rd" class="r30 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-kafka-byok&quot;</span>);
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r31 rd" class="r31 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
                <span class="r31 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#fdbfcdc1fa742ae1" class="i property">Kind</a> = <span class="s">&quot;Kafka&quot;</span>;
                <b>var</b> <span id="r32 rd" class="r32 r">workerNode</span> = <span class="r31 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r33 rd" class="r33 r">role</span> =&gt; <span class="r33 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;workernode&quot;</span>);
                <span class="r32 r">workerNode</span>.<span class="i">DataDisksGroups</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#7bc67cceb6bec85d" class="t t">DataDisksGroups</a>&gt;
                {
                    <b>new</b> <span class="t">DataDisksGroups</span>
                    {
                         <a href="/Microsoft.Azure.Management.HDInsight/A.html#2881f7bffd3c9919" class="i property">DisksPerNode</a> = 8
                    }
                };
 
                <span class="r31 r">createParams</span>.<span class="i">Identity</span> = <b>new</b> <span class="t">ClusterIdentity</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#b50b5c5c1dabbdb4" class="i property">Type</a> = <a href="/Microsoft.Azure.Management.HDInsight/A.html#2956a1ce4b18bb34" class="t t">ResourceIdentityType</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#e659f0d6715ea4d7" class="i field">UserAssigned</a>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#9f5b19457f4c6c04" class="i property">UserAssignedIdentities</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="/Microsoft.Azure.Management.HDInsight/A.html#3eb19568cd61825d" class="t t">ClusterIdentityUserAssignedIdentitiesValue</a>&gt;
                    {
                        { <span class="r26 r">msi</span>.<span class="i">Id</span>, <b>new</b> <span class="t">ClusterIdentityUserAssignedIdentitiesValue</span>() }
                    }
                };
 
                <span class="r31 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<span class="i">DiskEncryptionProperties</span> = <b>new</b> <span class="t">DiskEncryptionProperties</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#3a39b4e1e8a7b2a6" class="i property">VaultUri</a> = <span class="r29 r">keyIdentifier</span>.<span class="i">Vault</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#51f925ffdebd3d07" class="i property">KeyName</a> = <span class="r29 r">keyIdentifier</span>.<span class="i">Name</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#5b0f3d4c6c8b78bd" class="i property">KeyVersion</a> = <span class="r29 r">keyIdentifier</span>.<span class="i">Version</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#92b7ed5a75593718" class="i property">MsiResourceId</a> = <span class="r26 r">msi</span>.<span class="i">Id</span>
                };
 
                <b>var</b> <span id="r34 rd" class="r34 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r30 r">clusterName</span>, <span class="r31 r">createParams</span>);
                <span class="i">ValidateCluster</span>(<span class="r30 r">clusterName</span>, <span class="r31 r">createParams</span>, <span class="r34 r">cluster</span>);
 
                <span class="c">// check disk encryption properties</span>
                <b>var</b> <span id="r35 rd" class="r35 r">diskEncryptionProperties</span> = <span class="r34 r">cluster</span>.<span class="i">Properties</span>.<span class="i">DiskEncryptionProperties</span>;
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#a5d33524791414d2" class="k">var</a> <span id="r36 rd" class="r36 r">diskEncryptionPropertiesParams</span> = <span class="r31 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#4d0a1271afc63b36" class="i property">DiskEncryptionProperties</a>;
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r35 r">diskEncryptionProperties</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r36 r">diskEncryptionPropertiesParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#3a39b4e1e8a7b2a6" class="i property">VaultUri</a>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">VaultUri</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r36 r">diskEncryptionPropertiesParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#51f925ffdebd3d07" class="i property">KeyName</a>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">KeyName</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r36 r">diskEncryptionPropertiesParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#5b0f3d4c6c8b78bd" class="i property">KeyVersion</a>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">KeyVersion</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r26 r">msi</span>.<span class="i">Id</span>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">MsiResourceId</span>, <b>true</b>);
 
                <span class="r28 r">keyName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdicsharpkey2&quot;</span>);
                <b>var</b> <span id="r37 rd" class="r37 r">secondKeyIdentifier</span> = <a href="HDInsightManagementTestBase.cs.html#c7238a3a2d803264" class="i method">GenerateVaultKey</a>(<span class="r25 r">vault</span>, <span class="r28 r">keyName</span>);
 
                <span class="c">// rotate cluster key</span>
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#efddfcd9f1868b64" class="k">var</a> <span id="r38 rd" class="r38 r">rotateParams</span> = <b>new</b> <span class="t">ClusterDiskEncryptionParameters</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#8666c41bd71f5b9f" class="i property">VaultUri</a> = <span class="r37 r">secondKeyIdentifier</span>.<span class="i">Vault</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#7d5b8b474f535230" class="i property">KeyName</a> = <span class="r37 r">secondKeyIdentifier</span>.<span class="i">Name</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#83b3718eee294d27" class="i property">KeyVersion</a> = <span class="r37 r">secondKeyIdentifier</span>.<span class="i">Version</span>
                };
 
                <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">RotateDiskEncryptionKey</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r30 r">clusterName</span>, <span class="r38 r">rotateParams</span>);
                <span class="r34 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r30 r">clusterName</span>);
 
                <span class="c">// check disk encryption properties</span>
                <span class="r35 r">diskEncryptionProperties</span> = <span class="r34 r">cluster</span>.<span class="i">Properties</span>.<span class="i">DiskEncryptionProperties</span>;
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r35 r">diskEncryptionProperties</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r38 r">rotateParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#8666c41bd71f5b9f" class="i property">VaultUri</a>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">VaultUri</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r38 r">rotateParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#7d5b8b474f535230" class="i property">KeyName</a>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">KeyName</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r38 r">rotateParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#83b3718eee294d27" class="i property">KeyVersion</a>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">KeyVersion</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r26 r">msi</span>.<span class="i">Id</span>, <span class="r35 r">diskEncryptionProperties</span>.<span class="i">MsiResourceId</span>, <b>true</b>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r25 r">vault</span> != <b>null</b>)
                {
                    <a href="HDInsightManagementTestBase.cs.html#d34acd8cab910a4c" class="i method">DeleteVault</a>(<span class="r25 r">vault</span>);
                }
            }
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="76dcbc3cd2166d62" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateKafkaClusterWithRestProxyProperties</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r39 rd" class="r39 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-kafka-restproxy&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r40 rd" class="r40 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r40 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#acff7f47c74afc17" class="i property">ClusterVersion</a> = <span class="s">&quot;4.0&quot;</span>;
            <span class="r40 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#fdbfcdc1fa742ae1" class="i property">Kind</a> = <span class="s">&quot;kafka&quot;</span>;
            <span class="r40 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9ff1d247893a721f" class="i property">ComponentVersion</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;{ { <span class="s">&quot;Kafka&quot;</span>, <span class="s">&quot;2.1&quot;</span>} };
            <span class="r40 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9170a0a45eb684fe" class="i property">Location</a> = <span class="s">&quot;South Central US&quot;</span>;
 
            <b>var</b> <span id="r41 rd" class="r41 r">workerNode</span> = <span class="r40 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r42 rd" class="r42 r">role</span> =&gt; <span class="r42 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;workernode&quot;</span>);
            <span class="r41 r">workerNode</span>.<span class="i">DataDisksGroups</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#7bc67cceb6bec85d" class="t t">DataDisksGroups</a>&gt;
            {
                <b>new</b> <span class="t">DataDisksGroups</span>
                {
                     <a href="/Microsoft.Azure.Management.HDInsight/A.html#2881f7bffd3c9919" class="i property">DisksPerNode</a> = 8
                }
            };
 
            <span class="c">//KafkaManagementNode must be defined for Kafka Rest Proxy to be provisioned</span>
            <span class="r40 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">Add</span>(<b>new</b> <span class="t">Role</span>
            {
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#fb24039d3cd14132" class="i property">Name</a> = <span class="s">&quot;kafkamanagementnode&quot;</span>,
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#b3144617377d4ddd" class="i property">TargetInstanceCount</a> = 2,
                <span class="i">HardwareProfile</span> = <b>new</b> <span class="t">HardwareProfile</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#3e6a31f8dbb3cf06" class="i property">VmSize</a> = <span class="s">&quot;Standard_D4_v2&quot;</span>
                },
                <span class="i">OsProfile</span> = <b>new</b> <span class="t">OsProfile</span>
                {
                    <span class="i">LinuxOperatingSystemProfile</span> = <b>new</b> <span class="t">LinuxOperatingSystemProfile</span>
                    {
                        <a href="/Microsoft.Azure.Management.HDInsight/A.html#2d7f635cd13455ad" class="i property">Username</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#974e3d85f1d36aa5" class="i property">SshUsername</a>,
                        <a href="/Microsoft.Azure.Management.HDInsight/A.html#a8e52deb860237ff" class="i property">Password</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#da68f65ee8c982e2" class="i property">SshPassword</a>
                    }
                }
            });
            <span class="c">//only kafaka cluster with hdi 4.0 and above with kafaka version 2.1 and above can be deployed with rest proxy.</span>
            <span class="r40 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<span class="i">KafkaRestProperties</span> = <b>new</b> <span class="t">KafkaRestProperties</span>
            {
                <span class="i">ClientGroupInfo</span> = <b>new</b> <span class="t">ClientGroupInfo</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#e64b877acf87c074" class="i property">GroupId</a> = <a href="../../GuidAssembly/R/7bef90fa-0aa3-4bb4-b4d2-2ae7c14cfe41.html" target="n" class="s">&quot;7bef90fa-0aa3-4bb4-b4d2-2ae7c14cfe41&quot;</a>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#261e649efb114bec" class="i property">GroupName</a> = <span class="s">&quot;KafakaRestProperties&quot;</span>
                }
            };
 
            <b>var</b> <span id="r43 rd" class="r43 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r39 r">clusterName</span>, <span class="r40 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r39 r">clusterName</span>, <span class="r40 r">createParams</span>, <span class="r43 r">cluster</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r43 r">cluster</span>.<span class="i">Properties</span>.<span class="i">KafkaRestProperties</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="4191f191597f287d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateWithADLSv1</a>() {
 
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <span class="c">// This test case require ADLS gen1 storage account created beforehand</span>
            <b>if</b> (<a href="HDInsightManagementTestBase.cs.html#ef48a712e642a527" class="i method">IsPartialRecordMode</a>())
            {
                <b>return</b>;
            }
 
            <b>string</b> <span id="r44 rd" class="r44 r">mockedTenantId</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>();
            <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3dd50c3a4cf25fdf" class="i property">TenantId</a> = <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#2f55464eec7ba6e8" class="i method">GetTenantId</a>();
            <a href="#bec3d59a6a5cdae4" class="k">this</a>.<a href="HDInsightManagementTestBase.cs.html#5ed01e6f51c580cd" class="i property">Context</a>.<a href="../TestHelpers/HDInsightMockContext.cs.html#8ac667c68f15237f" class="i method">AddTextReplacementRule</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3dd50c3a4cf25fdf" class="i property">TenantId</a>, <span class="r44 r">mockedTenantId</span>);
 
            <b>string</b> <span id="r45 rd" class="r45 r">mockedDataLakeClientId</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>();
            <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#c528dd1a2136fc9a" class="i property">DataLakeClientId</a> = <a href="../TestHelpers/TestConfigurationManager.cs.html#da6439a50ba65554" class="t t">TestConfigurationManager</a>.<a href="../TestHelpers/TestConfigurationManager.cs.html#1105fe1d79699390" class="i property">Instance</a>.<a href="../TestHelpers/TestConfigurationManager.cs.html#581656e0d1766a37" class="i property">AppSettings</a>.<a href="../TestHelpers/TestConfigurationManager.cs.html#404a57f44e230148" class="i property">DataLakeClientId</a>;
            <a href="#bec3d59a6a5cdae4" class="k">this</a>.<a href="HDInsightManagementTestBase.cs.html#5ed01e6f51c580cd" class="i property">Context</a>.<a href="../TestHelpers/HDInsightMockContext.cs.html#8ac667c68f15237f" class="i method">AddTextReplacementRule</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#c528dd1a2136fc9a" class="i property">DataLakeClientId</a>, <span class="r45 r">mockedDataLakeClientId</span>);
 
            <b>string</b> <span id="r46 rd" class="r46 r">mockedDataLakeStoreAccountName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;fakehdiadlsaccount&quot;</span>);
            <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#783880fa639c7135" class="i property">DataLakeStoreAccountName</a> = <a href="../TestHelpers/TestConfigurationManager.cs.html#da6439a50ba65554" class="t t">TestConfigurationManager</a>.<a href="../TestHelpers/TestConfigurationManager.cs.html#1105fe1d79699390" class="i property">Instance</a>.<a href="../TestHelpers/TestConfigurationManager.cs.html#581656e0d1766a37" class="i property">AppSettings</a>.<a href="../TestHelpers/TestConfigurationManager.cs.html#ca12cb9c9b2c77e5" class="i property">DataLakeStoreAccountName</a>;
            <a href="#bec3d59a6a5cdae4" class="k">this</a>.<a href="HDInsightManagementTestBase.cs.html#5ed01e6f51c580cd" class="i property">Context</a>.<a href="../TestHelpers/HDInsightMockContext.cs.html#8ac667c68f15237f" class="i method">AddTextReplacementRule</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#783880fa639c7135" class="i property">DataLakeStoreAccountName</a>, <span class="r46 r">mockedDataLakeStoreAccountName</span>);
 
            <b>string</b> <span id="r47 rd" class="r47 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-adlgen1&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r48 rd" class="r48 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#05804a7e983df8b2" class="i method">PrepareClusterCreateParamsForADLSv1</a>();
 
            <span class="c">// Add additional storage account</span>
            <b>var</b> <span id="r49 rd" class="r49 r">secondaryStorageAccountName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdicsharpstorage2&quot;</span>);
            <b>var</b> <span id="r50 rd" class="r50 r">secondaryStorageAccountKey</span> = <span class="i">CreateStorageAccount</span>(<span class="r49 r">secondaryStorageAccountName</span>);
            <span class="r48 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#59cdf04de9bcc2c9" class="i property">StorageProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#2a922bdea0059b60" class="i property">Storageaccounts</a>.<span class="i">Add</span>(
                <b>new</b> <span class="t">StorageAccount</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#ee59b14f037ee346" class="i property">Name</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#2bd4d94eb58e7e0e" class="i property">StorageAccountName</a> + <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3202b9e58dcb894f" class="i property">BlobEndpointSuffix</a>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#1d6a69ae0576c2c2" class="i property">Key</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#c595f301cb6693a4" class="i property">StorageAccountKey</a>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#954479a222705214" class="i property">Container</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#0fe65d4671a357eb" class="i property">ContainerName</a>.<span class="i">ToLower</span>(),
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#ea3f8856de947b06" class="i property">IsDefault</a> = <b>false</b>
                }
            );
 
            <b>var</b> <span id="r51 rd" class="r51 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r47 r">clusterName</span>, <span class="r48 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r47 r">clusterName</span>, <span class="r48 r">createParams</span>, <span class="r51 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="51b8a46c915ea8e1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateWithADLSv2</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r52 rd" class="r52 r">mockedTenantId</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>();
            <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3dd50c3a4cf25fdf" class="i property">TenantId</a> = <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#2f55464eec7ba6e8" class="i method">GetTenantId</a>();
            <a href="#bec3d59a6a5cdae4" class="k">this</a>.<a href="HDInsightManagementTestBase.cs.html#5ed01e6f51c580cd" class="i property">Context</a>.<a href="../TestHelpers/HDInsightMockContext.cs.html#8ac667c68f15237f" class="i method">AddTextReplacementRule</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3dd50c3a4cf25fdf" class="i property">TenantId</a>, <span class="r52 r">mockedTenantId</span>);
 
            <b>string</b> <span id="r53 rd" class="r53 r">mockedClientObjectId</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>();
            <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#4a36949c099612cf" class="i property">ClientObjectId</a> = <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#e2f47667b1a05d11" class="i method">GetServicePrincipalObjectId</a>();
            <a href="#bec3d59a6a5cdae4" class="k">this</a>.<a href="HDInsightManagementTestBase.cs.html#5ed01e6f51c580cd" class="i property">Context</a>.<a href="../TestHelpers/HDInsightMockContext.cs.html#8ac667c68f15237f" class="i method">AddTextReplacementRule</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#4a36949c099612cf" class="i property">ClientObjectId</a>, <span class="r53 r">mockedClientObjectId</span>);
 
            <span class="c">// Create an Azure storage account with Data Lake Storage Gen 2.</span>
            <b>string</b> <span id="r54 rd" class="r54 r">adlsV2AccountName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdicsharpadlsv2&quot;</span>);
            <b>var</b> <span id="r55 rd" class="r55 r">storageV2AccountAccessKey</span> = <a href="HDInsightManagementTestBase.cs.html#993463aeb96cb876" class="i property">HDInsightManagementHelper</a>.<span class="i">CreateStorageAccount</span>(
                <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>,
                <span class="r54 r">adlsV2AccountName</span>,
                <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6062cb3407743238" class="i property">Location</a>,
                <b>out string</b> <span id="r56 rd" class="r56 r">storageAccountSuffix</span>,
                <span class="i">Kind</span>.<span class="i">StorageV2</span>,
                <b>true</b>);
            <b>string</b> <span id="r57 rd" class="r57 r">storageResourceId</span> = <a href="HDInsightManagementTestBase.cs.html#993463aeb96cb876" class="i property">HDInsightManagementHelper</a>.<a href="../TestHelpers/HDInsightManagementHelper.cs.html#604c628e220568c4" class="i method">GetStorageAccountId</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r54 r">adlsV2AccountName</span>);
 
            <span class="c">// Create a user assigned managed identity.</span>
            <b>var</b> <span id="r58 rd" class="r58 r">msi</span> = <a href="HDInsightManagementTestBase.cs.html#2ae9fe31f2b1df81" class="i method">CreateMsi</a>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#ae9653c418bb1123" class="i property">ManagedIdentityName</a>);
 
            <span class="c">// Wait some time in order to improve robustness</span>
            <span class="i">TestUtilities</span>.<span class="i">Wait</span>(<span class="i">TimeSpan</span>.<span class="i">FromMinutes</span>(1));
 
            <span class="c">// Assign Storage Blob Data Contributor access to the created managed identity on Azure Storage.</span>
            <b>string</b> <span id="r59 rd" class="r59 r">assignmentName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>();
            <a href="HDInsightManagementTestBase.cs.html#993463aeb96cb876" class="i property">HDInsightManagementHelper</a>.<span class="i">AddRoleAssignment</span>(<span class="r57 r">storageResourceId</span>, <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#0dfff26f3aa00b60" class="i property">AdlsGen2RequiredRoleName</a>, <span class="r59 r">assignmentName</span>, <span class="r58 r">msi</span>.<span class="i">PrincipalId</span>?.<span class="i">ToString</span>());
 
            <b>string</b> <span id="r60 rd" class="r60 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-adlgen2&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r61 rd" class="r61 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<span class="i">PrepareClusterCreateParamsForADLSv2</span>(<span class="r54 r">adlsV2AccountName</span>, <span class="r57 r">storageResourceId</span>, <span class="r58 r">msi</span>.<span class="i">Id</span>);
 
            <span class="c">// Add additional storage account</span>
            <span class="r61 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#59cdf04de9bcc2c9" class="i property">StorageProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#2a922bdea0059b60" class="i property">Storageaccounts</a>.<span class="i">Add</span>(
                <b>new</b> <span class="t">StorageAccount</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#ee59b14f037ee346" class="i property">Name</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#2bd4d94eb58e7e0e" class="i property">StorageAccountName</a> + <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3202b9e58dcb894f" class="i property">BlobEndpointSuffix</a>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#1d6a69ae0576c2c2" class="i property">Key</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#c595f301cb6693a4" class="i property">StorageAccountKey</a>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#954479a222705214" class="i property">Container</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#0fe65d4671a357eb" class="i property">ContainerName</a>.<span class="i">ToLower</span>(),
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#ea3f8856de947b06" class="i property">IsDefault</a> = <b>false</b>
                }
            );
 
            <span class="c">// Create a HDInsight cluster</span>
            <b>var</b> <span id="r62 rd" class="r62 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r60 r">clusterName</span>, <span class="r61 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r60 r">clusterName</span>, <span class="r61 r">createParams</span>, <span class="r62 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="6c3f04f4e9b64c9f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateWithAdditionalStorageAccount</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r63 rd" class="r63 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-additional&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r64 rd" class="r64 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
 
            <span class="c">// Add additional storage account</span>
            <b>var</b> <span id="r65 rd" class="r65 r">secondaryStorageAccountName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdicsharpstorage2&quot;</span>);
            <b>var</b> <span id="r66 rd" class="r66 r">secondaryStorageAccountKey</span> = <span class="i">CreateStorageAccount</span>(<span class="r65 r">secondaryStorageAccountName</span>);
            <span class="r64 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#59cdf04de9bcc2c9" class="i property">StorageProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#2a922bdea0059b60" class="i property">Storageaccounts</a>.<span class="i">Add</span>(
                <b>new</b> <span class="t">StorageAccount</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#ee59b14f037ee346" class="i property">Name</a> = <span class="r65 r">secondaryStorageAccountName</span> + <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#3202b9e58dcb894f" class="i property">BlobEndpointSuffix</a>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#1d6a69ae0576c2c2" class="i property">Key</a> = <span class="r66 r">secondaryStorageAccountKey</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#954479a222705214" class="i property">Container</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#0fe65d4671a357eb" class="i property">ContainerName</a>.<span class="i">ToLower</span>(),
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#ea3f8856de947b06" class="i property">IsDefault</a> = <b>false</b>
                }
            );
 
            <b>var</b> <span id="r67 rd" class="r67 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r63 r">clusterName</span>, <span class="r64 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r63 r">clusterName</span>, <span class="r64 r">createParams</span>, <span class="r67 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="f9177592dd02fe55" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateClusterWithAutoScaleLoadBasedType</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
            <b>string</b> <span id="r68 rd" class="r68 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-loadbased&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r69 rd" class="r69 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r70 rd" class="r70 r">workerNode</span> = <span class="r69 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r71 rd" class="r71 r">role</span> =&gt; <span class="r71 r">role</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;workernode&quot;</span>));
 
            <span class="c">//Add auto scale configuration Load-based type</span>
            <span class="r70 r">workerNode</span>.<span class="i">AutoscaleConfiguration</span> = <b>new</b> <span class="t">Autoscale</span>
            {
                <span class="i">Capacity</span> = <b>new</b> <span class="t">AutoscaleCapacity</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#e96f2b24be115d32" class="i property">MinInstanceCount</a> = 4,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#1c808fcf5a0a9cf7" class="i property">MaxInstanceCount</a> = 5
                }
            };
 
            <b>var</b> <span id="r72 rd" class="r72 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r68 r">clusterName</span>, <span class="r69 r">createParams</span>);
            <span class="i">ValidateAutoScaleConfig</span>(<span class="r70 r">workerNode</span>.<span class="i">AutoscaleConfiguration</span>,
                <span class="r72 r">cluster</span>.<span class="i">Properties</span>.<span class="i">ComputeProfile</span>.<span class="i">Roles</span>.<span class="i">First</span>(<span id="r73 rd" class="r73 r">role</span> =&gt; <span class="r73 r">role</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;workernode&quot;</span>)).<span class="i">AutoscaleConfiguration</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="56190320de6c6613" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateClusterWithAutoScaleScheduleBasedType</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
            <b>string</b> <span id="r74 rd" class="r74 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-schedulebased&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r75 rd" class="r75 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r76 rd" class="r76 r">workerNode</span> = <span class="r75 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r77 rd" class="r77 r">role</span> =&gt; <span class="r77 r">role</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;workernode&quot;</span>));
 
            <span class="c">//Add auto scale configuration.</span>
            <span class="r76 r">workerNode</span>.<span class="i">AutoscaleConfiguration</span> = <b>new</b> <span class="t">Autoscale</span>
            {
                <span class="i">Recurrence</span> = <b>new</b> <span class="t">AutoscaleRecurrence</span>
                {
                    <span class="c">//&quot;China Standard Time&quot;, &quot;Central Standard Time&quot;,&quot;Central American Standard Time&quot;</span>
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#2e3134fa3fcae2b9" class="i property">TimeZone</a> = <span class="s">&quot;China Standard Time&quot;</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#377398cd3b3b4f69" class="i property">Schedule</a> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#82a4e4e6eab4723b" class="t t">AutoscaleSchedule</a>&gt;
                    {
                        <b>new</b> <span class="t">AutoscaleSchedule</span>
                        {
                            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b3718bc198cfcdbb" class="i property">Days</a> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#b7740ae8cbbcaba3" class="t t">DaysOfWeek</a>?&gt;
                            {
                                <a href="/Microsoft.Azure.Management.HDInsight/A.html#b7740ae8cbbcaba3" class="t t">DaysOfWeek</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1f22eccb4467a92" class="i field">Thursday</a>
                            },
                            <span class="i">TimeAndCapacity</span> = <b>new</b> <span class="t">AutoscaleTimeAndCapacity</span>
                            {
                                <a href="/Microsoft.Azure.Management.HDInsight/A.html#4791215e96e2b030" class="i property">Time</a> = <span class="s">&quot;16:00&quot;</span>,
                                <a href="/Microsoft.Azure.Management.HDInsight/A.html#111a8a60a4555529" class="i property">MinInstanceCount</a> = 4,
                                <a href="/Microsoft.Azure.Management.HDInsight/A.html#bce5556859e2690b" class="i property">MaxInstanceCount</a> = 4
                            }
                        }
                    }
                }
            };
 
            <b>var</b> <span id="r78 rd" class="r78 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r74 r">clusterName</span>, <span class="r75 r">createParams</span>);
            <span class="i">ValidateAutoScaleConfig</span>(<span class="r76 r">workerNode</span>.<span class="i">AutoscaleConfiguration</span>,
                <span class="r78 r">cluster</span>.<span class="i">Properties</span>.<span class="i">ComputeProfile</span>.<span class="i">Roles</span>.<span class="i">First</span>(<span id="r79 rd" class="r79 r">role</span> =&gt; <span class="r79 r">role</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;workernode&quot;</span>)).<span class="i">AutoscaleConfiguration</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="89faa7f014885d5e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateRServerCluster</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r80 rd" class="r80 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-rserver&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r81 rd" class="r81 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r81 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#fdbfcdc1fa742ae1" class="i property">Kind</a> = <span class="s">&quot;RServer&quot;</span>;
            <span class="r81 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">Add</span>(
                <b>new</b> <span class="t">Role</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#fb24039d3cd14132" class="i property">Name</a> = <span class="s">&quot;edgenode&quot;</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#b3144617377d4ddd" class="i property">TargetInstanceCount</a> = 1,
                    <span class="i">HardwareProfile</span> = <b>new</b> <span class="t">HardwareProfile</span>
                    {
                        <a href="/Microsoft.Azure.Management.HDInsight/A.html#3e6a31f8dbb3cf06" class="i property">VmSize</a> = <span class="s">&quot;Standard_D4_v2&quot;</span>
                    },
                    <span class="i">OsProfile</span> = <b>new</b> <span class="t">OsProfile</span>
                    {
                        <span class="i">LinuxOperatingSystemProfile</span> = <b>new</b> <span class="t">LinuxOperatingSystemProfile</span>
                        {
                            <a href="/Microsoft.Azure.Management.HDInsight/A.html#2d7f635cd13455ad" class="i property">Username</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#974e3d85f1d36aa5" class="i property">SshUsername</a>,
                            <a href="/Microsoft.Azure.Management.HDInsight/A.html#a8e52deb860237ff" class="i property">Password</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#da68f65ee8c982e2" class="i property">SshPassword</a>
                        }
                    }
                }
            );
 
            <b>var</b> <span id="r82 rd" class="r82 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r80 r">clusterName</span>, <span class="r81 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r80 r">clusterName</span>, <span class="r81 r">createParams</span>, <span class="r82 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="cda38a8c5a30e5c1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateMLServicesCluster</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r83 rd" class="r83 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-mlservices&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r84 rd" class="r84 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r84 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#fdbfcdc1fa742ae1" class="i property">Kind</a> = <span class="s">&quot;MLServices&quot;</span>;
            <span class="r84 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#acff7f47c74afc17" class="i property">ClusterVersion</a> = <span class="s">&quot;3.6&quot;</span>;
            <span class="r84 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">Add</span>(
                <b>new</b> <span class="t">Role</span>
                {
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#fb24039d3cd14132" class="i property">Name</a> = <span class="s">&quot;edgenode&quot;</span>,
                    <a href="/Microsoft.Azure.Management.HDInsight/A.html#b3144617377d4ddd" class="i property">TargetInstanceCount</a> = 1,
                    <span class="i">HardwareProfile</span> = <b>new</b> <span class="t">HardwareProfile</span>
                    {
                        <a href="/Microsoft.Azure.Management.HDInsight/A.html#3e6a31f8dbb3cf06" class="i property">VmSize</a> = <span class="s">&quot;Standard_D4_v2&quot;</span>
                    },
                    <span class="i">OsProfile</span> = <b>new</b> <span class="t">OsProfile</span>
                    {
                        <span class="i">LinuxOperatingSystemProfile</span> = <b>new</b> <span class="t">LinuxOperatingSystemProfile</span>
                        {
                            <a href="/Microsoft.Azure.Management.HDInsight/A.html#2d7f635cd13455ad" class="i property">Username</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#974e3d85f1d36aa5" class="i property">SshUsername</a>,
                            <a href="/Microsoft.Azure.Management.HDInsight/A.html#a8e52deb860237ff" class="i property">Password</a> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#da68f65ee8c982e2" class="i property">SshPassword</a>
                        }
                    }
                }
            );
 
            <b>var</b> <span id="r85 rd" class="r85 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r83 r">clusterName</span>, <span class="r84 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r83 r">clusterName</span>, <span class="r84 r">createParams</span>, <span class="r85 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="20e0aa75e101f1e0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestListClustersInResourceGroup</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r86 rd" class="r86 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-cluster-rg1&quot;</span>);
            <b>var</b> <span id="r87 rd" class="r87 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">ListByResourceGroup</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>);
            <b>var</b> <span id="r88 rd" class="r88 r">clusterList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#1b7cc34fc3e6fb4a" class="t t">Cluster</a>&gt;(<span class="r87 r">clusterPage</span>);
            <b>while</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r87 r">clusterPage</span>.<span class="i">NextPageLink</span>))
            {
                <span class="r87 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">ListByResourceGroupNext</span>(<span class="r87 r">clusterPage</span>.<span class="i">NextPageLink</span>);
            }
 
            <span class="i">Assert</span>.<span class="i">DoesNotContain</span>(<span class="r88 r">clusterList</span>, <span id="r89 rd" class="r89 r">c</span> =&gt; <span class="r89 r">c</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="r86 r">clusterName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r90 rd" class="r90 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r91 rd" class="r91 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r86 r">clusterName</span>, <span class="r90 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r86 r">clusterName</span>, <span class="r90 r">createParams</span>, <span class="r91 r">cluster</span>);
 
            <span class="r87 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">ListByResourceGroup</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>);
            <span class="r88 r">clusterList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#1b7cc34fc3e6fb4a" class="t t">Cluster</a>&gt;(<span class="r87 r">clusterPage</span>);
            <b>while</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r87 r">clusterPage</span>.<span class="i">NextPageLink</span>))
            {
                <span class="r87 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">ListByResourceGroupNext</span>(<span class="r87 r">clusterPage</span>.<span class="i">NextPageLink</span>);
            }
 
            <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="r88 r">clusterList</span>, <span id="r92 rd" class="r92 r">c</span> =&gt; <span class="r92 r">c</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="r86 r">clusterName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
        }
 
        [<span class="i">Fact</span>(<span class="i">Skip</span> = <span class="s">&quot;Test case will list all clusters under a subscription.&quot;</span>)]
        <b>public void</b> <a id="231b6b2f73126468" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestListClustersInSubscription</a>()
        {
            <b>string</b> <span id="r93 rd" class="r93 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-cluster-rg1&quot;</span>);
            <b>var</b> <span id="r94 rd" class="r94 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">List</span>();
            <b>var</b> <span id="r95 rd" class="r95 r">clusterList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#1b7cc34fc3e6fb4a" class="t t">Cluster</a>&gt;(<span class="r94 r">clusterPage</span>);
            <b>while</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r94 r">clusterPage</span>.<span class="i">NextPageLink</span>))
            {
                <span class="r94 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">ListNext</span>(<span class="r94 r">clusterPage</span>.<span class="i">NextPageLink</span>);
            }
 
            <span class="i">Assert</span>.<span class="i">DoesNotContain</span>(<span class="r95 r">clusterList</span>, <span id="r96 rd" class="r96 r">c</span> =&gt; <span class="r96 r">c</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="r93 r">clusterName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r97 rd" class="r97 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r98 rd" class="r98 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r93 r">clusterName</span>, <span class="r97 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r93 r">clusterName</span>, <span class="r97 r">createParams</span>, <span class="r98 r">cluster</span>);
 
            <span class="r94 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">List</span>();
            <span class="r95 r">clusterList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.HDInsight/A.html#1b7cc34fc3e6fb4a" class="t t">Cluster</a>&gt;(<span class="r94 r">clusterPage</span>);
            <b>while</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r94 r">clusterPage</span>.<span class="i">NextPageLink</span>))
            {
                <span class="r94 r">clusterPage</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">ListNext</span>(<span class="r94 r">clusterPage</span>.<span class="i">NextPageLink</span>);
            }
 
            <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="r95 r">clusterList</span>, <span id="r99 rd" class="r99 r">c</span> =&gt; <span class="r99 r">c</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="r93 r">clusterName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="1c6c0efded0806a7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestResizeCluster</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r100 rd" class="r100 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-clusterresize&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r101 rd" class="r101 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r102 rd" class="r102 r">workerNodeParams</span> = <span class="r101 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">First</span>(<span id="r103 rd" class="r103 r">role</span> =&gt; <span class="r103 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;workernode&quot;</span>);
            <b>var</b> <span id="r104 rd" class="r104 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r100 r">clusterName</span>, <span class="r101 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r100 r">clusterName</span>, <span class="r101 r">createParams</span>, <span class="r104 r">cluster</span>);
 
            <span class="r104 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r100 r">clusterName</span>);
            <b>var</b> <span id="r105 rd" class="r105 r">workerNode</span> = <span class="r104 r">cluster</span>.<span class="i">Properties</span>.<span class="i">ComputeProfile</span>.<span class="i">Roles</span>.<span class="i">First</span>(<span id="r106 rd" class="r106 r">role</span> =&gt; <span class="r106 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;workernode&quot;</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r102 r">workerNodeParams</span>.<span class="i">TargetInstanceCount</span>, <span class="r105 r">workerNode</span>.<span class="i">TargetInstanceCount</span>);
 
            <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Resize</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r100 r">clusterName</span>, <span class="r102 r">workerNodeParams</span>.<span class="i">TargetInstanceCount</span>.<span class="i">Value</span> + 1);
            <span class="r104 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r100 r">clusterName</span>);
            <span class="r105 r">workerNode</span> = <span class="r104 r">cluster</span>.<span class="i">Properties</span>.<span class="i">ComputeProfile</span>.<span class="i">Roles</span>.<span class="i">First</span>(<span id="r107 rd" class="r107 r">role</span> =&gt; <span class="r107 r">role</span>.<span class="i">Name</span> == <span class="s">&quot;workernode&quot;</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r102 r">workerNodeParams</span>.<span class="i">TargetInstanceCount</span>.<span class="i">Value</span> + 1, <span class="r105 r">workerNode</span>.<span class="i">TargetInstanceCount</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="d163a53cc20437f8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestGetOrUpdateGatewaySettings</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r108 rd" class="r108 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-gateway&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r109 rd" class="r109 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <b>var</b> <span id="r110 rd" class="r110 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r108 r">clusterName</span>, <span class="r109 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r108 r">clusterName</span>, <span class="r109 r">createParams</span>, <span class="r110 r">cluster</span>);
 
            <b>string</b> <span id="r111 rd" class="r111 r">expectedUserName</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#76dea77c138d9f62" class="i property">ClusterUserName</a>;
            <b>string</b> <span id="r112 rd" class="r112 r">expectedPassword</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#373cdbf8adbfc6d6" class="i property">ClusterPassword</a>;
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#14651ffe1afd97a7" class="k">var</a> <span id="r113 rd" class="r113 r">gatewaySettings</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">GetGatewaySettings</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r108 r">clusterName</span>);
            <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#f39687eb51bd7180" class="i method">ValidateGatewaySettings</a>(<span class="r111 r">expectedUserName</span>, <span class="r112 r">expectedPassword</span>, <span class="r113 r">gatewaySettings</span>);
 
            <span class="c">// Disable gateway settings is not allowed.</span>
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#abae8598a48ee674" class="k">var</a> <span id="r114 rd" class="r114 r">updateParams</span> = <b>new</b> <span class="t">UpdateGatewaySettingsParameters</span>
            {
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#b1dc76ebb0d0ffc1" class="i property">IsCredentialEnabled</a> = <b>false</b>
            };
 
            <b>try</b>
            {
                <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">UpdateGatewaySettings</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r108 r">clusterName</span>, <span class="r114 r">updateParams</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<b>false</b>, <span class="s">&quot;Disable gateway settings should fail&quot;</span>);
            }
            <b>catch</b>(<a href="/Microsoft.Azure.Management.HDInsight/A.html#7244ec914a70326a" class="t t">ErrorResponseException</a> <span id="r115 rd" class="r115 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="i">HttpStatusCode</span>.<span class="i">MethodNotAllowed</span>, <span class="r115 r">ex</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9c69fdfc27e695f4" class="i property">Response</a>.<span class="i">StatusCode</span>);
            }
 
            <span class="c">// Make sure anything stay unchanged after attempting to disable gateway settings.</span>
            <span class="r113 r">gatewaySettings</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">GetGatewaySettings</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r108 r">clusterName</span>);
            <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#f39687eb51bd7180" class="i method">ValidateGatewaySettings</a>(<span class="r111 r">expectedUserName</span>, <span class="r112 r">expectedPassword</span>, <span class="r113 r">gatewaySettings</span>);
 
            <b>string</b> <span id="r116 rd" class="r116 r">newExpectedPassword</span> = <span class="s">&quot;NewPassword1!&quot;</span>;
            <span class="r114 r">updateParams</span> = <b>new</b> <span class="t">UpdateGatewaySettingsParameters</span>
            {
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#b1dc76ebb0d0ffc1" class="i property">IsCredentialEnabled</a> = <b>true</b>,
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#8a7b73dc40a397ab" class="i property">UserName</a> = <span class="r111 r">expectedUserName</span>,
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#2a81fe4e45a4093e" class="i property">Password</a> = <span class="r116 r">newExpectedPassword</span>
            };
 
            <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">UpdateGatewaySettings</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r108 r">clusterName</span>, <span class="r114 r">updateParams</span>);
            <span class="r113 r">gatewaySettings</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">GetGatewaySettings</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r108 r">clusterName</span>);
            <a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#f39687eb51bd7180" class="i method">ValidateGatewaySettings</a>(<span class="r111 r">expectedUserName</span>, <span class="r116 r">newExpectedPassword</span>, <span class="r113 r">gatewaySettings</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="5ca4f4d1c94b6221" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateClusterWithTLS12</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r117 rd" class="r117 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-tls12&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r118 rd" class="r118 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r118 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#5f7dd24782300ccc" class="i property">MinSupportedTlsVersion</a> = <span class="s">&quot;1.2&quot;</span>;
            <b>var</b> <span id="r119 rd" class="r119 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r117 r">clusterName</span>, <span class="r118 r">createParams</span>);
            <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;1.2&quot;</span>, <span class="r119 r">cluster</span>.<span class="i">Properties</span>.<span class="i">MinSupportedTlsVersion</span>);
            <span class="i">ValidateCluster</span>(<span class="r117 r">clusterName</span>, <span class="r118 r">createParams</span>, <span class="r119 r">cluster</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="07ddbf0495f112bd" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateClusterWithOutboundAndPrivateLink</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r120 rd" class="r120 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-outboundpl&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r121 rd" class="r121 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r121 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9170a0a45eb684fe" class="i property">Location</a> = <span class="s">&quot;South Central US&quot;</span>;
 
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#3cc341334f064e4c" class="k">var</a> <span id="r122 rd" class="r122 r">networkProperties</span> = <b>new</b> <span class="t">NetworkProperties</span>(<a href="/Microsoft.Azure.Management.HDInsight/A.html#a58b1464241dedd7" class="t t">ResourceProviderConnection</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#1b27067d8e6d3fe3" class="i field">Outbound</a>, <a href="/Microsoft.Azure.Management.HDInsight/A.html#781068ab4a39ad24" class="t t">PrivateLink</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#e609281d70d999d3" class="i field">Enabled</a>);
            <span class="r121 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<span class="i">NetworkProperties</span> = <span class="r122 r">networkProperties</span>;
 
            <b>string</b> <span id="r123 rd" class="r123 r">vnetId</span> = <span class="s">&quot;/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rg/providers/Microsoft.Network/virtualNetworks/fakevnet&quot;</span>;
            <b>string</b> <span id="r124 rd" class="r124 r">subnetId</span> = <span class="s">&quot;/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/rg/providers/Microsoft.Network/virtualNetworks/fakevnet/subnets/default&quot;</span>;
 
            <b>foreach</b> (<b>var</b> <span id="r125 rd" class="r125 r">role</span> <b>in</b> <span class="r121 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>)
            {
               <span class="r125 r">role</span>.<span class="i">VirtualNetworkProfile</span> = <b>new</b> <span class="t">VirtualNetworkProfile</span>(<span class="r123 r">vnetId</span>, <span class="r124 r">subnetId</span>);
            }
 
            <b>var</b> <span id="r126 rd" class="r126 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r120 r">clusterName</span>, <span class="r121 r">createParams</span>);
 
            <b>var</b> <span id="r127 rd" class="r127 r">result</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r120 r">clusterName</span>);
            <span class="i">ValidateCluster</span>(<span class="r120 r">clusterName</span>, <span class="r121 r">createParams</span>, <span class="r127 r">result</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="869e8a0ea4b23c43" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateClusterWithEncryptionInTransit</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <b>string</b> <span id="r128 rd" class="r128 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-encryption&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r129 rd" class="r129 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r129 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9170a0a45eb684fe" class="i property">Location</a> = <span class="s">&quot;South Central US&quot;</span>;
            <span class="r129 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<span class="i">EncryptionInTransitProperties</span> = <b>new</b> <span class="t">EncryptionInTransitProperties</span>
            {
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#ed25be2418ce04bd" class="i property">IsEncryptionInTransitEnabled</a> = <b>true</b>
            };
 
            <b>var</b> <span id="r130 rd" class="r130 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r128 r">clusterName</span>, <span class="r129 r">createParams</span>);
 
            <b>var</b> <span id="r131 rd" class="r131 r">result</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r128 r">clusterName</span>);
            <span class="i">ValidateCluster</span>(<span class="r128 r">clusterName</span>, <span class="r129 r">createParams</span>, <span class="r131 r">result</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="44bd769476943f22" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestUpdateAutoScaleConfiguration</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <span class="c">//create a cluster without autoscale config</span>
            <b>string</b> <span id="r132 rd" class="r132 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-updateautoscale&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r133 rd" class="r133 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r133 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9170a0a45eb684fe" class="i property">Location</a> = <span class="s">&quot;South Central US&quot;</span>;
 
            <b>var</b> <span id="r134 rd" class="r134 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r132 r">clusterName</span>, <span class="r133 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r132 r">clusterName</span>, <span class="r133 r">createParams</span>, <span class="r134 r">cluster</span>);
 
            <b>var</b> <span id="r135 rd" class="r135 r">clusterWithoutAutoscale</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r132 r">clusterName</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r134 r">cluster</span>.<span class="i">Properties</span>.<span class="i">ComputeProfile</span>.<span class="i">Roles</span>.<span class="i">First</span>(<span id="r136 rd" class="r136 r">role</span> =&gt; <span class="r136 r">role</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;workernode&quot;</span>)).<span class="i">AutoscaleConfiguration</span>);
 
            <span class="c">// enable autoscale</span>
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#19aacff49123692e" class="t t">AutoscaleConfigurationUpdateParameter</a> <span id="r137 rd" class="r137 r">loadBasedAutoScaleConfig</span> = <b>new</b> <span class="t">AutoscaleConfigurationUpdateParameter</span>
            {
                <span class="i">Autoscale</span> = <b>new</b> <span class="t">Autoscale</span>
                {
                    <span class="i">Capacity</span> = <b>new</b> <span class="t">AutoscaleCapacity</span>
                    {
                        <a href="/Microsoft.Azure.Management.HDInsight/A.html#e96f2b24be115d32" class="i property">MinInstanceCount</a> = 3,
                        <a href="/Microsoft.Azure.Management.HDInsight/A.html#1c808fcf5a0a9cf7" class="i property">MaxInstanceCount</a> = 4
                    }
                }
            };
            <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">UpdateAutoScaleConfiguration</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r132 r">clusterName</span>, <span class="r137 r">loadBasedAutoScaleConfig</span>);
            <b>var</b> <span id="r138 rd" class="r138 r">clusterEnabledAutoScale</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r132 r">clusterName</span>);
 
            <span class="i">ValidateAutoScaleConfig</span>(<span class="r137 r">loadBasedAutoScaleConfig</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f7c6eea52a253ed0" class="i property">Autoscale</a>, <span class="r138 r">clusterEnabledAutoScale</span>.<span class="i">Properties</span>.<span class="i">ComputeProfile</span>.<span class="i">Roles</span>.<span class="i">First</span>(<span id="r139 rd" class="r139 r">role</span> =&gt; <span class="r139 r">role</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;workernode&quot;</span>)).<span class="i">AutoscaleConfiguration</span>);
 
            <span class="c">// disable autoscale</span>
            <span class="r137 r">loadBasedAutoScaleConfig</span>.<span class="i">Autoscale</span> = <b>null</b>;
            <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">UpdateAutoScaleConfiguration</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r132 r">clusterName</span>, <span class="r137 r">loadBasedAutoScaleConfig</span>);
            <b>var</b> <span id="r140 rd" class="r140 r">clusterDisabledAutoScale</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Get</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r132 r">clusterName</span>);
 
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r140 r">clusterDisabledAutoScale</span>.<span class="i">Properties</span>.<span class="i">ComputeProfile</span>.<span class="i">Roles</span>.<span class="i">First</span>(<span id="r141 rd" class="r141 r">role</span> =&gt; <span class="r141 r">role</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;workernode&quot;</span>)).<span class="i">AutoscaleConfiguration</span>);
        }
 
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="139d7c2a80afc005" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestCreateClusterWithEncryptionAtHost</a>()
        {
            <a href="HDInsightManagementTestBase.cs.html#3e556594d1ac3c07" class="i method">TestInitialize</a>();
 
            <span class="c">// create HDInsight cluster with encrytpion at host</span>
            <b>string</b> <span id="r142 rd" class="r142 r">clusterName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;hdisdk-encryptionathost&quot;</span>);
            <a href="/Microsoft.Azure.Management.HDInsight/A.html#b40349c3dfb11e02" class="k">var</a> <span id="r143 rd" class="r143 r">createParams</span> = <a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/HDInsightManagementTestUtilities.cs.html#45750bba7a204f74" class="i method">PrepareClusterCreateParamsForWasb</a>();
            <span class="r143 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#9170a0a45eb684fe" class="i property">Location</a> = <span class="s">&quot;South Central US&quot;</span>;
            <span class="r143 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#f8dcb4ff658c96d8" class="i property">ClusterDefinition</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#fdbfcdc1fa742ae1" class="i property">Kind</a> = <span class="s">&quot;Spark&quot;</span>;
 
            <span class="r143 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#d30c89932f32148c" class="i property">ComputeProfile</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#81969beedb3162c1" class="i property">Roles</a>.<span class="i">ToList</span>().<span class="i">ForEach</span>(<span id="r144 rd" class="r144 r">role</span> =&gt; <span class="r144 r">role</span>.<span class="i">HardwareProfile</span>.<span class="i">VmSize</span> = <span class="s">&quot;Standard_DS14_v2&quot;</span>);
 
            <span class="r143 r">createParams</span>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#bbc24cdd78abc182" class="i property">Properties</a>.<span class="i">DiskEncryptionProperties</span> = <b>new</b> <span class="t">DiskEncryptionProperties</span>
            {
                <a href="/Microsoft.Azure.Management.HDInsight/A.html#6b73ea15e2d3aa9f" class="i property">EncryptionAtHost</a> = <b>true</b>
            };
 
            <b>var</b> <span id="r145 rd" class="r145 r">cluster</span> = <a href="HDInsightManagementTestBase.cs.html#fe3e7869a11be622" class="i property">HDInsightClient</a>.<a href="/Microsoft.Azure.Management.HDInsight/A.html#b1c6604bd2a9ab38" class="i property">Clusters</a>.<span class="i">Create</span>(<a href="HDInsightManagementTestBase.cs.html#e4e83f5856c511b0" class="i property">CommonData</a>.<a href="../TestHelpers/CommonTestsFixture.cs.html#6bbaafd9400ebcaa" class="i property">ResourceGroupName</a>, <span class="r142 r">clusterName</span>, <span class="r143 r">createParams</span>);
            <span class="i">ValidateCluster</span>(<span class="r142 r">clusterName</span>, <span class="r143 r">createParams</span>, <span class="r145 r">cluster</span>);
 
            <span class="c">// check encryption at host properties</span>
            <b>var</b> <span id="r146 rd" class="r146 r">diskEncryptionProperties</span> = <span class="r145 r">cluster</span>.<span class="i">Properties</span>.<span class="i">DiskEncryptionProperties</span>;
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r146 r">diskEncryptionProperties</span>.<span class="i">EncryptionAtHost</span>);
        }
    }
}
</pre></td></tr></table></div></body></html>
