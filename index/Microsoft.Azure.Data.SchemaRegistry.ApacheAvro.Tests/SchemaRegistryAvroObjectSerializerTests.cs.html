<!DOCTYPE html>
<html><head><title>SchemaRegistryAvroObjectSerializerTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(54);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.Data.SchemaRegistry.ApacheAvro.Tests/SchemaRegistryAvroObjectSerializerTests.cs" target="_top">SchemaRegistryAvroObjectSerializerTests.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/schemaregistry/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/tests/SchemaRegistryAvroObjectSerializerTests.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.Data.SchemaRegistry.ApacheAvro.Tests" target="_top">Microsoft.Azure.Data.SchemaRegistry.ApacheAvro.Tests.csproj</a> (Microsoft.Azure.Data.SchemaRegistry.ApacheAvro.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Data</span>.<span class="i n">SchemaRegistry</span>;
<b>using</b> <span class="i n">Moq</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
<b>using</b> <span class="i n">TestSchema</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Data</span>.<span class="i n">SchemaRegistry</span>.<span class="i n">ApacheAvro</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="0cced6933a7ead71" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="b8232522d1104016">SchemaRegistryAvroObjectSerializerTests</span></a>
    {
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7f3c372744acf1b6" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SerializeWorksWithNoOptions</a>()
        {
            <b>var</b> <span id="r0 rd" class="r0 r">mockClient</span> = <b>new</b> <span class="t constructor">Mock</span>&lt;<a href="/Azure.Data.SchemaRegistry/A.html#aaccabb1d39bb2b5" class="t t">SchemaRegistryClient</a>&gt;();
            <span class="r0 r">mockClient</span>
                .<span class="i method">Setup</span>(
                    <span id="r1 rd" class="r1 r">client</span> =&gt; <span class="r1 r">client</span>.<a href="/Azure.Data.SchemaRegistry/A.html#b34a430ed92ac35a" class="i method">GetSchemaPropertiesAsync</a>(
                        <span class="s">&quot;groupName&quot;</span>,
                        <a href="Models/Employee.cs.html#931b52565f96757d" class="t t">Employee</a>.<a href="Models/Employee.cs.html#fc1cac03a3a7075f" class="i field">_SCHEMA</a>.<span class="i property">Fullname</span>,
                        <a href="Models/Employee.cs.html#931b52565f96757d" class="t t">Employee</a>.<a href="Models/Employee.cs.html#fc1cac03a3a7075f" class="i field">_SCHEMA</a>.<span class="i method">ToString</span>(),
                        <a href="/Azure.Data.SchemaRegistry/A.html#e18a3cc6ea62d674" class="t t">SchemaFormat</a>.<a href="/Azure.Data.SchemaRegistry/A.html#ed513c1aee168ff2" class="i property">Avro</a>,
                        <a href="@0@mscorlib/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a>.<a href="@0@mscorlib/A.html#ec32c41597007382" class="i property">None</a>))
                .<span class="i method">Returns</span>(
                    <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#11a386e7d7cae64a" class="i method">FromResult</a>(
                        <a href="/Azure.Core/A.html#ad97b1910f5ca3eb" class="t t">Response</a>.<a href="/Azure.Core/A.html#ff41acd78201fc1c" class="i method">FromValue</a>(
                            <a href="/Azure.Data.SchemaRegistry/A.html#aa71464640f5f5d0" class="t t">SchemaRegistryModelFactory</a>.<a href="/Azure.Data.SchemaRegistry/A.html#821f76a3a01b1e0a" class="i method">SchemaProperties</a>(<a href="/Azure.Data.SchemaRegistry/A.html#e18a3cc6ea62d674" class="t t">SchemaFormat</a>.<a href="/Azure.Data.SchemaRegistry/A.html#ed513c1aee168ff2" class="i property">Avro</a>, <span class="s">&quot;schemaId&quot;</span>), <b>new</b> <a href="/Azure.Core.TestFramework/A.html#ef2adc622c2950d8" class="t constructor">MockResponse</a>(200))));
 
           <a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#8e46a6f3503de220" class="k">var</a> <span id="r2 rd" class="r2 r">serializer</span> = <b>new</b> <a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#773bd21949a02201" class="t constructor">SchemaRegistryAvroSerializer</a>(<span class="r0 r">mockClient</span>.<span class="i property">Object</span>, <span class="s">&quot;groupName&quot;</span>);
           <a href="/Azure.Core/A.html#71c53fa0fa3388b2" class="k">var</a> <span id="r3 rd" class="r3 r">content</span> = <b>await</b> <span class="r2 r">serializer</span>.<a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#426eeab26c7db717" class="i method">SerializeAsync</a>(<b>new</b> <a href="Models/Employee.cs.html#931b52565f96757d" class="t constructor">Employee</a> {<a href="Models/Employee.cs.html#f746388f85bc96ea" class="i property">Age</a> = 42, <a href="Models/Employee.cs.html#eaab8dd458258da3" class="i property">Name</a> = <span class="s">&quot;Caketown&quot;</span>});
           <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;schemaId&quot;</span>, <span class="r3 r">content</span>.<a href="/Azure.Core/A.html#8fdcb23beb9900d4" class="i property">ContentType</a>.<a href="@0@mscorlib/A.html#d83d2db767b43db7" class="i method">ToString</a>().<a href="@0@mscorlib/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<span class="s">&#39;+&#39;</span>)[1]);
 
           <span class="c">// also validate explicitly passing null</span>
           <span class="r2 r">serializer</span> = <b>new</b> <a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#103cacc1eefad014" class="t constructor">SchemaRegistryAvroSerializer</a>(<span class="r0 r">mockClient</span>.<span class="i property">Object</span>, <span class="s">&quot;groupName&quot;</span>, <b>null</b>);
           <span class="r3 r">content</span> = <b>await</b> <span class="r2 r">serializer</span>.<a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#426eeab26c7db717" class="i method">SerializeAsync</a>(<b>new</b> <a href="Models/Employee.cs.html#931b52565f96757d" class="t constructor">Employee</a> {<a href="Models/Employee.cs.html#f746388f85bc96ea" class="i property">Age</a> = 42, <a href="Models/Employee.cs.html#eaab8dd458258da3" class="i property">Name</a> = <span class="s">&quot;Caketown&quot;</span>});
           <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="s">&quot;schemaId&quot;</span>, <span class="r3 r">content</span>.<a href="/Azure.Core/A.html#8fdcb23beb9900d4" class="i property">ContentType</a>.<a href="@0@mscorlib/A.html#d83d2db767b43db7" class="i method">ToString</a>().<a href="@0@mscorlib/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<span class="s">&#39;+&#39;</span>)[1]);
        }
 
        [<span class="t constructor">Test</span>]
        <b>public void</b> <a id="45f46d6a4aa69b34" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CloneCopiesAllProperties</a>()
        {
            <a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#b710fba2bb09357d" class="k">var</a> <span id="r4 rd" class="r4 r">options</span> = <b>new</b> <a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#e271fb055de3f7f3" class="t constructor">SchemaRegistryAvroSerializerOptions</a>() { <a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#1821bcd6956d5f65" class="i property">AutoRegisterSchemas</a> = <b>true</b> };
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r4 r">options</span>.<a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#1821bcd6956d5f65" class="i property">AutoRegisterSchemas</a>);
 
            <a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#b710fba2bb09357d" class="k">var</a> <span id="r5 rd" class="r5 r">cloned</span> = <span class="r4 r">options</span>.<a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#ea183f7246445c3c" class="i method">Clone</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r4 r">options</span>.<a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#1821bcd6956d5f65" class="i property">AutoRegisterSchemas</a>, <span class="r5 r">cloned</span>.<a href="/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/A.html#1821bcd6956d5f65" class="i property">AutoRegisterSchemas</a>);
        }
    }
}</pre></td></tr></table></div></body></html>
