<!DOCTYPE html>
<html><head><title>TableSasQueryParameters.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(158);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Data.Tables/Sas/TableSasQueryParameters.cs" target="_top">Sas\TableSasQueryParameters.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Data.Tables" target="_top">src\Azure.Data.Tables.csproj</a> (Azure.Data.Tables)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Data</span>.<span class="i n">Tables</span>.<span class="i n">Sas</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#44469aede84faf55" class="t t">TableSasQueryParameters</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object represents the components</span>
    <span class="c">///</span><span class="c"> that make up an Azure Storage Shared Access Signature&#39;s query</span>
    <span class="c">///</span><span class="c"> parameters.  You can construct a new instance using</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="TableSasBuilder.cs.html#0846d051086f286a" class="t t">TableSasBuilder</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> For more information, </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">href</span><span class="c">=</span><span class="c">&quot;</span><span class="c">https://docs.microsoft.com/rest/api/storageservices/create-service-sas</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Create a service SAS</span><span class="c">&lt;/</span><span class="c">see</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="44469aede84faf55" href="../R/44469aede84faf55.html" target="n" data-glyph="0,0" class="t t">TableSasQueryParameters</a> : <a href="TableAccountSasQueryParameters.cs.html#509988ed2dde382e" class="t t">TableAccountSasQueryParameters</a>
    {
        <b>internal string</b> <a id="bd7c99fb56925fdf" href="../R/bd7c99fb56925fdf.html" target="n" data-glyph="104,1" class="i property">TableName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The start of PartionKey range.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="fc04ad7977a31e47" href="../R/fc04ad7977a31e47.html" target="n" data-glyph="102,1" class="i property">StartPartitionKey</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The end of PartionKey range.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="004a8c1f8efdf809" href="../R/004a8c1f8efdf809.html" target="n" data-glyph="102,1" class="i property">StartRowKey</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The start of RowKey range.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="a4779b7c54560eba" href="../R/a4779b7c54560eba.html" target="n" data-glyph="102,1" class="i property">EndPartitionKey</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The end of RowKey range.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="22dc20ef5bd71d74" href="../R/22dc20ef5bd71d74.html" target="n" data-glyph="102,1" class="i property">EndRowKey</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets empty shared access signature query parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#44469aede84faf55" class="t t">TableSasQueryParameters</a> <a id="b69e5e5a23cdb252" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Empty</a> =&gt; <b>new</b> <a href="#ffb6f6bc81cb4f17" class="t constructor">TableSasQueryParameters</a>();
 
        <b>internal</b> <a id="ffb6f6bc81cb4f17" href="../R/ffb6f6bc81cb4f17.html" target="n" data-glyph="74,1" class="t constructor">TableSasQueryParameters</a>()
            : <a href="TableAccountSasQueryParameters.cs.html#9d83df9e081a3531" class="k">base</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new TableSasQueryParameters instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="35ce8dfe2a830c58" href="../R/35ce8dfe2a830c58.html" target="n" data-glyph="74,1" class="t constructor">TableSasQueryParameters</a>(
            <b>string</b> <span id="r0 rd" class="r0 r">version</span>,
            <a href="TableAccountSasResourceTypes.cs.html#ad36919a6753b594" class="t t">TableAccountSasResourceTypes</a>? <span id="r1 rd" class="r1 r">resourceTypes</span>,
            <b>string</b> <span id="r2 rd" class="r2 r">tableName</span>,
            <b>string</b> <span id="r3 rd" class="r3 r">partitionKeyStart</span>,
            <b>string</b> <span id="r4 rd" class="r4 r">rowKeyStart</span>,
            <b>string</b> <span id="r5 rd" class="r5 r">partitionKeyEnd</span>,
            <b>string</b> <span id="r6 rd" class="r6 r">rowKeyEnd</span>,
            <a href="TableSasProtocol.cs.html#f120747ad1c44770" class="t t">TableSasProtocol</a> <span id="r7 rd" class="r7 r">protocol</span>,
            <span class="i">DateTimeOffset</span> <span id="r8 rd" class="r8 r">startsOn</span>,
            <span class="i">DateTimeOffset</span> <span id="r9 rd" class="r9 r">expiresOn</span>,
            <a href="TableSasIPRange.cs.html#6f63b11dc18152f6" class="t t">TableSasIPRange</a> <span id="r10 rd" class="r10 r">ipRange</span>,
            <b>string</b> <span id="r11 rd" class="r11 r">identifier</span>,
            <b>string</b> <span id="r12 rd" class="r12 r">resource</span>,
            <b>string</b> <span id="r13 rd" class="r13 r">permissions</span>,
            <b>string</b> <span id="r14 rd" class="r14 r">signature</span>)
            : <a href="TableAccountSasQueryParameters.cs.html#327c5d9d8c152998" class="k">base</a>(
                <span class="r0 r">version</span>,
                <span class="r1 r">resourceTypes</span>,
                <span class="r7 r">protocol</span>,
                <span class="r8 r">startsOn</span>,
                <span class="r9 r">expiresOn</span>,
                <span class="r10 r">ipRange</span>,
                <span class="r11 r">identifier</span>,
                <span class="r12 r">resource</span>,
                <span class="r13 r">permissions</span>,
                <span class="r14 r">signature</span>)
        {
            <a href="#bd7c99fb56925fdf" class="i property">TableName</a> = <span class="r2 r">tableName</span>;
            <a href="#fc04ad7977a31e47" class="i property">StartPartitionKey</a> = <span class="r3 r">partitionKeyStart</span>;
            <a href="#a4779b7c54560eba" class="i property">EndPartitionKey</a> = <span class="r5 r">partitionKeyEnd</span>;
            <a href="#004a8c1f8efdf809" class="i property">StartRowKey</a> = <span class="r4 r">rowKeyStart</span>;
            <a href="#22dc20ef5bd71d74" class="i property">EndRowKey</a> = <span class="r6 r">rowKeyEnd</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#44469aede84faf55" class="t t">TableSasQueryParameters</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> type based on the supplied query parameters </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">values</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> All SAS-related query parameters will be removed from</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">values</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">values</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">URI query parameters</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a2546ccae0c1302b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">TableSasQueryParameters</a>(
            <span class="i">IDictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <span id="r15 rd" class="r15 r">values</span>)
            : <a href="TableAccountSasQueryParameters.cs.html#143abaa87d71c49c" class="k">base</a>(<span class="r15 r">values</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r16 rd" class="r16 r">key</span> <b>in</b> <span class="r15 r">values</span>.<span class="i">Keys</span>.<span class="i">ToList</span>())
            {
                <span class="c">// these are already decoded</span>
                <b>var</b> <span id="r17 rd" class="r17 r">isSasKey</span> = <b>true</b>;
                <b>switch</b> (<span class="r16 r">key</span>.<span class="i">ToUpperInvariant</span>())
                {
                    <b>case</b> <a href="../TableConstants.cs.html#665de419db95984f" class="t t">TableConstants</a>.<a href="../TableConstants.cs.html#b6dae59194e47ef5" class="t t">Sas</a>.<a href="../TableConstants.cs.html#aaf2fc997e60d2c4" class="t t">Parameters</a>.<a href="../TableConstants.cs.html#aaedccc31a442f84" class="i field">TableNameUpper</a>:
                        <a href="#bd7c99fb56925fdf" class="i property">TableName</a> = <span class="r15 r">values</span>[<span class="r16 r">key</span>];
                        <b>break</b>;
 
                    <span class="c">// We didn&#39;t recognize the query parameter</span>
                    <b>default</b>:
                        <span class="r17 r">isSasKey</span> = <b>false</b>;
                        <b>break</b>;
                }
 
                <span class="c">// Set the value to null if it&#39;s part of the SAS</span>
                <b>if</b> (<span class="r17 r">isSasKey</span>)
                {
                    <span class="r15 r">values</span>[<span class="r16 r">key</span>] = <b>null</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert the SAS query parameters into a URL encoded query string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A URL encoded query string representing the SAS.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="e91b666948c7c3e8" href="../R/e91b666948c7c3e8.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <span class="i">StringBuilder</span> <span id="r18 rd" class="r18 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="r18 r">sb</span>.<a href="TableSasExtensions.cs.html#6e9161cae14b7495" class="i method">AppendQueryParameter</a>(<a href="../TableConstants.cs.html#665de419db95984f" class="t t">TableConstants</a>.<a href="../TableConstants.cs.html#b6dae59194e47ef5" class="t t">Sas</a>.<a href="../TableConstants.cs.html#aaf2fc997e60d2c4" class="t t">Parameters</a>.<a href="../TableConstants.cs.html#8206c2f1290a2bd3" class="i field">TableName</a>, <a href="#bd7c99fb56925fdf" class="i property">TableName</a>);
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<a href="#fc04ad7977a31e47" class="i property">StartPartitionKey</a>))
            {
                <span class="r18 r">sb</span>.<a href="TableSasExtensions.cs.html#6e9161cae14b7495" class="i method">AppendQueryParameter</a>(<a href="../TableConstants.cs.html#665de419db95984f" class="t t">TableConstants</a>.<a href="../TableConstants.cs.html#b6dae59194e47ef5" class="t t">Sas</a>.<a href="../TableConstants.cs.html#aaf2fc997e60d2c4" class="t t">Parameters</a>.<a href="../TableConstants.cs.html#b23fcdfef78d9fc8" class="i field">StartPartitionKey</a>, <a href="#fc04ad7977a31e47" class="i property">StartPartitionKey</a>);
            }
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<a href="#a4779b7c54560eba" class="i property">EndPartitionKey</a>))
            {
                <span class="r18 r">sb</span>.<a href="TableSasExtensions.cs.html#6e9161cae14b7495" class="i method">AppendQueryParameter</a>(<a href="../TableConstants.cs.html#665de419db95984f" class="t t">TableConstants</a>.<a href="../TableConstants.cs.html#b6dae59194e47ef5" class="t t">Sas</a>.<a href="../TableConstants.cs.html#aaf2fc997e60d2c4" class="t t">Parameters</a>.<a href="../TableConstants.cs.html#16f27c4ae119614c" class="i field">EndPartitionKey</a>, <a href="#a4779b7c54560eba" class="i property">EndPartitionKey</a>);
            }
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<a href="#004a8c1f8efdf809" class="i property">StartRowKey</a>))
            {
                <span class="r18 r">sb</span>.<a href="TableSasExtensions.cs.html#6e9161cae14b7495" class="i method">AppendQueryParameter</a>(<a href="../TableConstants.cs.html#665de419db95984f" class="t t">TableConstants</a>.<a href="../TableConstants.cs.html#b6dae59194e47ef5" class="t t">Sas</a>.<a href="../TableConstants.cs.html#aaf2fc997e60d2c4" class="t t">Parameters</a>.<a href="../TableConstants.cs.html#9013431f746bfb7d" class="i field">StartRowKey</a>, <a href="#004a8c1f8efdf809" class="i property">StartRowKey</a>);
            }
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<a href="#22dc20ef5bd71d74" class="i property">EndRowKey</a>))
            {
                <span class="r18 r">sb</span>.<a href="TableSasExtensions.cs.html#6e9161cae14b7495" class="i method">AppendQueryParameter</a>(<a href="../TableConstants.cs.html#665de419db95984f" class="t t">TableConstants</a>.<a href="../TableConstants.cs.html#b6dae59194e47ef5" class="t t">Sas</a>.<a href="../TableConstants.cs.html#aaf2fc997e60d2c4" class="t t">Parameters</a>.<a href="../TableConstants.cs.html#830a946ff61ba032" class="i field">EndRowKey</a>, <a href="#22dc20ef5bd71d74" class="i property">EndRowKey</a>);
            }
            <a href="#44469aede84faf55" class="k">this</a>.<a href="TableSasExtensions.cs.html#4fcbea1afcd7665f" class="i method">AppendProperties</a>(<span class="r18 r">sb</span>);
            <b>return</b> <span class="r18 r">sb</span>.<span class="i">ToString</span>();
        }
    }
}
</pre></td></tr></table></div></body></html>
