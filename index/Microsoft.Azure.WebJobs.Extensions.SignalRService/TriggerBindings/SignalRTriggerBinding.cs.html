<!DOCTYPE html>
<html><head><title>SignalRTriggerBinding.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(255);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.SignalRService/TriggerBindings/SignalRTriggerBinding.cs" target="_top">TriggerBindings\SignalRTriggerBinding.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/signalr/Microsoft.Azure.WebJobs.Extensions.SignalRService/src/TriggerBindings/SignalRTriggerBinding.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.SignalRService" target="_top">Microsoft.Azure.WebJobs.Extensions.SignalRService.csproj</a> (Microsoft.Azure.WebJobs.Extensions.SignalRService)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">SignalR</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">SignalR</span>.<span class="i n">Management</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Host</span>.<span class="i n">Bindings</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Host</span>.<span class="i n">Listeners</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Host</span>.<span class="i n">Protocols</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Host</span>.<span class="i n">Triggers</span>;
<b>using</b> <span class="i n">Newtonsoft</span>.<span class="i n">Json</span>.<span class="i n">Linq</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Extensions</span>.<span class="i n">SignalRService</span>
{
    <b>internal class</b> <a id="a608effc92817672" href="../R/a608effc92817672.html" target="n" data-glyph="2,0" class="t t">SignalRTriggerBinding</a> : <span class="t t">ITriggerBinding</span>
    {
        <b>private const string</b> <a id="5e63f339ecd19235" href="../R/5e63f339ecd19235.html" target="n" data-glyph="10,1" class="i field">ReturnParameterKey</a> = <span class="s">&quot;$return&quot;</span>;
 
        <b>private readonly</b> <a href="@1@netstandard/A.html#adf5577c07f51f16" class="t t">ParameterInfo</a> <a id="f74ae710e67f95b8" href="../R/f74ae710e67f95b8.html" target="n" data-glyph="46,1" class="i field">_parameterInfo</a>;
        <b>private readonly</b> <a href="SignalRTriggerAttribute.cs.html#5a1a9ceece6fd92d" class="t t">SignalRTriggerAttribute</a> <a id="61bd5b189818faea" href="../R/61bd5b189818faea.html" target="n" data-glyph="46,1" class="i field">_attribute</a>;
        <b>private readonly</b> <a href="ISignalRTriggerDispatcher.cs.html#ce7208060f389994" class="t t">ISignalRTriggerDispatcher</a> <a id="da2b69da0cce6908" href="../R/da2b69da0cce6908.html" target="n" data-glyph="46,1" class="i field">_dispatcher</a>;
        <b>private readonly</b> <span class="t t">AccessKey</span>[] <a id="b4f28a87b2451ed2" href="../R/b4f28a87b2451ed2.html" target="n" data-glyph="46,1" class="i field">_accessKeys</a>;
        <b>private readonly</b> <span class="t t">ServiceHubContext</span> <a id="a0552735457a3b39" href="../R/a0552735457a3b39.html" target="n" data-glyph="46,1" class="i field">_hubContext</a>;
 
        <b>public</b> <a id="4991351846591b50" href="../R/4991351846591b50.html" target="n" data-glyph="72,1" class="t constructor">SignalRTriggerBinding</a>(<a href="@1@netstandard/A.html#adf5577c07f51f16" class="t t">ParameterInfo</a> <span id="r0 rd" class="r0 r">parameterInfo</span>, <a href="SignalRTriggerAttribute.cs.html#5a1a9ceece6fd92d" class="t t">SignalRTriggerAttribute</a> <span id="r1 rd" class="r1 r">attribute</span>, <a href="ISignalRTriggerDispatcher.cs.html#ce7208060f389994" class="t t">ISignalRTriggerDispatcher</a> <span id="r2 rd" class="r2 r">dispatcher</span>, <span class="t t">AccessKey</span>[] <span id="r3 rd" class="r3 r">accessKeys</span>, <span class="t t">ServiceHubContext</span> <span id="r4 rd" class="r4 r">hubContext</span>)
        {
            <a href="#f74ae710e67f95b8" class="i field">_parameterInfo</a> = <span class="r0 r">parameterInfo</span> ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">parameterInfo</span>));
            <a href="#61bd5b189818faea" class="i field">_attribute</a> = <span class="r1 r">attribute</span> ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r1 r">attribute</span>));
            <a href="#da2b69da0cce6908" class="i field">_dispatcher</a> = <span class="r2 r">dispatcher</span> ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">dispatcher</span>));
            <a href="#b4f28a87b2451ed2" class="i field">_accessKeys</a> = <span class="r3 r">accessKeys</span> ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">accessKeys</span>));
            <a href="#a0552735457a3b39" class="i field">_hubContext</a> = <span class="r4 r">hubContext</span>;
            <a href="#ec401f76e015d773" class="i property">BindingDataContract</a> = <a href="#0095b1642e680acf" class="i method">CreateBindingContract</a>(<a href="#61bd5b189818faea" class="i field">_attribute</a>, <a href="#f74ae710e67f95b8" class="i field">_parameterInfo</a>);
        }
 
        <b>public</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="t t">ITriggerData</span>&gt; <a id="f1bce723d9fab0f1" href="../R/f1bce723d9fab0f1.html" target="n" data-glyph="72,1" class="i method">BindAsync</a>(<b>object</b> <span id="r5 rd" class="r5 r">value</span>, <span class="t t">ValueBindingContext</span> <span id="r6 rd" class="r6 r">context</span>)
        {
            <a href="@1@netstandard/A.html#d3599058f8d79be0" class="k">var</a> <span id="r7 rd" class="r7 r">bindingData</span> = <b>new</b> <a href="@1@netstandard/A.html#05d4a216235a779c" class="t constructor">Dictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;(<a href="@1@netstandard/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@1@netstandard/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>);
 
            <b>if</b> (<span class="r5 r">value</span> <b>is</b> <a href="SignalRTriggerEvent.cs.html#32afb3486e4dde4f" class="t t">SignalRTriggerEvent</a> <span id="r8 rd" class="r8 r">triggerEvent</span>)
            {
                <a href="Context/InvocationContext.cs.html#f093b6e0842b59d4" class="k">var</a> <span id="r9 rd" class="r9 r">bindingContext</span> = <span class="r8 r">triggerEvent</span>.<a href="SignalRTriggerEvent.cs.html#3743688c285a1836" class="i property">Context</a>;
                <span class="r9 r">bindingContext</span>.<a href="Context/InvocationContext.cs.html#dbc1e85c79ef7f66" class="i property">HubContext</a> = <a href="#a0552735457a3b39" class="i field">_hubContext</a>;
                <span class="c">// If ParameterNames are set, bind them in order.</span>
                <span class="c">// To reduce undefined situation, number of arguments should keep consist with that of ParameterNames</span>
                <b>if</b> (<a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#777633891f9909a2" class="i property">ParameterNames</a> != <b>null</b> &amp;&amp; <a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#777633891f9909a2" class="i property">ParameterNames</a>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a> != 0)
                {
                    <b>if</b> (<span class="r9 r">bindingContext</span>.<a href="Context/InvocationContext.cs.html#35f8f010910df223" class="i property">Arguments</a> == <b>null</b> ||
                        <span class="r9 r">bindingContext</span>.<a href="Context/InvocationContext.cs.html#35f8f010910df223" class="i property">Arguments</a>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a> != <a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#777633891f9909a2" class="i property">ParameterNames</a>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a>)
                    {
                        <b>throw</b> <b>new</b> <a href="../Exceptions/SignalRTriggerParametersNotMatchException.cs.html#ffbd033c2a3b61ac" class="t constructor">SignalRTriggerParametersNotMatchException</a>(<a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#777633891f9909a2" class="i property">ParameterNames</a>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r9 r">bindingContext</span>.<a href="Context/InvocationContext.cs.html#35f8f010910df223" class="i property">Arguments</a>?.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a> ?? 0);
                    }
 
                    <a href="#686fd8c813067b81" class="i method">AddParameterNamesBindingData</a>(<span class="r7 r">bindingData</span>, <a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#777633891f9909a2" class="i property">ParameterNames</a>, <span class="r9 r">bindingContext</span>.<a href="Context/InvocationContext.cs.html#35f8f010910df223" class="i property">Arguments</a>);
                }
 
                <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#11a386e7d7cae64a" class="i method">FromResult</a>&lt;<span class="t t">ITriggerData</span>&gt;(<b>new</b> <span class="t constructor">TriggerData</span>(<b>new</b> <a href="#45877e12a4e7dac2" class="t constructor">SignalRTriggerValueProvider</a>(<a href="#f74ae710e67f95b8" class="i field">_parameterInfo</a>, <span class="r9 r">bindingContext</span>), <span class="r7 r">bindingData</span>)
                {
                    <span class="i property">ReturnValueProvider</span> = <span class="r8 r">triggerEvent</span>.<a href="SignalRTriggerEvent.cs.html#2a91480a92a89e13" class="i property">TaskCompletionSource</a> == <b>null</b> ? <b>null</b> : <b>new</b> <a href="#244194280483642f" class="t constructor">TriggerReturnValueProvider</a>(<span class="r8 r">triggerEvent</span>.<a href="SignalRTriggerEvent.cs.html#2a91480a92a89e13" class="i property">TaskCompletionSource</a>),
                });
            }
 
            <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#11a386e7d7cae64a" class="i method">FromResult</a>&lt;<span class="t t">ITriggerData</span>&gt;(<b>null</b>);
        }
 
        <b>public</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="t t">IListener</span>&gt; <a id="bca1e9aff068f255" href="../R/bca1e9aff068f255.html" target="n" data-glyph="72,1" class="i method">CreateListenerAsync</a>(<span class="t t">ListenerFactoryContext</span> <span id="r10 rd" class="r10 r">context</span>)
        {
            <b>if</b> (<span class="r10 r">context</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r10 r">context</span>));
            }
 
            <span class="c">// It&#39;s not a real listener, and it doesn&#39;t need a start or close.</span>
            <a href="#da2b69da0cce6908" class="i field">_dispatcher</a>.<a href="ISignalRTriggerDispatcher.cs.html#0f7a4f9113037ade" class="i method">Map</a>((<a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#d2712b0ecc6923df" class="i property">HubName</a>, <a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#a20c4dc60d2d6d67" class="i property">Category</a>, <a href="#61bd5b189818faea" class="i field">_attribute</a>.<a href="SignalRTriggerAttribute.cs.html#ae9039db05a212f0" class="i property">Event</a>),
                <b>new</b> <a href="Executor/ExecutionContext.cs.html#4d1e21a8d92abc47" class="t constructor">ExecutionContext</a> { <a href="Executor/ExecutionContext.cs.html#43326607a9479b3d" class="i property">Executor</a> = <span class="r10 r">context</span>.<span class="i property">Executor</span>, <a href="Executor/ExecutionContext.cs.html#060bd729f5a1dea3" class="i property">AccessKeys</a> = <a href="#b4f28a87b2451ed2" class="i field">_accessKeys</a> });
 
            <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#11a386e7d7cae64a" class="i method">FromResult</a>&lt;<span class="t t">IListener</span>&gt;(<b>new</b> <a href="NullListener.cs.html#8652576c06dd8e44" class="t constructor">NullListener</a>());
        }
 
        <b>public</b> <span class="t t">ParameterDescriptor</span> <a id="6d045a434b89fe0c" href="../R/6d045a434b89fe0c.html" target="n" data-glyph="72,1" class="i method">ToParameterDescriptor</a>()
        {
            <b>return</b> <b>new</b> <span class="t constructor">ParameterDescriptor</span>
            {
                <span class="i property">Name</span> = <a href="#f74ae710e67f95b8" class="i field">_parameterInfo</a>.<a href="@1@netstandard/A.html#5189606fee27d248" class="i property">Name</a>,
            };
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Type of object in BindAsync</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a> <a id="7247b6f7e792f369" href="../R/7247b6f7e792f369.html" target="n" data-glyph="102,1" class="i property">TriggerValueType</a> =&gt; <b>typeof</b>(<a href="SignalRTriggerEvent.cs.html#32afb3486e4dde4f" class="t t">SignalRTriggerEvent</a>);
 
        <span class="c">// TODO: Use dynamic contract to deal with parameterName</span>
        <b>public</b> <a href="@1@netstandard/A.html#f786bcc5e7b69c7d" class="t t">IReadOnlyDictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a>&gt; <a id="ec401f76e015d773" href="../R/ec401f76e015d773.html" target="n" data-glyph="102,1" class="i property">BindingDataContract</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Defined what other bindings can use and return value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@1@netstandard/A.html#f786bcc5e7b69c7d" class="t t">IReadOnlyDictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a>&gt; <a id="0095b1642e680acf" href="../R/0095b1642e680acf.html" target="n" data-glyph="76,1" class="i method">CreateBindingContract</a>(<a href="SignalRTriggerAttribute.cs.html#5a1a9ceece6fd92d" class="t t">SignalRTriggerAttribute</a> <span id="r11 rd" class="r11 r">attribute</span>, <a href="@1@netstandard/A.html#adf5577c07f51f16" class="t t">ParameterInfo</a> <span id="r12 rd" class="r12 r">parameter</span>)
        {
            <a href="@1@netstandard/A.html#d3599058f8d79be0" class="k">var</a> <span id="r13 rd" class="r13 r">contract</span> = <b>new</b> <a href="@1@netstandard/A.html#05d4a216235a779c" class="t constructor">Dictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a>&gt;(<a href="@1@netstandard/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@1@netstandard/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>)
            {
                { <a href="#5e63f339ecd19235" class="i field">ReturnParameterKey</a>, <b>typeof</b>(<b>object</b>).<a href="@1@netstandard/A.html#a394028aecb1f144" class="i method">MakeByRefType</a>() },
            };
 
            <span class="c">// Add names in ParameterNames to binding contract, that user can bind to Functions&#39; parameter directly</span>
            <b>if</b> (<span class="r11 r">attribute</span>.<a href="SignalRTriggerAttribute.cs.html#777633891f9909a2" class="i property">ParameterNames</a> != <b>null</b>)
            {
                <a href="@1@netstandard/A.html#d3599058f8d79be0" class="k">var</a> <span id="r14 rd" class="r14 r">parameters</span> = ((<a href="@1@netstandard/A.html#382d90b1fa682bac" class="t t">MethodInfo</a>)<span class="r12 r">parameter</span>.<a href="@1@netstandard/A.html#b2e9492d4754805d" class="i property">Member</a>).<a href="@1@netstandard/A.html#91801fac9c14db1f" class="i method">GetParameters</a>().<a href="@1@netstandard/A.html#a6091311eadfdd8a" class="i method">ToDictionary</a>(<span id="r15 rd" class="r15 r">p</span> =&gt; <span class="r15 r">p</span>.<a href="@1@netstandard/A.html#5189606fee27d248" class="i property">Name</a>, <span id="r16 rd" class="r16 r">p</span> =&gt; <span class="r16 r">p</span>.<a href="@1@netstandard/A.html#caa6206e7a50fd83" class="i property">ParameterType</a>, <a href="@1@netstandard/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@1@netstandard/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>);
                <b>foreach</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r17 rd" class="r17 r">parameterName</span> <b>in</b> <span class="r11 r">attribute</span>.<a href="SignalRTriggerAttribute.cs.html#777633891f9909a2" class="i property">ParameterNames</a>)
                {
                    <b>if</b> (<span class="r14 r">parameters</span>.<a href="@1@netstandard/A.html#22fd7cd7408aed6e" class="i method">ContainsKey</a>(<span class="r17 r">parameterName</span>))
                    {
                        <span class="r13 r">contract</span>.<a href="@1@netstandard/A.html#a7861da7aaa500fe" class="i method">Add</a>(<span class="r17 r">parameterName</span>, <span class="r14 r">parameters</span><a href="@1@netstandard/A.html#49962975508e2d83">[</a><span class="r17 r">parameterName</span>]);
                    }
                    <b>else</b>
                    {
                        <span class="r13 r">contract</span>.<a href="@1@netstandard/A.html#a7861da7aaa500fe" class="i method">Add</a>(<span class="r17 r">parameterName</span>, <b>typeof</b>(<b>object</b>));
                    }
                }
            }
 
            <b>return</b> <span class="r13 r">contract</span>;
        }
 
        <b>private void</b> <a id="686fd8c813067b81" href="../R/686fd8c813067b81.html" target="n" data-glyph="76,1" class="i method">AddParameterNamesBindingData</a>(<a href="@1@netstandard/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt; <span id="r18 rd" class="r18 r">bindingData</span>, <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>[] <span id="r19 rd" class="r19 r">parameterNames</span>, <b>object</b>[] <span id="r20 rd" class="r20 r">arguments</span>)
        {
            <a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r21 rd" class="r21 r">length</span> = <span class="r19 r">parameterNames</span>.<a href="@1@netstandard/A.html#42e9b7616956cf94" class="i property">Length</a>;
            <b>for</b> (<a href="@1@netstandard/A.html#225942ed7b7a3252" class="k">var</a> <span id="r22 rd" class="r22 r">i</span> = 0; <span class="r22 r">i</span> &lt; <span class="r21 r">length</span>; <span class="r22 r">i</span>++)
            {
                <b>if</b> (<a href="#ec401f76e015d773" class="i property">BindingDataContract</a>.<a href="@1@netstandard/A.html#43db2f978cfd884d" class="i method">TryGetValue</a>(<span class="r19 r">parameterNames</span>[<span class="r22 r">i</span>], <b>out</b> <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="k">var</a> <span id="r23 rd" class="r23 r">type</span>))
                {
                    <span class="r18 r">bindingData</span>.<a href="@1@netstandard/A.html#a7861da7aaa500fe" class="i method">Add</a>(<span class="r19 r">parameterNames</span>[<span class="r22 r">i</span>], <a href="#e51d32b006781116" class="i method">ConvertValueIfNecessary</a>(<span class="r20 r">arguments</span>[<span class="r22 r">i</span>], <span class="r23 r">type</span>));
                }
                <b>else</b>
                {
                    <span class="r18 r">bindingData</span>.<a href="@1@netstandard/A.html#a7861da7aaa500fe" class="i method">Add</a>(<span class="r19 r">parameterNames</span>[<span class="r22 r">i</span>], <span class="r20 r">arguments</span>[<span class="r22 r">i</span>]);
                }
            }
        }
 
        <b>private static object</b> <a id="e51d32b006781116" href="../R/e51d32b006781116.html" target="n" data-glyph="76,1" class="i method">ConvertValueIfNecessary</a>(<b>object</b> <span id="r24 rd" class="r24 r">value</span>, <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r25 rd" class="r25 r">targetType</span>)
        {
            <b>if</b> (<span class="r24 r">value</span> != <b>null</b> &amp;&amp; !<span class="r25 r">targetType</span>.<a href="@1@netstandard/A.html#ba0cffea035fe210" class="i method">IsAssignableFrom</a>(<span class="r24 r">value</span>.<a href="@1@netstandard/A.html#4d73eb225aef8a61" class="i method">GetType</a>()))
            {
                <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="k">var</a> <span id="r26 rd" class="r26 r">underlyingTargetType</span> = <a href="@1@netstandard/A.html#c9505a785f9fd8c5" class="t t">Nullable</a>.<a href="@1@netstandard/A.html#ae2ae0d65dd71ecb" class="i method">GetUnderlyingType</a>(<span class="r25 r">targetType</span>) ?? <span class="r25 r">targetType</span>;
 
                <b>var</b> <span id="r27 rd" class="r27 r">jObject</span> = <span class="r24 r">value</span> <b>as</b> <span class="t t">JObject</span>;
                <b>if</b> (<span class="r27 r">jObject</span> != <b>null</b>)
                {
                    <span class="r24 r">value</span> = <span class="r27 r">jObject</span>.<span class="i method">ToObject</span>(<span class="r25 r">targetType</span>);
                }
                <b>else</b> <b>if</b> (<span class="r26 r">underlyingTargetType</span> == <b>typeof</b>(<a href="@1@netstandard/A.html#b622ef5f6b76c10a" class="t t">Guid</a>) &amp;&amp; <span class="r24 r">value</span>.<a href="@1@netstandard/A.html#4d73eb225aef8a61" class="i method">GetType</a>() == <b>typeof</b>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>))
                {
                    <span class="c">// Guids need to be converted by their own logic</span>
                    <span class="c">// Intentionally throw here on error to standardize behavior</span>
                    <span class="r24 r">value</span> = <a href="@1@netstandard/A.html#b622ef5f6b76c10a" class="t t">Guid</a>.<a href="@1@netstandard/A.html#c0f15e43675529c4" class="i method">Parse</a>((<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r24 r">value</span>);
                }
                <b>else</b>
                {
                    <span class="c">// if the type is nullable, we only need to convert to the</span>
                    <span class="c">// correct underlying type</span>
                    <span class="r24 r">value</span> = <a href="@1@netstandard/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@1@netstandard/A.html#3bcca7a9bda4114e" class="i method">ChangeType</a>(<span class="r24 r">value</span>, <span class="r26 r">underlyingTargetType</span>, <a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                }
            }
 
            <b>return</b> <span class="r24 r">value</span>;
        }
 
        <span class="c">// TODO: Add more supported type</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A provider that responsible for providing value in various type to be bond to function method parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private class</b> <a id="2291594415cb8380" href="../R/2291594415cb8380.html" target="n" data-glyph="4,1" class="t t">SignalRTriggerValueProvider</a> : <span class="t t">IValueBinder</span>
        {
            <b>private readonly</b> <a href="Context/InvocationContext.cs.html#f093b6e0842b59d4" class="t t">InvocationContext</a> <a id="5d0cb48bcb52abdb" href="../R/5d0cb48bcb52abdb.html" target="n" data-glyph="46,2" class="i field">_value</a>;
            <b>private readonly</b> <a href="@1@netstandard/A.html#adf5577c07f51f16" class="t t">ParameterInfo</a> <a id="8d1155b2accc33f0" href="../R/8d1155b2accc33f0.html" target="n" data-glyph="46,2" class="i field">_parameter</a>;
 
            <b>public</b> <a id="45877e12a4e7dac2" href="../R/45877e12a4e7dac2.html" target="n" data-glyph="72,2" class="t constructor">SignalRTriggerValueProvider</a>(<a href="@1@netstandard/A.html#adf5577c07f51f16" class="t t">ParameterInfo</a> <span id="r28 rd" class="r28 r">parameter</span>, <a href="Context/InvocationContext.cs.html#f093b6e0842b59d4" class="t t">InvocationContext</a> <span id="r29 rd" class="r29 r">value</span>)
            {
                <a href="#8d1155b2accc33f0" class="i field">_parameter</a> = <span class="r28 r">parameter</span> ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r28 r">parameter</span>));
                <a href="#5d0cb48bcb52abdb" class="i field">_value</a> = <span class="r29 r">value</span> ?? <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#8314938388254d5a" class="t constructor">ArgumentNullException</a>(<b>nameof</b>(<span class="r29 r">value</span>));
            }
 
            <b>public</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<b>object</b>&gt; <a id="1bca44406a34f007" href="../R/1bca44406a34f007.html" target="n" data-glyph="72,2" class="i method">GetValueAsync</a>()
            {
                <b>if</b> (<a href="#8d1155b2accc33f0" class="i field">_parameter</a>.<a href="@1@netstandard/A.html#caa6206e7a50fd83" class="i property">ParameterType</a> == <b>typeof</b>(<a href="Context/InvocationContext.cs.html#f093b6e0842b59d4" class="t t">InvocationContext</a>))
                {
                    <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#11a386e7d7cae64a" class="i method">FromResult</a>&lt;<b>object</b>&gt;(<a href="#5d0cb48bcb52abdb" class="i field">_value</a>);
                }
                <b>else</b> <b>if</b> (<a href="#8d1155b2accc33f0" class="i field">_parameter</a>.<a href="@1@netstandard/A.html#caa6206e7a50fd83" class="i property">ParameterType</a> == <b>typeof</b>(<b>object</b>) ||
                         <a href="#8d1155b2accc33f0" class="i field">_parameter</a>.<a href="@1@netstandard/A.html#caa6206e7a50fd83" class="i property">ParameterType</a> == <b>typeof</b>(<span class="t t">JObject</span>))
                {
                    <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#11a386e7d7cae64a" class="i method">FromResult</a>&lt;<b>object</b>&gt;(<span class="t t">JObject</span>.<span class="i method">FromObject</span>(<a href="#5d0cb48bcb52abdb" class="i field">_value</a>));
                }
 
                <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#11a386e7d7cae64a" class="i method">FromResult</a>&lt;<b>object</b>&gt;(<b>null</b>);
            }
 
            <b>public string</b> <a id="6afcfcbe7e982c96" href="../R/6afcfcbe7e982c96.html" target="n" data-glyph="72,2" class="i method">ToInvokeString</a>()
            {
                <b>return</b> <a href="#5d0cb48bcb52abdb" class="i field">_value</a>.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
            }
 
            <b>public</b> <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a> <a id="14e88fb3c4479c66" href="../R/14e88fb3c4479c66.html" target="n" data-glyph="102,2" class="i property">Type</a> =&gt; <a href="#8d1155b2accc33f0" class="i field">_parameter</a>.<a href="@1@netstandard/A.html#4d73eb225aef8a61" class="i method">GetType</a>();
 
            <span class="c">// No use here</span>
            <b>public</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7376ee0ead13ac31" href="../R/7376ee0ead13ac31.html" target="n" data-glyph="72,2" class="i method">SetValueAsync</a>(<b>object</b> <span id="r30 rd" class="r30 r">value</span>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r31 rd" class="r31 r">cancellationToken</span>)
            {
                <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A provider to handle return value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private class</b> <a id="a6f6a468bd3331c1" href="../R/a6f6a468bd3331c1.html" target="n" data-glyph="4,1" class="t t">TriggerReturnValueProvider</a> : <span class="t t">IValueBinder</span>
        {
            <b>private readonly</b> <a href="@1@netstandard/A.html#94bf04047d6bd325" class="t t">TaskCompletionSource</a>&lt;<b>object</b>&gt; <a id="f4812ff1313cf53d" href="../R/f4812ff1313cf53d.html" target="n" data-glyph="46,2" class="i field">_tcs</a>;
 
            <b>public</b> <a id="244194280483642f" href="../R/244194280483642f.html" target="n" data-glyph="72,2" class="t constructor">TriggerReturnValueProvider</a>(<a href="@1@netstandard/A.html#94bf04047d6bd325" class="t t">TaskCompletionSource</a>&lt;<b>object</b>&gt; <span id="r32 rd" class="r32 r">tcs</span>)
            {
                <a href="#f4812ff1313cf53d" class="i field">_tcs</a> = <span class="r32 r">tcs</span>;
            }
 
            <b>public</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<b>object</b>&gt; <a id="6aa98268d85fce8c" href="../R/6aa98268d85fce8c.html" target="n" data-glyph="72,2" class="i method">GetValueAsync</a>()
            {
                <span class="c">// Useless for return value provider</span>
                <b>return</b> <b>null</b>;
            }
 
            <b>public string</b> <a id="c5e4bd1c301cb4f1" href="../R/c5e4bd1c301cb4f1.html" target="n" data-glyph="72,2" class="i method">ToInvokeString</a>()
            {
                <span class="c">// Useless for return value provider</span>
                <b>return</b> <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#c9f70a27facb27cf" class="i field">Empty</a>;
            }
 
            <b>public</b> <a href="@1@netstandard/A.html#3d00eeab9feb80f3" class="t t">Type</a> <a id="d6b06b4555bdab6e" href="../R/d6b06b4555bdab6e.html" target="n" data-glyph="102,2" class="i property">Type</a> =&gt; <b>typeof</b>(<b>object</b>).<a href="@1@netstandard/A.html#a394028aecb1f144" class="i method">MakeByRefType</a>();
 
            <b>public</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5ec60c56fcc690b3" href="../R/5ec60c56fcc690b3.html" target="n" data-glyph="72,2" class="i method">SetValueAsync</a>(<b>object</b> <span id="r33 rd" class="r33 r">value</span>, <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r34 rd" class="r34 r">cancellationToken</span>)
            {
                <a href="#f4812ff1313cf53d" class="i field">_tcs</a>.<a href="@1@netstandard/A.html#f58e440930617bf6" class="i method">TrySetResult</a>(<span class="r33 r">value</span>);
                <b>return</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@netstandard/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
            }
        }
    }
}</pre></td></tr></table></div></body></html>
