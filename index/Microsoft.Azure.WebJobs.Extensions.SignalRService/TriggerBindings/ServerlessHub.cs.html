<!DOCTYPE html>
<html><head><title>ServerlessHub.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(177);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.SignalRService/TriggerBindings/ServerlessHub.cs" target="_top">TriggerBindings\ServerlessHub.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/signalr/Microsoft.Azure.WebJobs.Extensions.SignalRService/src/TriggerBindings/ServerlessHub.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Azure.WebJobs.Extensions.SignalRService" target="_top">Microsoft.Azure.WebJobs.Extensions.SignalRService.csproj</a> (Microsoft.Azure.WebJobs.Extensions.SignalRService)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IdentityModel</span>.<span class="i n">Tokens</span>.<span class="i n">Jwt</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Security</span>.<span class="i n">Claims</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">AspNetCore</span>.<span class="i n">SignalR</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">SignalR</span>.<span class="i n">Management</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">WebJobs</span>.<span class="i n">Extensions</span>.<span class="i n">SignalRService</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> When a class derived from </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f4a91ed4f596d263" class="t t">ServerlessHub</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> all the methods in the class are identified as using class based model.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">b</span><span class="c">&gt;</span><span class="c">HubName</span><span class="c">&lt;/</span><span class="c">b</span><span class="c">&gt;</span><span class="c"> is resolved from class name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">b</span><span class="c">&gt;</span><span class="c">Event</span><span class="c">&lt;/</span><span class="c">b</span><span class="c">&gt;</span><span class="c"> is resolved from method name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">b</span><span class="c">&gt;</span><span class="c">Category</span><span class="c">&lt;/</span><span class="c">b</span><span class="c">&gt;</span><span class="c"> is determined by the method name. Only </span><span class="c">&lt;</span><span class="c">b</span><span class="c">&gt;</span><span class="c">OnConnected</span><span class="c">&lt;/</span><span class="c">b</span><span class="c">&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">b</span><span class="c">&gt;</span><span class="c">OnDisconnected</span><span class="c">&lt;/</span><span class="c">b</span><span class="c">&gt;</span><span class="c"> will</span>
    <span class="c">///</span><span class="c"> be considered as Connections and others will be Messages.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">b</span><span class="c">&gt;</span><span class="c">ParameterNames</span><span class="c">&lt;/</span><span class="c">b</span><span class="c">&gt;</span><span class="c"> will be automatically resolved by all the parameters of the method in order, except the</span>
    <span class="c">///</span><span class="c"> parameter which belongs to a binding parameter, or has the type of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">Logging</span>.<span class="t t">ILogger</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Threading</span>.<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or marked by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="SignalRIgnoreAttribute.cs.html#04056f29bac1ff7d" class="t t">SignalRIgnoreAttribute</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> Note that </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="SignalRTriggerAttribute.cs.html#5a1a9ceece6fd92d" class="t t">SignalRTriggerAttribute</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> MUST use parameterless constructor in class based model.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="f4a91ed4f596d263" href="../R/f4a91ed4f596d263.html" target="n" data-glyph="0,0" class="t t">ServerlessHub</a> : <a href="@1@netstandard/A.html#1f55292c3174123d" class="t t">IDisposable</a>
    {
        <b>private static readonly</b> <a href="@1@netstandard/A.html#8b99c1f377873554" class="t t">Lazy</a>&lt;<span class="t t">JwtSecurityTokenHandler</span>&gt; <a id="7b00b056b8cea299" href="../R/7b00b056b8cea299.html" target="n" data-glyph="46,1" class="i field">JwtSecurityTokenHandler</a> = <b>new</b> <a href="@1@netstandard/A.html#c0f7b98bacad370a" class="t constructor">Lazy</a>&lt;<span class="t t">JwtSecurityTokenHandler</span>&gt;(() =&gt; <b>new</b> <span class="t constructor">JwtSecurityTokenHandler</span>());
        <b>private bool</b> <a id="e1a6d26acedf8583" href="../R/e1a6d26acedf8583.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Might be converted from </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="t t">IServiceHubContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, don&#39;t forget to test null before use it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="t t">ServiceHubContext</span> <a id="03b00e3f0b674f3e" href="../R/03b00e3f0b674f3e.html" target="n" data-glyph="46,1" class="i field">_hubContext</a>;
        <b>private readonly</b> <span class="t t">IServiceManager</span> <a id="9b0a31c1b8abc12a" href="../R/9b0a31c1b8abc12a.html" target="n" data-glyph="46,1" class="i field">_serviceManager</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Leave the parameters to be null when called by Azure Function infrastructure.</span>
        <span class="c">///</span><span class="c"> Or you can pass in your parameters in testing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="952ce5b1c7b2d72f" href="../R/952ce5b1c7b2d72f.html" target="n" data-glyph="75,1" class="t constructor">ServerlessHub</a>(<span class="t t">IServiceHubContext</span> <span id="r0 rd" class="r0 r">hubContext</span> = <b>null</b>, <span class="t t">IServiceManager</span> <span id="r1 rd" class="r1 r">serviceManager</span> = <b>null</b>)
        {
            <a href="#1ced147895249971" class="k">var</a> <span id="r2 rd" class="r2 r">hubContextAttribute</span> = <a href="@1@netstandard/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@1@netstandard/A.html#c6bc76200d08473d" class="i method">GetCustomAttribute</a>&lt;<a href="#1ced147895249971" class="t t">SignalRConnectionAttribute</a>&gt;(<b>true</b>);
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r3 rd" class="r3 r">connectionString</span> = <span class="r2 r">hubContextAttribute</span>?.<a href="#fd906e5a9801f854" class="i property">Connection</a> ?? <a href="../Constants.cs.html#2a8c172e6bf1aff3" class="t t">Constants</a>.<a href="../Constants.cs.html#2605f583f039e678" class="i field">AzureSignalRConnectionStringName</a>;
            <a href="#3560c7f4df4d80c1" class="i property">HubName</a> = <a href="@1@netstandard/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@1@netstandard/A.html#aa4f112f79364b6e" class="i property">Name</a>;
            <span class="r0 r">hubContext</span> = <span class="r0 r">hubContext</span> ?? <a href="../Config/StaticServiceHubContextStore.cs.html#c5ae42609dab8697" class="t t">StaticServiceHubContextStore</a>.<a href="../Config/StaticServiceHubContextStore.cs.html#450df90437278669" class="i method">Get</a>(<span class="r3 r">connectionString</span>).<a href="../Config/IServiceHubContextStore.cs.html#dfe4e17bbfd2b4f4" class="i method">GetAsync</a>(<a href="#3560c7f4df4d80c1" class="i property">HubName</a>).<span class="i method">GetAwaiter</span>().<span class="i method">GetResult</span>();
            <a href="#9b0a31c1b8abc12a" class="i field">_serviceManager</a> = <span class="r1 r">serviceManager</span> ?? <a href="../Config/StaticServiceHubContextStore.cs.html#c5ae42609dab8697" class="t t">StaticServiceHubContextStore</a>.<a href="../Config/StaticServiceHubContextStore.cs.html#450df90437278669" class="i method">Get</a>(<span class="r3 r">connectionString</span>).<a href="../Config/IServiceHubContextStore.cs.html#3f69828a369e1e1b" class="i property">ServiceManager</a>;
            <a href="#440c67d0c874db80" class="i property">Clients</a> = <span class="r0 r">hubContext</span>.<span class="i property">Clients</span>;
            <a href="#ab6cc692bd6d8968" class="i property">Groups</a> = <span class="r0 r">hubContext</span>.<span class="i property">Groups</span>;
            <a href="#e6c70840f12c73a6" class="i property">UserGroups</a> = <span class="r0 r">hubContext</span>.<span class="i property">UserGroups</span>;
            <a href="#03b00e3f0b674f3e" class="i field">_hubContext</a> = <span class="r0 r">hubContext</span> <b>as</b> <span class="t t">ServiceHubContext</span>;
            <a href="#ddf4985e3222a0b9" class="i property">ClientManager</a> = <a href="#03b00e3f0b674f3e" class="i field">_hubContext</a>?.<span class="i property">ClientManager</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Customized settings to be passed into the serverless hub context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<a href="@1@netstandard/A.html#2b75b4729f275854" class="t constructor">AttributeUsage</a>(<a href="@1@netstandard/A.html#bbeab60ef22e6977" class="t t">AttributeTargets</a>.<a href="@1@netstandard/A.html#16349e8915c7392b" class="i field">Class</a>)]
        <b>protected internal class</b> <a id="1ced147895249971" href="../R/1ced147895249971.html" target="n" data-glyph="3,1" class="t t">SignalRConnectionAttribute</a> : <a href="@1@netstandard/A.html#707d3dbc6c887265" class="t t">Attribute</a>, <span class="t t">IConnectionProvider</span>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#1ced147895249971" class="t t">SignalRConnectionAttribute</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">connectionStringSetting</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Gets or sets the app setting name that contains the Azure SignalR connection string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>public</b> <a id="59ac873a09806d23" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="t constructor">SignalRConnectionAttribute</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">connectionStringSetting</span>)
            {
                <a href="#fd906e5a9801f854" class="i property">Connection</a> = <span class="r4 r">connectionStringSetting</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets or sets the app setting name that contains the Azure SignalR connection string.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public string</b> <a id="fd906e5a9801f854" href="../R/fd906e5a9801f854.html" target="n" data-glyph="102,2" class="i property">Connection</a> { <b>get</b>; <b>set</b>; } = <a href="../Constants.cs.html#2a8c172e6bf1aff3" class="t t">Constants</a>.<a href="../Constants.cs.html#2605f583f039e678" class="i field">AzureSignalRConnectionStringName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an object that can be used to invoke methods on the clients connected to this hub.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">IHubClients</span> <a id="440c67d0c874db80" href="../R/440c67d0c874db80.html" target="n" data-glyph="102,1" class="i property">Clients</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the group manager of this hub.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">IGroupManager</span> <a id="ab6cc692bd6d8968" href="../R/ab6cc692bd6d8968.html" target="n" data-glyph="102,1" class="i property">Groups</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the user group manager of this hub.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">IUserGroupManager</span> <a id="e6c70840f12c73a6" href="../R/e6c70840f12c73a6.html" target="n" data-glyph="102,1" class="i property">UserGroups</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the client manager of this hub.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="t t">ClientManager</span> <a id="ddf4985e3222a0b9" href="../R/ddf4985e3222a0b9.html" target="n" data-glyph="102,1" class="i property">ClientManager</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the hub name of this hub.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="3560c7f4df4d80c1" href="../R/3560c7f4df4d80c1.html" target="n" data-glyph="102,1" class="i property">HubName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets client endpoint access information object for SignalR hub connections to connect to Azure SignalR Service</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a href="../Bindings/SignalRConnectionInfo.cs.html#eb822a02cdd4471e" class="t t">SignalRConnectionInfo</a> <a id="6033e218f5620022" href="../R/6033e218f5620022.html" target="n" data-glyph="75,1" class="i method">Negotiate</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r5 rd" class="r5 r">userId</span> = <b>null</b>, <a href="@1@netstandard/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@1@netstandard/A.html#52a2b29224ad0a58" class="t t">Claim</a>&gt; <span id="r6 rd" class="r6 r">claims</span> = <b>null</b>, <a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>? <span id="r7 rd" class="r7 r">lifetime</span> = <b>null</b>)
        {
            <b>return</b> <a href="#0c4a19acd314f30a" class="i method">NegotiateAsync</a>(<b>new</b> <span class="t constructor">NegotiationOptions</span>
            {
                <span class="i property">UserId</span> = <span class="r5 r">userId</span>,
                <span class="i property">Claims</span> = <span class="r6 r">claims</span>,
                <span class="i property">TokenLifetime</span> = <span class="r7 r">lifetime</span>.<a href="@1@netstandard/A.html#8c499091e3b47bc7" class="i method">GetValueOrDefault</a>(<a href="@1@netstandard/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@1@netstandard/A.html#060fe8cc38e0a7e3" class="i method">FromHours</a>(1))
            }).<a href="@1@netstandard/A.html#826690b09f24e719" class="i property">Result</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets client endpoint access information object for SignalR hub connections to connect to Azure SignalR Service</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected async</b> <a href="@1@netstandard/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="../Bindings/SignalRConnectionInfo.cs.html#eb822a02cdd4471e" class="t t">SignalRConnectionInfo</a>&gt; <a id="0c4a19acd314f30a" href="../R/0c4a19acd314f30a.html" target="n" data-glyph="75,1" class="i method">NegotiateAsync</a>(<span class="t t">NegotiationOptions</span> <span id="r8 rd" class="r8 r">options</span>)
        {
            <b>if</b> (<a href="#03b00e3f0b674f3e" class="i field">_hubContext</a> != <b>null</b>)
            {
                <b>var</b> <span id="r9 rd" class="r9 r">negotiateResponse</span> = <b>await</b> <a href="#03b00e3f0b674f3e" class="i field">_hubContext</a>.<span class="i method">NegotiateAsync</span>(<span class="r8 r">options</span>).<span class="i method">ConfigureAwait</span>(<b>false</b>);
                <b>return</b> <b>new</b> <a href="../Bindings/SignalRConnectionInfo.cs.html#eb822a02cdd4471e" class="t constructor">SignalRConnectionInfo</a>
                {
                    <a href="../Bindings/SignalRConnectionInfo.cs.html#1bf1a245f4887200" class="i property">Url</a> = <span class="r9 r">negotiateResponse</span>.<span class="i property">Url</span>,
                    <a href="../Bindings/SignalRConnectionInfo.cs.html#4f3ad75dabd7a995" class="i property">AccessToken</a> = <span class="r9 r">negotiateResponse</span>.<span class="i property">AccessToken</span>
                };
            }
            <b>else</b>
            {
                <span class="c">//fall back to single endpoint negotiation</span>
                <b>return</b> <b>new</b> <a href="../Bindings/SignalRConnectionInfo.cs.html#eb822a02cdd4471e" class="t constructor">SignalRConnectionInfo</a>
                {
                    <a href="../Bindings/SignalRConnectionInfo.cs.html#1bf1a245f4887200" class="i property">Url</a> = <a href="#9b0a31c1b8abc12a" class="i field">_serviceManager</a>.<span class="i method">GetClientEndpoint</span>(<a href="#3560c7f4df4d80c1" class="i property">HubName</a>),
                    <a href="../Bindings/SignalRConnectionInfo.cs.html#4f3ad75dabd7a995" class="i property">AccessToken</a> = <a href="#9b0a31c1b8abc12a" class="i field">_serviceManager</a>.<span class="i method">GenerateClientAccessToken</span>(<a href="#3560c7f4df4d80c1" class="i property">HubName</a>, <span class="r8 r">options</span>.<span class="i property">UserId</span>, <span class="r8 r">options</span>.<span class="i property">Claims</span>, <span class="r8 r">options</span>.<span class="i property">TokenLifetime</span>)
                };
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get claim list from a JWT.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i n">CodeAnalysis</span>.<a href="@1@netstandard/A.html#5e00de6576fb9ce7" class="t constructor">SuppressMessage</a>(<span class="s">&quot;Performance&quot;</span>, <span class="s">&quot;CA1822:Mark members as static&quot;</span>, <a href="@1@netstandard/A.html#ce02a652a479502a" class="i property">Justification</a> = <span class="s">&quot;Breaking change&quot;</span>)]
        <b>protected</b> <a href="@1@netstandard/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@1@netstandard/A.html#52a2b29224ad0a58" class="t t">Claim</a>&gt; <a id="c7d57ec2b658c60c" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">GetClaims</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">jwt</span>)
        {
            <b>if</b> (<span class="r10 r">jwt</span>.<a href="@1@netstandard/A.html#1c787ba07a7b11ab" class="i method">StartsWith</a>(<span class="s">&quot;Bearer &quot;</span>, <a href="@1@netstandard/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@1@netstandard/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
            {
                <span class="r10 r">jwt</span> = <span class="r10 r">jwt</span>.<a href="@1@netstandard/A.html#882fa7998d6ca35a" class="i method">Substring</a>(<span class="s">&quot;Bearer &quot;</span>.<a href="@1@netstandard/A.html#e13f5829ef28aa07" class="i property">Length</a>).<a href="@1@netstandard/A.html#06a5f7c688e69307" class="i method">Trim</a>();
            }
            <b>return</b> <a href="#7b00b056b8cea299" class="i field">JwtSecurityTokenHandler</a>.<a href="@1@netstandard/A.html#606a17645b0dc0ff" class="i property">Value</a>.<span class="i method">ReadJwtToken</span>(<span class="r10 r">jwt</span>).<span class="i property">Claims</span>.<a href="@1@netstandard/A.html#e276d6892241255b" class="i method">ToList</a>();
        }
 
        <b>protected virtual void</b> <a id="4871f728b90ad59b" href="../R/4871f728b90ad59b.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r11 rd" class="r11 r">disposing</span>)
        {
            <b>if</b> (!<a href="#e1a6d26acedf8583" class="i field">_disposed</a>)
            {
                <b>if</b> (<span class="r11 r">disposing</span>)
                {
                    <span class="c">// TODO: dispose managed state (managed objects)</span>
                }
 
                <span class="c">// TODO: free unmanaged resources (unmanaged objects) and override finalizer</span>
                <span class="c">// TODO: set large fields to null</span>
                <a href="#e1a6d26acedf8583" class="i field">_disposed</a> = <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">inheritdoc</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="d6c42762a70ceeac" href="../R/d6c42762a70ceeac.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="c">// Do not change this code. Put cleanup code in &#39;Dispose(bool disposing)&#39; method</span>
            <a href="#4871f728b90ad59b" class="i method">Dispose</a>(<span class="r11 r">disposing</span>: <b>true</b>);
            <a href="@1@netstandard/A.html#25d9c1e022317a99" class="t t">GC</a>.<a href="@1@netstandard/A.html#2673f5220a565bf2" class="i method">SuppressFinalize</a>(<a href="#f4a91ed4f596d263" class="k">this</a>);
        }
    }
}</pre></td></tr></table></div></body></html>
