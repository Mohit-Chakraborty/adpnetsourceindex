<!DOCTYPE html>
<html><head><title>Sample1_CallClient.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(83);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Communication.CallingServer.Tests/samples/Sample1_CallClient.cs" target="_top">samples\Sample1_CallClient.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/communication/Azure.Communication.CallingServer/tests/samples/Sample1_CallClient.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Communication.CallingServer.Tests" target="_top">Azure.Communication.CallingServer.Tests.csproj</a> (Azure.Communication.CallingServer.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Communication</span>.<span class="i n">Identity</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Communication</span>.<span class="i n">CallingServer</span>.<span class="i n">Tests</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Samples that are used in the README.md file.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public</b> <b>partial</b> <b>class</b> <a id="edfd4ed4ada1faf9" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">Sample1_CallClient</a> : <a href="../Infrastructure/CallingServerLiveTestBase.cs.html#5389b11fee447c5d" class="t t">CallingServerLiveTestBase</a>
    {
        <b>public</b> <a id="af6a3217c10fd168" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">Sample1_CallClient</a>(<b>bool</b> <span id="r0 rd" class="r0 r">isAsync</span>) : <a href="../Infrastructure/CallingServerLiveTestBase.cs.html#5cd537cdd11796fc" class="k">base</a>(<span class="r0 r">isAsync</span>)
        {
        }
 
        [<span class="t constructor">Test</span>]
        [<a href="/Azure.Core.TestFramework/A.html#d5dbfb6fe4270897" class="t constructor">AsyncOnly</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="27907c77a116aabc" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateCallAsync</a>()
        {
            <a href="/Azure.Communication.Identity/A.html#34cfd954a8ba7f75" class="t t">CommunicationIdentityClient</a> <span id="r1 rd" class="r1 r">communicationIdentityClient</span> = <a href="../Infrastructure/CallingServerLiveTestBase.cs.html#9b7a9b726a4280f4" class="i method">CreateInstrumentedCommunicationIdentityClient</a>();
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="k">var</a> <span id="r2 rd" class="r2 r">source</span> = <b>await</b> <span class="r1 r">communicationIdentityClient</span>.<a href="/Azure.Communication.Identity/A.html#104281511bf7438a" class="i method">CreateUserAsync</a>();
            <b>var</b> <span id="r3 rd" class="r3 r">targets</span> = <b>new</b>[] { <b>new</b> <a href="/Azure.Communication.Common/A.html#7f5e8789e46bab4d" class="t constructor">PhoneNumberIdentifier</a>(<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="../Infrastructure/CallingServerTestEnvironment.cs.html#d47a09a2c3af1651" class="i property">TargetPhoneNumber</a>) };
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Snippet:Azure_Communication_Call_Tests_CreateCallOptions
            <a href="/Azure.Communication.CallingServer/A.html#0f3f14d4f2c826ce" class="k">var</a> <span id="r4 rd" class="r4 r">createCallOption</span> = <b>new</b> <a href="/Azure.Communication.CallingServer/A.html#b92add00a3e5a3f7" class="t constructor">CreateCallOptions</a>(
                   <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="../Infrastructure/CallingServerTestEnvironment.cs.html#1444079159850b8a" class="i property">AppCallbackUrl</a>),
                   <b>new</b>[] { <a href="/Azure.Communication.CallingServer/A.html#c7cbdf27d7e8f5b0" class="t t">MediaType</a>.<a href="/Azure.Communication.CallingServer/A.html#36d63003a0b5142b" class="i property">Audio</a> },
                   <b>new</b>[]
                   {
                       <a href="/Azure.Communication.CallingServer/A.html#4de570215bf03118" class="t t">EventSubscriptionType</a>.<a href="/Azure.Communication.CallingServer/A.html#4d0a46e007cd1e84" class="i property">ParticipantsUpdated</a>,
                       <a href="/Azure.Communication.CallingServer/A.html#4de570215bf03118" class="t t">EventSubscriptionType</a>.<a href="/Azure.Communication.CallingServer/A.html#de968d85c17a25d7" class="i property">DtmfReceived</a>
                   });
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Snippet:Azure_Communication_Call_Tests_CreateCallOptions
            <a href="/Azure.Communication.CallingServer/A.html#9f943c4e2b6174ec" class="t t">CallingServerClient</a> <span id="r5 rd" class="r5 r">callingServerClient</span> = <a href="../Infrastructure/CallingServerLiveTestBase.cs.html#8d8b28e4d0c4fc29" class="i method">CreateInstrumentedCallingServerClient</a>();
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;Performing CreateCallConnection operation&quot;</span>);
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Snippet:Azure_Communication_Call_Tests_CreateCallAsync
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="k">var</a> <span id="r6 rd" class="r6 r">callConnection</span> = <b>await</b> <span class="r5 r">callingServerClient</span>.<a href="/Azure.Communication.CallingServer/A.html#04bebf76bb3105e9" class="i method">CreateCallConnectionAsync</a>(
                <span class="c">//@@ source: new CommunicationUserIdentifier(&quot;&lt;source-identifier&gt;&quot;), // Your Azure Communication Resource Guid Id used to make a Call</span>
                <span class="c">//@@ targets: new List&lt;CommunicationIdentifier&gt;() { new PhoneNumberIdentifier(&quot;&lt;targets-phone-number&gt;&quot;) }, // E.164 formatted recipient phone number</span>
                <span class="c">//@@ options: createCallOption // The options for creating a call.</span>
                <span class="c">/*@@*/</span> <span class="r7 r">source</span>: <span class="r2 r">source</span>,
                <span class="c">/*@@*/</span> <span class="r8 r">targets</span>: <span class="r3 r">targets</span>,
                <span class="c">/*@@*/</span> <span class="r9 r">options</span>: <span class="r4 r">createCallOption</span>
                );
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Call connection id: </span>{<span class="r6 r">callConnection</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Communication.CallingServer/A.html#2aad017960f8d98e" class="i property">CallConnectionId</a>}<span class="s">&quot;</span>);
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Snippet:Azure_Communication_Call_Tests_CreateCallAsync
        }
 
        [<span class="t constructor">Test</span>]
        [<a href="/Azure.Core.TestFramework/A.html#d8e3fad5782f7ada" class="t constructor">SyncOnly</a>]
        <b>public void</b> <a id="953ac07077198cea" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateCall</a>()
        {
            <a href="/Azure.Communication.Identity/A.html#34cfd954a8ba7f75" class="t t">CommunicationIdentityClient</a> <span id="r10 rd" class="r10 r">communicationIdentityClient</span> = <a href="../Infrastructure/CallingServerLiveTestBase.cs.html#9b7a9b726a4280f4" class="i method">CreateInstrumentedCommunicationIdentityClient</a>();
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="k">var</a> <span id="r11 rd" class="r11 r">source</span> = <span class="r10 r">communicationIdentityClient</span>.<a href="/Azure.Communication.Identity/A.html#7e2b99028c66d450" class="i method">CreateUser</a>();
            <b>var</b> <span id="r12 rd" class="r12 r">targets</span> = <b>new</b>[] { <b>new</b> <a href="/Azure.Communication.Common/A.html#7f5e8789e46bab4d" class="t constructor">PhoneNumberIdentifier</a>(<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="../Infrastructure/CallingServerTestEnvironment.cs.html#d47a09a2c3af1651" class="i property">TargetPhoneNumber</a>) };
            <a href="/Azure.Communication.CallingServer/A.html#0f3f14d4f2c826ce" class="k">var</a> <span id="r13 rd" class="r13 r">createCallOption</span> = <b>new</b> <a href="/Azure.Communication.CallingServer/A.html#b92add00a3e5a3f7" class="t constructor">CreateCallOptions</a>(
                   <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="../Infrastructure/CallingServerTestEnvironment.cs.html#1444079159850b8a" class="i property">AppCallbackUrl</a>),
                   <b>new</b>[] { <a href="/Azure.Communication.CallingServer/A.html#c7cbdf27d7e8f5b0" class="t t">MediaType</a>.<a href="/Azure.Communication.CallingServer/A.html#36d63003a0b5142b" class="i property">Audio</a> },
                   <b>new</b>[] {
                       <a href="/Azure.Communication.CallingServer/A.html#4de570215bf03118" class="t t">EventSubscriptionType</a>.<a href="/Azure.Communication.CallingServer/A.html#4d0a46e007cd1e84" class="i property">ParticipantsUpdated</a>,
                       <a href="/Azure.Communication.CallingServer/A.html#4de570215bf03118" class="t t">EventSubscriptionType</a>.<a href="/Azure.Communication.CallingServer/A.html#de968d85c17a25d7" class="i property">DtmfReceived</a>
                   });
            <a href="/Azure.Communication.CallingServer/A.html#9f943c4e2b6174ec" class="t t">CallingServerClient</a> <span id="r14 rd" class="r14 r">callingServerClient</span> = <a href="../Infrastructure/CallingServerLiveTestBase.cs.html#8d8b28e4d0c4fc29" class="i method">CreateInstrumentedCallingServerClient</a>();
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">&quot;Performing CreateCallConnection operation&quot;</span>);
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Snippet:Azure_Communication_Call_Tests_CreateCall
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="k">var</a> <span id="r15 rd" class="r15 r">callConnection</span> = <span class="r14 r">callingServerClient</span>.<a href="/Azure.Communication.CallingServer/A.html#694711c5ed46cb62" class="i method">CreateCallConnection</a>(
                <span class="c">//@@ source: new CommunicationUserIdentifier(&quot;&lt;source-identifier&gt;&quot;), // Your Azure Communication Resource Guid Id used to make a Call</span>
                <span class="c">//@@ targets: new List&lt;CommunicationIdentifier&gt;() { new PhoneNumberIdentifier(&quot;&lt;targets-phone-number&gt;&quot;) }, // E.164 formatted recipient phone number</span>
                <span class="c">//@@ options: createCallOption // The options for creating a call.</span>
                <span class="c">/*@@*/</span> <span class="r16 r">source</span>: <span class="r11 r">source</span>,
                <span class="c">/*@@*/</span> <span class="r17 r">targets</span>: <span class="r12 r">targets</span>,
                <span class="c">/*@@*/</span> <span class="r18 r">options</span>: <span class="r13 r">createCallOption</span>
                );
            <a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#5ac7c4fda643413b" class="i method">WriteLine</a>(<span class="s">$&quot;</span><span class="s">Call connection id: </span>{<span class="r15 r">callConnection</span>.<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>.<a href="/Azure.Communication.CallingServer/A.html#2aad017960f8d98e" class="i property">CallConnectionId</a>}<span class="s">&quot;</span>);
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Snippet:Azure_Communication_Call_Tests_CreateCall
        }
    }
}
</pre></td></tr></table></div></body></html>
