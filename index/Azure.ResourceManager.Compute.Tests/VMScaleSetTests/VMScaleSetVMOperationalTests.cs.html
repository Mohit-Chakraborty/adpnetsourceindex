<!DOCTYPE html>
<html><head><title>VMScaleSetVMOperationalTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(325);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.ResourceManager.Compute.Tests/VMScaleSetTests/VMScaleSetVMOperationalTests.cs" target="_top">VMScaleSetTests\VMScaleSetVMOperationalTests.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/compute/Azure.ResourceManager.Compute/tests/VMScaleSetTests/VMScaleSetVMOperationalTests.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.ResourceManager.Compute.Tests" target="_top">Azure.ResourceManager.Compute.Tests.csproj</a> (Azure.ResourceManager.Compute.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Compute</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Resources</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Compute</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="4995777b9b4f556e" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">VMScaleSetVMOperationalTests</a> : <a href="VMScaleSetVMTestsBase.cs.html#7b9bd148d7f4cf2f" class="t t">VMScaleSetVMTestsBase</a>
    {
        <b>public</b> <a id="f393a294ca3b16a0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">VMScaleSetVMOperationalTests</a>(<b>bool</b> <span id="r0 rd" class="r0 r">isAsync</span>)
        : <a href="VMScaleSetVMTestsBase.cs.html#8e0544502561e789" class="k">base</a>(<span class="r0 r">isAsync</span>)
        {
        }
        <b>private string</b> <a id="2a126df63101db1a" href="../R/2a126df63101db1a.html" target="n" data-glyph="46,1" class="i field">rgName</a>, <a id="257e0ebcd24c9118" href="../R/257e0ebcd24c9118.html" target="n" data-glyph="46,1" class="i field">vmssName</a>, <a id="2c61b906644b3bc4" href="../R/2c61b906644b3bc4.html" target="n" data-glyph="46,1" class="i field">storageAccountName</a>, <a id="809d2819eff96759" href="../R/809d2819eff96759.html" target="n" data-glyph="46,1" class="i field">instanceId</a>;
        <b>private</b> <a href="/Azure.ResourceManager.Compute/A.html#19e1fbe185d30a5a" class="t t">ImageReference</a> <a id="a0e0b48cc13849c9" href="../R/a0e0b48cc13849c9.html" target="n" data-glyph="46,1" class="i field">imageRef</a>;
        <b>private</b> <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <a id="5dd5b95baf2c0598" href="../R/5dd5b95baf2c0598.html" target="n" data-glyph="46,1" class="i field">inputVMScaleSet</a>;
 
        <b>private async void</b> <a id="3a8e1d4b956a8b66" href="../R/3a8e1d4b956a8b66.html" target="n" data-glyph="76,1" class="i method">InitializeCommon</a>()
        {
            <a href="#a0e0b48cc13849c9" class="i field">imageRef</a> = <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#6b6ed5979dd3115f" class="i method">GetPlatformVMImage</a>(<span class="r1 r">useWindowsImage</span>: <b>true</b>);
            <a href="#2a126df63101db1a" class="i field">rgName</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<a href="../ScenarioTests/VMTestBase.cs.html#aed9c098bd677b62" class="i field">TestPrefix</a>) + 1;
            <a href="#257e0ebcd24c9118" class="i field">vmssName</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;vmss&quot;</span>);
            <a href="#2c61b906644b3bc4" class="i field">storageAccountName</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<a href="../ScenarioTests/VMTestBase.cs.html#aed9c098bd677b62" class="i field">TestPrefix</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Covers following Operations:</span>
        <span class="c">///</span><span class="c"> Create RG</span>
        <span class="c">///</span><span class="c"> Create Storage Account</span>
        <span class="c">///</span><span class="c"> Create Network Resources</span>
        <span class="c">///</span><span class="c"> Create VMScaleSet</span>
        <span class="c">///</span><span class="c"> Get VMScaleSetVM Model View</span>
        <span class="c">///</span><span class="c"> Get VMScaleSetVM Instance View</span>
        <span class="c">///</span><span class="c"> List VMScaleSetVMs Model View</span>
        <span class="c">///</span><span class="c"> List VMScaleSetVMs Instance View</span>
        <span class="c">///</span><span class="c"> Start VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Stop VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Restart VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Deallocate VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Delete VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Delete RG</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="e3fc74d49a1ef3ce" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestVMScaleSetVMOperations</a>()
        {
            <a href="../ScenarioTests/VMTestBase.cs.html#c8bb06c66a2ba553" class="i method">EnsureClientsInitialized</a>(<a href="../ComputeClientBase.cs.html#f7137fafdd67386c" class="i field">DefaultLocation</a>);
            <b>await</b> <a href="#bcc607575b1846cb" class="i method">TestVMScaleSetVMOperationsInternal</a>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Covers following Operations for a VMSS VM with managed disks:</span>
        <span class="c">///</span><span class="c"> Create RG</span>
        <span class="c">///</span><span class="c"> Create Storage Account</span>
        <span class="c">///</span><span class="c"> Create Network Resources</span>
        <span class="c">///</span><span class="c"> Create VMScaleSet</span>
        <span class="c">///</span><span class="c"> Get VMScaleSetVM Model View</span>
        <span class="c">///</span><span class="c"> Get VMScaleSetVM Instance View</span>
        <span class="c">///</span><span class="c"> List VMScaleSetVMs Model View</span>
        <span class="c">///</span><span class="c"> List VMScaleSetVMs Instance View</span>
        <span class="c">///</span><span class="c"> Start VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Reimage VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> ReimageAll VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Stop VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Restart VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Deallocate VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Delete VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Delete RG</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c0c3afd3a8c35be6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestVMScaleSetVMOperations_ManagedDisks</a>()
        {
            <a href="../ScenarioTests/VMTestBase.cs.html#c8bb06c66a2ba553" class="i method">EnsureClientsInitialized</a>(<a href="../ComputeClientBase.cs.html#f7137fafdd67386c" class="i field">DefaultLocation</a>);
            <b>await</b> <a href="#bcc607575b1846cb" class="i method">TestVMScaleSetVMOperationsInternal</a>(<b>true</b>);
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="bcc607575b1846cb" href="../R/bcc607575b1846cb.html" target="n" data-glyph="76,1" class="i method">TestVMScaleSetVMOperationsInternal</a>(<b>bool</b> <span id="r2 rd" class="r2 r">hasManagedDisks</span> = <b>false</b>)
        {
            <a href="#3a8e1d4b956a8b66" class="i method">InitializeCommon</a>();
            <a href="#809d2819eff96759" class="i field">instanceId</a> = <span class="s">&quot;0&quot;</span>;
 
            <b>bool</b> <span id="r3 rd" class="r3 r">passed</span> = <b>false</b>;
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="k">var</a> <span id="r4 rd" class="r4 r">storageAccountOutput</span> = <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#dec732e84a34be03" class="i method">CreateStorageAccount</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#2c61b906644b3bc4" class="i field">storageAccountName</a>);
 
            <a href="/System.ValueTuple/A.html#0d3bf0818d69cf43" class="k">var</a> <span id="r5 rd" class="r5 r">getTwoVirtualMachineScaleSet</span> = <b>await</b> <a href="VMScaleSetTestsBase.cs.html#5f0c67f1f72b07a5" class="i method">CreateVMScaleSet_NoAsyncTracking</a>(
                <a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#257e0ebcd24c9118" class="i field">vmssName</a>, <span class="r4 r">storageAccountOutput</span>, <a href="#a0e0b48cc13849c9" class="i field">imageRef</a>,
                <span class="r6 r">createWithManagedDisks</span>: <span class="r2 r">hasManagedDisks</span>);
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r7 rd" class="r7 r">vmScaleSet</span> = <span class="r5 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#f482d78f1948e364" class="i field">Response</a>;
            <a href="#5dd5b95baf2c0598" class="i field">inputVMScaleSet</a> = <span class="r5 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#c897d38156562673" class="i field">Input</a>;
            <a href="/Azure.ResourceManager.Compute/A.html#dcd1fb031c53ff76" class="k">var</a> <span id="r8 rd" class="r8 r">getResponse</span> = (<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#3984060af75b0989" class="i method">GetAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>)).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
 
            <a href="/Azure.ResourceManager.Compute/A.html#19e1fbe185d30a5a" class="k">var</a> <span id="r9 rd" class="r9 r">imageReference</span> = <span class="r8 r">getResponse</span>.<a href="/Azure.ResourceManager.Compute/A.html#966c4afc142b07fb" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#65d9a2e7a70dbc09" class="i property">ImageReference</a>;
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r9 r">imageReference</span>?.<a href="/Azure.ResourceManager.Compute/A.html#cb58abc81de7dc82" class="i property">ExactVersion</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r9 r">imageReference</span>.<a href="/Azure.ResourceManager.Compute/A.html#591e98bb49bed28d" class="i property">Version</a>, <span class="r9 r">imageReference</span>.<a href="/Azure.ResourceManager.Compute/A.html#cb58abc81de7dc82" class="i property">ExactVersion</a>);
 
            <a href="/Azure.ResourceManager.Compute/A.html#dcd1fb031c53ff76" class="t t">VirtualMachineScaleSetVM</a> <span id="r10 rd" class="r10 r">vmScaleSetVMModel</span> = <a href="VMScaleSetVMTestsBase.cs.html#46332a0af0584388" class="i method">GenerateVMScaleSetVMModel</a>(<span class="r7 r">vmScaleSet</span>, <a href="#809d2819eff96759" class="i field">instanceId</a>, <span class="r2 r">hasManagedDisks</span>);
            <a href="VMScaleSetVMTestsBase.cs.html#28a6966ddcce6498" class="i method">ValidateVMScaleSetVM</a>(<span class="r10 r">vmScaleSetVMModel</span>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#910ea2150de9bf4d" class="i property">Name</a>, <span class="r8 r">getResponse</span>, <span class="r2 r">hasManagedDisks</span>);
 
            <a href="/Azure.Core/A.html#f0acdd38dd24ccb7" class="k">var</a> <span id="r11 rd" class="r11 r">getInstanceViewResponse</span> = <b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#f38d1f1b4a10e0c9" class="i method">GetInstanceViewAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>,
                <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>);
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r11 r">getInstanceViewResponse</span> != <b>null</b>, <span class="s">&quot;VMScaleSetVM not returned.&quot;</span>);
            <a href="VMScaleSetVMTestsBase.cs.html#5b7d39dbbf776194" class="i method">ValidateVMScaleSetVMInstanceView</a>(<span class="r11 r">getInstanceViewResponse</span>, <span class="r2 r">hasManagedDisks</span>);
 
            <span class="c">//var query = new Microsoft.Rest.Azure.OData.ODataQuery&lt;VirtualMachineScaleSetVM&gt;();</span>
            <span class="c">//query.SetFilter(vm =&gt; vm.LatestModelApplied == true);</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r12 rd" class="r12 r">query</span> = <span class="s">&quot;properties/latestModelApplied eq true&quot;</span>;
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r13 rd" class="r13 r">listResponse</span> = <b>await</b> (<a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#a19cbc3c59f5db04" class="i method">ListAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#257e0ebcd24c9118" class="i field">vmssName</a>, <span class="r12 r">query</span>)).<a href="/Azure.Core.TestFramework/A.html#8ddeb68c4e93863e" class="i method">ToEnumerableAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">False</span>(<span class="r13 r">listResponse</span> == <b>null</b>, <span class="s">&quot;VMScaleSetVMs not returned&quot;</span>);
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r13 r">listResponse</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>() == <a href="#5dd5b95baf2c0598" class="i field">inputVMScaleSet</a>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#4b0057351c10d40a" class="i property">Capacity</a>);
 
            <span class="r12 r">query</span> = <b>null</b>;
            <span class="c">//query.Filter = null;</span>
            <span class="c">//query.Expand = &quot;instanceView&quot;;</span>
            <span class="r13 r">listResponse</span> = <b>await</b> (<a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#a19cbc3c59f5db04" class="i method">ListAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#257e0ebcd24c9118" class="i field">vmssName</a>, <span class="r12 r">query</span>, <b>null</b>, <span class="s">&quot;instanceView&quot;</span>)).<a href="/Azure.Core.TestFramework/A.html#8ddeb68c4e93863e" class="i method">ToEnumerableAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">False</span>(<span class="r13 r">listResponse</span> == <b>null</b>, <span class="s">&quot;VMScaleSetVMs not returned&quot;</span>);
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r13 r">listResponse</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>() == <a href="#5dd5b95baf2c0598" class="i field">inputVMScaleSet</a>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#4b0057351c10d40a" class="i property">Capacity</a>);
 
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#b8986a1dfc9bdd36" class="i method">StartStartAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#4632eaca4cdf9ef5" class="i method">StartReimageAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
 
            <b>if</b> (<span class="r2 r">hasManagedDisks</span>)
            {
                <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#dbe0871fa4dbb466" class="i method">StartReimageAllAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
            }
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#3c9958a27905418d" class="i method">StartRestartAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#bfd07a9fa132892d" class="i method">StartPowerOffAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#d2ae5373c485bc22" class="i method">StartDeallocateAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#30b8d13e28d4a44b" class="i method">StartDeleteAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r7 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
            <span class="r3 r">passed</span> = <b>true</b>;
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r3 r">passed</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Covers following Operations for a VMSS VM with managed disks:</span>
        <span class="c">///</span><span class="c"> Create RG</span>
        <span class="c">///</span><span class="c"> Create Storage Account</span>
        <span class="c">///</span><span class="c"> Create Network Resources</span>
        <span class="c">///</span><span class="c"> Create VMScaleSet</span>
        <span class="c">///</span><span class="c"> Start VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> RunCommand VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Delete VMScaleSetVM</span>
        <span class="c">///</span><span class="c"> Delete RG</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f19427488516edfc" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestVMScaleSetVMOperations_RunCommand</a>()
        {
            <a href="../ScenarioTests/VMTestBase.cs.html#c8bb06c66a2ba553" class="i method">EnsureClientsInitialized</a>(<a href="../ComputeClientBase.cs.html#f7137fafdd67386c" class="i field">DefaultLocation</a>);
            <a href="#3a8e1d4b956a8b66" class="i method">InitializeCommon</a>();
            <a href="#809d2819eff96759" class="i field">instanceId</a> = <span class="s">&quot;0&quot;</span>;
            <b>bool</b> <span id="r14 rd" class="r14 r">passed</span> = <b>false</b>;
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="k">var</a> <span id="r15 rd" class="r15 r">storageAccountOutput</span> = <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#dec732e84a34be03" class="i method">CreateStorageAccount</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#2c61b906644b3bc4" class="i field">storageAccountName</a>);
 
            <a href="/System.ValueTuple/A.html#0d3bf0818d69cf43" class="k">var</a> <span id="r16 rd" class="r16 r">getTwoVirtualMachineScaleSet</span> = <b>await</b> <a href="VMScaleSetTestsBase.cs.html#5f0c67f1f72b07a5" class="i method">CreateVMScaleSet_NoAsyncTracking</a>(
                <a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#257e0ebcd24c9118" class="i field">vmssName</a>, <span class="r15 r">storageAccountOutput</span>, <a href="#a0e0b48cc13849c9" class="i field">imageRef</a>,
                <span class="r6 r">createWithManagedDisks</span>: <b>true</b>);
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r17 rd" class="r17 r">vmScaleSet</span> = <span class="r16 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#f482d78f1948e364" class="i field">Response</a>;
            <a href="#5dd5b95baf2c0598" class="i field">inputVMScaleSet</a> = <span class="r16 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#c897d38156562673" class="i field">Input</a>;
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#b8986a1dfc9bdd36" class="i method">StartStartAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r17 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
 
            <a href="/Azure.ResourceManager.Compute/A.html#d5a62dd68b3580b2" class="t t">RunCommandResult</a> <span id="r18 rd" class="r18 r">result</span> = (<b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#8184b67f5bcf0b34" class="i method">StartRunCommandAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r17 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>, <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#6d72d63376120b50" class="t constructor">RunCommandInput</a>(<span class="s">&quot;ipconfig&quot;</span>)))).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r18 r">result</span>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r18 r">result</span>.<a href="/Azure.ResourceManager.Compute/A.html#acc93d84a1be1a62" class="i property">Value</a>);
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r18 r">result</span>.<a href="/Azure.ResourceManager.Compute/A.html#acc93d84a1be1a62" class="i property">Value</a>.<a href="@0@mscorlib/A.html#6f182bb82f68780e" class="i property">Count</a> &gt; 0);
            <span class="r14 r">passed</span> = <b>true</b>;
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r14 r">passed</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Covers following Operations for a VMSS VM with managed disks:</span>
        <span class="c">///</span><span class="c"> Create RG</span>
        <span class="c">///</span><span class="c"> Create Storage Account</span>
        <span class="c">///</span><span class="c"> Create Network Resources</span>
        <span class="c">///</span><span class="c"> Create VMScaleSet</span>
        <span class="c">///</span><span class="c"> Get VMScaleSetVM Model View</span>
        <span class="c">///</span><span class="c"> Create DataDisk</span>
        <span class="c">///</span><span class="c"> Update VirtualMachineScaleVM to Attach Disk</span>
        <span class="c">///</span><span class="c"> Delete RG</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">Test</span>]
        [<span class="t constructor">Ignore</span>(<span class="s">&quot;TRACK2: compute team will help to record&quot;</span>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="2f695efe02d4ff24" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestVMScaleSetVMOperations_Put</a>()
        {
            <b>bool</b> <span id="r19 rd" class="r19 r">passed</span> = <b>false</b>;
            <a href="../ScenarioTests/VMTestBase.cs.html#c8bb06c66a2ba553" class="i method">EnsureClientsInitialized</a>(<span class="s">&quot;westus2&quot;</span>);
            <a href="#3a8e1d4b956a8b66" class="i method">InitializeCommon</a>();
            <a href="#809d2819eff96759" class="i field">instanceId</a> = <span class="s">&quot;0&quot;</span>;
 
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="k">var</a> <span id="r20 rd" class="r20 r">storageAccountOutput</span> = <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#dec732e84a34be03" class="i method">CreateStorageAccount</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#2c61b906644b3bc4" class="i field">storageAccountName</a>);
 
            <a href="/System.ValueTuple/A.html#0d3bf0818d69cf43" class="k">var</a> <span id="r21 rd" class="r21 r">getTwoVirtualMachineScaleSet</span> = <b>await</b> <a href="VMScaleSetTestsBase.cs.html#5f0c67f1f72b07a5" class="i method">CreateVMScaleSet_NoAsyncTracking</a>(
                <a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#257e0ebcd24c9118" class="i field">vmssName</a>, <span class="r20 r">storageAccountOutput</span>, <a href="#a0e0b48cc13849c9" class="i field">imageRef</a>, <span class="r6 r">createWithManagedDisks</span>: <b>true</b>, <span class="r22 r">machineSizeType</span>: <a href="/Azure.ResourceManager.Compute/A.html#092f62ef5b5456f9" class="t t">VirtualMachineSizeTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#4f14506d583104d2" class="i property">StandardA1V2</a>.<a href="/Azure.ResourceManager.Compute/A.html#73e6918fee024e09" class="i method">ToString</a>());
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r23 rd" class="r23 r">vmScaleSet</span> = <span class="r21 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#f482d78f1948e364" class="i field">Response</a>;
            <a href="#5dd5b95baf2c0598" class="i field">inputVMScaleSet</a> = <span class="r21 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#c897d38156562673" class="i field">Input</a>;
            <a href="/Azure.ResourceManager.Compute/A.html#dcd1fb031c53ff76" class="t t">VirtualMachineScaleSetVM</a> <span id="r24 rd" class="r24 r">vmssVM</span> = <b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#3984060af75b0989" class="i method">GetAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r23 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>);
 
            <a href="/Azure.ResourceManager.Compute/A.html#dcd1fb031c53ff76" class="t t">VirtualMachineScaleSetVM</a> <span id="r25 rd" class="r25 r">vmScaleSetVMModel</span> = <a href="VMScaleSetVMTestsBase.cs.html#46332a0af0584388" class="i method">GenerateVMScaleSetVMModel</a>(<span class="r23 r">vmScaleSet</span>, <a href="#809d2819eff96759" class="i field">instanceId</a>, <span class="r26 r">hasManagedDisks</span>: <b>true</b>);
            <a href="VMScaleSetVMTestsBase.cs.html#28a6966ddcce6498" class="i method">ValidateVMScaleSetVM</a>(<span class="r25 r">vmScaleSetVMModel</span>, <span class="r23 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#910ea2150de9bf4d" class="i property">Name</a>, <span class="r24 r">vmssVM</span>, <span class="r27 r">hasManagedDisks</span>: <b>true</b>);
            <b>await</b> <a href="#859cb4c5e4ee5023" class="i method">AttachDataDiskToVMScaleSetVM</a>(<span class="r24 r">vmssVM</span>, <span class="r25 r">vmScaleSetVMModel</span>, 2);
            <a href="/Azure.ResourceManager.Compute/A.html#dcd1fb031c53ff76" class="t t">VirtualMachineScaleSetVM</a> <span id="r28 rd" class="r28 r">vmssVMReturned</span> = (<b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#f6378bcfa09a980e" class="i method">StartUpdateAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r23 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <span class="r24 r">vmssVM</span>.<a href="/Azure.ResourceManager.Compute/A.html#de943b3b88d27ee3" class="i property">InstanceId</a>, <span class="r24 r">vmssVM</span>))).<a href="/Azure.Core/A.html#26af68e791f2f80a" class="i property">Value</a>;
            <a href="VMScaleSetVMTestsBase.cs.html#28a6966ddcce6498" class="i method">ValidateVMScaleSetVM</a>(<span class="r25 r">vmScaleSetVMModel</span>, <span class="r23 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#910ea2150de9bf4d" class="i property">Name</a>, <span class="r28 r">vmssVMReturned</span>, <span class="r27 r">hasManagedDisks</span>: <b>true</b>);
            <span class="r19 r">passed</span> = <b>true</b>;
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r19 r">passed</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Covers following operations:</span>
        <span class="c">///</span><span class="c"> Create RG</span>
        <span class="c">///</span><span class="c"> Create VM Scale Set</span>
        <span class="c">///</span><span class="c"> Redeploy one instance of VM Scale Set</span>
        <span class="c">///</span><span class="c"> Delete RG</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="45d0aae8df3612e9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestVMScaleSetVMOperations_Redeploy</a>()
        {
            <a href="../ScenarioTests/VMTestBase.cs.html#c8bb06c66a2ba553" class="i method">EnsureClientsInitialized</a>(<a href="../ComputeClientBase.cs.html#e8058ca2ca2849d8" class="i field">LocationEastUs2UpperCase</a>);
            <a href="#809d2819eff96759" class="i field">instanceId</a> = <span class="s">&quot;0&quot;</span>;
            <b>bool</b> <span id="r29 rd" class="r29 r">passed</span> = <b>false</b>;
 
            <a href="#3a8e1d4b956a8b66" class="i method">InitializeCommon</a>();
 
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="k">var</a> <span id="r30 rd" class="r30 r">storageAccountOutput</span> = <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#dec732e84a34be03" class="i method">CreateStorageAccount</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#2c61b906644b3bc4" class="i field">storageAccountName</a>);
            <a href="/System.ValueTuple/A.html#0d3bf0818d69cf43" class="k">var</a> <span id="r31 rd" class="r31 r">getTwoVirtualMachineScaleSet</span> = <b>await</b> <a href="VMScaleSetTestsBase.cs.html#5f0c67f1f72b07a5" class="i method">CreateVMScaleSet_NoAsyncTracking</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#257e0ebcd24c9118" class="i field">vmssName</a>,
                <span class="r30 r">storageAccountOutput</span>, <a href="#a0e0b48cc13849c9" class="i field">imageRef</a>, <span class="r6 r">createWithManagedDisks</span>: <b>true</b>);
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r32 rd" class="r32 r">vmScaleSet</span> = <span class="r31 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#f482d78f1948e364" class="i field">Response</a>;
            <a href="#5dd5b95baf2c0598" class="i field">inputVMScaleSet</a> = <span class="r31 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#c897d38156562673" class="i field">Input</a>;
            <b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#dcfe9da5fe5b11ad" class="i method">StartRedeployAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r32 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>);
 
            <span class="r29 r">passed</span> = <b>true</b>;
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r29 r">passed</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Covers following operations:</span>
        <span class="c">///</span><span class="c"> Create RG</span>
        <span class="c">///</span><span class="c"> Create VM Scale Set</span>
        <span class="c">///</span><span class="c"> Perform maintenance on one instance of VM Scale Set</span>
        <span class="c">///</span><span class="c"> Delete RG</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="t constructor">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f19de3dbefe7c800" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestVMScaleSetVMOperations_PerformMaintenance</a>()
        {
            <a href="../ScenarioTests/VMTestBase.cs.html#c8bb06c66a2ba553" class="i method">EnsureClientsInitialized</a>(<a href="../ComputeClientBase.cs.html#e8058ca2ca2849d8" class="i field">LocationEastUs2UpperCase</a>);
            <a href="#809d2819eff96759" class="i field">instanceId</a> = <span class="s">&quot;0&quot;</span>;
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r33 rd" class="r33 r">vmScaleSet</span> = <b>null</b>;
 
            <b>bool</b> <span id="r34 rd" class="r34 r">passed</span> = <b>false</b>;
 
            <b>try</b>
            {
                <a href="#3a8e1d4b956a8b66" class="i method">InitializeCommon</a>();
 
                <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="k">var</a> <span id="r35 rd" class="r35 r">storageAccountOutput</span> = <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#dec732e84a34be03" class="i method">CreateStorageAccount</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#2c61b906644b3bc4" class="i field">storageAccountName</a>);
                <a href="/System.ValueTuple/A.html#0d3bf0818d69cf43" class="k">var</a> <span id="r36 rd" class="r36 r">getTwoVirtualMachineScaleSet</span> = <b>await</b> <a href="VMScaleSetTestsBase.cs.html#5f0c67f1f72b07a5" class="i method">CreateVMScaleSet_NoAsyncTracking</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <a href="#257e0ebcd24c9118" class="i field">vmssName</a>, <span class="r35 r">storageAccountOutput</span>, <a href="#a0e0b48cc13849c9" class="i field">imageRef</a>,
                    <span class="r6 r">createWithManagedDisks</span>: <b>true</b>);
                <span class="r33 r">vmScaleSet</span> = <span class="r36 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#f482d78f1948e364" class="i field">Response</a>;
                <a href="#5dd5b95baf2c0598" class="i field">inputVMScaleSet</a> = <span class="r36 r">getTwoVirtualMachineScaleSet</span>.<a href="/System.ValueTuple/A.html#c897d38156562673" class="i field">Input</a>;
                <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>(<b>await</b> <a href="../ComputeClientBase.cs.html#b558ce9c4fb60027" class="i property">VirtualMachineScaleSetVMsOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#4a1b18219c7b10eb" class="i method">StartPerformMaintenanceAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r33 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>, <a href="#809d2819eff96759" class="i field">instanceId</a>));
 
                <span class="r34 r">passed</span> = <b>true</b>;
            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r37 rd" class="r37 r">cex</span>)
            {
                <span class="r34 r">passed</span> = <b>true</b>;
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r38 rd" class="r38 r">expectedMessage</span> =
                    <span class="s">$&quot;</span><span class="s">Operation &#39;performMaintenance&#39; is not allowed on VM &#39;</span>{<span class="r33 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a>}<span class="s">_0&#39; </span><span class="s">&quot;</span> +
                    <span class="s">&quot;since the Subscription of this VM is not eligible.&quot;</span>;
                <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r37 r">cex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="r38 r">expectedMessage</span>));
            }
 
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r34 r">passed</span>);
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="/Azure.ResourceManager.Compute/A.html#c70b0d8ea2353212" class="t t">Disk</a>&gt; <a id="3a16720d7cf704a7" href="../R/3a16720d7cf704a7.html" target="n" data-glyph="76,1" class="i method">CreateDataDisk</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r39 rd" class="r39 r">diskName</span>)
        {
            <a href="/Azure.ResourceManager.Compute/A.html#c70b0d8ea2353212" class="k">var</a> <span id="r40 rd" class="r40 r">disk</span> = <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#7fe23f3c0cd6ea5e" class="t constructor">Disk</a>(<b>null</b>, <b>null</b>, <b>null</b>, <a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="/Azure.Core.TestFramework/A.html#54bc5e3ade2ad6bf" class="i property">Location</a>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, 10, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>);
            <span class="r40 r">disk</span>.<a href="/Azure.ResourceManager.Compute/A.html#d764709e5d6d0dcd" class="i property">Sku</a> = <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#4c38439e6badda2c" class="t constructor">DiskSku</a>(<a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#608af9c19c2b728e" class="i property">StandardLRS</a>.<a href="/Azure.ResourceManager.Compute/A.html#c86aca915634b0cd" class="i method">ToString</a>(), <b>null</b>);
            <span class="r40 r">disk</span>.<a href="/Azure.ResourceManager.Compute/A.html#4a97e114d5c3c446" class="i property">CreationData</a> = <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#a0c39c69e6f5fea6" class="t constructor">CreationData</a>(<a href="/Azure.ResourceManager.Compute/A.html#d889ca44ea16d086" class="t t">DiskCreateOption</a>.<a href="/Azure.ResourceManager.Compute/A.html#004b3bf77bb968fe" class="i property">Empty</a>);
            <b>return</b> <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#6edc64a9bfff94b5" class="i method">WaitForCompletionAsync</a>((<b>await</b> <a href="../ComputeClientBase.cs.html#8fb7f9f62b3686c7" class="i property">DisksOperations</a>.<a href="/Azure.ResourceManager.Compute/A.html#60043c07f1d6707e" class="i method">StartCreateOrUpdateAsync</a>(<a href="#2a126df63101db1a" class="i field">rgName</a>, <span class="r39 r">diskName</span>, <span class="r40 r">disk</span>)));
        }
 
        <b>private</b> <a href="/Azure.ResourceManager.Compute/A.html#0ac6d991aa0fa699" class="t t">DataDisk</a> <a id="27b00b936344e0f6" href="../R/27b00b936344e0f6.html" target="n" data-glyph="76,1" class="i method">CreateModelDataDisk</a>(<a href="/Azure.ResourceManager.Compute/A.html#c70b0d8ea2353212" class="t t">Disk</a> <span id="r41 rd" class="r41 r">disk</span>)
        {
            <a href="/Azure.ResourceManager.Compute/A.html#0ac6d991aa0fa699" class="k">var</a> <span id="r42 rd" class="r42 r">modelDisk</span> = <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#08aa1447be74fe8b" class="t constructor">DataDisk</a>(0, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <a href="/Azure.ResourceManager.Compute/A.html#04b47e9b28f04490" class="t t">DiskCreateOptionTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#8fe8e7a923f9504c" class="i property">Attach</a>, <span class="r41 r">disk</span>.<a href="/Azure.ResourceManager.Compute/A.html#458d94b73af82153" class="i property">DiskSizeGB</a>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>);
 
            <b>return</b> <span class="r42 r">modelDisk</span>;
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="859cb4c5e4ee5023" href="../R/859cb4c5e4ee5023.html" target="n" data-glyph="76,1" class="i method">AttachDataDiskToVMScaleSetVM</a>(<a href="/Azure.ResourceManager.Compute/A.html#dcd1fb031c53ff76" class="t t">VirtualMachineScaleSetVM</a> <span id="r43 rd" class="r43 r">vmssVM</span>, <a href="/Azure.ResourceManager.Compute/A.html#dcd1fb031c53ff76" class="t t">VirtualMachineScaleSetVM</a> <span id="r44 rd" class="r44 r">vmModel</span>, <b>int</b> <span id="r45 rd" class="r45 r">lun</span>)
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r46 rd" class="r46 r">diskName</span> = <a href="../ScenarioTests/VMTestBase.cs.html#aed9c098bd677b62" class="i field">TestPrefix</a> + <span class="s">&quot;dataDisk&quot;</span> + <span class="r45 r">lun</span>;
 
            <a href="/Azure.ResourceManager.Compute/A.html#c70b0d8ea2353212" class="k">var</a> <span id="r47 rd" class="r47 r">disk</span> = <b>await</b> <a href="#3a16720d7cf704a7" class="i method">CreateDataDisk</a>(<span class="r46 r">diskName</span>);
 
            <a href="/Azure.ResourceManager.Compute/A.html#0ac6d991aa0fa699" class="k">var</a> <span id="r48 rd" class="r48 r">dd</span> = <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#11cfd536f7541e5f" class="t constructor">DataDisk</a>(<span class="r45 r">lun</span>, <a href="/Azure.ResourceManager.Compute/A.html#04b47e9b28f04490" class="t t">DiskCreateOptionTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#8fe8e7a923f9504c" class="i property">Attach</a>)
            {
                <a href="/Azure.ResourceManager.Compute/A.html#72f8f36b32368a26" class="i property">Name</a> = <span class="r46 r">diskName</span>,
                <a href="/Azure.ResourceManager.Compute/A.html#dbca0fa954ebf91d" class="i property">ManagedDisk</a> = <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#de2038ffbf0feb6c" class="t constructor">ManagedDiskParameters</a>()
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#db7f6acff8a8c083" class="i property">Id</a> = <span class="r47 r">disk</span>.<a href="/Azure.ResourceManager.Compute/A.html#a7ec5750a212bbe4" class="i property">Id</a>,
                    <a href="/Azure.ResourceManager.Compute/A.html#f0057911d5f90933" class="i property">StorageAccountType</a> = <a href="#4c66f0209aa2e076" class="i method">changeType</a>(<span class="r47 r">disk</span>.<a href="/Azure.ResourceManager.Compute/A.html#d764709e5d6d0dcd" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#3be03710750e0f2e" class="i property">Name</a>)
                }
            };
 
            <span class="c">//(lun, diskName, null, null, null, DiskCreateOptionTypes.Attach, null, new ManagedDiskParameters(disk.Id,disk.Sku.Name,null), null, null, null);</span>
 
            <span class="r43 r">vmssVM</span>.<a href="/Azure.ResourceManager.Compute/A.html#966c4afc142b07fb" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#36b236bb164065e9" class="i property">DataDisks</a>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>(<span class="r48 r">dd</span>);
 
            <span class="c">// Add the data disk to the model for validation later</span>
            <span class="r44 r">vmModel</span>.<a href="/Azure.ResourceManager.Compute/A.html#966c4afc142b07fb" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#36b236bb164065e9" class="i property">DataDisks</a>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>(<a href="#27b00b936344e0f6" class="i method">CreateModelDataDisk</a>(<span class="r47 r">disk</span>));
        }
 
        <b>public</b> <a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>? <a id="4c66f0209aa2e076" href="../R/4c66f0209aa2e076.html" target="n" data-glyph="72,1" class="i method">changeType</a>(<a href="/Azure.ResourceManager.Compute/A.html#6fd2210a8d82dee2" class="t t">DiskStorageAccountTypes</a>? <span id="r49 rd" class="r49 r">DiskStorageAccountTypes</span>)
        {
            <a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>? <span id="r50 rd" class="r50 r">storageAccountTypes</span> = <b>new</b> <a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>?(<span class="r49 r">DiskStorageAccountTypes</span>.<a href="@0@mscorlib/A.html#d83d2db767b43db7" class="i method">ToString</a>());
            <b>return</b> <span class="r50 r">storageAccountTypes</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
