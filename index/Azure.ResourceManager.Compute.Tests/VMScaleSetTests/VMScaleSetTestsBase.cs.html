<!DOCTYPE html>
<html><head><title>VMScaleSetTestsBase.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(724);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.ResourceManager.Compute.Tests/VMScaleSetTests/VMScaleSetTestsBase.cs" target="_top">VMScaleSetTests\VMScaleSetTestsBase.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.ResourceManager.Compute.Tests" target="_top">tests\Azure.ResourceManager.Compute.Tests.csproj</a> (Azure.ResourceManager.Compute.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Compute</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i">Network</span>.<span class="i">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i">Resources</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i">Resources</span>.<span class="i">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i">Storage</span>.<span class="i">Models</span>;
<b>using</b> <span class="i">NUnit</span>.<span class="i">Framework</span>;
<span class="c">//using Newtonsoft.Json.Linq;</span>
<b>using</b> <span class="i">CM</span> = <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Compute</span>.<span class="i n">Models</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Compute</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="9e511b57fff7d637" href="../R/9e511b57fff7d637.html" target="n" data-glyph="0,0" class="t t">VMScaleSetTestsBase</a> : <a href="../ScenarioTests/VMTestBase.cs.html#ec61fd5d3586bd7b" class="t t">VMTestBase</a>
    {
        <b>public</b> <a id="5046a1c236f08175" href="../R/5046a1c236f08175.html" target="n" data-glyph="72,1" class="t constructor">VMScaleSetTestsBase</a>(<b>bool</b> <span id="r0 rd" class="r0 r">isAsync</span>)
        : <a href="../ScenarioTests/VMTestBase.cs.html#4afc900c4cedf919" class="k">base</a>(<span class="r0 r">isAsync</span>)
        {
        }
        [<span class="i">SetUp</span>]
        <b>public void</b> <a id="c9aa787aed8c6e2b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ClearChallengeCacheforRecord</a>()
        {
            <b>if</b> (<a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> == <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#62f98a4a2b1d56c3" class="i field">Record</a> || <a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> == <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#bde4663b03b59b85" class="i field">Playback</a>)
            {
                <a href="../ComputeClientBase.cs.html#a1d96c26b416afe3" class="i method">InitializeBase</a>();
            }
        }
 
        [<span class="i">TearDown</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3296a36312f4c114" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CleanupResourceGroup</a>()
        {
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#e05feca36660f887" class="i method">CleanupResourceGroupsAsync</a>();
        }
 
        <b>protected</b> <a href="/Azure.ResourceManager.Compute/A.html#76a88e4b5e3774f2" class="t t">VirtualMachineScaleSetExtension</a> <a id="225a04fc55b116a0" href="../R/225a04fc55b116a0.html" target="n" data-glyph="75,1" class="i method">GetTestVMSSVMExtension</a>(
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">name</span> = <span class="s">&quot;vmssext01&quot;</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r2 rd" class="r2 r">publisher</span> = <span class="s">&quot;Microsoft.Compute&quot;</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">type</span> = <span class="s">&quot;VMAccessAgent&quot;</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">version</span> = <span class="s">&quot;2.0&quot;</span>)
        {
            <a href="/Azure.ResourceManager.Compute/A.html#76a88e4b5e3774f2" class="k">var</a> <span id="r5 rd" class="r5 r">vmExtension</span> = <b>new</b> <span class="t">VirtualMachineScaleSetExtension</span>()
            {
                <a href="/Azure.ResourceManager.Compute/A.html#8469e03b6983d48f" class="i property">Name</a> = <span class="r1 r">name</span>,
                <a href="/Azure.ResourceManager.Compute/A.html#6d98cf5e0dd5d6c3" class="i property">Publisher</a> = <span class="r2 r">publisher</span>,
                <a href="/Azure.ResourceManager.Compute/A.html#dfa0e2c08030ffcb" class="i property">TypePropertiesType</a> = <span class="r3 r">type</span>,
                <a href="/Azure.ResourceManager.Compute/A.html#196fd87553ae1232" class="i property">TypeHandlerVersion</a> = <span class="r4 r">version</span>,
                <a href="/Azure.ResourceManager.Compute/A.html#49bc3b605264c854" class="i property">AutoUpgradeMinorVersion</a> = <b>true</b>,
                <a href="/Azure.ResourceManager.Compute/A.html#650d62a99b980085" class="i property">Settings</a> = <span class="s">&quot;{}&quot;</span>,
                <a href="/Azure.ResourceManager.Compute/A.html#4b200d790884f1b2" class="i property">ProtectedSettings</a> = <span class="s">&quot;{}&quot;</span>
            };
            <b>return</b> <span class="r5 r">vmExtension</span>;
        }
 
        <b>protected</b> <a href="/Azure.ResourceManager.Compute/A.html#76a88e4b5e3774f2" class="t t">VirtualMachineScaleSetExtension</a> <a id="8c8c55d850ba7082" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">GetVmssServiceFabricExtension</a>()
        {
            <a href="/Azure.ResourceManager.Compute/A.html#76a88e4b5e3774f2" class="t t">VirtualMachineScaleSetExtension</a> <span id="r6 rd" class="r6 r">sfExtension</span> = <b>new</b> <span class="t">VirtualMachineScaleSetExtension</span>(
                <b>null</b>, <span class="s">&quot;vmsssfext01&quot;</span>, <span class="s">&quot;ServiceFabricNode&quot;</span>, <b>null</b>, <span class="s">&quot;Microsoft.Azure.ServiceFabric&quot;</span>, <b>null</b>, <span class="s">&quot;1.0&quot;</span>, <b>true</b>, <span class="s">&quot;{}&quot;</span>, <span class="s">&quot;{}&quot;</span>, <b>null</b>, <b>null</b>);
 
            <b>return</b> <span class="r6 r">sfExtension</span>;
        }
 
        <b>protected</b> <a href="/Azure.ResourceManager.Compute/A.html#76a88e4b5e3774f2" class="t t">VirtualMachineScaleSetExtension</a> <a id="c0f08f8b2cdc2386" href="../R/c0f08f8b2cdc2386.html" target="n" data-glyph="75,1" class="i method">GetAzureDiskEncryptionExtension</a>()
        {
            <span class="c">// NOTE: Replace dummy values for AAD credentials and KeyVault urls below by running DiskEncryptionPreRequisites.ps1.</span>
            <span class="c">// There is no ARM client implemented for key-vault in swagger test framework yet. These changes need to go sooner to</span>
            <span class="c">// unblock powershell cmdlets/API for disk encryption on scale set. So recorded this test by creating required resources</span>
            <span class="c">// in prod and replaced them with dummy value before check-in.</span>
            <span class="c">//</span>
            <span class="c">// Follow below steps to run this test again:</span>
            <span class="c">//   Step 1: Execute DiskEncryptionPreRequisites.ps1. Use same subscription and region as you are running test in.</span>
            <span class="c">//   Step 2: Replace aadClientId, aadClientSecret, keyVaultUrl, and keyVaultId values below with the values returned</span>
            <span class="c">//           by above PS script</span>
            <span class="c">//   Step 3: Run test and record session</span>
            <span class="c">//   Step 4: Delete KeyVault, AAD app created by above PS script</span>
            <span class="c">//   Step 5: Replace values for AAD credentials and KeyVault urls by dummy values before check-in</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r7 rd" class="r7 r">aadClientId</span> = <a href="@0@mscorlib/A.html#b622ef5f6b76c10a" class="t t">Guid</a>.<a href="@0@mscorlib/A.html#b7fae6994c22c22e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r8 rd" class="r8 r">aadClientSecret</span> = <a href="@0@mscorlib/A.html#b622ef5f6b76c10a" class="t t">Guid</a>.<a href="@0@mscorlib/A.html#b7fae6994c22c22e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">keyVaultUrl</span> = <span class="s">&quot;https://adetestkv1.vault.azure.net/&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">keyVaultId</span> =
                <span class="s">&quot;/subscriptions/d0d8594d-65c5-481c-9a58-fea6f203f1e2/resourceGroups/adetest/providers/Microsoft.KeyVault/vaults/adetestkv1&quot;</span>;
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r11 rd" class="r11 r">settings</span> =
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#ad9f5b0b214ae8f3" class="i method">Format</a>(<span class="s">&quot;\&quot;AADClientID\&quot;: \&quot;{0}\&quot;, \&quot;KeyVaultURL\&quot;: \&quot;{1}\&quot;, \&quot;KeyEncryptionKeyURL\&quot;: \&quot;\&quot;, \&quot;KeyVaultResourceId\&quot;:\&quot;{2}\&quot;, \&quot;KekVaultResourceId\&quot;: \&quot;\&quot;, \&quot;KeyEncryptionAlgorithm\&quot;: \&quot;{3}\&quot;, \&quot;VolumeType\&quot;: \&quot;{4}\&quot;, \&quot;EncryptionOperation\&quot;: \&quot;{5}\&quot;&quot;</span>,
                                <span class="r7 r">aadClientId</span>, <span class="r9 r">keyVaultUrl</span>, <span class="r10 r">keyVaultId</span>, <span class="s">&quot;&quot;</span>, <span class="s">&quot;All&quot;</span>, <span class="s">&quot;DisableEncryption&quot;</span>);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r12 rd" class="r12 r">protectedSettings</span> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#9d5604d4425b216f" class="i method">Format</a>(<span class="s">&quot;\&quot;AADClientSecret\&quot;: \&quot;{0}\&quot;&quot;</span>, <span class="r8 r">aadClientSecret</span>);
 
            <a href="/Azure.ResourceManager.Compute/A.html#76a88e4b5e3774f2" class="k">var</a> <span id="r13 rd" class="r13 r">vmExtension</span> = <b>new</b> <span class="t">VirtualMachineScaleSetExtension</span>(
                <b>null</b>, <span class="s">&quot;adeext1&quot;</span>, <span class="s">&quot;ADETest&quot;</span>, <b>null</b>, <span class="s">&quot;Microsoft.Azure.Security&quot;</span>, <b>null</b>, <span class="s">&quot;2.0&quot;</span>, <b>null</b>, <span class="s">&quot;{ &quot;</span> + <span class="r11 r">settings</span> + <span class="s">&quot; }&quot;</span>, <span class="s">&quot;{ &quot;</span> + <span class="r12 r">protectedSettings</span> + <span class="s">&quot; }&quot;</span>, <b>null</b>, <b>null</b>);
            <b>return</b> <span class="r13 r">vmExtension</span>;
        }
 
        <b>protected</b> <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <a id="f6694434356bca7f" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">CreateDefaultVMScaleSetInput</a>(
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">rgName</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r15 rd" class="r15 r">storageAccountName</span>,
            <a href="/Azure.ResourceManager.Compute/A.html#19e1fbe185d30a5a" class="t t">ImageReference</a> <span id="r16 rd" class="r16 r">imageRef</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">subnetId</span>,
            <b>bool</b> <span id="r18 rd" class="r18 r">hasManagedDisks</span> = <b>false</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r19 rd" class="r19 r">healthProbeId</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">loadBalancerBackendPoolId</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r21 rd" class="r21 r">zones</span> = <b>null</b>,
            <b>int</b>? <span id="r22 rd" class="r22 r">osDiskSizeInGB</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r23 rd" class="r23 r">machineSizeType</span> = <b>null</b>,
            <b>bool</b>? <span id="r24 rd" class="r24 r">enableUltraSSD</span> = <b>false</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r25 rd" class="r25 r">diskEncryptionSetId</span> = <b>null</b>,
            <a href="/Azure.ResourceManager.Compute/A.html#decd73f3134d9a7e" class="t t">AutomaticRepairsPolicy</a> <span id="r26 rd" class="r26 r">automaticRepairsPolicy</span> = <b>null</b>)
        {
            <span class="c">// Generate Container name to hold disk VHds</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r27 rd" class="r27 r">containerName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<a href="../ScenarioTests/VMTestBase.cs.html#aed9c098bd677b62" class="i field">TestPrefix</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r28 rd" class="r28 r">vhdContainer</span> = <span class="s">&quot;https://&quot;</span> + <span class="r15 r">storageAccountName</span> + <span class="s">&quot;.blob.core.windows.net/&quot;</span> + <span class="r27 r">containerName</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r29 rd" class="r29 r">vmssName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;vmss&quot;</span>);
            <b>bool</b> <span id="r30 rd" class="r30 r">createOSDisk</span> = !<span class="r18 r">hasManagedDisks</span> || <span class="r22 r">osDiskSizeInGB</span> != <b>null</b>;
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r31 rd" class="r31 r">vmSize</span> = <span class="r21 r">zones</span> == <b>null</b> ? <a href="/Azure.ResourceManager.Compute/A.html#092f62ef5b5456f9" class="t t">VirtualMachineSizeTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#b8f9194c6506ccff" class="i property">StandardA0</a>.<a href="@0@mscorlib/A.html#74fc14588f65e616" class="i method">ToString</a>() : <a href="/Azure.ResourceManager.Compute/A.html#092f62ef5b5456f9" class="t t">VirtualMachineSizeTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#4f14506d583104d2" class="i property">StandardA1V2</a>.<a href="@0@mscorlib/A.html#74fc14588f65e616" class="i method">ToString</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r32 rd" class="r32 r">test1</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;vmsstestnetconfig&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r33 rd" class="r33 r">test2</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;vmsstestnetconfig&quot;</span>);
            <a href="/Azure.ResourceManager.Compute/A.html#0fd44b3412b9927d" class="k">var</a> <span id="r34 rd" class="r34 r">virtualMachineScaleSetIpConfiguration</span> = <b>new</b> <span class="t">VirtualMachineScaleSetIPConfiguration</span>(<span class="r33 r">test2</span>)
            {
                <span class="i">Subnet</span> = <b>new</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Compute</span>.<span class="i n">Models</span>.<span class="t">ApiEntityReference</span>()
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#03f1343cdb863204" class="i property">Id</a> = <span class="r17 r">subnetId</span>
                }
            };
 
            <span class="r34 r">virtualMachineScaleSetIpConfiguration</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>.<span class="i">Clear</span>();
            <b>if</b> (<span class="r20 r">loadBalancerBackendPoolId</span> != <b>null</b>)
            {
                <span class="r34 r">virtualMachineScaleSetIpConfiguration</span>.<a href="/Azure.ResourceManager.Compute/A.html#a1946696c2c3d443" class="i property">LoadBalancerBackendAddressPools</a>.<span class="i">Add</span>(<b>new</b> <span class="i n">Models</span>.<span class="t">SubResource</span>(<span class="r20 r">loadBalancerBackendPoolId</span>));
            }
 
            <a href="/Azure.ResourceManager.Compute/A.html#366ccad7bf756a9b" class="k">var</a> <span id="r35 rd" class="r35 r">virtualMachineScaleSetOsDisk</span> = !<span class="r30 r">createOSDisk</span> ? <b>null</b> : <b>new</b> <span class="t">VirtualMachineScaleSetOSDisk</span>(<a href="/Azure.ResourceManager.Compute/A.html#04b47e9b28f04490" class="t t">DiskCreateOptionTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#26c2fd3d03e23069" class="i property">FromImage</a>)
            {
                <a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a> = <a href="/Azure.ResourceManager.Compute/A.html#582888f93d0af1cc" class="t t">CachingTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#bc143ab7730ec61d" class="i field">None</a>,
                <a href="/Azure.ResourceManager.Compute/A.html#1fe1910fe7752f41" class="i property">Name</a> = <span class="r18 r">hasManagedDisks</span> ? <b>null</b> : <span class="s">&quot;test&quot;</span>,
                <a href="/Azure.ResourceManager.Compute/A.html#7834dcb261f06cfe" class="i property">DiskSizeGB</a> = <span class="r22 r">osDiskSizeInGB</span>,
                <span class="i">ManagedDisk</span> = <span class="r25 r">diskEncryptionSetId</span> == <b>null</b> ? <b>null</b> : <b>new</b> <span class="t">VirtualMachineScaleSetManagedDiskParameters</span>()
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> = <a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#608af9c19c2b728e" class="i property">StandardLRS</a>,
                    <span class="i">DiskEncryptionSet</span> = <b>new</b> <span class="t">DiskEncryptionSetParameters</span>()
                    {
                        <a href="/Azure.ResourceManager.Compute/A.html#db7f6acff8a8c083" class="i property">Id</a> = <span class="r25 r">diskEncryptionSetId</span>
                    }
                }
            };
 
            <b>if</b> (!<span class="r18 r">hasManagedDisks</span>)
            {
                <span class="r35 r">virtualMachineScaleSetOsDisk</span>?.<a href="/Azure.ResourceManager.Compute/A.html#17decc5a27fcd6bf" class="i property">VhdContainers</a>.<span class="i">Add</span>(<span class="r28 r">vhdContainer</span>);
            }
 
            <a href="/Azure.ResourceManager.Compute/A.html#0ad098d15e4bc864" class="k">var</a> <span id="r36 rd" class="r36 r">virtualMachineScaleSetStorageProfile</span> = <b>new</b> <span class="t">VirtualMachineScaleSetStorageProfile</span>()
            {
                <span class="i">ImageReference</span> = <span class="r16 r">imageRef</span>,
                <span class="i">OsDisk</span> = <span class="r35 r">virtualMachineScaleSetOsDisk</span>
            };
 
            <b>if</b> (<span class="r18 r">hasManagedDisks</span>)
            {
                <span class="r36 r">virtualMachineScaleSetStorageProfile</span>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a>.<span class="i">Add</span>(<b>new</b> <span class="t">VirtualMachineScaleSetDataDisk</span>(1, <a href="/Azure.ResourceManager.Compute/A.html#04b47e9b28f04490" class="t t">DiskCreateOptionTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#694d5e51bbe9050e" class="i property">Empty</a>)
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#aaea64b886a663c5" class="i property">DiskSizeGB</a> = 128,
                    <span class="i">ManagedDisk</span> = <span class="r25 r">diskEncryptionSetId</span> == <b>null</b>
                        ? <b>null</b>
                        : <b>new</b> <span class="t">VirtualMachineScaleSetManagedDiskParameters</span>()
                        {
                            <a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> = <a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#608af9c19c2b728e" class="i property">StandardLRS</a>,
                            <span class="i">DiskEncryptionSet</span> = <b>new</b> <span class="t">DiskEncryptionSetParameters</span>()
                            {
                                <a href="/Azure.ResourceManager.Compute/A.html#db7f6acff8a8c083" class="i property">Id</a> = <span class="r25 r">diskEncryptionSetId</span>
                            }
                        }
                });
            }
 
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="k">var</a> <span id="r37 rd" class="r37 r">vmScaleSet</span> = <b>new</b> <span class="t">VirtualMachineScaleSet</span>(<a href="../ScenarioTests/VMTestBase.cs.html#95ceb6a332cc253c" class="i field">m_location</a>)
            {
                <a href="/Azure.ResourceManager.Compute/A.html#b235408b70b35e9b" class="i property">Location</a> = <a href="../ScenarioTests/VMTestBase.cs.html#95ceb6a332cc253c" class="i field">m_location</a>,
                <a href="/Azure.ResourceManager.Compute/A.html#bf47c21c10578129" class="i property">Tags</a> = { { <span class="s">&quot;RG&quot;</span>, <span class="s">&quot;rg&quot;</span> }, { <span class="s">&quot;testTag&quot;</span>, <span class="s">&quot;1&quot;</span> } },
                <span class="i">Sku</span> = <b>new</b> <span class="i n">CM</span>.<span class="t">Sku</span>()
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#4b0057351c10d40a" class="i property">Capacity</a> = 2,
                    <a href="/Azure.ResourceManager.Compute/A.html#910ea2150de9bf4d" class="i property">Name</a> = <span class="r23 r">machineSizeType</span> == <b>null</b> ? <span class="r31 r">vmSize</span> : <span class="r23 r">machineSizeType</span>
                },
                <a href="/Azure.ResourceManager.Compute/A.html#da24a07ec2c90299" class="i property">Overprovision</a> = <b>false</b>,
                <span class="i">UpgradePolicy</span> = <b>new</b> <span class="t">UpgradePolicy</span>()
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#5537b23f1818350d" class="i property">Mode</a> = <a href="/Azure.ResourceManager.Compute/A.html#29a29bc4ce160a32" class="t t">UpgradeMode</a>.<a href="/Azure.ResourceManager.Compute/A.html#4e84f8d811e8d427" class="i field">Automatic</a>
                },
                <span class="i">VirtualMachineProfile</span> = <b>new</b> <span class="t">VirtualMachineScaleSetVMProfile</span>()
                {
                    <span class="i">StorageProfile</span> = <span class="r36 r">virtualMachineScaleSetStorageProfile</span>,
                    <span class="i">OsProfile</span> = <b>new</b> <span class="t">VirtualMachineScaleSetOSProfile</span>()
                    {
                        <a href="/Azure.ResourceManager.Compute/A.html#e8599c5bed7d8df2" class="i property">ComputerNamePrefix</a> = <span class="s">&quot;test&quot;</span>,
                        <a href="/Azure.ResourceManager.Compute/A.html#998bafebb326c2d9" class="i property">AdminUsername</a> = <span class="s">&quot;Foo12&quot;</span>,
                        <a href="/Azure.ResourceManager.Compute/A.html#de715405ab399077" class="i property">AdminPassword</a> = <a href="../ScenarioTests/VMTestBase.cs.html#ef7f62b101fa12ab" class="i field">PLACEHOLDER</a>,
                        <a href="/Azure.ResourceManager.Compute/A.html#7e0b3235ef9b7060" class="i property">CustomData</a> = <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#f9e5bd7b69c5f334" class="i method">ToBase64String</a>(<a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#a10eb90a3d884500" class="i property">UTF8</a>.<a href="@0@mscorlib/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="s">&quot;Custom data&quot;</span>))
                    },
                    <span class="i">NetworkProfile</span> = <b>new</b> <span class="t">VirtualMachineScaleSetNetworkProfile</span>()
                    {
                        <span class="i">HealthProbe</span> = <span class="r19 r">healthProbeId</span> == <b>null</b> ? <b>null</b> : <b>new</b> <span class="t">ApiEntityReference</span>
                        {
                            <a href="/Azure.ResourceManager.Compute/A.html#03f1343cdb863204" class="i property">Id</a> = <span class="r19 r">healthProbeId</span>
                        },
                        <a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a> = {
                            <b>new</b> <span class="t">VirtualMachineScaleSetNetworkConfiguration</span>(<span class="r32 r">test1</span>)
                            {
                                <a href="/Azure.ResourceManager.Compute/A.html#884c7ed4bbd4e728" class="i property">Primary</a> = <b>true</b>,
                                <a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a> = {
                                    <span class="r34 r">virtualMachineScaleSetIpConfiguration</span>
                                }
                            }
                        }
                    },
                    <span class="i">ExtensionProfile</span> = <b>new</b> <span class="t">VirtualMachineScaleSetExtensionProfile</span>(),
                },
                <span class="i">AutomaticRepairsPolicy</span> = <span class="r26 r">automaticRepairsPolicy</span>
            };
 
            <span class="r37 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#c0b71f06d5237e12" class="i property">Zones</a>.<span class="i">InitializeFrom</span>(<span class="r21 r">zones</span>);
            <b>if</b> (<span class="r24 r">enableUltraSSD</span> == <b>true</b>)
            {
                <span class="r37 r">vmScaleSet</span>.<span class="i">AdditionalCapabilities</span> = <b>new</b> <span class="t">AdditionalCapabilities</span>
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#585bd3b26488956c" class="i property">UltraSSDEnabled</a> = <b>true</b>
                };
 
                <a href="/Azure.ResourceManager.Compute/A.html#366ccad7bf756a9b" class="t t">VirtualMachineScaleSetOSDisk</a> <span id="r38 rd" class="r38 r">osDisk</span> = <span class="r37 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>;
                <span class="r38 r">osDisk</span>.<span class="i">ManagedDisk</span> = <span class="r38 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a> ?? <b>new</b> <span class="t">VirtualMachineScaleSetManagedDiskParameters</span>();
                <span class="r38 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> = <a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#a1e5be5e5538de3a" class="i property">PremiumLRS</a>;
 
                <b>foreach</b> (<a href="/Azure.ResourceManager.Compute/A.html#80df06e48d139560" class="t t">VirtualMachineScaleSetDataDisk</a> <span id="r39 rd" class="r39 r">dataDisk</span> <b>in</b> <span class="r37 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a>)
                {
                    <span class="r39 r">dataDisk</span>.<span class="i">ManagedDisk</span> = <span class="r39 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#f05819613e5174a3" class="i property">ManagedDisk</a> ?? <b>new</b> <span class="t">VirtualMachineScaleSetManagedDiskParameters</span>();
                    <span class="r39 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#f05819613e5174a3" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> = <a href="/Azure.ResourceManager.Compute/A.html#874aadda420cd4e2" class="t t">StorageAccountTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#fe090e47f98a2234" class="i property">UltraSSDLRS</a>;
                }
            }
 
            <b>return</b> <span class="r37 r">vmScaleSet</span>;
        }
 
        <b>public async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;(<a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a>, <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a>)&gt; <a id="411e3a6aa6e5cc86" href="../R/411e3a6aa6e5cc86.html" target="n" data-glyph="72,1" class="i method">CreateVMScaleSet_NoAsyncTracking</a>(
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r40 rd" class="r40 r">rgName</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r41 rd" class="r41 r">vmssName</span>,
            <span class="i">StorageAccount</span> <span id="r42 rd" class="r42 r">storageAccount</span>,
            <a href="/Azure.ResourceManager.Compute/A.html#19e1fbe185d30a5a" class="t t">ImageReference</a> <span id="r43 rd" class="r43 r">imageRef</span>,
            <a href="/Azure.ResourceManager.Compute/A.html#ffa5a2f376aa0d38" class="t t">VirtualMachineScaleSetExtensionProfile</a> <span id="r44 rd" class="r44 r">extensionProfile</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#486d58da4553e12d" class="t t">Action</a>&lt;<a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a>&gt; <span id="r45 rd" class="r45 r">vmScaleSetCustomizer</span> = <b>null</b>,
            <b>bool</b> <span id="r46 rd" class="r46 r">createWithPublicIpAddress</span> = <b>false</b>,
            <b>bool</b> <span id="r47 rd" class="r47 r">createWithManagedDisks</span> = <b>false</b>,
            <b>bool</b> <span id="r48 rd" class="r48 r">hasDiffDisks</span> = <b>false</b>,
            <b>bool</b> <span id="r49 rd" class="r49 r">createWithHealthProbe</span> = <b>false</b>,
            <span class="i">Subnet</span> <span id="r50 rd" class="r50 r">subnet</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r51 rd" class="r51 r">zones</span> = <b>null</b>,
            <b>int</b>? <span id="r52 rd" class="r52 r">osDiskSizeInGB</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r53 rd" class="r53 r">ppgId</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r54 rd" class="r54 r">machineSizeType</span> = <b>null</b>,
            <b>bool</b>? <span id="r55 rd" class="r55 r">enableUltraSSD</span> = <b>false</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r56 rd" class="r56 r">diskEncryptionSetId</span> = <b>null</b>,
            <a href="/Azure.ResourceManager.Compute/A.html#decd73f3134d9a7e" class="t t">AutomaticRepairsPolicy</a> <span id="r57 rd" class="r57 r">automaticRepairsPolicy</span> = <b>null</b>)
        {
            <b>try</b>
            {
                <a href="/System.ValueTuple/A.html#0d3bf0818d69cf43" class="k">var</a> <span id="r58 rd" class="r58 r">createOrUpdateResponse</span> = <b>await</b> <a href="#5750b0ad9f9f6515" class="i method">CreateVMScaleSetAndGetOperationResponse</a>(<span class="r40 r">rgName</span>,
                                                                                     <span class="r41 r">vmssName</span>,
                                                                                     <span class="r42 r">storageAccount</span>,
                                                                                     <span class="r43 r">imageRef</span>,
                                                                                     <span class="r44 r">extensionProfile</span>,
                                                                                     <span class="r45 r">vmScaleSetCustomizer</span>,
                                                                                     <span class="r46 r">createWithPublicIpAddress</span>,
                                                                                     <span class="r47 r">createWithManagedDisks</span>,
                                                                                     <span class="r48 r">hasDiffDisks</span>,
                                                                                     <span class="r49 r">createWithHealthProbe</span>,
                                                                                     <span class="r50 r">subnet</span>,
                                                                                     <span class="r51 r">zones</span>,
                                                                                     <span class="r52 r">osDiskSizeInGB</span>,
                                                                                     <span class="r59 r">ppgId</span>: <span class="r53 r">ppgId</span>,
                                                                                     <span class="r60 r">machineSizeType</span>: <span class="r54 r">machineSizeType</span>,
                                                                                     <span class="r61 r">enableUltraSSD</span>: <span class="r55 r">enableUltraSSD</span>,
                                                                                     <span class="r62 r">diskEncryptionSetId</span>: <span class="r56 r">diskEncryptionSetId</span>,
                                                                                     <span class="r63 r">automaticRepairsPolicy</span>: <span class="r57 r">automaticRepairsPolicy</span>);
 
                <b>var</b> <span id="r64 rd" class="r64 r">getResponse</span> = <b>await</b> <a href="../ComputeClientBase.cs.html#5d0663a22cddbee5" class="i property">VirtualMachineScaleSetsOperations</a>.<span class="i">GetAsync</span>(<span class="r40 r">rgName</span>, <span class="r41 r">vmssName</span>);
                <b>return</b> (<span class="r64 r">getResponse</span>, <span class="r58 r">createOrUpdateResponse</span>.<a href="/System.ValueTuple/A.html#620a93a987665270" class="i field">Item2</a>);
            }
            <b>catch</b>
            {
                <b>throw</b>;
            }
        }
 
        <span class="c">//not use in track one</span>
        <span class="c">//protected async Task&lt;VirtualMachineScaleSet&gt; CreateVMScaleSet(</span>
        <span class="c">//    string rgName,</span>
        <span class="c">//    string vmssName,</span>
        <span class="c">//    StorageAccount storageAccount,</span>
        <span class="c">//    ImageReference imageRef,</span>
        <span class="c">//    VirtualMachineScaleSetExtensionProfile extensionProfile = null,</span>
        <span class="c">//    Action&lt;VirtualMachineScaleSet&gt; vmScaleSetCustomizer = null,</span>
        <span class="c">//    bool createWithPublicIpAddress = false,</span>
        <span class="c">//    bool createWithManagedDisks = false)</span>
        <span class="c">//{</span>
        <span class="c">//    try</span>
        <span class="c">//    {</span>
        <span class="c">//        var createOrUpdateResponse = CreateVMScaleSetAndGetOperationResponse(</span>
        <span class="c">//            rgName,</span>
        <span class="c">//            vmssName,</span>
        <span class="c">//            storageAccount,</span>
        <span class="c">//            imageRef,</span>
        <span class="c">//            extensionProfile,</span>
        <span class="c">//            vmScaleSetCustomizer,</span>
        <span class="c">//            createWithPublicIpAddress,</span>
        <span class="c">//            createWithManagedDisks);</span>
 
        <span class="c">//        var lroResponse = await VirtualMachineScaleSetsClient.StartCreateOrUpdateAsync(rgName, inputVMScaleSet.Name, inputVMScaleSet);</span>
 
        <span class="c">//        var getResponse = await VirtualMachineScaleSetsClient.Get(rgName, inputVMScaleSet.Name);</span>
 
        <span class="c">//        return getResponse;</span>
        <span class="c">//    }</span>
        <span class="c">//    catch</span>
        <span class="c">//    {</span>
        <span class="c">//        await ResourceGroupsClient.Delete(rgName);</span>
        <span class="c">//        throw;</span>
        <span class="c">//    }</span>
        <span class="c">//}</span>
 
        <b>protected async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="541b1c16708c15d8" href="../R/541b1c16708c15d8.html" target="n" data-glyph="75,1" class="i method">UpdateVMScaleSet</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r65 rd" class="r65 r">rgName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r66 rd" class="r66 r">vmssName</span>, <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r67 rd" class="r67 r">inputVMScaleSet</span>)
        {
            <b>var</b> <span id="r68 rd" class="r68 r">createOrUpdateResponse</span> = <b>await</b> <span class="i">WaitForCompletionAsync</span>(<b>await</b> <a href="../ComputeClientBase.cs.html#5d0663a22cddbee5" class="i property">VirtualMachineScaleSetsOperations</a>.<span class="i">StartCreateOrUpdateAsync</span>(<span class="r65 r">rgName</span>, <span class="r66 r">vmssName</span>, <span class="r67 r">inputVMScaleSet</span>));
        }
 
        <span class="c">// This method is used to Update VM Scale Set but it internally calls PATCH verb instead of PUT.</span>
        <span class="c">// PATCH verb is more relaxed and does not puts constraint to specify full parameters.</span>
        <b>protected async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d5b94af64c214b98" href="../R/d5b94af64c214b98.html" target="n" data-glyph="75,1" class="i method">PatchVMScaleSet</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r69 rd" class="r69 r">rgName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r70 rd" class="r70 r">vmssName</span>, <a href="/Azure.ResourceManager.Compute/A.html#2a9188b337515bcb" class="t t">VirtualMachineScaleSetUpdate</a> <span id="r71 rd" class="r71 r">inputVMScaleSet</span>)
        {
            <b>var</b> <span id="r72 rd" class="r72 r">patchResponse</span> = <b>await</b> <span class="i">WaitForCompletionAsync</span>(<b>await</b> <a href="../ComputeClientBase.cs.html#5d0663a22cddbee5" class="i property">VirtualMachineScaleSetsOperations</a>.<span class="i">StartUpdateAsync</span>(<span class="r69 r">rgName</span>, <span class="r70 r">vmssName</span>, <span class="r71 r">inputVMScaleSet</span>));
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;(<a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a>, <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a>)&gt; <a id="5750b0ad9f9f6515" href="../R/5750b0ad9f9f6515.html" target="n" data-glyph="76,1" class="i method">CreateVMScaleSetAndGetOperationResponse</a>(
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r73 rd" class="r73 r">rgName</span>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r74 rd" class="r74 r">vmssName</span>,
            <span class="i">StorageAccount</span> <span id="r75 rd" class="r75 r">storageAccount</span>,
            <a href="/Azure.ResourceManager.Compute/A.html#19e1fbe185d30a5a" class="t t">ImageReference</a> <span id="r76 rd" class="r76 r">imageRef</span>,
            <a href="/Azure.ResourceManager.Compute/A.html#ffa5a2f376aa0d38" class="t t">VirtualMachineScaleSetExtensionProfile</a> <span id="r77 rd" class="r77 r">extensionProfile</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#486d58da4553e12d" class="t t">Action</a>&lt;<a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a>&gt; <span id="r78 rd" class="r78 r">vmScaleSetCustomizer</span> = <b>null</b>,
            <b>bool</b> <span id="r79 rd" class="r79 r">createWithPublicIpAddress</span> = <b>false</b>,
            <b>bool</b> <span id="r80 rd" class="r80 r">createWithManagedDisks</span> = <b>false</b>,
            <b>bool</b> <span id="r81 rd" class="r81 r">hasDiffDisks</span> = <b>false</b>,
            <b>bool</b> <span id="r82 rd" class="r82 r">createWithHealthProbe</span> = <b>false</b>,
            <span class="i">Subnet</span> <span id="r83 rd" class="r83 r">subnet</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r84 rd" class="r84 r">zones</span> = <b>null</b>,
            <b>int</b>? <span id="r85 rd" class="r85 r">osDiskSizeInGB</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r59 rd" class="r59 r">ppgId</span> = <b>null</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r60 rd" class="r60 r">machineSizeType</span> = <b>null</b>,
            <b>bool</b>? <span id="r61 rd" class="r61 r">enableUltraSSD</span> = <b>false</b>,
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r62 rd" class="r62 r">diskEncryptionSetId</span> = <b>null</b>,
            <a href="/Azure.ResourceManager.Compute/A.html#decd73f3134d9a7e" class="t t">AutomaticRepairsPolicy</a> <span id="r63 rd" class="r63 r">automaticRepairsPolicy</span> = <b>null</b>)
        {
            <span class="c">// Create the resource Group, it might have been already created during StorageAccount creation.</span>
            <b>var</b> <span id="r86 rd" class="r86 r">resourceGroup</span> = <b>await</b> <a href="../ComputeClientBase.cs.html#8139955127602360" class="i property">ResourceGroupsOperations</a>.<span class="i">CreateOrUpdateAsync</span>(
                <span class="r73 r">rgName</span>,
                <b>new</b> <span class="i">ResourceGroup</span>(<a href="../ScenarioTests/VMTestBase.cs.html#95ceb6a332cc253c" class="i field">m_location</a>));
 
            <b>var</b> <span id="r87 rd" class="r87 r">getPublicIpAddressResponse</span> = <span class="r79 r">createWithPublicIpAddress</span> ? <b>null</b> : <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#db2b56533b31d75a" class="i method">CreatePublicIP</a>(<span class="r73 r">rgName</span>);
 
            <b>var</b> <span id="r88 rd" class="r88 r">subnetResponse</span> = <span class="r83 r">subnet</span> ?? <b>await</b> <a href="../ScenarioTests/VMTestBase.cs.html#fdc6a124f1bce000" class="i method">CreateVNET</a>(<span class="r73 r">rgName</span>);
 
            <b>var</b> <span id="r89 rd" class="r89 r">nicResponse</span> = <b>await</b> <span class="i">CreateNIC</span>(
                <span class="r73 r">rgName</span>,
                <span class="r88 r">subnetResponse</span>,
                <span class="r87 r">getPublicIpAddressResponse</span> != <b>null</b> ? <span class="r87 r">getPublicIpAddressResponse</span>.<span class="i">IpAddress</span> : <b>null</b>);
 
            <b>var</b> <span id="r90 rd" class="r90 r">loadBalancer</span> = ((<span class="r87 r">getPublicIpAddressResponse</span> != <b>null</b> &amp;&amp; <span class="r82 r">createWithHealthProbe</span>) ?
                (<b>await</b> <span class="i">CreatePublicLoadBalancerWithProbe</span>(<span class="r73 r">rgName</span>, <span class="r87 r">getPublicIpAddressResponse</span>)) : <b>null</b>);
 
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r80 r">createWithManagedDisks</span> || <span class="r75 r">storageAccount</span> != <b>null</b>);
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="k">var</a> <span id="r91 rd" class="r91 r">inputVMScaleSet</span> = <span class="i">CreateDefaultVMScaleSetInput</span>(<span class="r73 r">rgName</span>, <span class="r75 r">storageAccount</span>?.<span class="i">Name</span>, <span class="r76 r">imageRef</span>, <span class="r88 r">subnetResponse</span>.<span class="i">Id</span>, <span class="i">hasManagedDisks</span>: <span class="r80 r">createWithManagedDisks</span>,
                <span class="i">healthProbeId</span>: <span class="r90 r">loadBalancer</span>?.<span class="i">Probes</span>?.<span class="i">FirstOrDefault</span>()?.<span class="i">Id</span>,
                <span class="i">loadBalancerBackendPoolId</span>: <span class="r90 r">loadBalancer</span>?.<span class="i">BackendAddressPools</span>?.<span class="i">FirstOrDefault</span>()?.<span class="i">Id</span>, <span class="i">zones</span>: <span class="r84 r">zones</span>, <span class="i">osDiskSizeInGB</span>: <span class="r85 r">osDiskSizeInGB</span>,
                <span class="i">machineSizeType</span>: <span class="r60 r">machineSizeType</span>, <span class="i">enableUltraSSD</span>: <span class="r61 r">enableUltraSSD</span>, <span class="i">diskEncryptionSetId</span>: <span class="r62 r">diskEncryptionSetId</span>, <span class="i">automaticRepairsPolicy</span>: <span class="r63 r">automaticRepairsPolicy</span>);
            <b>if</b> (<span class="r78 r">vmScaleSetCustomizer</span> != <b>null</b>)
            {
                <span class="r78 r">vmScaleSetCustomizer</span>(<span class="r91 r">inputVMScaleSet</span>);
            }
 
            <b>if</b> (<span class="r81 r">hasDiffDisks</span>)
            {
                <a href="/Azure.ResourceManager.Compute/A.html#366ccad7bf756a9b" class="t t">VirtualMachineScaleSetOSDisk</a> <span id="r92 rd" class="r92 r">osDisk</span> = <b>new</b> <span class="t">VirtualMachineScaleSetOSDisk</span>(<a href="/Azure.ResourceManager.Compute/A.html#04b47e9b28f04490" class="t t">DiskCreateOptionTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#26c2fd3d03e23069" class="i property">FromImage</a>);
                <span class="r92 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a> = <a href="/Azure.ResourceManager.Compute/A.html#582888f93d0af1cc" class="t t">CachingTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#f2efbb710f25c07a" class="i field">ReadOnly</a>;
                <span class="r92 r">osDisk</span>.<span class="i">DiffDiskSettings</span> = <b>new</b> <span class="t">DiffDiskSettings</span>
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#dd1d25c67a396662" class="i property">Option</a> = <span class="s">&quot;Local&quot;</span>,
                    <span class="c">//TODO the value of &quot;Placement&quot; may not be given</span>
                    <span class="c">//Placement = DiffDiskPlacement.CacheDisk</span>
                };
                <span class="r91 r">inputVMScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<span class="i">OsDisk</span> = <span class="r92 r">osDisk</span>;
            }
 
            <span class="r91 r">inputVMScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<span class="i">ExtensionProfile</span> = <span class="r77 r">extensionProfile</span>;
 
            <b>if</b> (<span class="r59 r">ppgId</span> != <b>null</b>)
            {
                <span class="r91 r">inputVMScaleSet</span>.<span class="i">ProximityPlacementGroup</span> = <b>new</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Compute</span>.<span class="i n">Models</span>.<span class="t">SubResource</span>() { <a href="/Azure.ResourceManager.Compute/A.html#db7f6acff8a8c083" class="i property">Id</a> = <span class="r59 r">ppgId</span> };
            }
 
            <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r93 rd" class="r93 r">createOrUpdateResponse</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r93 r">createOrUpdateResponse</span> = <b>await</b> <span class="i">WaitForCompletionAsync</span>(<b>await</b> <a href="../ComputeClientBase.cs.html#5d0663a22cddbee5" class="i property">VirtualMachineScaleSetsOperations</a>.<span class="i">StartCreateOrUpdateAsync</span>(<span class="r73 r">rgName</span>, <span class="r74 r">vmssName</span>, <span class="r91 r">inputVMScaleSet</span>));
 
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r93 r">createOrUpdateResponse</span>.<a href="/Azure.ResourceManager.Compute/A.html#7be792e3b436d256" class="i property">Name</a> == <span class="r74 r">vmssName</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r93 r">createOrUpdateResponse</span>.<a href="/Azure.ResourceManager.Compute/A.html#b235408b70b35e9b" class="i property">Location</a>.<span class="i">ToLower</span>() == <span class="r91 r">inputVMScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#b235408b70b35e9b" class="i property">Location</a>.<span class="i">ToLower</span>().<span class="i">Replace</span>(<span class="s">&quot; &quot;</span>, <span class="s">&quot;&quot;</span>));
            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r94 rd" class="r94 r">e</span>)
            {
                <b>if</b> (<span class="r94 r">e</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;the allotted time&quot;</span>))
                {
                    <span class="r93 r">createOrUpdateResponse</span> = <b>await</b> <a href="../ComputeClientBase.cs.html#5d0663a22cddbee5" class="i property">VirtualMachineScaleSetsOperations</a>.<span class="i">GetAsync</span>(<span class="r73 r">rgName</span>, <span class="r74 r">vmssName</span>);
                }
                <b>else</b>
                {
                    <b>throw</b>;
                }
            }
 
            <a href="#dbca6eab6aa7d1c9" class="i method">ValidateVMScaleSet</a>(<span class="r91 r">inputVMScaleSet</span>, <span class="r93 r">createOrUpdateResponse</span>, <span class="r80 r">createWithManagedDisks</span>, <span class="r95 r">ppgId</span>: <span class="r59 r">ppgId</span>);
 
            <b>return</b> (<span class="r93 r">createOrUpdateResponse</span>, <span class="r91 r">inputVMScaleSet</span>);
        }
 
        <b>protected void</b> <a id="db3798fce6fb6be9" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ValidateVMScaleSetInstanceView</a>(<a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r96 rd" class="r96 r">vmScaleSet</span>,
            <a href="/Azure.ResourceManager.Compute/A.html#9b0e558244cd0481" class="t t">VirtualMachineScaleSetInstanceView</a> <span id="r97 rd" class="r97 r">vmScaleSetInstanceView</span>)
        {
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r97 r">vmScaleSetInstanceView</span>.<a href="/Azure.ResourceManager.Compute/A.html#75833ca48f136cba" class="i property">Statuses</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r97 r">vmScaleSetInstanceView</span>);
            <b>if</b> (<span class="r96 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#0df4abb1e699006b" class="i property">ExtensionProfile</a> != <b>null</b>)
            {
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r97 r">vmScaleSetInstanceView</span>.<a href="/Azure.ResourceManager.Compute/A.html#869db1d06a2d62e4" class="i property">Extensions</a>);
                <b>int</b> <span id="r98 rd" class="r98 r">instancesCount</span> = <span class="r97 r">vmScaleSetInstanceView</span>.<a href="/Azure.ResourceManager.Compute/A.html#869db1d06a2d62e4" class="i property">Extensions</a>.<span class="i">First</span>().<span class="i">StatusesSummary</span>.<span class="i">Sum</span>(<span id="r99 rd" class="r99 r">t</span> =&gt; <span class="r99 r">t</span>.<span class="i">Count</span>.<span class="i">Value</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r98 r">instancesCount</span> == <span class="r96 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#4b0057351c10d40a" class="i property">Capacity</a>);
            }
        }
 
        <b>protected void</b> <a id="dbca6eab6aa7d1c9" href="../R/dbca6eab6aa7d1c9.html" target="n" data-glyph="75,1" class="i method">ValidateVMScaleSet</a>(<a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r100 rd" class="r100 r">vmScaleSet</span>, <a href="/Azure.ResourceManager.Compute/A.html#0625e08d6ffc09dc" class="t t">VirtualMachineScaleSet</a> <span id="r101 rd" class="r101 r">vmScaleSetOut</span>, <b>bool</b> <span id="r102 rd" class="r102 r">hasManagedDisks</span> = <b>false</b>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r95 rd" class="r95 r">ppgId</span> = <b>null</b>)
        {
            <span class="i">Assert</span>.<span class="i">True</span>(!<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#ae245529e340a535" class="i property">ProvisioningState</a>));
 
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#910ea2150de9bf4d" class="i property">Name</a>
                     == <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#a9848208ff07be83" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Compute/A.html#910ea2150de9bf4d" class="i property">Name</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>);
 
            <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>?.<a href="/Azure.ResourceManager.Compute/A.html#7834dcb261f06cfe" class="i property">DiskSizeGB</a> != <b>null</b>)
            {
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#7834dcb261f06cfe" class="i property">DiskSizeGB</a>);
                <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#7834dcb261f06cfe" class="i property">DiskSizeGB</a>, <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#7834dcb261f06cfe" class="i property">DiskSizeGB</a>);
            }
 
            <b>if</b> (!<span class="r102 r">hasManagedDisks</span>)
            {
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#1fe1910fe7752f41" class="i property">Name</a>
                            == <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#1fe1910fe7752f41" class="i property">Name</a>);
 
                <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#4809a6ace1f8ff2d" class="i property">Image</a> != <b>null</b>)
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#4809a6ace1f8ff2d" class="i property">Image</a>.<a href="/Azure.ResourceManager.Compute/A.html#8ddbc33338714b67" class="i property">Uri</a>
                                == <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#4809a6ace1f8ff2d" class="i property">Image</a>.<a href="/Azure.ResourceManager.Compute/A.html#8ddbc33338714b67" class="i property">Uri</a>);
                }
 
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a>
                            == <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a>);
            }
            <b>else</b>
            {
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a>);
 
                <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a> != <b>null</b>)
                {
                    <a href="/Azure.ResourceManager.Compute/A.html#366ccad7bf756a9b" class="t t">VirtualMachineScaleSetOSDisk</a> <span id="r103 rd" class="r103 r">osDisk</span> = <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>;
                    <a href="/Azure.ResourceManager.Compute/A.html#366ccad7bf756a9b" class="t t">VirtualMachineScaleSetOSDisk</a> <span id="r104 rd" class="r104 r">osDiskOut</span> =
                        <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#f7067055823eecc7" class="i property">OsDisk</a>;
 
                    <b>if</b> (<span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a> != <b>null</b>)
                    {
                        <span class="i">Assert</span>.<span class="i">True</span>(<span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a> == <span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a>);
                    }
                    <b>else</b>
                    {
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#ff25f8934f78861a" class="i property">Caching</a>);
                    }
 
                    <b>if</b> (<span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#e3797bf27bc827bd" class="i property">DiffDiskSettings</a> != <b>null</b>)
                    {
                        <span class="i">Assert</span>.<span class="i">True</span>(<span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#e3797bf27bc827bd" class="i property">DiffDiskSettings</a>.<a href="/Azure.ResourceManager.Compute/A.html#dd1d25c67a396662" class="i property">Option</a> == <span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#e3797bf27bc827bd" class="i property">DiffDiskSettings</a>.<a href="/Azure.ResourceManager.Compute/A.html#dd1d25c67a396662" class="i property">Option</a>);
                    }
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a>);
                    <b>if</b> (<span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a> != <b>null</b> &amp;&amp; <span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> != <b>null</b>)
                    {
                        <span class="i">Assert</span>.<span class="i">True</span>(<span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> == <span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a>);
                    }
                    <b>else</b>
                    {
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#4e3fab6914a17514" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a>);
                    }
 
                    <b>if</b> (<span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#1fe1910fe7752f41" class="i property">Name</a> != <b>null</b>)
                    {
                        <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#1fe1910fe7752f41" class="i property">Name</a>, <span class="r103 r">osDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#1fe1910fe7752f41" class="i property">Name</a>);
                    }
 
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r104 r">osDiskOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#e69109f0171e0b11" class="i property">CreateOption</a> == <a href="/Azure.ResourceManager.Compute/A.html#04b47e9b28f04490" class="t t">DiskCreateOptionTypes</a>.<a href="/Azure.ResourceManager.Compute/A.html#26c2fd3d03e23069" class="i property">FromImage</a>);
                }
 
                <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a> != <b>null</b>
                    &amp;&amp; <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(
                        <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a>.<span class="i">Count</span>,
                        <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a>.<span class="i">Count</span>);
 
                    <b>foreach</b> (<a href="/Azure.ResourceManager.Compute/A.html#80df06e48d139560" class="t t">VirtualMachineScaleSetDataDisk</a> <span id="r105 rd" class="r105 r">dataDisk</span> <b>in</b> <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a>)
                    {
                        <a href="/Azure.ResourceManager.Compute/A.html#80df06e48d139560" class="t t">VirtualMachineScaleSetDataDisk</a> <span id="r106 rd" class="r106 r">matchingDataDisk</span>
                            = <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#3bd967d7f085cd9e" class="i property">StorageProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#4bb9ec4ceb87efe8" class="i property">DataDisks</a>.<span class="i">FirstOrDefault</span>(<span id="r107 rd" class="r107 r">disk</span> =&gt; <span class="r107 r">disk</span>.<span class="i">Lun</span> == <span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#16eddde570c804eb" class="i property">Lun</a>);
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r106 r">matchingDataDisk</span>);
 
                        <b>if</b> (<span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#bfe34caf5a5ecb5c" class="i property">Caching</a> != <b>null</b>)
                        {
                            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#bfe34caf5a5ecb5c" class="i property">Caching</a> == <span class="r106 r">matchingDataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#bfe34caf5a5ecb5c" class="i property">Caching</a>);
                        }
                        <b>else</b>
                        {
                            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r106 r">matchingDataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#bfe34caf5a5ecb5c" class="i property">Caching</a>);
                        }
 
                        <b>if</b> (<span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#f05819613e5174a3" class="i property">ManagedDisk</a> != <b>null</b> &amp;&amp; <span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#f05819613e5174a3" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> != <b>null</b>)
                        {
                            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#f05819613e5174a3" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a> == <span class="r106 r">matchingDataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#f05819613e5174a3" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a>);
                        }
                        <b>else</b>
                        {
                            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r106 r">matchingDataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#f05819613e5174a3" class="i property">ManagedDisk</a>.<a href="/Azure.ResourceManager.Compute/A.html#3734d120212a4b45" class="i property">StorageAccountType</a>);
                        }
 
                        <b>if</b> (<span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#c514f608790c8a75" class="i property">Name</a> != <b>null</b>)
                        {
                            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#c514f608790c8a75" class="i property">Name</a>, <span class="r106 r">matchingDataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#c514f608790c8a75" class="i property">Name</a>);
                        }
                        <span class="i">Assert</span>.<span class="i">True</span>(<span class="r105 r">dataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#533c098bfe0b05f4" class="i property">CreateOption</a> == <span class="r106 r">matchingDataDisk</span>.<a href="/Azure.ResourceManager.Compute/A.html#533c098bfe0b05f4" class="i property">CreateOption</a>);
                    }
                }
            }
 
            <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#9de96adb8f53d132" class="i property">UpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#44f1541f542e7915" class="i property">AutomaticOSUpgradePolicy</a> != <b>null</b>)
            {
                <b>bool</b> <span id="r108 rd" class="r108 r">expectedDisableAutomaticRollbackValue</span> = <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#9de96adb8f53d132" class="i property">UpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#44f1541f542e7915" class="i property">AutomaticOSUpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#1b2562de9b245f3b" class="i property">DisableAutomaticRollback</a> ?? <b>false</b>;
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#9de96adb8f53d132" class="i property">UpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#44f1541f542e7915" class="i property">AutomaticOSUpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#1b2562de9b245f3b" class="i property">DisableAutomaticRollback</a> == <span class="r108 r">expectedDisableAutomaticRollbackValue</span>);
 
                <b>bool</b> <span id="r109 rd" class="r109 r">expectedEnableAutomaticOSUpgradeValue</span> = <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#9de96adb8f53d132" class="i property">UpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#44f1541f542e7915" class="i property">AutomaticOSUpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#04cd8150e7febcb5" class="i property">EnableAutomaticOSUpgrade</a> ?? <b>false</b>;
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#9de96adb8f53d132" class="i property">UpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#44f1541f542e7915" class="i property">AutomaticOSUpgradePolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#04cd8150e7febcb5" class="i property">EnableAutomaticOSUpgrade</a> == <span class="r109 r">expectedEnableAutomaticOSUpgradeValue</span>);
            }
 
            <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#9d606709b30b3a38" class="i property">AutomaticRepairsPolicy</a> != <b>null</b>)
            {
                <b>bool</b> <span id="r110 rd" class="r110 r">expectedAutomaticRepairsEnabledValue</span> = <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#9d606709b30b3a38" class="i property">AutomaticRepairsPolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#fe7fa4a5469f210f" class="i property">Enabled</a> ?? <b>false</b>;
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#9d606709b30b3a38" class="i property">AutomaticRepairsPolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#fe7fa4a5469f210f" class="i property">Enabled</a> == <span class="r110 r">expectedAutomaticRepairsEnabledValue</span>);
 
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r111 rd" class="r111 r">expectedAutomaticRepairsGracePeriodValue</span> = <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#9d606709b30b3a38" class="i property">AutomaticRepairsPolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#70118eede1786836" class="i property">GracePeriod</a> ?? <span class="s">&quot;PT30M&quot;</span>;
                <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#9d606709b30b3a38" class="i property">AutomaticRepairsPolicy</a>.<a href="/Azure.ResourceManager.Compute/A.html#70118eede1786836" class="i property">GracePeriod</a>, <span class="r111 r">expectedAutomaticRepairsGracePeriodValue</span>);
            }
 
            <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#8ae37dba4f9de7ae" class="i property">OsProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#2df8004925c99e2c" class="i property">Secrets</a> != <b>null</b> &amp;&amp;
               <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#8ae37dba4f9de7ae" class="i property">OsProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#2df8004925c99e2c" class="i property">Secrets</a>.<span class="i">Any</span>())
            {
                <b>foreach</b> (<b>var</b> <span id="r112 rd" class="r112 r">secret</span> <b>in</b> <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#8ae37dba4f9de7ae" class="i property">OsProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#2df8004925c99e2c" class="i property">Secrets</a>)
                {
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r112 r">secret</span>.<span class="i">VaultCertificates</span>);
                    <b>var</b> <span id="r113 rd" class="r113 r">secretOut</span> = <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#8ae37dba4f9de7ae" class="i property">OsProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#2df8004925c99e2c" class="i property">Secrets</a>.<span class="i">FirstOrDefault</span>(<span id="r114 rd" class="r114 r">s</span> =&gt; <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<span class="i">Equals</span>(<span class="r112 r">secret</span>.<span class="i">SourceVault</span>.<span class="i">Id</span>, <span class="r114 r">s</span>.<span class="i">SourceVault</span>.<span class="i">Id</span>));
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r113 r">secretOut</span>);
 
                    <span class="c">// Disabling resharper null-ref check as it doesn&#39;t seem to understand the not-null assert above.</span>
                    <span class="c">// ReSharper disable PossibleNullReferenceException</span>
 
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r113 r">secretOut</span>.<span class="i">VaultCertificates</span>);
                    <a href="../Helpers/VaultCertComparer.cs.html#37ec501647cd1b78" class="k">var</a> <span id="r115 rd" class="r115 r">VaultCertComparer</span> = <b>new</b> <a href="../Helpers/VaultCertComparer.cs.html#37ec501647cd1b78" class="t constructor">VaultCertComparer</a>();
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r113 r">secretOut</span>.<span class="i">VaultCertificates</span>.<span class="i">SequenceEqual</span>(<span class="r112 r">secret</span>.<span class="i">VaultCertificates</span>, <span class="r115 r">VaultCertComparer</span>));
 
                    <span class="c">// ReSharper enable PossibleNullReferenceException</span>
                }
            }
 
            <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#0df4abb1e699006b" class="i property">ExtensionProfile</a> != <b>null</b> &amp;&amp;
                <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#0df4abb1e699006b" class="i property">ExtensionProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#e26c838f333bf6f4" class="i property">Extensions</a>.<span class="i">Any</span>())
            {
                <b>foreach</b> (<b>var</b> <span id="r116 rd" class="r116 r">vmExtension</span> <b>in</b> <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#0df4abb1e699006b" class="i property">ExtensionProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#e26c838f333bf6f4" class="i property">Extensions</a>)
                {
                    <b>var</b> <span id="r117 rd" class="r117 r">vmExt</span> = <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#0df4abb1e699006b" class="i property">ExtensionProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#e26c838f333bf6f4" class="i property">Extensions</a>.<span class="i">FirstOrDefault</span>(<span id="r118 rd" class="r118 r">s</span> =&gt; <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<span class="i">Compare</span>(<span class="r118 r">s</span>.<span class="i">Name</span>, <span class="r116 r">vmExtension</span>.<span class="i">Name</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>) == 0);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r117 r">vmExt</span>);
                }
            }
 
            <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a> != <b>null</b>)
            {
                <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a> != <b>null</b> &amp;&amp; <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a>);
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(
                        <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a>.<span class="i">Count</span>,
                        <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a>.<span class="i">Count</span>);
 
                    <b>foreach</b> (<b>var</b> <span id="r119 rd" class="r119 r">nicconfig</span> <b>in</b> <span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a>)
                    {
                        <b>var</b> <span id="r120 rd" class="r120 r">outnicconfig</span> =
                            <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a>.<span class="i">First</span>(
                                <span id="r121 rd" class="r121 r">nc</span> =&gt; <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<span class="i">Equals</span>(<span class="r121 r">nc</span>.<span class="i">Name</span>, <span class="r119 r">nicconfig</span>.<span class="i">Name</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>));
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r120 r">outnicconfig</span>);
                        <span class="i">CompareVmssNicConfig</span>(<span class="r119 r">nicconfig</span>, <span class="r120 r">outnicconfig</span>);
                    }
                }
            }
            <b>else</b>
            {
                <span class="i">Assert</span>.<span class="i">True</span>((<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a> == <b>null</b>) || (<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#d63e47366a81e339" class="i property">VirtualMachineProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#aa1348097528c0c5" class="i property">NetworkProfile</a>.<a href="/Azure.ResourceManager.Compute/A.html#a731a65239e6a7de" class="i property">NetworkInterfaceConfigurations</a>.<span class="i">Count</span> == 0));
            }
 
            <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#c0b71f06d5237e12" class="i property">Zones</a>.<span class="i">Count</span> != 0)
            {
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#c0b71f06d5237e12" class="i property">Zones</a>.<span class="i">SequenceEqual</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#c0b71f06d5237e12" class="i property">Zones</a>), <span class="s">&quot;Zones don&#39;t match&quot;</span>);
                <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#402c8b76fd4f4bc8" class="i property">ZoneBalance</a>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#402c8b76fd4f4bc8" class="i property">ZoneBalance</a>, <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#402c8b76fd4f4bc8" class="i property">ZoneBalance</a>);
                }
                <b>else</b>
                {
                    <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#c0b71f06d5237e12" class="i property">Zones</a>.<span class="i">Count</span> &gt; 1)
                    {
                        <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#402c8b76fd4f4bc8" class="i property">ZoneBalance</a>.<span class="i">HasValue</span>);
                    }
                    <b>else</b>
                    {
                        <span class="i">Assert</span>.<span class="i">False</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#402c8b76fd4f4bc8" class="i property">ZoneBalance</a>.<span class="i">HasValue</span>);
                    }
                }
 
                <b>if</b> (<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#de374fd31d1381c1" class="i property">PlatformFaultDomainCount</a>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r100 r">vmScaleSet</span>.<a href="/Azure.ResourceManager.Compute/A.html#de374fd31d1381c1" class="i property">PlatformFaultDomainCount</a>, <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#de374fd31d1381c1" class="i property">PlatformFaultDomainCount</a>);
                }
                <b>else</b>
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#de374fd31d1381c1" class="i property">PlatformFaultDomainCount</a>.<span class="i">HasValue</span>);
                }
            }
            <b>else</b>
            {
                <span class="i">Assert</span>.<span class="i">IsEmpty</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#c0b71f06d5237e12" class="i property">Zones</a>);
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#402c8b76fd4f4bc8" class="i property">ZoneBalance</a>);
            }
 
            <b>if</b> (<span class="r95 r">ppgId</span> != <b>null</b>)
            {
                <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r95 r">ppgId</span>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>(), <span class="r101 r">vmScaleSetOut</span>.<a href="/Azure.ResourceManager.Compute/A.html#4708d37e3903e995" class="i property">ProximityPlacementGroup</a>.<a href="/Azure.ResourceManager.Compute/A.html#db7f6acff8a8c083" class="i property">Id</a>.<span class="i">ToLower</span>());
            }
        }
 
        <b>protected void</b> <a id="8215bc76fcbcb29c" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">CompareVmssNicConfig</a>(<a href="/Azure.ResourceManager.Compute/A.html#aae48b0adfb7b025" class="t t">VirtualMachineScaleSetNetworkConfiguration</a> <span id="r122 rd" class="r122 r">nicconfig</span>,
            <a href="/Azure.ResourceManager.Compute/A.html#aae48b0adfb7b025" class="t t">VirtualMachineScaleSetNetworkConfiguration</a> <span id="r123 rd" class="r123 r">outnicconfig</span>)
        {
            <b>if</b> (<span class="r122 r">nicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a> != <b>null</b> &amp;&amp; <span class="r122 r">nicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r123 r">outnicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a>);
 
                <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r122 r">nicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a>.<span class="i">Count</span>, <span class="r123 r">outnicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a>.<span class="i">Count</span>);
 
                <b>foreach</b> (<b>var</b> <span id="r124 rd" class="r124 r">ipconfig</span> <b>in</b> <span class="r122 r">nicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a>)
                {
                    <b>var</b> <span id="r125 rd" class="r125 r">outipconfig</span> =
                        <span class="r123 r">outnicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a>.<span class="i">First</span>(
                            <span id="r126 rd" class="r126 r">ic</span> =&gt; <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<span class="i">Equals</span>(<span class="r126 r">ic</span>.<span class="i">Name</span>, <span class="r124 r">ipconfig</span>.<span class="i">Name</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>));
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r125 r">outipconfig</span>);
                    <span class="i">CompareIpConfigApplicationGatewayPools</span>(<span class="r124 r">ipconfig</span>, <span class="r125 r">outipconfig</span>);
                }
            }
            <b>else</b>
            {
                <span class="i">Assert</span>.<span class="i">True</span>((<span class="r123 r">outnicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a> == <b>null</b>) || (<span class="r123 r">outnicconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#526094feb4b1df2f" class="i property">IpConfigurations</a>.<span class="i">Count</span> == 0));
            }
        }
 
        <b>protected void</b> <a id="a2eb47672ecfc4ad" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">CompareIpConfigApplicationGatewayPools</a>(<a href="/Azure.ResourceManager.Compute/A.html#0fd44b3412b9927d" class="t t">VirtualMachineScaleSetIPConfiguration</a> <span id="r127 rd" class="r127 r">ipconfig</span>, <a href="/Azure.ResourceManager.Compute/A.html#0fd44b3412b9927d" class="t t">VirtualMachineScaleSetIPConfiguration</a> <span id="r128 rd" class="r128 r">outipconfig</span>)
        {
            <b>if</b> (<span class="r127 r">ipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a> != <b>null</b> &amp;&amp; <span class="r127 r">ipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r128 r">outipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>);
 
                <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r127 r">ipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>.<span class="i">Count</span>,
                    <span class="r128 r">outipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>.<span class="i">Count</span>);
 
                <b>foreach</b> (<b>var</b> <span id="r129 rd" class="r129 r">pool</span> <b>in</b> <span class="r127 r">ipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>)
                {
                    <b>var</b> <span id="r130 rd" class="r130 r">outPool</span> =
                        <span class="r128 r">outipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>.<span class="i">First</span>(
                            <span id="r131 rd" class="r131 r">p</span> =&gt; <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<span class="i">Equals</span>(<span class="r131 r">p</span>.<span class="i">Id</span>, <span class="r129 r">pool</span>.<span class="i">Id</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>));
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r130 r">outPool</span>);
                }
            }
            <b>else</b>
            {
                <span class="i">Assert</span>.<span class="i">True</span>((<span class="r128 r">outipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a> == <b>null</b>) || (<span class="r128 r">outipconfig</span>.<a href="/Azure.ResourceManager.Compute/A.html#902ca66a08c0e1ec" class="i property">ApplicationGatewayBackendAddressPools</a>.<span class="i">Count</span> == 0));
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
