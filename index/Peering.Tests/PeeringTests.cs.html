<!DOCTYPE html>
<html><head><title>PeeringTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(1221);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Peering.Tests/PeeringTests.cs" target="_top">PeeringTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Peering.Tests" target="_top">tests\Microsoft.Azure.Management.Peering.Tests.csproj</a> (Peering.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// --------------------------------------------------------------------------------------------------------------------</span>
<span class="c">// &lt;copyright file=&quot;PeeringTests.cs&quot; company=&quot;Microsoft&quot;&gt;</span>
<span class="c">//   </span>
<span class="c">// &lt;/copyright&gt;</span>
<span class="c">// &lt;summary&gt;</span>
<span class="c">//   Defines the  PeeringTests type.</span>
<span class="c">// &lt;/summary&gt;</span>
<span class="c">// --------------------------------------------------------------------------------------------------------------------</span>
 
<b>namespace</b> <span class="i n">Peering</span>.<span class="i n">Tests</span>
{
    <b>using</b> <span class="i">System</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Net</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Net</span>.<span class="i">Http</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Text</span>;
    <b>using</b> <span class="i">System</span>.<span class="i">Threading</span>;
 
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Peering</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Peering</span>.<span class="i n">Models</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i">Resources</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i">Resources</span>.<span class="i">Models</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i">Rest</span>.<span class="i">ClientRuntime</span>.<span class="i">Azure</span>.<span class="i">TestFramework</span>;
 
    <b>using</b> <span class="i">Newtonsoft</span>.<span class="i">Json</span>;
 
    <b>using</b> <span class="i">Xunit</span>;
 
    <b>using</b> <span class="t">DirectConnection</span> = <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Peering</span>.<span class="i n">Models</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#0a8420144ba1a4c3" class="t t">DirectConnection</a>;
    <b>using</b> <span class="i">MockServer</span> = <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i">Test</span>.<span class="i">HttpRecorder</span>.<span class="i">HttpMockServer</span>;
    <b>using</b> <span class="t">PeeringSku</span> = <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Peering</span>.<span class="i n">Models</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#e8a2f10dd78f07a8" class="t t">PeeringSku</a>;
    <b>using</b> <span class="t">SubResource</span> = <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Peering</span>.<span class="i n">Models</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#52da05620feb872d" class="t t">SubResource</a>;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The peering tests.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="10a37f15ea7fcac0" href="R/10a37f15ea7fcac0.html" target="n" data-glyph="0,0" class="t t">PeeringTests</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The local edge rp uri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;StyleCop.CSharp.DocumentationRules&quot;</span>, <span class="s">&quot;SA1650:ElementDocumentationMustBeSpelledCorrectly&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Reviewed. Suppression is OK here.&quot;</span>)]
        <b>public static</b> <span class="i">Uri</span> <a id="d0242f5bd781c3bc" href="R/d0242f5bd781c3bc.html" target="n" data-glyph="42,1" class="i field">LocalEdgeRpUri</a> = <b>new</b> <span class="i">Uri</span>(<span class="s">&quot;https://secrets.wanrr-test.radar.core.azure-test.net/&quot;</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The random.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Random</span> <a id="72d929bb4a27eb07" href="R/72d929bb4a27eb07.html" target="n" data-glyph="46,1" class="i field">random</a> = <b>new</b> <span class="i">Random</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#10a37f15ea7fcac0" class="t t">PeeringTests</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="0a6f73ddc5fcffbc" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PeeringTests</a>()
        {
            <span class="c">// Set the value to false for Playback or True for record.</span>
            <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#c3cb29bd63a1f672" class="i method">Setup</a>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="/Microsoft.Azure.Management.Peering/A.html#aa26d3bfb78c17ee" class="t t">PeeringManagementClient</a> <a id="8f54dd9ebd990357" href="R/8f54dd9ebd990357.html" target="n" data-glyph="102,1" class="i property">Client</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the resources client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ResourceManagementClient</span> <a id="1461542a81648870" href="R/1461542a81648870.html" target="n" data-glyph="102,1" class="i property">ResourcesClient</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the subscription id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="44da1e972ac34e30" href="R/44da1e972ac34e30.html" target="n" data-glyph="102,1" class="i property">SubscriptionId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The api version latest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="aad06a09c7e76021" href="R/aad06a09c7e76021.html" target="n" data-glyph="6,1" class="i field">ApiVersionLatest</a> = <span class="s">&quot;2020-10-01&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The peering operations test.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="18ce99af81f19a76" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PeeringOperationsTest</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r0 rd" class="r0 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r0 r">context</span>);
                <b>var</b> <span id="r1 rd" class="r1 r">peeringLists</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#67ad717435891bff" class="i property">Operations</a>.<span class="i">List</span>();
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r1 r">peeringLists</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The get direct locations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="0f01520429c64ce1" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetDirectLocations</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r2 rd" class="r2 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r2 r">context</span>);
                <b>var</b> <span id="r3 rd" class="r3 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#a716df479cf2df0c" class="i property">PeeringLocations</a>.<span class="i">List</span>(<span class="s">&quot;Direct&quot;</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r3 r">result</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The get exchange locations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="0561fcd62196f46b" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetExchangeLocations</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r4 rd" class="r4 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r4 r">context</span>);
                <b>var</b> <span id="r5 rd" class="r5 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#a716df479cf2df0c" class="i property">PeeringLocations</a>.<span class="i">List</span>(<span class="s">&quot;Exchange&quot;</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r5 r">result</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The update peer info test.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="da34bed155670f2c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UpdatePeerInfoTest</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r6 rd" class="r6 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r6 r">context</span>);
                <b>int</b> <span id="r7 rd" class="r7 r">asn</span> = 65000;
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#798133ec69cd00a4" class="i method">updatePeerAsn</a>(<span class="r7 r">asn</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#9d54ddbbbf7a55bc" class="i method">DeletePeerAsn</a>(<span class="s">$&quot;</span><span class="s">Contoso</span>{<span class="r7 r">asn</span>}<span class="s">&quot;</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create get remove peer asn.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(
            <span class="s">&quot;StyleCop.CSharp.DocumentationRules&quot;</span>,
            <span class="s">&quot;SA1650:ElementDocumentationMustBeSpelledCorrectly&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;Reviewed. Suppression is OK here.&quot;</span>)]
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="895ae19e523c0297" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateGetRemovePeerAsn</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r8 rd" class="r8 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r8 r">context</span>);
                <b>int</b> <span id="r9 rd" class="r9 r">asn</span> = 65000;
                {
                    <b>try</b>
                    {
                        <span class="c">// Create the peerAsn</span>
                        <b>var</b> <span id="r10 rd" class="r10 r">subId</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#d4c6d636a49d3ff0" class="i method">CreatePeerAsn</a>(<span class="r9 r">asn</span>, <span class="s">$&quot;</span><span class="s">AS</span>{<span class="r9 r">asn</span>}<span class="s">&quot;</span>, <span class="r11 r">isApproved</span>: <b>false</b>);
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r10 r">subId</span>);
                        <span class="c">// Get the PeerAsn</span>
                        <b>var</b> <span id="r12 rd" class="r12 r">peerAsn</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">Get</span>(<span class="s">$&quot;</span><span class="s">AS</span>{<span class="r9 r">asn</span>}<span class="s">&quot;</span>);
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r12 r">peerAsn</span>);
                    }
                    <b>catch</b>
                    {
                        <span class="c">// Should not fail unless connection issue or authentication issue.</span>
                    }
                    <b>finally</b>
                    {
                        <span class="c">// Delete the PeerAsn</span>
                        <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#9d54ddbbbf7a55bc" class="i method">DeletePeerAsn</a>(<span class="s">$&quot;</span><span class="s">AS</span>{<span class="r9 r">asn</span>}<span class="s">&quot;</span>));
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create direct peering.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="0e10a7cc8256b648" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateDirectPeering</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r13 rd" class="r13 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r13 r">context</span>);
                <span class="c">//Create a Resource Group</span>
                <b>var</b> <span id="r14 rd" class="r14 r">rgname</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;res&quot;</span>);
                <b>var</b> <span id="r15 rd" class="r15 r">resourceGroup</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#1461542a81648870" class="i property">ResourcesClient</a>.<span class="i">ResourceGroups</span>.<span class="i">CreateOrUpdate</span>(
                    <span class="r14 r">rgname</span>,
                    <b>new</b> <span class="i">ResourceGroup</span> { <span class="i">Location</span> = <span class="s">&quot;centralus&quot;</span> });
 
                <span class="c">//Create Direct Peering</span>
                <a href="/Microsoft.Azure.Management.Peering/A.html#0a8420144ba1a4c3" class="k">var</a> <span id="r16 rd" class="r16 r">directConnection</span> = <b>new</b> <span class="t">DirectConnection</span>
                {
                    <a href="/Microsoft.Azure.Management.Peering/A.html#f5376b7a52aa6d10" class="i property">ConnectionIdentifier</a> = <span class="i">Guid</span>.<span class="i">NewGuid</span>().<span class="i">ToString</span>(),
                    <a href="/Microsoft.Azure.Management.Peering/A.html#9a052e27acd354b6" class="i property">BandwidthInMbps</a> = 10000,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#b44ddab38084da9d" class="i property">PeeringDBFacilityId</a> = 99999,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#cc5e52aeeb7c6fd2" class="i property">SessionAddressProvider</a> = <a href="/Microsoft.Azure.Management.Peering/A.html#0bd781f706efe8ea" class="t t">SessionAddressProvider</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#74cd43ab89e0f618" class="i field">Peer</a>,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#717b0b095df502d0" class="i property">UseForPeeringService</a> = <b>false</b>,
                    <span class="i">BgpSession</span> = <b>new</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Peering</span>.<span class="i n">Models</span>.<span class="t">BgpSession</span>()
                    {
                        <a href="/Microsoft.Azure.Management.Peering/A.html#b8446d3eff64fefb" class="i property">SessionPrefixV4</a> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#2526f18c10753b97" class="i method">CreateIpv4Address</a>(<b>true</b>),
                        <a href="/Microsoft.Azure.Management.Peering/A.html#1d2c489cbfb7f546" class="i property">MaxPrefixesAdvertisedV4</a> = 20000
                    }
                };
 
                <span class="c">// Create Asn </span>
                <b>int</b> <span id="r17 rd" class="r17 r">asn</span> = 65003;
                <b>var</b> <span id="r18 rd" class="r18 r">subId</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#d4c6d636a49d3ff0" class="i method">CreatePeerAsn</a>(<span class="r17 r">asn</span>, <span class="s">$&quot;</span><span class="s">AS</span>{<span class="r17 r">asn</span>}<span class="s">&quot;</span>, <span class="r11 r">isApproved</span>: <b>true</b>);
 
                <a href="/Microsoft.Azure.Management.Peering/A.html#52da05620feb872d" class="t t">SubResource</a> <span id="r19 rd" class="r19 r">asnReference</span> = <b>new</b> <span class="t">SubResource</span>(<span class="r18 r">subId</span>);
                <a href="/Microsoft.Azure.Management.Peering/A.html#0cf58fe3caa9be15" class="k">var</a> <span id="r20 rd" class="r20 r">directPeeringProperties</span> = <b>new</b> <span class="t">PeeringPropertiesDirect</span>(
                    <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#0a8420144ba1a4c3" class="t t">DirectConnection</a>&gt;(),
                    <b>false</b>,
                    <span class="r19 r">asnReference</span>,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#adbd71f30bd0eeb9" class="t t">DirectPeeringType</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#030fb7efeae00b9b" class="i field">Edge</a>);
                <span class="r20 r">directPeeringProperties</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#d2d983491d3deff5" class="i property">Connections</a>.<span class="i">Add</span>(<span class="r16 r">directConnection</span>);
                <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="k">var</a> <span id="r21 rd" class="r21 r">peeringModel</span> = <b>new</b> <span class="t">PeeringModel</span>
                {
                    <a href="/Microsoft.Azure.Management.Peering/A.html#440af1faf24f98df" class="i property">PeeringLocation</a> = <span class="s">&quot;Seattle&quot;</span>,
                    <span class="i">Sku</span> = <b>new</b> <span class="t">PeeringSku</span>(<span class="s">&quot;Basic_Direct_Free&quot;</span>),
                    <span class="i">Direct</span> = <span class="r20 r">directPeeringProperties</span>,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#dca6d802d56fd34b" class="i property">Location</a> = <span class="s">&quot;centralus&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#08016f35caff891b" class="i property">Kind</a> = <span class="s">&quot;Direct&quot;</span>
                };
                <b>var</b> <span id="r22 rd" class="r22 r">name</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;direct_&quot;</span>);
                <b>try</b>
                {
                    <b>var</b> <span id="r23 rd" class="r23 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">CreateOrUpdate</span>(<span class="r14 r">rgname</span>, <span class="r22 r">name</span>, <span class="r21 r">peeringModel</span>);
                    <b>var</b> <span id="r24 rd" class="r24 r">peering</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">Get</span>(<span class="r14 r">rgname</span>, <span class="r22 r">name</span>);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r24 r">peering</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r25 rd" class="r25 r">ex</span>)
                {
                    <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;MethodNotAllowed&quot;</span>, <span class="r25 r">ex</span>.<span class="i">Message</span>);
                }
                <b>finally</b>
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">DeletePeering</span>(<span class="r22 r">name</span>, <span class="r14 r">rgname</span>));
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#9d54ddbbbf7a55bc" class="i method">DeletePeerAsn</a>(<span class="s">$&quot;</span><span class="s">AS</span>{<span class="r17 r">asn</span>}<span class="s">&quot;</span>));
 
                    <span class="c">// Assert.True(this.DeleteResourceGroup(context, rgname));</span>
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create peering service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="56cc18516aaf8b2a" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreatePeeringService</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r26 rd" class="r26 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r26 r">context</span>);
                <span class="c">// Create a Resource Group</span>
                <b>var</b> <span id="r27 rd" class="r27 r">rgname</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;res&quot;</span>);
                <b>var</b> <span id="r28 rd" class="r28 r">resourceGroup</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#1461542a81648870" class="i property">ResourcesClient</a>.<span class="i">ResourceGroups</span>.<span class="i">CreateOrUpdate</span>(
                    <span class="r27 r">rgname</span>,
                    <b>new</b> <span class="i">ResourceGroup</span> { <span class="i">Location</span> = <span class="s">&quot;centralus&quot;</span> });
 
                <span class="c">// List Locations</span>
                <b>var</b> <span id="r29 rd" class="r29 r">peeringServiceLocations</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#91b8f05950f8310c" class="i property">PeeringServiceLocations</a>.<span class="i">List</span>().<span class="i">ToList</span>();
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r29 r">peeringServiceLocations</span>);
 
                <b>var</b> <span id="r30 rd" class="r30 r">location</span> = <span class="r29 r">peeringServiceLocations</span>.<span class="i">Find</span>(<span id="r31 rd" class="r31 r">s</span> =&gt; <span class="r31 r">s</span>.<span class="i">Name</span> == <span class="s">&quot;Washington&quot;</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r30 r">location</span>);
 
                <span class="c">// List Providers</span>
                <b>var</b> <span id="r32 rd" class="r32 r">listProviders</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#42dd91732a3df958" class="i property">PeeringServiceProviders</a>.<span class="i">List</span>().<span class="i">ToList</span>();
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r32 r">listProviders</span>);
                <a href="/Microsoft.Azure.Management.Peering/A.html#eccff75bc32fb892" class="t t">PeeringServiceProvider</a> <span id="r33 rd" class="r33 r">myProvider</span> = <b>null</b>;
                <b>foreach</b> (<b>var</b> <span id="r34 rd" class="r34 r">provider</span> <b>in</b> <span class="r32 r">listProviders</span>)
                {
                    <b>var</b> <span id="r35 rd" class="r35 r">isAvailable</span> =
                        <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<span class="i">CheckServiceProviderAvailability</span>(
                            <span class="r30 r">location</span>.<span class="i">State</span>,
                            <span class="r34 r">provider</span>.<span class="i">Name</span>);
                    <b>if</b> (<span class="r35 r">isAvailable</span> == <span class="s">&quot;Available&quot;</span>)
                    {
                        <span class="r33 r">myProvider</span> = <span class="r34 r">provider</span>;
                        <b>break</b>;
                    }
                }
 
                <span class="c">// Create Peering Service</span>
                <a href="/Microsoft.Azure.Management.Peering/A.html#e9ea6d5c31f45d5f" class="k">var</a> <span id="r36 rd" class="r36 r">peeringService</span> = <b>new</b> <span class="t">PeeringService</span>
                {
                    <a href="/Microsoft.Azure.Management.Peering/A.html#e86226954ba57b64" class="i property">Location</a> = <span class="r30 r">location</span>.<span class="i">AzureRegion</span>,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#6f7fe296ec8b2e20" class="i property">PeeringServiceLocation</a> = <span class="r30 r">location</span>.<span class="i">Name</span>,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#4078e4b582280c4e" class="i property">PeeringServiceProvider</a> = <span class="r33 r">myProvider</span>?.<a href="/Microsoft.Azure.Management.Peering/A.html#117338f1ab04aa22" class="i property">Name</a>,
                };
 
                <b>var</b> <span id="r37 rd" class="r37 r">name</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;myPeeringService&quot;</span>);
                <b>var</b> <span id="r38 rd" class="r38 r">prefixName</span> = <span class="s">&quot;AS54733Prefix&quot;</span>;
 
                <b>try</b>
                {
                    <b>var</b> <span id="r39 rd" class="r39 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#7be3641db7a55d81" class="i property">PeeringServices</a>.<span class="i">CreateOrUpdate</span>(<span class="r27 r">rgname</span>, <span class="r37 r">name</span>, <span class="r36 r">peeringService</span>);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r39 r">result</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r37 r">name</span>, <span class="r39 r">result</span>.<span class="i">Name</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r40 rd" class="r40 r">ex</span>)
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">DeletePeeringService</span>(<span class="r37 r">name</span>, <span class="r27 r">rgname</span>));
                    <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;NotFound&quot;</span>, <span class="r40 r">ex</span>.<span class="i">Message</span>);
                }
 
                <b>try</b>
                {
                    <a href="/Microsoft.Azure.Management.Peering/A.html#c93ff171e58e5ff6" class="k">var</a> <span id="r41 rd" class="r41 r">prefix</span> = <b>new</b> <span class="t">PeeringServicePrefix</span>
                        {
                            <a href="/Microsoft.Azure.Management.Peering/A.html#8b649da174c5ea2d" class="i property">Prefix</a> = <span class="s">&quot;34.56.10.0/24&quot;</span>,
                            <a href="/Microsoft.Azure.Management.Peering/A.html#662620be1bff8167" class="i property">PeeringServicePrefixKey</a> = <span class="i">TestUtilities</span>.<span class="i">GenerateGuid</span>().<span class="i">ToString</span>()
                        };
 
                    <b>var</b> <span id="r42 rd" class="r42 r">peeringServicePrefix</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#2599bc1c98100d9d" class="i property">Prefixes</a>.<span class="i">CreateOrUpdate</span>(
                        <span class="r27 r">rgname</span>,
                        <span class="r37 r">name</span>,
                        <span class="r38 r">prefixName</span>,
                        <span class="r41 r">prefix</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#8b649da174c5ea2d" class="i property">Prefix</a>,
                        <span class="r41 r">prefix</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#662620be1bff8167" class="i property">PeeringServicePrefixKey</a>);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r42 r">peeringServicePrefix</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r38 r">prefixName</span>, <span class="r42 r">peeringServicePrefix</span>.<span class="i">Name</span>);
 
                    <span class="c">// var servicePrefix = this.client.PeeringServicePrefixes.Get(rgname, name, prefixName);</span>
                    <span class="c">// Assert.NotNull(servicePrefix);</span>
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r43 rd" class="r43 r">ex</span>)
                {
                    <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;BadRequest&quot;</span>, <span class="r43 r">ex</span>.<span class="i">Message</span>);
                }
                <b>finally</b>
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">DeletePeeringService</span>(<span class="r37 r">name</span>, <span class="r27 r">rgname</span>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The get old peer asn contact details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="bee2800043101d53" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetOldPeerAsnContactDetails</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r44 rd" class="r44 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r44 r">context</span>, <b>true</b>);
                <b>var</b> <span id="r45 rd" class="r45 r">peerAsns</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">ListBySubscription</span>();
                <b>foreach</b> (<b>var</b> <span id="r46 rd" class="r46 r">peerAsn</span> <b>in</b> <span class="r45 r">peerAsns</span>)
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<span class="r46 r">peerAsn</span>.<span class="i">PeerContactDetail</span>.<span class="i">Any</span>());
                }
            }
        }
        <b>private void</b> <a id="f82166e926cc64cb" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RunDftest</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r47 rd" class="r47 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r47 r">context</span>, <b>false</b>);
                <b>var</b> <span id="r48 rd" class="r48 r">asns</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">ListBySubscription</span>();
                <b>if</b> (!<span class="r48 r">asns</span>.<span class="i">FirstOrDefault</span>().<span class="i">ValidationState</span>.<span class="i">Equals</span>(
                        <span class="s">&quot;Approved&quot;</span>,
                        <span class="i">StringComparison</span>.<span class="i">InvariantCultureIgnoreCase</span>))
                {
                    <b>var</b> <span id="r49 rd" class="r49 r">subId</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">UpdatePeerValidationState</span>(<span class="r48 r">asns</span>.<span class="i">FirstOrDefault</span>(), <span class="s">&quot;Approved&quot;</span>);
                }
                <b>var</b> <span id="r50 rd" class="r50 r">peerings</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">ListBySubscription</span>();
                <b>var</b> <span id="r51 rd" class="r51 r">peering</span> = <span class="r50 r">peerings</span>.<span class="i">FirstOrDefault</span>(<span id="r52 rd" class="r52 r">x</span> =&gt; <span class="r52 r">x</span>.<span class="i">Name</span> == <span class="s">&quot;KyleTestPeering4&quot;</span>);
 
                <b>var</b> <span id="r53 rd" class="r53 r">rg</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetResourceGroup</span>(<span class="r51 r">peering</span>.<span class="i">Id</span>);
                <b>var</b> <span id="r54 rd" class="r54 r">n</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetPeeringName</span>(<span class="r51 r">peering</span>.<span class="i">Id</span>);
                <b>var</b> <span id="r55 rd" class="r55 r">prefixName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;prefix_&quot;</span>);
                <a href="/Microsoft.Azure.Management.Peering/A.html#fbf965858bc3ee6d" class="k">var</a> <span id="r56 rd" class="r56 r">prefix</span> = <b>new</b> <span class="t">PeeringRegisteredPrefix</span> { <a href="/Microsoft.Azure.Management.Peering/A.html#84950fc05eb4eab7" class="i property">Prefix</a> = <a href="#2526f18c10753b97" class="i method">CreateIpv4Address</a>(<b>true</b>) };
                <b>var</b> <span id="r57 rd" class="r57 r">resource</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#34dd2736b01b97c3" class="i property">RegisteredPrefixes</a>.<span class="i">CreateOrUpdate</span>(
                    <span class="r53 r">rg</span>,
                    <span class="r54 r">n</span>,
                    <span class="s">$&quot;</span>{<span class="r51 r">peering</span>.<span class="i">Name</span>}{<span class="r55 r">prefixName</span>}<span class="s">&quot;</span>,
                    <span class="r56 r">prefix</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#84950fc05eb4eab7" class="i property">Prefix</a>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r57 r">resource</span>.<span class="i">PeeringServicePrefixKey</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create get list and delete registered prefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="567af4b0de7eb736" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateGetListAndDeleteRegisteredPrefix</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r58 rd" class="r58 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r58 r">context</span>);
                <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="t t">PeeringModel</a> <span id="r59 rd" class="r59 r">peering</span> = <b>null</b>;
                <b>var</b> <span id="r60 rd" class="r60 r">asn</span> = <b>int</b>.<span class="i">Parse</span>(<span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;0&quot;</span>));
                <b>var</b> <span id="r61 rd" class="r61 r">prefixName</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;prefix_&quot;</span>);
                <b>try</b>
                {
                    <span class="c">// Create a Resource Group</span>
                    <b>var</b> <span id="r62 rd" class="r62 r">rgname</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#4bb9702173b594cb" class="i method">CreateResourceGroup</a>().<span class="i">Name</span>;
 
                    <span class="c">// Create Asn </span>
                    <b>var</b> <span id="r63 rd" class="r63 r">subId</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">CreatePeerAsn</span>(<span class="r60 r">asn</span>, <span class="s">$&quot;</span><span class="s">AS</span>{<span class="r60 r">asn</span>}<span class="s">&quot;</span>, <span class="i">isApproved</span>: <b>true</b>, <span class="i">peerName</span>: <span class="s">&quot;FooBar&quot;</span>);
 
                    <span class="c">// Set prefix</span>
                    <a href="/Microsoft.Azure.Management.Peering/A.html#fbf965858bc3ee6d" class="k">var</a> <span id="r64 rd" class="r64 r">prefix</span> = <b>new</b> <span class="t">PeeringRegisteredPrefix</span> { <a href="/Microsoft.Azure.Management.Peering/A.html#84950fc05eb4eab7" class="i property">Prefix</a> = <a href="#2526f18c10753b97" class="i method">CreateIpv4Address</a>(<b>true</b>) };
 
                    <a href="/Microsoft.Azure.Management.Peering/A.html#52da05620feb872d" class="t t">SubResource</a> <span id="r65 rd" class="r65 r">asnReference</span> = <b>new</b> <span class="t">SubResource</span>(<span class="r63 r">subId</span>);
                    <a href="/Microsoft.Azure.Management.Peering/A.html#0cf58fe3caa9be15" class="k">var</a> <span id="r66 rd" class="r66 r">directPeeringProperties</span> = <b>new</b> <span class="t">PeeringPropertiesDirect</span>(
                        <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#0a8420144ba1a4c3" class="t t">DirectConnection</a>&gt;(),
                        <b>true</b>,
                        <span class="r65 r">asnReference</span>,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#adbd71f30bd0eeb9" class="t t">DirectPeeringType</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#030fb7efeae00b9b" class="i field">Edge</a>);
                    <b>var</b> <span id="r67 rd" class="r67 r">locations</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#a716df479cf2df0c" class="i property">PeeringLocations</a>.<span class="i">List</span>(<span class="s">&quot;Direct&quot;</span>, <a href="/Microsoft.Azure.Management.Peering/A.html#adbd71f30bd0eeb9" class="t t">DirectPeeringType</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#030fb7efeae00b9b" class="i field">Edge</a>);
                    <b>var</b> <span id="r68 rd" class="r68 r">loc</span> = <span class="r67 r">locations</span>.<span class="i">FirstOrDefault</span>(<span id="r69 rd" class="r69 r">x</span> =&gt; <span class="r69 r">x</span>.<span class="i">Name</span> == <span class="s">&quot;Seattle&quot;</span>);
 
                    <span class="c">// Create Direct Peering</span>
                    <a href="/Microsoft.Azure.Management.Peering/A.html#0a8420144ba1a4c3" class="k">var</a> <span id="r70 rd" class="r70 r">directConnection</span> = <b>new</b> <span class="t">DirectConnection</span>
                        {
                            <a href="/Microsoft.Azure.Management.Peering/A.html#f5376b7a52aa6d10" class="i property">ConnectionIdentifier</a> = <span class="i">Guid</span>.<span class="i">NewGuid</span>().<span class="i">ToString</span>(),
                            <a href="/Microsoft.Azure.Management.Peering/A.html#9a052e27acd354b6" class="i property">BandwidthInMbps</a> = 10000,
                            <a href="/Microsoft.Azure.Management.Peering/A.html#b44ddab38084da9d" class="i property">PeeringDBFacilityId</a> =
                                <span class="r68 r">loc</span>.<span class="i">Direct</span>.<span class="i">PeeringFacilities</span>.<span class="i">FirstOrDefault</span>(<span id="r71 rd" class="r71 r">x</span> =&gt; <span class="r71 r">x</span>.<span class="i">PeeringDBFacilityId</span> == 99999)
                                    ?.<span class="i">PeeringDBFacilityId</span>,
                            <a href="/Microsoft.Azure.Management.Peering/A.html#cc5e52aeeb7c6fd2" class="i property">SessionAddressProvider</a> = <a href="/Microsoft.Azure.Management.Peering/A.html#0bd781f706efe8ea" class="t t">SessionAddressProvider</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#74cd43ab89e0f618" class="i field">Peer</a>,
                            <span class="i">BgpSession</span> = <b>new</b> <span class="t">BgpSession</span>
                                {
                                    <a href="/Microsoft.Azure.Management.Peering/A.html#b8446d3eff64fefb" class="i property">SessionPrefixV4</a> = <span class="r64 r">prefix</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#84950fc05eb4eab7" class="i property">Prefix</a>, <a href="/Microsoft.Azure.Management.Peering/A.html#1d2c489cbfb7f546" class="i property">MaxPrefixesAdvertisedV4</a> = 20000
                                },
                            <a href="/Microsoft.Azure.Management.Peering/A.html#717b0b095df502d0" class="i property">UseForPeeringService</a> = <b>true</b>
                        };
 
                    <span class="r66 r">directPeeringProperties</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#d2d983491d3deff5" class="i property">Connections</a>.<span class="i">Add</span>(<span class="r70 r">directConnection</span>);
                    <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="k">var</a> <span id="r72 rd" class="r72 r">peeringModel</span> = <b>new</b> <span class="t">PeeringModel</span>
                    {
                        <a href="/Microsoft.Azure.Management.Peering/A.html#440af1faf24f98df" class="i property">PeeringLocation</a> = <span class="r68 r">loc</span>.<span class="i">Name</span>,
                        <span class="i">Sku</span> = <b>new</b> <span class="t">PeeringSku</span>(<span class="s">&quot;Premium_Direct_Free&quot;</span>),
                        <span class="i">Direct</span> = <span class="r66 r">directPeeringProperties</span>,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#dca6d802d56fd34b" class="i property">Location</a> = <span class="r68 r">loc</span>.<span class="i">AzureRegion</span>,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#08016f35caff891b" class="i property">Kind</a> = <span class="s">&quot;Direct&quot;</span>
                    };
                    <b>var</b> <span id="r73 rd" class="r73 r">name</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;direct_&quot;</span>);
                    <b>try</b>
                    {
                        <b>var</b> <span id="r74 rd" class="r74 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">CreateOrUpdate</span>(<span class="r62 r">rgname</span>, <span class="r73 r">name</span>, <span class="r72 r">peeringModel</span>);
                        <span class="r59 r">peering</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">Get</span>(<span class="r62 r">rgname</span>, <span class="r73 r">name</span>);
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r59 r">peering</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r75 rd" class="r75 r">ex</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;NotFound&quot;</span>, <span class="r75 r">ex</span>.<span class="i">Message</span>);
                    }
 
                    <b>var</b> <span id="r76 rd" class="r76 r">resourceGroupName</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetResourceGroup</span>(<span class="r59 r">peering</span>?.<a href="/Microsoft.Azure.Management.Peering/A.html#e5990efabaa715ee" class="i property">Id</a>);
                    <b>var</b> <span id="r77 rd" class="r77 r">peeringName</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetPeeringName</span>(<span class="r59 r">peering</span>?.<a href="/Microsoft.Azure.Management.Peering/A.html#e5990efabaa715ee" class="i property">Id</a>);
                    <b>var</b> <span id="r78 rd" class="r78 r">registeredPrefixName</span> = <span class="s">$&quot;</span>{<span class="r59 r">peering</span>?.<a href="/Microsoft.Azure.Management.Peering/A.html#117338f1ab04aa22" class="i property">Name</a>}{<span class="r61 r">prefixName</span>}<span class="s">&quot;</span>;
                    
                    <b>var</b> <span id="r79 rd" class="r79 r">resource</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#34dd2736b01b97c3" class="i property">RegisteredPrefixes</a>.<span class="i">CreateOrUpdate</span>(
                        <span class="r76 r">resourceGroupName</span>,
                        <span class="r77 r">peeringName</span>,
                        <span class="r78 r">registeredPrefixName</span>,
                        <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#2526f18c10753b97" class="i method">CreateIpv4Address</a>(<b>true</b>));
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r79 r">resource</span>.<span class="i">PeeringServicePrefixKey</span>);
                    <span class="r79 r">resource</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#34dd2736b01b97c3" class="i property">RegisteredPrefixes</a>.<span class="i">Get</span>(
                        <span class="r76 r">resourceGroupName</span>,
                        <span class="r77 r">peeringName</span>,
                        <span class="r78 r">registeredPrefixName</span>);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r79 r">resource</span>.<span class="i">PeeringServicePrefixKey</span>);
                    <b>var</b> <span id="r80 rd" class="r80 r">list</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#34dd2736b01b97c3" class="i property">RegisteredPrefixes</a>.<span class="i">ListByPeering</span>(<span class="r76 r">resourceGroupName</span>, <span class="r77 r">peeringName</span>);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r80 r">list</span>.<span class="i">FirstOrDefault</span>()?.<span class="i">PeeringServicePrefixKey</span>);
                    <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#34dd2736b01b97c3" class="i property">RegisteredPrefixes</a>.<span class="i">Delete</span>(
                        <span class="r76 r">resourceGroupName</span>,
                        <span class="r77 r">peeringName</span>,
                        <span class="r78 r">registeredPrefixName</span>);
                    <b>try</b>
                    {
                        <span class="r79 r">resource</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#34dd2736b01b97c3" class="i property">RegisteredPrefixes</a>.<span class="i">Get</span>(
                            <span class="r76 r">resourceGroupName</span>,
                            <span class="r77 r">peeringName</span>,
                            <span class="r78 r">registeredPrefixName</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r81 rd" class="r81 r">ex</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r81 r">ex</span>.<span class="i">Message</span>);
                    }
                }
                <b>finally</b>
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b9fd2c4bd18d3a25" class="i method">DeletePeering</a>(<span class="r59 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#117338f1ab04aa22" class="i property">Name</a>, <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#2eafa56fff40e1da" class="i method">GetResourceGroup</a>(<span class="r59 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#e5990efabaa715ee" class="i property">Id</a>)));
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#9d54ddbbbf7a55bc" class="i method">DeletePeerAsn</a>(<span class="s">$&quot;</span><span class="s">AS</span>{<span class="r60 r">asn</span>}<span class="s">&quot;</span>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create get list and delete registered ans.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="2389b6ffe6afb8f5" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateGetListAndDeleteRegisteredAsns</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r82 rd" class="r82 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r82 r">context</span>);
 
                <span class="c">// Create a Resource Group</span>
                <b>var</b> <span id="r83 rd" class="r83 r">rgname</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#4bb9702173b594cb" class="i method">CreateResourceGroup</a>().<span class="i">Name</span>;
 
                <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="t t">PeeringModel</a> <span id="r84 rd" class="r84 r">peering</span> = <b>null</b>;
                <b>var</b> <span id="r85 rd" class="r85 r">asn</span> = <b>int</b>.<span class="i">Parse</span>(<span class="i">MockServer</span>.<span class="i">GetVariable</span>(<span class="s">&quot;asnInteger&quot;</span>, <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(1, 65000).<span class="i">ToString</span>()));
                <b>var</b> <span id="r86 rd" class="r86 r">peerAsnId</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">CreatePeerAsn</span>(<span class="r85 r">asn</span>, <span class="s">$&quot;</span><span class="s">AS</span>{<span class="r85 r">asn</span>}<span class="s">&quot;</span>, <span class="i">isApproved</span>: <b>true</b>);
                <b>var</b> <span id="r87 rd" class="r87 r">peerAsn</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">Get</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#88c5598cc6b05889" class="i method">GetPeerAsnName</a>(<span class="r86 r">peerAsnId</span>));
                <b>try</b>
                {
                    <a href="/Microsoft.Azure.Management.Peering/A.html#0cf58fe3caa9be15" class="k">var</a> <span id="r88 rd" class="r88 r">directPeeringProperties</span> = <b>new</b> <span class="t">PeeringPropertiesDirect</span>(
                                <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#0a8420144ba1a4c3" class="t t">DirectConnection</a>&gt;(),
                                <b>true</b>,
                                <b>new</b> <span class="t">SubResource</span>(<span class="r86 r">peerAsnId</span>),
                                <a href="/Microsoft.Azure.Management.Peering/A.html#adbd71f30bd0eeb9" class="t t">DirectPeeringType</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#dc70e77f9a393510" class="i field">IxRs</a>);
                    <b>var</b> <span id="r89 rd" class="r89 r">locations</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#a716df479cf2df0c" class="i property">PeeringLocations</a>.<span class="i">List</span>(<span class="s">&quot;Direct&quot;</span>, <a href="/Microsoft.Azure.Management.Peering/A.html#adbd71f30bd0eeb9" class="t t">DirectPeeringType</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#030fb7efeae00b9b" class="i field">Edge</a>);
                    <b>var</b> <span id="r90 rd" class="r90 r">loc</span> = <span class="r89 r">locations</span>.<span class="i">FirstOrDefault</span>(<span id="r91 rd" class="r91 r">x</span> =&gt; <span class="r91 r">x</span>.<span class="i">Name</span> == <span class="s">&quot;Seattle&quot;</span>);
 
                    <span class="c">// Create Direct Peering</span>
                    <a href="/Microsoft.Azure.Management.Peering/A.html#0a8420144ba1a4c3" class="k">var</a> <span id="r92 rd" class="r92 r">directConnection</span> = <b>new</b> <span class="t">DirectConnection</span>
                    {
                        <a href="/Microsoft.Azure.Management.Peering/A.html#f5376b7a52aa6d10" class="i property">ConnectionIdentifier</a> = <span class="i">Guid</span>.<span class="i">NewGuid</span>().<span class="i">ToString</span>(),
                        <a href="/Microsoft.Azure.Management.Peering/A.html#9a052e27acd354b6" class="i property">BandwidthInMbps</a> = 10000,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#b44ddab38084da9d" class="i property">PeeringDBFacilityId</a> =
                                                       <span class="r90 r">loc</span>.<span class="i">Direct</span>.<span class="i">PeeringFacilities</span>
                                                           .<span class="i">FirstOrDefault</span>(<span id="r93 rd" class="r93 r">x</span> =&gt; <span class="r93 r">x</span>.<span class="i">PeeringDBFacilityId</span> == 99999)
                                                           ?.<span class="i">PeeringDBFacilityId</span>,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#cc5e52aeeb7c6fd2" class="i property">SessionAddressProvider</a> = <a href="/Microsoft.Azure.Management.Peering/A.html#0bd781f706efe8ea" class="t t">SessionAddressProvider</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#6d0ba27e7255eed6" class="i field">Microsoft</a>,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#717b0b095df502d0" class="i property">UseForPeeringService</a> = <b>true</b>
                    };
                    <span class="r88 r">directPeeringProperties</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#d2d983491d3deff5" class="i property">Connections</a>.<span class="i">Add</span>(<span class="r92 r">directConnection</span>);
                    <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="k">var</a> <span id="r94 rd" class="r94 r">peeringModel</span> = <b>new</b> <span class="t">PeeringModel</span>
                    {
                        <a href="/Microsoft.Azure.Management.Peering/A.html#440af1faf24f98df" class="i property">PeeringLocation</a> = <span class="r90 r">loc</span>.<span class="i">Name</span>,
                        <span class="i">Sku</span> = <b>new</b> <span class="t">PeeringSku</span>(<span class="s">&quot;Premium_Direct_Free&quot;</span>),
                        <span class="i">Direct</span> = <span class="r88 r">directPeeringProperties</span>,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#dca6d802d56fd34b" class="i property">Location</a> = <span class="r90 r">loc</span>.<span class="i">AzureRegion</span>,
                        <a href="/Microsoft.Azure.Management.Peering/A.html#08016f35caff891b" class="i property">Kind</a> = <span class="s">&quot;Direct&quot;</span>
                    };
                    <b>var</b> <span id="r95 rd" class="r95 r">name</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;direct_&quot;</span>);
                    <b>try</b>
                    {
                        <b>var</b> <span id="r96 rd" class="r96 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">CreateOrUpdate</span>(<span class="r83 r">rgname</span>, <span class="r95 r">name</span>, <span class="r94 r">peeringModel</span>);
                        <span class="r84 r">peering</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">Get</span>(<span class="r83 r">rgname</span>, <span class="r95 r">name</span>);
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r84 r">peering</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r97 rd" class="r97 r">ex</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;NotFound&quot;</span>, <span class="r97 r">ex</span>.<span class="i">Message</span>);
                }
                    <b>var</b> <span id="r98 rd" class="r98 r">rgName</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#2eafa56fff40e1da" class="i method">GetResourceGroup</a>(<span class="r84 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#e5990efabaa715ee" class="i property">Id</a>);
                    <b>var</b> <span id="r99 rd" class="r99 r">pName</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b8eae33e1bd549ac" class="i method">GetPeeringName</a>(<span class="r84 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#e5990efabaa715ee" class="i property">Id</a>);
                    <b>var</b> <span id="r100 rd" class="r100 r">registeredAsnName</span> = <span class="s">$&quot;</span>{<span class="r84 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#117338f1ab04aa22" class="i property">Name</a>}<span class="s">_</span>{<span class="r87 r">peerAsn</span>.<span class="i">PeerAsnProperty</span>}<span class="s">&quot;</span>;
                    <b>var</b> <span id="r101 rd" class="r101 r">resource</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#81740cd877edb9ac" class="i property">RegisteredAsns</a>.<span class="i">CreateOrUpdate</span>(
                        <span class="r98 r">rgName</span>,
                        <span class="r99 r">pName</span>,
                        <span class="r100 r">registeredAsnName</span>,
                        <span class="r87 r">peerAsn</span>.<span class="i">PeerAsnProperty</span>);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">resource</span>);
                    <b>try</b>
                    {
                        <span class="r101 r">resource</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#81740cd877edb9ac" class="i property">RegisteredAsns</a>.<span class="i">Get</span>(<span class="r98 r">rgName</span>, <span class="r99 r">pName</span>, <span class="r100 r">registeredAsnName</span>);
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">resource</span>);
                        <b>var</b> <span id="r102 rd" class="r102 r">list</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#81740cd877edb9ac" class="i property">RegisteredAsns</a>.<span class="i">ListByPeering</span>(<span class="r83 r">rgname</span>, <span class="r99 r">pName</span>);
                        <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r102 r">list</span>);
                        <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#81740cd877edb9ac" class="i property">RegisteredAsns</a>.<span class="i">Delete</span>(
                            <span class="r98 r">rgName</span>,
                            <span class="r99 r">pName</span>,
                            <span class="r100 r">registeredAsnName</span>);
                        <span class="r101 r">resource</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#81740cd877edb9ac" class="i property">RegisteredAsns</a>.<span class="i">Get</span>(
                            <span class="r98 r">rgName</span>,
                            <span class="r99 r">pName</span>,
                            <span class="r100 r">registeredAsnName</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r103 rd" class="r103 r">ex</span>)
                    {
                        <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;NotFound&quot;</span>, <span class="r103 r">ex</span>.<span class="i">Message</span>);
                    }
                }
                <b>finally</b>
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b9fd2c4bd18d3a25" class="i method">DeletePeering</a>(<span class="r84 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#117338f1ab04aa22" class="i property">Name</a>, <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#2eafa56fff40e1da" class="i method">GetResourceGroup</a>(<span class="r84 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#e5990efabaa715ee" class="i property">Id</a>)));
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#9d54ddbbbf7a55bc" class="i method">DeletePeerAsn</a>(<span class="s">$&quot;</span><span class="s">AS</span>{<span class="r85 r">asn</span>}<span class="s">&quot;</span>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create exchange peering.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Fact</span>]
        <b>public void</b> <a id="9d5a87ca706c00fe" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateExchangePeering</a>()
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r104 rd" class="r104 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b6cc22910eca16d2" class="i method">MockClients</a>(<span class="r104 r">context</span>);
                <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="t t">PeeringModel</a> <span id="r105 rd" class="r105 r">peering</span> = <b>null</b>;
                <b>var</b> <span id="r106 rd" class="r106 r">asn</span> = <b>int</b>.<span class="i">Parse</span>(<span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;0&quot;</span>));
                <b>try</b>
                {
                    <span class="r105 r">peering</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">CreateExchangePeeringModel</span>(<span class="r106 r">asn</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r107 rd" class="r107 r">ex</span>)
                {
                    <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;NotFound&quot;</span>, <span class="r107 r">ex</span>.<span class="i">Message</span>);
                }
                <b>finally</b>
                {
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#b9fd2c4bd18d3a25" class="i method">DeletePeering</a>(<span class="r105 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#117338f1ab04aa22" class="i property">Name</a>, <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#2eafa56fff40e1da" class="i method">GetResourceGroup</a>(<span class="r105 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#e5990efabaa715ee" class="i property">Id</a>)));
                    <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#9d54ddbbbf7a55bc" class="i method">DeletePeerAsn</a>(<span class="s">$&quot;</span><span class="s">AS</span>{<span class="r106 r">asn</span>}<span class="s">&quot;</span>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The setup.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">recordMockResults</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The is record.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c3cb29bd63a1f672" href="R/c3cb29bd63a1f672.html" target="n" data-glyph="74,1" class="i method">Setup</a>(<b>bool</b> <span id="r108 rd" class="r108 r">recordMockResults</span> = <b>false</b>)
        {
            <b>var</b> <span id="r109 rd" class="r109 r">mode</span> = <span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;AZURE_TEST_MODE&quot;</span>);
 
            <b>var</b> <span id="r110 rd" class="r110 r">connectionstring</span> = <span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;TEST_CSM_ORGID_AUTHENTICATION&quot;</span>);
 
            <b>if</b> (<span class="r109 r">mode</span> == <b>null</b>)
            {
                <span class="i">Environment</span>.<span class="i">SetEnvironmentVariable</span>(<span class="s">&quot;AZURE_TEST_MODE&quot;</span>, <span class="r108 r">recordMockResults</span> ? <span class="s">&quot;Record&quot;</span> : <span class="s">&quot;Playback&quot;</span>);
            }
 
            <b>if</b> (<span class="r110 r">connectionstring</span> == <b>null</b> &amp;&amp; <span class="r108 r">recordMockResults</span>)
            {
                <b>var</b> <span id="r111 rd" class="r111 r">path</span> = <span class="i">Environment</span>.<span class="i">GetFolderPath</span>(
                    <span class="i">Environment</span>.<span class="i">SpecialFolder</span>.<span class="i">MyDocuments</span>,
                    <span class="i">Environment</span>.<span class="i">SpecialFolderOption</span>.<span class="i">None</span>);
                <b>if</b> (<span class="r111 r">path</span> != <b>string</b>.<span class="i">Empty</span>)
                {
                    <span class="c">// See the team notes under ibiza SDK update or search connectionString.txt</span>
                    <span class="r111 r">path</span> += <span class="s">@&quot;\..\.azure\connectionString.txt&quot;</span>;
                    <b>string</b> <span id="r112 rd" class="r112 r">connection</span> = <span class="i">File</span>.<span class="i">ReadAllText</span>(<span class="r111 r">path</span>);
                    <span class="i">Environment</span>.<span class="i">SetEnvironmentVariable</span>(<span class="s">&quot;TEST_CSM_ORGID_AUTHENTICATION&quot;</span>, <span class="r112 r">connection</span>);
                }
            }
 
            <b>var</b> <span id="r113 rd" class="r113 r">subscriptionId</span> = <span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;TEST_CSM_ORGID_AUTHENTICATION&quot;</span>)?.<span class="i">Split</span>(<span class="s">&quot;;&quot;</span>)[0]
                .<span class="i">Split</span>(<span class="s">&quot;=&quot;</span>)[1];
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r113 r">subscriptionId</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#44da1e972ac34e30" class="i property">SubscriptionId</a> = <span class="r113 r">subscriptionId</span>;
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">MockRegisterSubscription</span>(<span class="r113 r">subscriptionId</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The mock register subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">subscriptionId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscription id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="1c0b31a48e3c5b68" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">MockRegisterSubscription</a>(<b>string</b> <span id="r114 rd" class="r114 r">subscriptionId</span>)
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r115 rd" class="r115 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#ffbf67bade099bcf" class="i method">RegisterSubscription</a>(<span class="r114 r">subscriptionId</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The mock clients.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">isLocal</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The is Local.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b6cc22910eca16d2" href="R/b6cc22910eca16d2.html" target="n" data-glyph="74,1" class="i method">MockClients</a>(<span class="i">MockContext</span> <span id="r116 rd" class="r116 r">context</span>, <b>bool</b> <span id="r117 rd" class="r117 r">isLocal</span> = <b>true</b>)
        {
            <b>if</b> (<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a> == <b>null</b>)
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a> = <span class="r116 r">context</span>.<span class="i">GetServiceClient</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#aa26d3bfb78c17ee" class="t t">PeeringManagementClient</a>&gt;();
                <b>if</b> (<span class="r117 r">isLocal</span>)
                {
                    <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#0b9957a90a189745" class="i property">BaseUri</a> = <a href="#d0242f5bd781c3bc" class="i field">LocalEdgeRpUri</a>;
                }
            }
 
            <b>if</b> (<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#1461542a81648870" class="i property">ResourcesClient</a> == <b>null</b>)
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#1461542a81648870" class="i property">ResourcesClient</a> = <span class="r116 r">context</span>.<span class="i">GetServiceClient</span>&lt;<span class="i">ResourceManagementClient</span>&gt;();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create resource group.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">isLocal</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The is Local.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ResourceGroup</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">ResourceGroup</span> <a id="4bb9702173b594cb" href="R/4bb9702173b594cb.html" target="n" data-glyph="76,1" class="i method">CreateResourceGroup</a>(<b>bool</b> <span id="r118 rd" class="r118 r">isLocal</span> = <b>true</b>)
        {
            <b>var</b> <span id="r119 rd" class="r119 r">rgname</span> = <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;res&quot;</span>);
 
            <b>if</b> (<span class="r118 r">isLocal</span>)
            {
                <b>return</b> <b>new</b> <span class="i">ResourceGroup</span>(<span class="s">&quot;centralus&quot;</span>, <b>null</b>, <span class="r119 r">rgname</span>);
            }
 
            <b>var</b> <span id="r120 rd" class="r120 r">resourceGroup</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#1461542a81648870" class="i property">ResourcesClient</a>.<span class="i">ResourceGroups</span>.<span class="i">CreateOrUpdate</span>(
                <span class="r119 r">rgname</span>,
                <b>new</b> <span class="i">ResourceGroup</span> { <span class="i">Location</span> = <span class="s">&quot;centralus&quot;</span> });
            <b>return</b> <span class="r120 r">resourceGroup</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The create exchange peering.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">asn</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asn.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="t t">PeeringModel</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="t t">PeeringModel</a> <a id="b38882fbc8551c60" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CreateExchangePeeringModel</a>(<b>int</b> <span id="r121 rd" class="r121 r">asn</span> = 65000)
        {
            <span class="c">// create resource group</span>
            <b>var</b> <span id="r122 rd" class="r122 r">resourceGroup</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#4bb9702173b594cb" class="i method">CreateResourceGroup</a>();
 
            <span class="c">// Create Asn</span>
            <b>var</b> <span id="r123 rd" class="r123 r">subId</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#d4c6d636a49d3ff0" class="i method">CreatePeerAsn</a>(<span class="r121 r">asn</span>, <span class="s">$&quot;</span><span class="s">AS</span>{<span class="r121 r">asn</span>}<span class="s">&quot;</span>, <span class="r11 r">isApproved</span>: <b>true</b>);
 
            <span class="c">// Create Exchange Peering</span>
            <b>var</b> <span id="r124 rd" class="r124 r">ipAddress</span> = <b>int</b>.<span class="i">Parse</span>(<span class="i">MockServer</span>.<span class="i">GetVariable</span>(<span class="s">&quot;ipAddress&quot;</span>, <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(150, 190).<span class="i">ToString</span>()));
            <a href="/Microsoft.Azure.Management.Peering/A.html#d3b354a4268abe33" class="k">var</a> <span id="r125 rd" class="r125 r">exchangeConnection</span> = <b>new</b> <span class="t">ExchangeConnection</span>
            {
                <a href="/Microsoft.Azure.Management.Peering/A.html#dc1f760591e0e766" class="i property">ConnectionIdentifier</a> = <span class="i">Guid</span>.<span class="i">NewGuid</span>().<span class="i">ToString</span>(),
                <a href="/Microsoft.Azure.Management.Peering/A.html#c33fbc74cab507f5" class="i property">PeeringDBFacilityId</a> = 99999,
                <span class="i">BgpSession</span> = <b>new</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">Peering</span>.<span class="i n">Models</span>.<span class="t">BgpSession</span>()
                {
                    <a href="/Microsoft.Azure.Management.Peering/A.html#bdbad9d2833ff7ac" class="i property">PeerSessionIPv4Address</a> = <span class="s">$&quot;</span><span class="s">10.12.97.</span>{<span class="r124 r">ipAddress</span>}<span class="s">&quot;</span>,
                    <a href="/Microsoft.Azure.Management.Peering/A.html#1d2c489cbfb7f546" class="i property">MaxPrefixesAdvertisedV4</a> = 20000
                }
            };
            <a href="/Microsoft.Azure.Management.Peering/A.html#52da05620feb872d" class="t t">SubResource</a> <span id="r126 rd" class="r126 r">asnReference</span> = <b>new</b> <span class="t">SubResource</span>(<span class="r123 r">subId</span>);
            <a href="/Microsoft.Azure.Management.Peering/A.html#34159f4218caa0a6" class="k">var</a> <span id="r127 rd" class="r127 r">exchangePeeringProperties</span> = <b>new</b> <span class="t">PeeringPropertiesExchange</span>(
                <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#d3b354a4268abe33" class="t t">ExchangeConnection</a>&gt;(),
                <span class="r126 r">asnReference</span>);
            <span class="r127 r">exchangePeeringProperties</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#da6678340c4ac29b" class="i property">Connections</a>.<span class="i">Add</span>(<span class="r125 r">exchangeConnection</span>);
            <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="k">var</a> <span id="r128 rd" class="r128 r">peeringModel</span> = <b>new</b> <span class="t">PeeringModel</span>
            {
                <a href="/Microsoft.Azure.Management.Peering/A.html#440af1faf24f98df" class="i property">PeeringLocation</a> = <span class="s">&quot;Seattle&quot;</span>,
                <span class="i">Sku</span> = <b>new</b> <span class="t">PeeringSku</span>(<span class="s">&quot;Basic_Exchange_Free&quot;</span>),
                <a href="/Microsoft.Azure.Management.Peering/A.html#dca6d802d56fd34b" class="i property">Location</a> = <span class="s">&quot;centralus&quot;</span>,
                <span class="i">Exchange</span> = <span class="r127 r">exchangePeeringProperties</span>,
                <a href="/Microsoft.Azure.Management.Peering/A.html#08016f35caff891b" class="i property">Kind</a> = <span class="s">&quot;Exchange&quot;</span>,
                <a href="/Microsoft.Azure.Management.Peering/A.html#321b98e4b447310a" class="i property">Tags</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;
                                                      {
                                                          { <span class="i">TestUtilities</span>.<span class="i">GenerateName</span>(<span class="s">&quot;tfs_&quot;</span>), <span class="s">&quot;Active&quot;</span> }
                                                      }
            };
            <b>var</b> <span id="r129 rd" class="r129 r">name</span> = <span class="s">$&quot;</span><span class="s">exchangepeering</span>{<span class="r121 r">asn</span>}<span class="s">&quot;</span>;
            <b>try</b>
            {
                <b>var</b> <span id="r130 rd" class="r130 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">CreateOrUpdate</span>(<span class="r122 r">resourceGroup</span>.<span class="i">Name</span>, <span class="r129 r">name</span>, <span class="r128 r">peeringModel</span>);
                <b>var</b> <span id="r131 rd" class="r131 r">peering</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">Get</span>(<span class="r122 r">resourceGroup</span>.<span class="i">Name</span>, <span class="r129 r">name</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r131 r">peering</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r129 r">name</span>, <span class="r131 r">peering</span>.<span class="i">Name</span>);
                <b>return</b> <span class="r131 r">peering</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r132 rd" class="r132 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Contains</span>(<span class="s">&quot;NotFound&quot;</span>, <span class="r132 r">ex</span>.<span class="i">Message</span>);
            }
            <b>return</b> <b>null</b>;
        }
 
        <b>private string</b> <a id="2526f18c10753b97" href="R/2526f18c10753b97.html" target="n" data-glyph="76,1" class="i method">CreateIpv4Address</a>(<b>bool</b> <span id="r133 rd" class="r133 r">useMaxSubNet</span> = <b>true</b>)
        {
            <b>return</b> <span class="r133 r">useMaxSubNet</span>
                ? <span class="s">$&quot;</span>{<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(1, 255)}<span class="s">.</span>{<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(0, 255)}<span class="s">.</span>{<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(0, 255)}<span class="s">.0/30</span><span class="s">&quot;</span>
                : <span class="s">$&quot;</span>{<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(1, 255)}<span class="s">.</span>{<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(0, 255)}<span class="s">.</span>{<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#72d929bb4a27eb07" class="i field">random</a>.<span class="i">Next</span>(0, 255)}<span class="s">.0/31</span><span class="s">&quot;</span>;
        }
 
        <b>private void</b> <a id="798133ec69cd00a4" href="R/798133ec69cd00a4.html" target="n" data-glyph="76,1" class="i method">updatePeerAsn</a>(<b>int</b> <span id="r134 rd" class="r134 r">asn</span>)
        {
            <b>string</b> <span id="r135 rd" class="r135 r">phone</span> = <span class="s">&quot;9999999&quot;</span>;
            <b>string</b> <span id="r136 rd" class="r136 r">email</span> = <span class="s">$&quot;</span><span class="s">noc</span>{<span class="r134 r">asn</span>}<span class="s">@contoso.com</span><span class="s">&quot;</span>;
            <a href="/Microsoft.Azure.Management.Peering/A.html#1b795c8e92deb683" class="k">var</a> <span id="r137 rd" class="r137 r">contactInfo</span> = <b>new</b> <span class="t">ContactDetail</span>(<a href="/Microsoft.Azure.Management.Peering/A.html#c558ffa2d7292440" class="t t">Role</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#393b132e82677179" class="i field">Noc</a>, <span class="r136 r">email</span>, <span class="r135 r">phone</span>);
            <a href="/Microsoft.Azure.Management.Peering/A.html#2704afa52c35ac53" class="k">var</a> <span id="r138 rd" class="r138 r">peerInfo</span> = <b>new</b> <span class="t">PeerAsn</span>(<span class="i">peerAsnProperty</span>: <span class="r134 r">asn</span>, <span class="i">peerContactDetail</span>: <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#1b795c8e92deb683" class="t t">ContactDetail</a>&gt; { <span class="r137 r">contactInfo</span> }, <span class="i">peerName</span>: <span class="s">$&quot;</span><span class="s">Contoso</span>{<span class="r134 r">asn</span>}<span class="s">&quot;</span>, <span class="i">validationState</span>: <span class="s">&quot;Approved&quot;</span>);
 
            <b>try</b>
            {
                <b>var</b> <span id="r139 rd" class="r139 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">CreateOrUpdate</span>(<span class="r138 r">peerInfo</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#0dc9168455676048" class="i property">PeerName</a>, <span class="r138 r">peerInfo</span>);
                <b>var</b> <span id="r140 rd" class="r140 r">peerAsn</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">Get</span>(<span class="r138 r">peerInfo</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#0dc9168455676048" class="i property">PeerName</a>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">peerAsn</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r141 rd" class="r141 r">exception</span>)
            {
                <b>var</b> <span id="r142 rd" class="r142 r">peerAsn</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">ListBySubscription</span>();
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r142 r">peerAsn</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r141 r">exception</span>);
            }
        }
 
        <b>private string</b> <a id="d4c6d636a49d3ff0" href="R/d4c6d636a49d3ff0.html" target="n" data-glyph="76,1" class="i method">CreatePeerAsn</a>(<b>int</b> <span id="r143 rd" class="r143 r">asn</span> = 99999, <b>string</b> <span id="r144 rd" class="r144 r">name</span> = <span class="s">&quot;AS99999&quot;</span>, <b>string</b> <span id="r145 rd" class="r145 r">peerName</span> = <span class="s">&quot;Contoso&quot;</span>, <b>bool</b> <span id="r11 rd" class="r11 r">isApproved</span> = <b>false</b>)
        {
            <a href="/Microsoft.Azure.Management.Peering/A.html#2704afa52c35ac53" class="k">var</a> <span id="r146 rd" class="r146 r">peerAsn</span> = <b>new</b> <span class="t">PeerAsn</span>(<span class="r144 r">name</span>)
            {
                <a href="/Microsoft.Azure.Management.Peering/A.html#0dc9168455676048" class="i property">PeerName</a> = <span class="r145 r">peerName</span>,
                <a href="/Microsoft.Azure.Management.Peering/A.html#46bed27b195c85ec" class="i property">PeerAsnProperty</a> = <span class="r143 r">asn</span>,
                <a href="/Microsoft.Azure.Management.Peering/A.html#ff20494aa6b7c8dd" class="i property">PeerContactDetail</a> = <b>new</b> <span class="i">List</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#1b795c8e92deb683" class="t t">ContactDetail</a>&gt;
 
                {
                    <b>new</b> <span class="t">ContactDetail</span>
                        {
                            <a href="/Microsoft.Azure.Management.Peering/A.html#12438a383e56fd2b" class="i property">Role</a> = <a href="/Microsoft.Azure.Management.Peering/A.html#c558ffa2d7292440" class="t t">Role</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#393b132e82677179" class="i field">Noc</a>,
                            <a href="/Microsoft.Azure.Management.Peering/A.html#8592771832aef309" class="i property">Email</a> = <span class="s">$&quot;</span><span class="s">noc</span>{<span class="r143 r">asn</span>}<span class="s">@contoso.com</span><span class="s">&quot;</span>,
                            <a href="/Microsoft.Azure.Management.Peering/A.html#5667955974077244" class="i property">Phone</a> = <span class="s">&quot;8888988888&quot;</span>
                        }
                },
                <a href="/Microsoft.Azure.Management.Peering/A.html#a7d28deab6fe16a8" class="i property">ValidationState</a> = <span class="r11 r">isApproved</span> ? <a href="/Microsoft.Azure.Management.Peering/A.html#0226c455ecabb0ca" class="t t">ValidationState</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#d10c6780f2b34e2f" class="i field">Approved</a> : <a href="/Microsoft.Azure.Management.Peering/A.html#0226c455ecabb0ca" class="t t">ValidationState</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d86156f7af75639" class="i field">Pending</a>
            };
 
            <b>try</b>
            {
                <span class="r144 r">name</span> = <span class="s">$&quot;</span><span class="s">AS</span>{<span class="r143 r">asn</span>}<span class="s">&quot;</span>;
                <b>var</b> <span id="r147 rd" class="r147 r">result</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">CreateOrUpdate</span>(<span class="r144 r">name</span>, <span class="r146 r">peerAsn</span>);
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">UpdatePeerValidationState</span>(<span class="r147 r">result</span>, <a href="/Microsoft.Azure.Management.Peering/A.html#0226c455ecabb0ca" class="t t">ValidationState</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#d10c6780f2b34e2f" class="i field">Approved</a>);
                <b>var</b> <span id="r148 rd" class="r148 r">resultPeerAsn</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">Get</span>(<span class="r144 r">name</span>);
                <b>if</b> (<span class="r11 r">isApproved</span>)
                {
                    <span class="i">Thread</span>.<span class="i">Sleep</span>(100);
                    <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r148 r">resultPeerAsn</span>);
                    <span class="i">Assert</span>.<span class="i">Equal</span>(<a href="/Microsoft.Azure.Management.Peering/A.html#0226c455ecabb0ca" class="t t">ValidationState</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#d10c6780f2b34e2f" class="i field">Approved</a>, <span class="r148 r">resultPeerAsn</span>.<span class="i">ValidationState</span>);
                }
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r148 r">resultPeerAsn</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r144 r">name</span>, <span class="r148 r">resultPeerAsn</span>.<span class="i">Name</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r143 r">asn</span>, <span class="r148 r">resultPeerAsn</span>.<span class="i">PeerAsnProperty</span>);
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="r145 r">peerName</span>, <span class="r148 r">resultPeerAsn</span>.<span class="i">PeerName</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r148 r">resultPeerAsn</span>.<span class="i">Id</span>);
                <b>return</b> <span class="r148 r">resultPeerAsn</span>.<span class="i">Id</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r149 rd" class="r149 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Equal</span>(<span class="s">&quot;NotFound&quot;</span>, <span class="r149 r">ex</span>.<span class="i">Message</span>);
            }
 
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The delete peering.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">resourceGroupName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource group name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>bool</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="b9fd2c4bd18d3a25" href="R/b9fd2c4bd18d3a25.html" target="n" data-glyph="76,1" class="i method">DeletePeering</a>(<b>string</b> <span id="r150 rd" class="r150 r">name</span>, <b>string</b> <span id="r151 rd" class="r151 r">resourceGroupName</span>)
        {
 
            <a href="/Microsoft.Azure.Management.Peering/A.html#54bae3b0fa9f74b1" class="t t">PeeringModel</a> <span id="r152 rd" class="r152 r">peering</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">Delete</span>(<span class="r151 r">resourceGroupName</span>, <span class="r150 r">name</span>);
                <span class="r152 r">peering</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b5f493cbb606acae" class="i property">Peerings</a>.<span class="i">Get</span>(<span class="r151 r">resourceGroupName</span>, <span class="r150 r">name</span>);
                <b>if</b> (<span class="r152 r">peering</span> == <b>null</b> || <span class="r152 r">peering</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#054a44160d29558f" class="i property">ProvisioningState</a> == <span class="s">&quot;Deleting&quot;</span>)
                {
                    <b>return</b> <b>true</b>;
                }
 
                <b>return</b> <b>false</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r153 rd" class="r153 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r152 r">peering</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r153 r">ex</span>.<span class="i">Message</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#64d48f7f28072c80" class="i method">DeleteResourceGroup</a>(<span class="r151 r">resourceGroupName</span>));
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The delete resource group.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">resourceGroupName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource group name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>bool</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="64d48f7f28072c80" href="R/64d48f7f28072c80.html" target="n" data-glyph="76,1" class="i method">DeleteResourceGroup</a>(<b>string</b> <span id="r154 rd" class="r154 r">resourceGroupName</span>, <b>bool</b> <span id="r155 rd" class="r155 r">isLocal</span> = <b>true</b>)
        {
            <span class="i">ResourceGroup</span> <span id="r156 rd" class="r156 r">resourceGroup</span> = <b>null</b>;
            <b>try</b>
            {
                <b>if</b> (<span class="r155 r">isLocal</span>)
                {
                    <b>return</b> <b>true</b>;
                }
 
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#1461542a81648870" class="i property">ResourcesClient</a>.<span class="i">ResourceGroups</span>.<span class="i">Delete</span>(<span class="r154 r">resourceGroupName</span>);
                <span class="r156 r">resourceGroup</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#1461542a81648870" class="i property">ResourcesClient</a>.<span class="i">ResourceGroups</span>.<span class="i">Get</span>(<span class="r154 r">resourceGroupName</span>);
                <b>if</b> (<span class="r156 r">resourceGroup</span> == <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
                <b>else</b>
                {
                    <b>return</b> <b>false</b>;
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r157 rd" class="r157 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r156 r">resourceGroup</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r157 r">ex</span>.<span class="i">Message</span>);
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The delete prefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r158 r">prefixName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The prefix name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r159 r">peeringServiceName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The peering service name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r160 r">resourceGroupName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource group name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>bool</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="a05dff00a824b788" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">DeletePrefix</a>(<b>string</b> <span id="r158 rd" class="r158 r">prefixName</span>, <b>string</b> <span id="r159 rd" class="r159 r">peeringServiceName</span>, <b>string</b> <span id="r160 rd" class="r160 r">resourceGroupName</span>)
        {
 
            <a href="/Microsoft.Azure.Management.Peering/A.html#c93ff171e58e5ff6" class="t t">PeeringServicePrefix</a> <span id="r161 rd" class="r161 r">service</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#2599bc1c98100d9d" class="i property">Prefixes</a>.<span class="i">Delete</span>(<span class="r160 r">resourceGroupName</span>, <span class="r159 r">peeringServiceName</span>, <span class="r158 r">prefixName</span>);
                <span class="r161 r">service</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#2599bc1c98100d9d" class="i property">Prefixes</a>.<span class="i">Get</span>(<span class="r160 r">resourceGroupName</span>, <span class="r159 r">peeringServiceName</span>, <span class="r158 r">prefixName</span>);
                <b>if</b> (<span class="r161 r">service</span> == <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
                <b>return</b> <b>false</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r162 rd" class="r162 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r161 r">service</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r162 r">ex</span>.<span class="i">Message</span>);
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The delete peering service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r163 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r164 r">resourceGroupName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource group name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>bool</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="39259afb63bcb1cd" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">DeletePeeringService</a>(<b>string</b> <span id="r163 rd" class="r163 r">name</span>, <b>string</b> <span id="r164 rd" class="r164 r">resourceGroupName</span>)
        {
 
            <a href="/Microsoft.Azure.Management.Peering/A.html#e9ea6d5c31f45d5f" class="t t">PeeringService</a> <span id="r165 rd" class="r165 r">service</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#7be3641db7a55d81" class="i property">PeeringServices</a>.<span class="i">Delete</span>(<span class="r164 r">resourceGroupName</span>, <span class="r163 r">name</span>);
                <span class="c">//service = this.client.PeeringServices.Get(resourceGroupName, name);</span>
                <b>return</b> <span class="r165 r">service</span> == <b>null</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r166 rd" class="r166 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r165 r">service</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r166 r">ex</span>.<span class="i">Message</span>);
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The delete peer asn.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r167 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>bool</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;StyleCop.CSharp.DocumentationRules&quot;</span>, <span class="s">&quot;SA1650:ElementDocumentationMustBeSpelledCorrectly&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Reviewed. Suppression is OK here.&quot;</span>)]
        <b>private bool</b> <a id="9d54ddbbbf7a55bc" href="R/9d54ddbbbf7a55bc.html" target="n" data-glyph="76,1" class="i method">DeletePeerAsn</a>(<b>string</b> <span id="r167 rd" class="r167 r">name</span>)
        {
 
            <a href="/Microsoft.Azure.Management.Peering/A.html#2704afa52c35ac53" class="t t">PeerAsn</a> <span id="r168 rd" class="r168 r">peerAsn</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">Delete</span>(<span class="r167 r">name</span>);
                <span class="r168 r">peerAsn</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#1d9aa2b7fbcb3452" class="i property">PeerAsns</a>.<span class="i">Get</span>(<span class="r167 r">name</span>);
                <b>return</b> <span class="r168 r">peerAsn</span> == <b>null</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r169 rd" class="r169 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r168 r">peerAsn</span>);
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r169 r">ex</span>.<span class="i">Message</span>);
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The get client certificate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">X509Certificate2</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">X509Certificate2</span> <a id="e2da34efe3195765" href="R/e2da34efe3195765.html" target="n" data-glyph="76,1" class="i method">GetClientCertificate</a>()
        {
            <b>var</b> <span id="r170 rd" class="r170 r">store</span> = <b>new</b> <span class="i">X509Store</span>(<span class="i">StoreName</span>.<span class="i">My</span>, <span class="i">StoreLocation</span>.<span class="i">LocalMachine</span>);
            <span class="r170 r">store</span>.<span class="i">Open</span>(<span class="i">OpenFlags</span>.<span class="i">ReadOnly</span>);
            <b>foreach</b> (<b>var</b> <span id="r171 rd" class="r171 r">storeCertificate</span> <b>in</b> <span class="r170 r">store</span>.<span class="i">Certificates</span>)
            {
                <b>if</b> (<span class="r171 r">storeCertificate</span>.<span class="i">Thumbprint</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r171 r">storeCertificate</span>.<span class="i">Thumbprint</span>.<span class="i">Equals</span>(
                        <span class="s">&quot;ebd2bcdaedccaa360e7eb98ac128c7c1ceb34719&quot;</span>, <span class="c">//&quot;c189a71f9e6bde7d7c713531007048c22ac5c225&quot;, //&quot;72765da05695c17975cfc755c9763eed81b7add7&quot;,</span>
                        <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <span class="r171 r">storeCertificate</span>;
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The register subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r172 r">subscriptionId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscription id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ffbf67bade099bcf" href="R/ffbf67bade099bcf.html" target="n" data-glyph="76,1" class="i method">RegisterSubscription</a>(<b>string</b> <span id="r172 rd" class="r172 r">subscriptionId</span>)
        {
            <b>using</b> (<span class="i">MockContext</span> <span id="r173 rd" class="r173 r">context</span> = <span class="i">MockContext</span>.<span class="i">Start</span>(<a href="#10a37f15ea7fcac0" class="k">this</a>.<span class="i">GetType</span>().<span class="i">FullName</span>))
            {
                <b>var</b> <span id="r174 rd" class="r174 r">cert</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#e2da34efe3195765" class="i method">GetClientCertificate</a>();
                <b>var</b> <span id="r175 rd" class="r175 r">url</span> = <b>new</b> <span class="i">Uri</span>(<span class="s">$&quot;</span>{<a href="#d0242f5bd781c3bc" class="i field">LocalEdgeRpUri</a>}<span class="s">api/v1/subscriptions/</span>{<span class="r172 r">subscriptionId</span>}<span class="s">?api-version=2.0</span><span class="s">&quot;</span>);
 
                <span class="i">ServicePointManager</span>.<span class="i">SecurityProtocol</span> = <span class="i">SecurityProtocolType</span>.<span class="i">Tls12</span>;
                <span class="i">ServicePointManager</span>.<span class="i">Expect100Continue</span> = <b>true</b>;
                <b>var</b> <span id="r176 rd" class="r176 r">request</span> = (<span class="i">HttpWebRequest</span>)<span class="i">WebRequest</span>.<span class="i">Create</span>(<span class="r175 r">url</span>);
 
                <span class="r176 r">request</span>.<span class="i">Method</span> = <span class="i">HttpMethod</span>.<span class="i">Put</span>.<span class="i">ToString</span>();
                <span class="r176 r">request</span>.<span class="i">ClientCertificates</span> = <b>new</b> <span class="i">X509Certificate2Collection</span>(<span class="r174 r">cert</span>);
                <span class="r176 r">request</span>.<span class="i">ServerCertificateValidationCallback</span> = (<span id="r177 rd" class="r177 r">a</span>, <span id="r178 rd" class="r178 r">b</span>, <span id="r179 rd" class="r179 r">c</span>, <span id="r180 rd" class="r180 r">d</span>) =&gt; <b>true</b>;
                <span class="r176 r">request</span>.<span class="i">ContentLength</span> = 0;
                <b>var</b> <span id="r181 rd" class="r181 r">postData</span> = <span class="s">@&quot;{
                                &#39;state&#39;: &#39;Registered&#39;,
                                &#39;registrationDate&#39;: &#39;2019-03-01T23:57:05.644Z&#39;,
                                &#39;properties&#39;: {
                                    &#39;tenantId&#39;: &#39;string&#39;,
                                    &#39;locationPlacementId&#39;: &#39;string&#39;,
                                    &#39;quotaId&#39;: &#39;string&#39;,
                                    &#39;registeredFeatures&#39;: [
                                        {
                                        &#39;name&#39;: &#39;Microsoft.Peering/AllowExchangePeering&#39;,
                                        &#39;state&#39;: &#39;Registered&#39;
                                        },
                                        {
                                        &#39;name&#39;: &#39;Microsoft.Peering/AllowDirectPeering&#39;,
                                        &#39;state&#39;: &#39;Registered&#39;
                                        },
                                        {
                                        &#39;name&#39;: &#39;Microsoft.Peering/AllowPeeringService&#39;,
                                        &#39;state&#39;: &#39;Registered&#39;
                                        }
                                    ]
                                }
                            }&quot;</span>;
                <b>var</b> <span id="r182 rd" class="r182 r">data</span> = <span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<span class="r181 r">postData</span>);
                <span class="r176 r">request</span>.<span class="i">ContentType</span> = <span class="s">&quot;application/json&quot;</span>;
                <span class="r176 r">request</span>.<span class="i">ContentLength</span> = <span class="r182 r">data</span>.<span class="i">Length</span>;
                <span class="r176 r">request</span>.<span class="i">GetRequestStream</span>().<span class="i">Write</span>(<span class="r182 r">data</span>, 0, <span class="r182 r">data</span>.<span class="i">Length</span>);
 
                <b>var</b> <span id="r183 rd" class="r183 r">responseString</span> = <b>string</b>.<span class="i">Empty</span>;
 
                <b>using</b> (<b>var</b> <span id="r184 rd" class="r184 r">response</span> = <span class="r176 r">request</span>.<span class="i">GetResponse</span>())
                {
                    <b>using</b> (<b>var</b> <span id="r185 rd" class="r185 r">responseStream</span> = <span class="r184 r">response</span>.<span class="i">GetResponseStream</span>())
                    {
                        <b>if</b> (<span class="r185 r">responseStream</span> != <b>null</b>)
                        {
                            <b>using</b> (<b>var</b> <span id="r186 rd" class="r186 r">sr</span> = <b>new</b> <span class="i">StreamReader</span>(<span class="r185 r">responseStream</span>, <span class="i">Encoding</span>.<span class="i">UTF8</span>))
                            {
                                <span class="r183 r">responseString</span> = <span class="r186 r">sr</span>.<span class="i">ReadToEnd</span>();
                                <span class="r186 r">sr</span>.<span class="i">Close</span>();
                            }
                        }
                    }
                }
 
                <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r183 r">responseString</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The update peer validation state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r187 r">peerAsn</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The peer asn.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">asnValidationState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asn validation state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>object</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;StyleCop.CSharp.DocumentationRules&quot;</span>, <span class="s">&quot;SA1650:ElementDocumentationMustBeSpelledCorrectly&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Reviewed. Suppression is OK here.&quot;</span>)]
        <b>private object</b> <a id="248988090972ce04" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">UpdatePeerValidationState</a>(<a href="/Microsoft.Azure.Management.Peering/A.html#2704afa52c35ac53" class="t t">PeerAsn</a> <span id="r187 rd" class="r187 r">peerAsn</span>, <b>string</b> <span id="r188 rd" class="r188 r">asnValidationState</span>)
        {
            <span class="c">// Patch with correct approval</span>
            <b>var</b> <span id="r189 rd" class="r189 r">url</span> =
                <span class="s">$&quot;</span><span class="s">api/v1/subscriptions?subscriptionId=</span>{<a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#44da1e972ac34e30" class="i property">SubscriptionId</a>}<span class="s">&amp;peerAsnName=</span>{<span class="r187 r">peerAsn</span>.<a href="/Microsoft.Azure.Management.Peering/A.html#117338f1ab04aa22" class="i property">Name</a>}<span class="s">&amp;api-version=</span>{<a href="#aad06a09c7e76021" class="i field">ApiVersionLatest</a>}<span class="s">&amp;validationState=</span>{<span class="r188 r">asnValidationState</span>}<span class="s">&quot;</span>;
            <b>try</b>
            {
                <b>var</b> <span id="r190 rd" class="r190 r">response</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#d7e85dce98d2146e" class="i method">Send</a>(<span class="r187 r">peerAsn</span>, <span class="s">&quot;PATCH&quot;</span>, <span class="r189 r">url</span>);
                <b>return</b> <span class="i">JsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<a href="/Microsoft.Azure.Management.Peering/A.html#2704afa52c35ac53" class="t t">PeerAsn</a>&gt;(<span class="r190 r">response</span>, <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#8f54dd9ebd990357" class="i property">Client</a>.<a href="/Microsoft.Azure.Management.Peering/A.html#b6a1c3b66161c1e9" class="i property">DeserializationSettings</a>);
            }
            <b>catch</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <b>private string</b> <a id="2eafa56fff40e1da" href="R/2eafa56fff40e1da.html" target="n" data-glyph="76,1" class="i method">GetResourceGroup</a>(<b>string</b> <span id="r191 rd" class="r191 r">id</span>)
        {
            <b>return</b> <span class="r191 r">id</span>.<span class="i">Split</span>(<span class="s">&quot;/&quot;</span>)[4];
        }
 
        <b>private string</b> <a id="b8eae33e1bd549ac" href="R/b8eae33e1bd549ac.html" target="n" data-glyph="76,1" class="i method">GetPeeringName</a>(<b>string</b> <span id="r192 rd" class="r192 r">id</span>)
        {
            <b>return</b> <span class="r192 r">id</span>.<span class="i">Split</span>(<span class="s">&quot;/&quot;</span>)[8];
        }
 
        <b>private string</b> <a id="88c5598cc6b05889" href="R/88c5598cc6b05889.html" target="n" data-glyph="76,1" class="i method">GetPeerAsnName</a>(<b>string</b> <span id="r193 rd" class="r193 r">id</span>)
        {
            <b>return</b> <span class="r193 r">id</span>.<span class="i">Split</span>(<span class="s">&quot;/&quot;</span>)[6];
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The send.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">t</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The t.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">httpMethod</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The http method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">url</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The url.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r197 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>string</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="d7e85dce98d2146e" href="R/d7e85dce98d2146e.html" target="n" data-glyph="76,1" class="i method">Send</a>&lt;<span id="r197 rd t" class="r197 r t">T</span>&gt;(<span class="r197 r t">T</span> <span id="r194 rd" class="r194 r">t</span>, <b>string</b> <span id="r195 rd" class="r195 r">httpMethod</span>, <b>string</b> <span id="r196 rd" class="r196 r">url</span>)
        {
            <b>var</b> <span id="r198 rd" class="r198 r">cert</span> = <a href="#10a37f15ea7fcac0" class="k">this</a>.<a href="#e2da34efe3195765" class="i method">GetClientCertificate</a>();
            <span class="i">ServicePointManager</span>.<span class="i">SecurityProtocol</span> = <span class="i">SecurityProtocolType</span>.<span class="i">Tls12</span>;
            <span class="i">ServicePointManager</span>.<span class="i">Expect100Continue</span> = <b>true</b>;
            <b>var</b> <span id="r199 rd" class="r199 r">path</span> = <a href="#d0242f5bd781c3bc" class="i field">LocalEdgeRpUri</a> + <span class="r196 r">url</span>;
            <b>var</b> <span id="r200 rd" class="r200 r">request</span> = (<span class="i">HttpWebRequest</span>)<span class="i">WebRequest</span>.<span class="i">Create</span>(<span class="r199 r">path</span>);
 
            <span class="r200 r">request</span>.<span class="i">Method</span> = <span class="r195 r">httpMethod</span>;
            <span class="r200 r">request</span>.<span class="i">ClientCertificates</span> = <b>new</b> <span class="i">X509Certificate2Collection</span>(<span class="r198 r">cert</span>);
            <span class="r200 r">request</span>.<span class="i">ServerCertificateValidationCallback</span> = (<span id="r201 rd" class="r201 r">a</span>, <span id="r202 rd" class="r202 r">b</span>, <span id="r203 rd" class="r203 r">c</span>, <span id="r204 rd" class="r204 r">d</span>) =&gt; <b>true</b>;
            <span class="r200 r">request</span>.<span class="i">ContentLength</span> = 0;
            <b>var</b> <span id="r205 rd" class="r205 r">postData</span> = <span class="i">JsonConvert</span>.<span class="i">SerializeObject</span>(<span class="r194 r">t</span>);
            <b>var</b> <span id="r206 rd" class="r206 r">data</span> = <span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetBytes</span>(<span class="r205 r">postData</span>);
            <span class="r200 r">request</span>.<span class="i">ContentType</span> = <span class="s">&quot;application/json&quot;</span>;
            <span class="r200 r">request</span>.<span class="i">ContentLength</span> = <span class="r206 r">data</span>.<span class="i">Length</span>;
            <span class="r200 r">request</span>.<span class="i">GetRequestStream</span>().<span class="i">Write</span>(<span class="r206 r">data</span>, 0, <span class="r206 r">data</span>.<span class="i">Length</span>);
 
            <b>var</b> <span id="r207 rd" class="r207 r">responseString</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>using</b> (<b>var</b> <span id="r208 rd" class="r208 r">response</span> = <span class="r200 r">request</span>.<span class="i">GetResponse</span>())
            {
                <b>using</b> (<b>var</b> <span id="r209 rd" class="r209 r">responseStream</span> = <span class="r208 r">response</span>.<span class="i">GetResponseStream</span>())
                {
                    <b>if</b> (<span class="r209 r">responseStream</span> != <b>null</b>)
                    {
                        <b>using</b> (<b>var</b> <span id="r210 rd" class="r210 r">sr</span> = <b>new</b> <span class="i">StreamReader</span>(<span class="r209 r">responseStream</span>, <span class="i">Encoding</span>.<span class="i">UTF8</span>))
                        {
                            <span class="r207 r">responseString</span> = <span class="r210 r">sr</span>.<span class="i">ReadToEnd</span>();
                            <span class="r210 r">sr</span>.<span class="i">Close</span>();
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r207 r">responseString</span>;
        }
    }
}</pre></td></tr></table></div></body></html>
