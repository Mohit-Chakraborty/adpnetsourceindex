<!DOCTYPE html>
<html><head><title>ServiceBusRuleManager.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(257);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Messaging.ServiceBus/RuleManager/ServiceBusRuleManager.cs" target="_top">RuleManager\ServiceBusRuleManager.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Messaging.ServiceBus" target="_top">src\Azure.Messaging.ServiceBus.csproj</a> (Azure.Messaging.ServiceBus)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Threading</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>.<span class="i n">Administration</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Manages rules for subscriptions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="50094469945fd1d0" href="../R/50094469945fd1d0.html" target="n" data-glyph="2,0" class="t t">ServiceBusRuleManager</a> : <span class="i">IAsyncDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the Service Bus subscription that the rule manager is connected to, specific to the</span>
        <span class="c">///</span><span class="c"> Service Bus namespace that contains it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="3a8c2776a728f190" href="../R/3a8c2776a728f190.html" target="n" data-glyph="102,1" class="i property">SubscriptionPath</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ID to identify this client. This can be used to correlate logs and exceptions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Every new client has a unique ID.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="ec2c864b962fabda" href="../R/ec2c864b962fabda.html" target="n" data-glyph="104,1" class="i property">Identifier</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Indicates whether or not this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> has been disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the rule manager is disposed; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="48c71e46d7ed9a19" href="../R/48c71e46d7ed9a19.html" target="n" data-glyph="102,1" class="i property">IsDisposed</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The active connection to the Azure Service Bus service, enabling client communications for metadata</span>
        <span class="c">///</span><span class="c"> about the associated Service Bus entity and access to transport-aware rule manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private readonly</b> <a href="../Primitives/ServiceBusConnection.cs.html#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a> <a id="00d0e4e599c2d0a0" href="../R/00d0e4e599c2d0a0.html" target="n" data-glyph="46,1" class="i field">_connection</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An abstracted Service Bus transport-specific rule manager that is associated with the</span>
        <span class="c">///</span><span class="c"> Service Bus entity gateway; intended to perform delegated operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal readonly</b> <a href="../Core/TransportRuleManager.cs.html#756a3d383b80bb40" class="t t">TransportRuleManager</a> <a id="d8c8ca37902196ab" href="../R/d8c8ca37902196ab.html" target="n" data-glyph="44,1" class="i field">InnerRuleManager</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">connection</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Primitives/ServiceBusConnection.cs.html#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> connection to use for communication with the Service Bus service.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">subscriptionPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path of the Service Bus subscription to which the rule manager is bound.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>internal</b> <a id="a34489fbb643da68" href="../R/a34489fbb643da68.html" target="n" data-glyph="74,1" class="t constructor">ServiceBusRuleManager</a>(
            <a href="../Primitives/ServiceBusConnection.cs.html#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a> <span id="r0 rd" class="r0 r">connection</span>,
            <b>string</b> <span id="r1 rd" class="r1 r">subscriptionPath</span>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r0 r">connection</span>, <b>nameof</b>(<span class="r0 r">connection</span>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r0 r">connection</span>.<a href="../Primitives/ServiceBusConnection.cs.html#6fbb28757496f6ee" class="i property">RetryOptions</a>, <b>nameof</b>(<span class="r0 r">connection</span>.<a href="../Primitives/ServiceBusConnection.cs.html#6fbb28757496f6ee" class="i property">RetryOptions</a>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#fa55a5c88c3dc11d" class="i method">AssertNotNullOrWhiteSpace</a>(<span class="r1 r">subscriptionPath</span>, <b>nameof</b>(<span class="r1 r">subscriptionPath</span>));
            <span class="r0 r">connection</span>.<a href="../Primitives/ServiceBusConnection.cs.html#9c53664d76dd11d7" class="i method">ThrowIfClosed</a>();
 
            <a href="#ec2c864b962fabda" class="i property">Identifier</a> = <a href="../Diagnostics/DiagnosticUtilities.cs.html#e63dadcef3cbbce1" class="t t">DiagnosticUtilities</a>.<a href="../Diagnostics/DiagnosticUtilities.cs.html#582c96465587da53" class="i method">GenerateIdentifier</a>(<span class="r1 r">subscriptionPath</span>);
            <a href="#00d0e4e599c2d0a0" class="i field">_connection</a> = <span class="r0 r">connection</span>;
            <a href="#3a8c2776a728f190" class="i property">SubscriptionPath</a> = <span class="r1 r">subscriptionPath</span>;
            <a href="#d8c8ca37902196ab" class="i field">InnerRuleManager</a> = <a href="#00d0e4e599c2d0a0" class="i field">_connection</a>.<a href="../Primitives/ServiceBusConnection.cs.html#b2be2aca3d8e07a6" class="i method">CreateTransportRuleManager</a>(
                <span class="r2 r">subscriptionPath</span>: <a href="#3a8c2776a728f190" class="i property">SubscriptionPath</a>,
                <span class="r3 r">retryPolicy</span>: <span class="r0 r">connection</span>.<a href="../Primitives/ServiceBusConnection.cs.html#6fbb28757496f6ee" class="i property">RetryOptions</a>.<a href="../Core/ServiceBusRetryOptionsExtensions.cs.html#d698c84551779460" class="i method">ToRetryPolicy</a>(),
                <span class="r4 r">identifier</span>: <a href="#ec2c864b962fabda" class="i property">Identifier</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a rule to the current subscription to filter the messages reaching from topic to the subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">ruleName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the rule</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">filter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The filter expression against which messages will be matched.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CancellationToken</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> You can add rules to the subscription that decides which messages from the topic should reach the subscription.</span>
        <span class="c">///</span><span class="c"> A default </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Administration/Rules/TrueRuleFilter.cs.html#ba078703df057514" class="t t">TrueRuleFilter</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> rule named </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Administration/Rules/RuleProperties.cs.html#b23c8647941f6cd1" class="t t">RuleProperties</a>.<a href="../Administration/Rules/RuleProperties.cs.html#25056788d39b4302" class="i field">DefaultRuleName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is always added while creation of the Subscription.</span>
        <span class="c">///</span><span class="c"> You can add multiple rules with distinct names to the same subscription.</span>
        <span class="c">///</span><span class="c"> Multiple filters combine with each other using logical OR condition. i.e., If any filter succeeds, the message is passed on to the subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task instance that represents the asynchronous add rule operation.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual async</b> <span class="i">Task</span> <a id="3a3ffd5e70ccf96a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AddRuleAsync</a>(
            <b>string</b> <span id="r5 rd" class="r5 r">ruleName</span>,
            <a href="../Administration/Rules/RuleFilter.cs.html#45efbc9118b2c40d" class="t t">RuleFilter</a> <span id="r6 rd" class="r6 r">filter</span>,
            <span class="i">CancellationToken</span> <span id="r7 rd" class="r7 r">cancellationToken</span> = <b>default</b>)
        {
            <b>await</b> <a href="#b0d928095bf8aa0b" class="i method">AddRuleAsync</a>(<b>new</b> <a href="../Administration/Rules/RuleProperties.cs.html#5e97a7ba6813321a" class="t constructor">RuleProperties</a>(<span class="r8 r">name</span>: <span class="r5 r">ruleName</span>, <span class="r9 r">filter</span>: <span class="r6 r">filter</span>), <span class="r7 r">cancellationToken</span>).<span class="i">ConfigureAwait</span>(<b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a rule to the current subscription to filter the messages reaching from topic to the subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The rule description that provides the rule to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CancellationToken</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> You can add rules to the subscription that decides which messages from the topic should reach the subscription.</span>
        <span class="c">///</span><span class="c"> A default </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Administration/Rules/TrueRuleFilter.cs.html#ba078703df057514" class="t t">TrueRuleFilter</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> rule named </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Administration/Rules/RuleProperties.cs.html#b23c8647941f6cd1" class="t t">RuleProperties</a>.<a href="../Administration/Rules/RuleProperties.cs.html#25056788d39b4302" class="i field">DefaultRuleName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is always added while creation of the Subscription.</span>
        <span class="c">///</span><span class="c"> You can add multiple rules with distinct names to the same subscription.</span>
        <span class="c">///</span><span class="c"> Multiple filters combine with each other using logical OR condition. i.e., If any filter succeeds, the message is passed on to the subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task instance that represents the asynchronous add rule operation.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual async</b> <span class="i">Task</span> <a id="b0d928095bf8aa0b" href="../R/b0d928095bf8aa0b.html" target="n" data-glyph="72,1" class="i method">AddRuleAsync</a>(
            <a href="../Administration/Rules/RuleProperties.cs.html#b23c8647941f6cd1" class="t t">RuleProperties</a> <span id="r10 rd" class="r10 r">description</span>,
            <span class="i">CancellationToken</span> <span id="r11 rd" class="r11 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../Core/Argument.cs.html#ad31cdc7051f5f26" class="i method">AssertNotDisposed</a>(<a href="#48c71e46d7ed9a19" class="i property">IsDisposed</a>, <b>nameof</b>(<a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r10 r">description</span>, <b>nameof</b>(<span class="r10 r">description</span>));
            <span class="r11 r">cancellationToken</span>.<a href="../Core/CancellationTokenExtensions.cs.html#02fb1f7bead5539d" class="i method">ThrowIfCancellationRequested</a>&lt;<span class="i">TaskCanceledException</span>&gt;();
            <a href="../EntityNameFormatter.cs.html#a1a69c56795bc65a" class="t t">EntityNameFormatter</a>.<a href="../EntityNameFormatter.cs.html#e4770a51ea1d1173" class="i method">CheckValidRuleName</a>(<span class="r10 r">description</span>.<a href="../Administration/Rules/RuleProperties.cs.html#5b6ae11b0935ebf7" class="i property">Name</a>);
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#39de4d42005c4e73" class="i method">AddRuleStart</a>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>, <span class="r10 r">description</span>.<a href="../Administration/Rules/RuleProperties.cs.html#5b6ae11b0935ebf7" class="i property">Name</a>);
 
            <b>try</b>
            {
                <b>await</b> <a href="#d8c8ca37902196ab" class="i field">InnerRuleManager</a>.<a href="../Core/TransportRuleManager.cs.html#a4cada513631bd8c" class="i method">AddRuleAsync</a>(
                    <span class="r10 r">description</span>,
                    <span class="r11 r">cancellationToken</span>).<span class="i">ConfigureAwait</span>(<b>false</b>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r12 rd" class="r12 r">exception</span>)
            {
                <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<span class="i">AddRuleException</span>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>, <span class="r12 r">exception</span>.<span class="i">ToString</span>());
                <b>throw</b>;
            }
 
            <span class="r11 r">cancellationToken</span>.<a href="../Core/CancellationTokenExtensions.cs.html#02fb1f7bead5539d" class="i method">ThrowIfCancellationRequested</a>&lt;<span class="i">TaskCanceledException</span>&gt;();
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#b7cd22d1a86b0a80" class="i method">AddRuleComplete</a>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the rule on the subscription identified by </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">ruleName</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">ruleName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the rule</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CancellationToken</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task instance that represents the asynchronous remove rule operation.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual async</b> <span class="i">Task</span> <a id="43d2f9920bbc0290" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">RemoveRuleAsync</a>(
            <b>string</b> <span id="r13 rd" class="r13 r">ruleName</span>,
            <span class="i">CancellationToken</span> <span id="r14 rd" class="r14 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../Core/Argument.cs.html#ad31cdc7051f5f26" class="i method">AssertNotDisposed</a>(<a href="#48c71e46d7ed9a19" class="i property">IsDisposed</a>, <b>nameof</b>(<a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#6f15f042abe7f96a" class="i method">AssertNotNullOrEmpty</a>(<span class="r13 r">ruleName</span>, <b>nameof</b>(<span class="r13 r">ruleName</span>));
            <span class="r14 r">cancellationToken</span>.<a href="../Core/CancellationTokenExtensions.cs.html#02fb1f7bead5539d" class="i method">ThrowIfCancellationRequested</a>&lt;<span class="i">TaskCanceledException</span>&gt;();
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#30e2a69153321799" class="i method">RemoveRuleStart</a>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>, <span class="r13 r">ruleName</span>);
 
            <b>try</b>
            {
                <b>await</b> <a href="#d8c8ca37902196ab" class="i field">InnerRuleManager</a>.<a href="../Core/TransportRuleManager.cs.html#d8b3d438f8783d3e" class="i method">RemoveRuleAsync</a>(
                    <span class="r13 r">ruleName</span>,
                    <span class="r14 r">cancellationToken</span>).<span class="i">ConfigureAwait</span>(<b>false</b>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r15 rd" class="r15 r">exception</span>)
            {
                <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<span class="i">RemoveRuleException</span>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>, <span class="r15 r">exception</span>.<span class="i">ToString</span>());
                <b>throw</b>;
            }
 
            <span class="r14 r">cancellationToken</span>.<a href="../Core/CancellationTokenExtensions.cs.html#02fb1f7bead5539d" class="i method">ThrowIfCancellationRequested</a>&lt;<span class="i">TaskCanceledException</span>&gt;();
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#7ca271e8f066c36a" class="i method">RemoveRuleComplete</a>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get all rules associated with the subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CancellationToken</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns a list of rules description</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual async</b> <span class="i">Task</span>&lt;<span class="i">IList</span>&lt;<a href="../Administration/Rules/RuleProperties.cs.html#b23c8647941f6cd1" class="t t">RuleProperties</a>&gt;&gt; <a id="b1819ef5f1d3a23a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetRulesAsync</a>(<span class="i">CancellationToken</span> <span id="r16 rd" class="r16 r">cancellationToken</span> = <b>default</b>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../Core/Argument.cs.html#ad31cdc7051f5f26" class="i method">AssertNotDisposed</a>(<a href="#48c71e46d7ed9a19" class="i property">IsDisposed</a>, <b>nameof</b>(<a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a>));
            <span class="r16 r">cancellationToken</span>.<a href="../Core/CancellationTokenExtensions.cs.html#02fb1f7bead5539d" class="i method">ThrowIfCancellationRequested</a>&lt;<span class="i">TaskCanceledException</span>&gt;();
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#e26cf7ec2d410a78" class="i method">GetRuleStart</a>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>);
            <span class="i">IList</span>&lt;<a href="../Administration/Rules/RuleProperties.cs.html#b23c8647941f6cd1" class="t t">RuleProperties</a>&gt; <span id="r17 rd" class="r17 r">rulesDescription</span>;
 
            <b>try</b>
            {
                <span class="r17 r">rulesDescription</span> = <b>await</b> <a href="#d8c8ca37902196ab" class="i field">InnerRuleManager</a>.<a href="../Core/TransportRuleManager.cs.html#26f3b7c426499194" class="i method">GetRulesAsync</a>(<span class="r16 r">cancellationToken</span>).<span class="i">ConfigureAwait</span>(<b>false</b>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r18 rd" class="r18 r">exception</span>)
            {
                <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<span class="i">GetRuleException</span>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>, <span class="r18 r">exception</span>.<span class="i">ToString</span>());
                <b>throw</b>;
            }
 
            <span class="r16 r">cancellationToken</span>.<a href="../Core/CancellationTokenExtensions.cs.html#02fb1f7bead5539d" class="i method">ThrowIfCancellationRequested</a>&lt;<span class="i">TaskCanceledException</span>&gt;();
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#52311f75f48ee0ef" class="i method">GetRuleComplete</a>(<a href="#ec2c864b962fabda" class="i property">Identifier</a>);
            <b>return</b> <span class="r17 r">rulesDescription</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Performs the task needed to clean up resources used by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task to be resolved on when the operation has completed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual async</b> <span class="i">ValueTask</span> <a id="1a807c388898c83d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DisposeAsync</a>()
        {
            <a href="#48c71e46d7ed9a19" class="i property">IsDisposed</a> = <b>true</b>;
 
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<span class="i">ClientCloseStart</span>(<b>typeof</b>(<a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a>), <a href="#ec2c864b962fabda" class="i property">Identifier</a>);
            <b>try</b>
            {
                <b>await</b> <a href="#d8c8ca37902196ab" class="i field">InnerRuleManager</a>.<span class="i">CloseAsync</span>(<span class="i">CancellationToken</span>.<span class="i">None</span>).<span class="i">ConfigureAwait</span>(<b>false</b>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r19 rd" class="r19 r">ex</span>)
            {
                <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<span class="i">ClientCloseException</span>(<b>typeof</b>(<a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a>), <a href="#ec2c864b962fabda" class="i property">Identifier</a>, <span class="r19 r">ex</span>);
                <b>throw</b>;
            }
 
            <a href="../Diagnostics/ServiceBusEventSource.cs.html#9f107e3f0d141c2b" class="t t">ServiceBusEventSource</a>.<a href="../Diagnostics/ServiceBusEventSource.cs.html#9494c77d3f8244ec" class="i property">Log</a>.<span class="i">ClientCloseComplete</span>(<b>typeof</b>(<a href="#50094469945fd1d0" class="t t">ServiceBusRuleManager</a>), <a href="#ec2c864b962fabda" class="i property">Identifier</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">System</span>.<span class="i">Object</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is equal to this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">System</span>.<span class="i">Object</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> to compare with this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">System</span>.<span class="i">Object</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is equal to this instance; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">EditorBrowsable</span>(<span class="i">EditorBrowsableState</span>.<span class="i">Never</span>)]
        <b>public override bool</b> <a id="209e4fb89d7c895e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r20 rd" class="r20 r">obj</span>) =&gt; <b>base</b>.<span class="i">Equals</span>(<span class="r20 r">obj</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a hash code for this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A hash code for this instance, suitable for use in hashing algorithms and data structures like a hash table.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">EditorBrowsable</span>(<span class="i">EditorBrowsableState</span>.<span class="i">Never</span>)]
        <b>public override int</b> <a id="34eeb9209139548b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>() =&gt; <b>base</b>.<span class="i">GetHashCode</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the instance to string representation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">System</span>.<span class="i">String</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> that represents this instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">EditorBrowsable</span>(<span class="i">EditorBrowsableState</span>.<span class="i">Never</span>)]
        <b>public override string</b> <a id="5201ad5f3cb7d937" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>() =&gt; <b>base</b>.<span class="i">ToString</span>();
    }
}
</pre></td></tr></table></div></body></html>
