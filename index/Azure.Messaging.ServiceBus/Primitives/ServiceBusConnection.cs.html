<!DOCTYPE html>
<html><head><title>ServiceBusConnection.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(451);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.Messaging.ServiceBus/Primitives/ServiceBusConnection.cs" target="_top">Primitives\ServiceBusConnection.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/servicebus/Azure.Messaging.ServiceBus/src/Primitives/ServiceBusConnection.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.Messaging.ServiceBus" target="_top">Azure.Messaging.ServiceBus.csproj</a> (Azure.Messaging.ServiceBus)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>.<span class="i n">Amqp</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>.<span class="i n">Authorization</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>.<span class="i n">Core</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">Messaging</span>.<span class="i n">ServiceBus</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">   A connection to the Azure Service Bus service, enabling client communications with a specific</span>
    <span class="c">///</span><span class="c">   Service Bus entity instance within a Service Bus namespace. There is a one-to-one correspondence</span>
    <span class="c">///</span><span class="c">   between </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Client/ServiceBusClient.cs.html#ad46ff0588c85077" class="t t">ServiceBusClient</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instances.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="5fc67fb7b5056bea" href="../R/5fc67fb7b5056bea.html" target="n" data-glyph="2,0" class="t t">ServiceBusConnection</a> : <span class="t t">IAsyncDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The fully qualified Service Bus namespace that the connection is associated with.</span>
        <span class="c">///</span><span class="c">   This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="729943334b661165" href="../R/729943334b661165.html" target="n" data-glyph="102,1" class="i property">FullyQualifiedNamespace</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Indicates whether or not this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> has been closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the connection is closed; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="032653d385638dae" href="../R/032653d385638dae.html" target="n" data-glyph="102,1" class="i property">IsClosed</a> =&gt; <a href="#4a737298ce7fdb96" class="i property">InnerClient</a>.<a href="../Core/TransportClient.cs.html#1b1a32e01f6b0320" class="i property">IsClosed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The entity path that the connection is bound to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="7f73213b86f87214" href="../R/7f73213b86f87214.html" target="n" data-glyph="102,1" class="i property">EntityPath</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   The endpoint for the Service Bus service to which the connection is associated.</span>
        <span class="c">///</span><span class="c">   This is essentially the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#729943334b661165" class="i property">FullyQualifiedNamespace</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> but with</span>
        <span class="c">///</span><span class="c">   the scheme included.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="@1@netstandard/A.html#991565dd25f47c90" class="t t">Uri</a> <a id="e974e1c22d28f5d0" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">ServiceEndpoint</a> =&gt; <a href="#4a737298ce7fdb96" class="i property">InnerClient</a>.<a href="../Core/TransportClient.cs.html#255be8743ebee24d" class="i property">ServiceEndpoint</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The transport type used for this connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="ServiceBusTransportType.cs.html#b07ef16e21fea68e" class="t t">ServiceBusTransportType</a> <a id="69f0394cd5b18421" href="../R/69f0394cd5b18421.html" target="n" data-glyph="102,1" class="i property">TransportType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The retry options associated with this connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="ServiceBusRetryOptions.cs.html#f405da36db2d38b0" class="t t">ServiceBusRetryOptions</a> <a id="6fbb28757496f6ee" href="../R/6fbb28757496f6ee.html" target="n" data-glyph="102,1" class="i property">RetryOptions</a> { <b>get</b>; }
 
        <b>internal</b> <a href="../Core/TransportClient.cs.html#1e482fe9c3dcc163" class="t t">TransportClient</a> <a id="4a737298ce7fdb96" href="../R/4a737298ce7fdb96.html" target="n" data-glyph="104,1" class="i property">InnerClient</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameterless constructor to allow mocking.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="973fc14c6714fa3e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ServiceBusConnection</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">connectionString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The connection string to use for connecting to the Service Bus namespace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   If the connection string is copied from the Service Bus entity itself, it will contain the name of the desired Service Bus entity,</span>
        <span class="c">///</span><span class="c">   and can be used directly without passing the  name=&quot;entityName&quot; /&gt;.  The name of the Service Bus entity should be</span>
        <span class="c">///</span><span class="c">   passed only once, either as part of the connection string or separately.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a id="d5310b52185247a2" href="../R/d5310b52185247a2.html" target="n" data-glyph="74,1" class="t constructor">ServiceBusConnection</a>(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">connectionString</span>,
            <a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a> <span id="r1 rd" class="r1 r">options</span>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#6f15f042abe7f96a" class="i method">AssertNotNullOrEmpty</a>(<span class="r0 r">connectionString</span>, <b>nameof</b>(<span class="r0 r">connectionString</span>));
            <a href="#cc2015a1b43a6d44" class="i method">ValidateConnectionOptions</a>(<span class="r1 r">options</span>);
 
            <a href="ServiceBusConnectionStringProperties.cs.html#b011974d70d9c929" class="k">var</a> <span id="r2 rd" class="r2 r">connectionStringProperties</span> = <a href="ServiceBusConnectionStringProperties.cs.html#b011974d70d9c929" class="t t">ServiceBusConnectionStringProperties</a>.<a href="ServiceBusConnectionStringProperties.cs.html#045f3a6b96bd4afd" class="i method">Parse</a>(<span class="r0 r">connectionString</span>);
            <a href="#855403e2d1c4cf76" class="i method">ValidateConnectionStringProperties</a>(<span class="r2 r">connectionStringProperties</span>, <b>nameof</b>(<span class="r0 r">connectionString</span>));
 
            <a href="#729943334b661165" class="i property">FullyQualifiedNamespace</a> = <span class="r2 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#3a46b590394b2830" class="i property">Endpoint</a>.<a href="@1@netstandard/A.html#c230833968da7179" class="i property">Host</a>;
            <a href="#69f0394cd5b18421" class="i property">TransportType</a> = <span class="r1 r">options</span>.<a href="../Client/ServiceBusClientOptions.cs.html#beccbe5f47fe4d95" class="i property">TransportType</a>;
            <a href="#7f73213b86f87214" class="i property">EntityPath</a> = <span class="r2 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#6300a49393b9e1d9" class="i property">EntityPath</a>;
            <a href="#6fbb28757496f6ee" class="i property">RetryOptions</a> = <span class="r1 r">options</span>.<a href="../Client/ServiceBusClientOptions.cs.html#f604bfc6c825072d" class="i property">RetryOptions</a>;
 
            <a href="../Authorization/SharedAccessSignature.cs.html#590cb6f714812552" class="t t">SharedAccessSignature</a> <span id="r3 rd" class="r3 r">sharedAccessSignature</span>;
 
            <b>if</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r2 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#12d390919cf49ab3" class="i property">SharedAccessSignature</a>))
            {
                <span class="r3 r">sharedAccessSignature</span> = <b>new</b> <a href="../Authorization/SharedAccessSignature.cs.html#f216fbff8ee290db" class="t constructor">SharedAccessSignature</a>(
                     <a href="#cb4206079cf16f03" class="i method">BuildConnectionResource</a>(<span class="r1 r">options</span>.<a href="../Client/ServiceBusClientOptions.cs.html#beccbe5f47fe4d95" class="i property">TransportType</a>, <a href="#729943334b661165" class="i property">FullyQualifiedNamespace</a>, <a href="#7f73213b86f87214" class="i property">EntityPath</a>),
                     <span class="r2 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#b51acce87d7adfd2" class="i property">SharedAccessKeyName</a>,
                     <span class="r2 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#a9d7834911da1b51" class="i property">SharedAccessKey</a>);
            }
            <b>else</b>
            {
                <span class="r3 r">sharedAccessSignature</span> = <b>new</b> <a href="../Authorization/SharedAccessSignature.cs.html#996dfe7080688211" class="t constructor">SharedAccessSignature</a>(<span class="r2 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#12d390919cf49ab3" class="i property">SharedAccessSignature</a>);
            }
 
            <a href="../Authorization/SharedAccessCredential.cs.html#c63e778f05acc6e2" class="k">var</a> <span id="r4 rd" class="r4 r">sharedCredential</span> = <b>new</b> <a href="../Authorization/SharedAccessCredential.cs.html#e43ee6fbd27d485f" class="t constructor">SharedAccessCredential</a>(<span class="r3 r">sharedAccessSignature</span>);
            <a href="../Authorization/ServiceBusTokenCredential.cs.html#e09f4bf6aa653648" class="k">var</a> <span id="r5 rd" class="r5 r">tokenCredential</span> = <b>new</b> <a href="../Authorization/ServiceBusTokenCredential.cs.html#1a22cc73c4bddef6" class="t constructor">ServiceBusTokenCredential</a>(<span class="r4 r">sharedCredential</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> <span class="i">CA2214</span> <span class="c">// Do not call overridable methods in constructors. This internal method is virtual for testing purposes.</span>
            <a href="#4a737298ce7fdb96" class="i property">InnerClient</a> = <a href="#56acbd6beeee0319" class="i method">CreateTransportClient</a>(<span class="r5 r">tokenCredential</span>, <span class="r1 r">options</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> <span class="i">CA2214</span> <span class="c">// Do not call overridable methods in constructors</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Service Bus namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Core/A.html#ff9da284cd79b59b" class="t t">AzureNamedKeyCredential</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> credential to use for authorization.  Access controls may be specified by the Service Bus namespace or the requested Service Bus entity, depending on Azure configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6182aa2e6ebddac6" href="../R/6182aa2e6ebddac6.html" target="n" data-glyph="74,1" class="t constructor">ServiceBusConnection</a>(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">fullyQualifiedNamespace</span>,
            <a href="/Azure.Core/A.html#ff9da284cd79b59b" class="t t">AzureNamedKeyCredential</a> <span id="r7 rd" class="r7 r">credential</span>,
            <a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a> <span id="r8 rd" class="r8 r">options</span>)
                : <a href="#1352379239c15af9" class="k">this</a>(
                    <span class="r6 r">fullyQualifiedNamespace</span>,
                    <a href="#c4c8509d06f0dc98" class="i method">TranslateNamedKeyCredential</a>(<span class="r7 r">credential</span>, <span class="r6 r">fullyQualifiedNamespace</span>, <b>null</b>, <span class="r8 r">options</span>.<a href="../Client/ServiceBusClientOptions.cs.html#beccbe5f47fe4d95" class="i property">TransportType</a>),
                    <span class="r8 r">options</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Service Bus namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Core/A.html#77bc7924ac000276" class="t t">AzureSasCredential</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> credential to use for authorization.  Access controls may be specified by the Service Bus namespace or the requested Service Bus entity, depending on Azure configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="28de7d57200bf2b3" href="../R/28de7d57200bf2b3.html" target="n" data-glyph="74,1" class="t constructor">ServiceBusConnection</a>(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">fullyQualifiedNamespace</span>,
            <a href="/Azure.Core/A.html#77bc7924ac000276" class="t t">AzureSasCredential</a> <span id="r10 rd" class="r10 r">credential</span>,
            <a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a> <span id="r11 rd" class="r11 r">options</span>)
                : <a href="#1352379239c15af9" class="k">this</a>(
                    <span class="r9 r">fullyQualifiedNamespace</span>,
                    <b>new</b> <a href="../Authorization/SharedAccessCredential.cs.html#f24ebaf359d6b88b" class="t constructor">SharedAccessCredential</a>(<span class="r10 r">credential</span>),
                    <span class="r11 r">options</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Service Bus namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Azure managed identity credential to use for authorization.  Access controls may be specified by the Service Bus namespace or the requested Service Bus entity, depending on Azure configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="1352379239c15af9" href="../R/1352379239c15af9.html" target="n" data-glyph="74,1" class="t constructor">ServiceBusConnection</a>(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r12 rd" class="r12 r">fullyQualifiedNamespace</span>,
            <a href="/Azure.Core/A.html#d93a9ffee404e938" class="t t">TokenCredential</a> <span id="r13 rd" class="r13 r">credential</span>,
            <a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a> <span id="r14 rd" class="r14 r">options</span>)
        {
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../Core/Argument.cs.html#afc5f61cce810570" class="i method">AssertWellFormedServiceBusNamespace</a>(<span class="r12 r">fullyQualifiedNamespace</span>, <b>nameof</b>(<span class="r12 r">fullyQualifiedNamespace</span>));
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../SharedSource/Azure.Core/Argument.cs.html#208d023d6fa23d33" class="i method">AssertNotNull</a>(<span class="r13 r">credential</span>, <b>nameof</b>(<span class="r13 r">credential</span>));
            <a href="#cc2015a1b43a6d44" class="i method">ValidateConnectionOptions</a>(<span class="r14 r">options</span>);
 
            <a href="../Authorization/ServiceBusTokenCredential.cs.html#e09f4bf6aa653648" class="k">var</a> <span id="r15 rd" class="r15 r">tokenCredential</span> = <b>new</b> <a href="../Authorization/ServiceBusTokenCredential.cs.html#1a22cc73c4bddef6" class="t constructor">ServiceBusTokenCredential</a>(<span class="r13 r">credential</span>);
 
            <a href="#729943334b661165" class="i property">FullyQualifiedNamespace</a> = <span class="r12 r">fullyQualifiedNamespace</span>;
            <a href="#69f0394cd5b18421" class="i property">TransportType</a> = <span class="r14 r">options</span>.<a href="../Client/ServiceBusClientOptions.cs.html#beccbe5f47fe4d95" class="i property">TransportType</a>;
            <a href="#6fbb28757496f6ee" class="i property">RetryOptions</a> = <span class="r14 r">options</span>.<a href="../Client/ServiceBusClientOptions.cs.html#f604bfc6c825072d" class="i property">RetryOptions</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> <span class="i">CA2214</span> <span class="c">// Do not call overridable methods in constructors. This internal method is virtual for testing purposes.</span>
            <a href="#4a737298ce7fdb96" class="i property">InnerClient</a> = <a href="#56acbd6beeee0319" class="i method">CreateTransportClient</a>(<span class="r15 r">tokenCredential</span>, <span class="r14 r">options</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> <span class="i">CA2214</span> <span class="c">// Do not call overridable methods in constructors</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Closes the connection to the Service Bus namespace and associated Service Bus entity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">cancellationToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An optional </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance to signal the request to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task to be resolved on when the operation has completed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <a href="@1@netstandard/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="2f68689ef44d041d" href="../R/2f68689ef44d041d.html" target="n" data-glyph="72,1" class="i method">CloseAsync</a>(<a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r16 rd" class="r16 r">cancellationToken</span> = <b>default</b>) =&gt;
            <b>await</b> <a href="#4a737298ce7fdb96" class="i property">InnerClient</a>.<a href="../Core/TransportClient.cs.html#bf3144a0a5a16176" class="i method">CloseAsync</a>(<span class="r16 r">cancellationToken</span>).<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Performs the task needed to clean up resources used by the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c">   including ensuring that the connection itself has been closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A task to be resolved on when the operation has completed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>public virtual async</b> <span class="t t">ValueTask</span> <a id="e94a87ab041fe288" href="../R/e94a87ab041fe288.html" target="n" data-glyph="72,1" class="i method">DisposeAsync</a>() =&gt; <b>await</b> <a href="#2f68689ef44d041d" class="i method">CloseAsync</a>().<a href="@1@netstandard/A.html#9ca6b2f012ce7587" class="i method">ConfigureAwait</a>(<b>false</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Determines whether the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#d9262ceecc1719ab" class="t t">Object</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is equal to this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#d9262ceecc1719ab" class="t t">Object</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> to compare with this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#d9262ceecc1719ab" class="t t">Object</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> is equal to this instance; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@1@netstandard/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@1@netstandard/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public override bool</b> <a id="3623e5f9e55d20a3" href="../R/3623e5f9e55d20a3.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r17 rd" class="r17 r">obj</span>) =&gt; <a href="@1@netstandard/A.html#d9262ceecc1719ab" class="k">base</a>.<a href="@1@netstandard/A.html#517682d5f6f4f8b4" class="i method">Equals</a>(<span class="r17 r">obj</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Returns a hash code for this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A hash code for this instance, suitable for use in hashing algorithms and data structures like a hash table.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@1@netstandard/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@1@netstandard/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public override int</b> <a id="034755be9d6d8701" href="../R/034755be9d6d8701.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>() =&gt; <a href="@1@netstandard/A.html#d9262ceecc1719ab" class="k">base</a>.<a href="@1@netstandard/A.html#4de9cf234d0d8b16" class="i method">GetHashCode</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Converts the instance to string representation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="t t">String</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> that represents this instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        [<a href="@1@netstandard/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@1@netstandard/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@1@netstandard/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public override string</b> <a id="83d2c6501355a20a" href="../R/83d2c6501355a20a.html" target="n" data-glyph="72,1" class="i method">ToString</a>() =&gt; <a href="@1@netstandard/A.html#d9262ceecc1719ab" class="k">base</a>.<a href="@1@netstandard/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
 
        <b>internal virtual</b> <a href="../Core/TransportSender.cs.html#c54f19921ea3dbe2" class="t t">TransportSender</a> <a id="43eed66c6da39eaf" href="../R/43eed66c6da39eaf.html" target="n" data-glyph="74,1" class="i method">CreateTransportSender</a>(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r18 rd" class="r18 r">entityPath</span>,
            <a href="ServiceBusRetryPolicy.cs.html#d0d6be7ac57eb9c9" class="t t">ServiceBusRetryPolicy</a> <span id="r19 rd" class="r19 r">retryPolicy</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">identifier</span>) =&gt;
            <a href="#4a737298ce7fdb96" class="i property">InnerClient</a>.<a href="../Core/TransportClient.cs.html#d20ffc03a653ffaa" class="i method">CreateSender</a>(<span class="r18 r">entityPath</span>, <span class="r19 r">retryPolicy</span>, <span class="r20 r">identifier</span>);
 
        <b>internal virtual</b> <a href="../Core/TransportReceiver.cs.html#1b072fa1ddd22c6a" class="t t">TransportReceiver</a> <a id="2098bbcc1f3805e9" href="../R/2098bbcc1f3805e9.html" target="n" data-glyph="74,1" class="i method">CreateTransportReceiver</a>(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r21 rd" class="r21 r">entityPath</span>,
            <a href="ServiceBusRetryPolicy.cs.html#d0d6be7ac57eb9c9" class="t t">ServiceBusRetryPolicy</a> <span id="r22 rd" class="r22 r">retryPolicy</span>,
            <a href="../Receiver/ServiceBusReceiveMode.cs.html#baa558d5ec869168" class="t t">ServiceBusReceiveMode</a> <span id="r23 rd" class="r23 r">receiveMode</span>,
            <b>uint</b> <span id="r24 rd" class="r24 r">prefetchCount</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r25 rd" class="r25 r">identifier</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r26 rd" class="r26 r">sessionId</span>,
            <b>bool</b> <span id="r27 rd" class="r27 r">isSessionReceiver</span>,
            <b>bool</b> <span id="r28 rd" class="r28 r">isProcessor</span>,
            <a href="@1@netstandard/A.html#36b17ded8b1a228c" class="t t">CancellationToken</a> <span id="r29 rd" class="r29 r">cancellationToken</span>) =&gt;
                <a href="#4a737298ce7fdb96" class="i property">InnerClient</a>.<a href="../Core/TransportClient.cs.html#10a44c17111ff147" class="i method">CreateReceiver</a>(
                    <span class="r21 r">entityPath</span>,
                    <span class="r22 r">retryPolicy</span>,
                    <span class="r23 r">receiveMode</span>,
                    <span class="r24 r">prefetchCount</span>,
                    <span class="r25 r">identifier</span>,
                    <span class="r26 r">sessionId</span>,
                    <span class="r27 r">isSessionReceiver</span>,
                    <span class="r28 r">isProcessor</span>,
                    <span class="r29 r">cancellationToken</span>);
 
        <b>internal virtual</b> <a href="../Core/TransportRuleManager.cs.html#756a3d383b80bb40" class="t t">TransportRuleManager</a> <a id="b2be2aca3d8e07a6" href="../R/b2be2aca3d8e07a6.html" target="n" data-glyph="74,1" class="i method">CreateTransportRuleManager</a>(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r30 rd" class="r30 r">subscriptionPath</span>,
            <a href="ServiceBusRetryPolicy.cs.html#d0d6be7ac57eb9c9" class="t t">ServiceBusRetryPolicy</a> <span id="r31 rd" class="r31 r">retryPolicy</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r32 rd" class="r32 r">identifier</span>) =&gt;
            <a href="#4a737298ce7fdb96" class="i property">InnerClient</a>.<a href="../Core/TransportClient.cs.html#4db45b241f6087ea" class="i method">CreateRuleManager</a>(<span class="r30 r">subscriptionPath</span>, <span class="r31 r">retryPolicy</span>, <span class="r32 r">identifier</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Builds a Service Bus client specific to the protocol and transport specified by the</span>
        <span class="c">///</span><span class="c">   requested connection type of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Azure managed identity credential to use for authorization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A client generalization specific to the specified protocol/transport to which operations may be delegated.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   As an internal method, only basic sanity checks are performed against arguments.  It is</span>
        <span class="c">///</span><span class="c">   assumed that callers are trusted and have performed deep validation.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">   Parameters passed are also assumed to be owned by thee transport client and safe to mutate or dispose;</span>
        <span class="c">///</span><span class="c">   creation of clones or otherwise protecting the parameters is assumed to be the purview of the caller.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>internal virtual</b> <a href="../Core/TransportClient.cs.html#1e482fe9c3dcc163" class="t t">TransportClient</a> <a id="56acbd6beeee0319" href="../R/56acbd6beeee0319.html" target="n" data-glyph="74,1" class="i method">CreateTransportClient</a>(
            <a href="../Authorization/ServiceBusTokenCredential.cs.html#e09f4bf6aa653648" class="t t">ServiceBusTokenCredential</a> <span id="r33 rd" class="r33 r">credential</span>,
            <a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a> <span id="r34 rd" class="r34 r">options</span>)
        {
            <b>switch</b> (<a href="#69f0394cd5b18421" class="i property">TransportType</a>)
            {
                <b>case</b> <a href="ServiceBusTransportType.cs.html#b07ef16e21fea68e" class="t t">ServiceBusTransportType</a>.<a href="ServiceBusTransportType.cs.html#3ed180f98e8874d3" class="i field">AmqpTcp</a>:
                <b>case</b> <a href="ServiceBusTransportType.cs.html#b07ef16e21fea68e" class="t t">ServiceBusTransportType</a>.<a href="ServiceBusTransportType.cs.html#5284a94cfb633714" class="i field">AmqpWebSockets</a>:
                    <b>return</b> <b>new</b> <a href="../Amqp/AmqpClient.cs.html#245773fd39821bba" class="t constructor">AmqpClient</a>(<a href="#729943334b661165" class="i property">FullyQualifiedNamespace</a>, <span class="r33 r">credential</span>, <span class="r34 r">options</span>);
 
                <b>default</b>:
                    <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#c07c3772222caaff" class="i method">Format</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <a href="../Resources.Designer.cs.html#7e6b2ac45384f6a8" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#9550ce2a1565e89b" class="i property">InvalidTransportType</a>, <span class="r34 r">options</span>.<a href="../Client/ServiceBusClientOptions.cs.html#beccbe5f47fe4d95" class="i property">TransportType</a>.<a href="@1@netstandard/A.html#1365cfeffd45409d" class="i method">ToString</a>()), <b>nameof</b>(<span class="r34 r">options</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Builds the audience of the connection for use in the signature.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">transportType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of protocol and transport that will be used for communicating with the Service Bus service.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Service Bus namespace.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">entityName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the specific entity to connect the client to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value to use as the audience of the signature.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>internal static string</b> <a id="cb4206079cf16f03" href="../R/cb4206079cf16f03.html" target="n" data-glyph="74,1" class="i method">BuildConnectionResource</a>(
            <a href="ServiceBusTransportType.cs.html#b07ef16e21fea68e" class="t t">ServiceBusTransportType</a> <span id="r35 rd" class="r35 r">transportType</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r36 rd" class="r36 r">fullyQualifiedNamespace</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r37 rd" class="r37 r">entityName</span>)
        {
            <span class="c">// If there is no namespace, there is no basis for a URL and the</span>
            <span class="c">// resource is empty.</span>
 
            <b>if</b> (<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r36 r">fullyQualifiedNamespace</span>))
            {
                <b>return</b> <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#c9f70a27facb27cf" class="i field">Empty</a>;
            }
 
            <a href="@1@netstandard/A.html#634c7a8e7fe9ce50" class="k">var</a> <span id="r38 rd" class="r38 r">builder</span> = <b>new</b> <a href="@1@netstandard/A.html#1b781c82a56a2c24" class="t constructor">UriBuilder</a>(<span class="r36 r">fullyQualifiedNamespace</span>)
            {
                <a href="@1@netstandard/A.html#93fdb47baf06de3c" class="i property">Scheme</a> = <span class="r35 r">transportType</span>.<a href="../Core/TransportTypeExtensions.cs.html#4d70475a72015f55" class="i method">GetUriScheme</a>(),
                <a href="@1@netstandard/A.html#793136ff40a9de89" class="i property">Path</a> = <span class="r37 r">entityName</span>,
                <a href="@1@netstandard/A.html#bce622dac8981dc1" class="i property">Port</a> = -1,
                <a href="@1@netstandard/A.html#9de13d66340dcc03" class="i property">Fragment</a> = <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#c9f70a27facb27cf" class="i field">Empty</a>,
                <a href="@1@netstandard/A.html#8b5c74527c53ad9e" class="i property">Password</a> = <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#c9f70a27facb27cf" class="i field">Empty</a>,
                <a href="@1@netstandard/A.html#9d175080de9f599a" class="i property">UserName</a> = <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#c9f70a27facb27cf" class="i field">Empty</a>,
            };
 
            <b>if</b> (<span class="r38 r">builder</span>.<a href="@1@netstandard/A.html#793136ff40a9de89" class="i property">Path</a>.<a href="@1@netstandard/A.html#41a31e4feec3ef41" class="i method">EndsWith</a>(<span class="s">&quot;/&quot;</span>, <a href="@1@netstandard/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@1@netstandard/A.html#87891a6d28c64c9b" class="i field">Ordinal</a>))
            {
                <span class="r38 r">builder</span>.<a href="@1@netstandard/A.html#793136ff40a9de89" class="i property">Path</a> = <span class="r38 r">builder</span>.<a href="@1@netstandard/A.html#793136ff40a9de89" class="i property">Path</a>.<a href="@1@netstandard/A.html#fc988fb267590f98" class="i method">TrimEnd</a>(<span class="s">&#39;/&#39;</span>);
            }
 
            <b>return</b> <span class="r38 r">builder</span>.<a href="@1@netstandard/A.html#b59ac7e3edbfe76c" class="i property">Uri</a>.<a href="@1@netstandard/A.html#e335fec0022465e6" class="i property">AbsoluteUri</a>.<a href="@1@netstandard/A.html#2d51c212cb09178e" class="i method">ToLowerInvariant</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throw an ObjectDisposedException if the object is Closing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="9c53664d76dd11d7" href="../R/9c53664d76dd11d7.html" target="n" data-glyph="74,1" class="i method">ThrowIfClosed</a>() =&gt;
            <a href="../P/0198b1312554d2ed.html#0198b1312554d2ed" class="t t">Argument</a>.<a href="../Core/Argument.cs.html#ad31cdc7051f5f26" class="i method">AssertNotDisposed</a>(<a href="#032653d385638dae" class="i property">IsClosed</a>, <b>nameof</b>(<a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a>));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Creates an </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> based on the provided options and credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r t">TCredential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of credential being used.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Event Hubs namespace to connect to.  This is likely to be similar to </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{yournamespace}.servicebus.windows.net</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The credential to use for authorization.  This may be of type </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Core/A.html#d93a9ffee404e938" class="t t">TokenCredential</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Core/A.html#77bc7924ac000276" class="t t">AzureSasCredential</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Core/A.html#ff9da284cd79b59b" class="t t">AzureNamedKeyCredential</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A set of options to apply when configuring the connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The connection that was created.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Ownership of the connection is transferred to the caller.  The caller holds responsibility</span>
        <span class="c">///</span><span class="c">   for closing the connection and other cleanup activities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>internal static</b> <a href="#5fc67fb7b5056bea" class="t t">ServiceBusConnection</a> <a id="91bda9d667ba7967" href="../R/91bda9d667ba7967.html" target="n" data-glyph="74,1" class="i method">CreateWithCredential</a>&lt;<span id="r39 rd t" class="r39 r t">TCredential</span>&gt;(
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r40 rd" class="r40 r">fullyQualifiedNamespace</span>,
            <span class="r39 r t">TCredential</span> <span id="r41 rd" class="r41 r">credential</span>,
            <a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a> <span id="r42 rd" class="r42 r">options</span>) =&gt;
            <span class="r41 r">credential</span> <b>switch</b>
            {
                <a href="/Azure.Core/A.html#d93a9ffee404e938" class="t t">TokenCredential</a> <span id="r43 rd" class="r43 r">cred</span> =&gt; <b>new</b> <a href="#1352379239c15af9" class="t constructor">ServiceBusConnection</a>(<span class="r40 r">fullyQualifiedNamespace</span>, <span class="r43 r">cred</span>, <span class="r42 r">options</span>),
                <a href="/Azure.Core/A.html#77bc7924ac000276" class="t t">AzureSasCredential</a> <span id="r44 rd" class="r44 r">cred</span> =&gt; <b>new</b> <a href="#28de7d57200bf2b3" class="t constructor">ServiceBusConnection</a>(<span class="r40 r">fullyQualifiedNamespace</span>, <span class="r44 r">cred</span>, <span class="r42 r">options</span>),
                <a href="/Azure.Core/A.html#ff9da284cd79b59b" class="t t">AzureNamedKeyCredential</a> <span id="r45 rd" class="r45 r">cred</span> =&gt; <b>new</b> <a href="#6182aa2e6ebddac6" class="t constructor">ServiceBusConnection</a>(<span class="r40 r">fullyQualifiedNamespace</span>, <span class="r45 r">cred</span>, <span class="r42 r">options</span>),
                <b>_</b> =&gt; <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>(<a href="../Resources.Designer.cs.html#7e6b2ac45384f6a8" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#95b5c59d93867f52" class="i property">UnsupportedCredential</a>, <b>nameof</b>(<span class="r41 r">credential</span>))
            };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Translates an </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/Azure.Core/A.html#ff9da284cd79b59b" class="t t">AzureNamedKeyCredential</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> into the equivalent shared access signature credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The credential to translate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">fullyQualifiedNamespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fully qualified Service Bus namespace being connected to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">entityPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path of the entity being connected to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">transportType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of transport being used for the connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Authorization/SharedAccessCredential.cs.html#c63e778f05acc6e2" class="t t">SharedAccessCredential</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> which the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">credential</span><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> was translated into.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private static</b> <a href="../Authorization/SharedAccessCredential.cs.html#c63e778f05acc6e2" class="t t">SharedAccessCredential</a> <a id="c4c8509d06f0dc98" href="../R/c4c8509d06f0dc98.html" target="n" data-glyph="76,1" class="i method">TranslateNamedKeyCredential</a>(
            <a href="/Azure.Core/A.html#ff9da284cd79b59b" class="t t">AzureNamedKeyCredential</a> <span id="r46 rd" class="r46 r">credential</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r47 rd" class="r47 r">fullyQualifiedNamespace</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r48 rd" class="r48 r">entityPath</span>,
            <a href="ServiceBusTransportType.cs.html#b07ef16e21fea68e" class="t t">ServiceBusTransportType</a> <span id="r49 rd" class="r49 r">transportType</span>) =&gt;
               <b>new</b> <a href="../Authorization/SharedAccessCredential.cs.html#4848f709b01a60c6" class="t constructor">SharedAccessCredential</a>(<span class="r46 r">credential</span>, <a href="#cb4206079cf16f03" class="i method">BuildConnectionResource</a>(<span class="r49 r">transportType</span>, <span class="r47 r">fullyQualifiedNamespace</span>, <span class="r48 r">entityPath</span>));
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Performs the actions needed to validate the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> associated</span>
        <span class="c">///</span><span class="c">   with this client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">connectionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of options to validate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   In the case that the options violate an invariant or otherwise represent a combination that</span>
        <span class="c">///</span><span class="c">   is not permissible, an appropriate exception will be thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private static void</b> <a id="cc2015a1b43a6d44" href="../R/cc2015a1b43a6d44.html" target="n" data-glyph="76,1" class="i method">ValidateConnectionOptions</a>(<a href="../Client/ServiceBusClientOptions.cs.html#5281daacdf25ac92" class="t t">ServiceBusClientOptions</a> <span id="r50 rd" class="r50 r">connectionOptions</span>)
        {
            <span class="c">// If there were no options passed, they cannot be in an invalid state.</span>
 
            <b>if</b> (<span class="r50 r">connectionOptions</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="c">// A proxy is only valid when web sockets is used as the transport.</span>
 
            <b>if</b> ((!<span class="r50 r">connectionOptions</span>.<a href="../Client/ServiceBusClientOptions.cs.html#beccbe5f47fe4d95" class="i property">TransportType</a>.<a href="../Core/TransportTypeExtensions.cs.html#74769f5a3f30ed15" class="i method">IsWebSocketTransport</a>()) &amp;&amp; (<span class="r50 r">connectionOptions</span>.<a href="../Client/ServiceBusClientOptions.cs.html#91c69f48952f0b0c" class="i property">WebProxy</a> != <b>null</b>))
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>(<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#691a34e179b91fdb" class="i method">Format</a>(<a href="@1@netstandard/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@netstandard/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <a href="../Resources.Designer.cs.html#7e6b2ac45384f6a8" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#b751fc937cd84f73" class="i property">ProxyMustUseWebSockets</a>), <b>nameof</b>(<span class="r50 r">connectionOptions</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   Performs the actions needed to validate the set of connection string properties for connecting to the</span>
        <span class="c">///</span><span class="c">   Service Bus service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">connectionStringProperties</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of connection string properties to validate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">connectionStringArgumentName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the argument associated with the connection string; to be used when raising </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a><span class="c">&quot;</span> <span class="c">/&gt;</span><span class="c"> variants.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@1@netstandard/A.html#109b3ef6299ef9df" class="t t">ArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">In the case that the properties violate an invariant or otherwise represent a combination that is not permissible, an appropriate exception will be thrown.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>private static void</b> <a id="855403e2d1c4cf76" href="../R/855403e2d1c4cf76.html" target="n" data-glyph="76,1" class="i method">ValidateConnectionStringProperties</a>(
            <a href="ServiceBusConnectionStringProperties.cs.html#b011974d70d9c929" class="t t">ServiceBusConnectionStringProperties</a> <span id="r51 rd" class="r51 r">connectionStringProperties</span>,
            <a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r52 rd" class="r52 r">connectionStringArgumentName</span>)
        {
            <a href="@1@netstandard/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r53 rd" class="r53 r">hasSharedKey</span> = ((!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r51 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#b51acce87d7adfd2" class="i property">SharedAccessKeyName</a>)) &amp;&amp; (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r51 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#a9d7834911da1b51" class="i property">SharedAccessKey</a>)));
            <a href="@1@netstandard/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r54 rd" class="r54 r">hasSharedSignature</span> = (!<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r51 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#12d390919cf49ab3" class="i property">SharedAccessSignature</a>));
 
            <span class="c">// Ensure that each of the needed components are present for connecting.</span>
 
            <b>if</b> ((<a href="@1@netstandard/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@netstandard/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r51 r">connectionStringProperties</span>.<a href="ServiceBusConnectionStringProperties.cs.html#3a46b590394b2830" class="i property">Endpoint</a>?.<a href="@1@netstandard/A.html#c230833968da7179" class="i property">Host</a>))
                || ((!<span class="r53 r">hasSharedKey</span>) &amp;&amp; (!<span class="r54 r">hasSharedSignature</span>)))
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>(<a href="../Resources.Designer.cs.html#7e6b2ac45384f6a8" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#28e846e124baa15d" class="i property">MissingConnectionInformation</a>, <span class="r52 r">connectionStringArgumentName</span>);
            }
 
            <span class="c">// The connection string may contain a precomputed shared access signature OR a shared key name and value,</span>
            <span class="c">// but not both.</span>
 
            <b>if</b> (<span class="r53 r">hasSharedKey</span> &amp;&amp; <span class="r54 r">hasSharedSignature</span>)
            {
                <b>throw</b> <b>new</b> <a href="@1@netstandard/A.html#4b20cd3790b6426a" class="t constructor">ArgumentException</a>(<a href="../Resources.Designer.cs.html#7e6b2ac45384f6a8" class="t t">Resources</a>.<a href="../Resources.Designer.cs.html#807e732929184512" class="i property">OnlyOneSharedAccessAuthorizationMayBeSpecified</a>, <span class="r52 r">connectionStringArgumentName</span>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
