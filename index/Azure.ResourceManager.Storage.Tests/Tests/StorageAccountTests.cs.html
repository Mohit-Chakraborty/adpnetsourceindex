<!DOCTYPE html>
<html><head><title>StorageAccountTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1821);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.ResourceManager.Storage.Tests/Tests/StorageAccountTests.cs" target="_top">Tests\StorageAccountTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.ResourceManager.Storage.Tests" target="_top">tests\Azure.ResourceManager.Storage.Tests.csproj</a> (Azure.ResourceManager.Storage.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
 
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Storage</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Storage</span>.<span class="i n">Tests</span>.<span class="i n">Helpers</span>;
 
<b>using</b> <span class="i">NUnit</span>.<span class="i">Framework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">ResourceManager</span>.<span class="i n">Storage</span>.<span class="i n">Tests</span>.<span class="i n">Tests</span>
{
    [<span class="i">RunFrequency</span>(<a href="/Azure.Core.TestFramework/A.html#fd69b424cd3d052f" class="t t">RunTestFrequency</a>.<a href="/Azure.Core.TestFramework/A.html#852e7a9329ae7142" class="i field">Manually</a>)]
    <b>public class</b> <a id="1fc1672c310c20d6" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">StorageAccountTests</a> : <a href="../Helpers/StorageTestsManagementClientBase.cs.html#6f90a201c6961bfa" class="t t">StorageTestsManagementClientBase</a>
    {
        <b>public</b> <a id="46f8fcfe3d33fa15" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">StorageAccountTests</a>(<b>bool</b> <span id="r0 rd" class="r0 r">isAsync</span>) : <a href="../Helpers/StorageTestsManagementClientBase.cs.html#214c77efd9a48f51" class="k">base</a>(<span class="r0 r">isAsync</span>)
        {
        }
 
        [<span class="i">SetUp</span>]
        <b>public void</b> <a id="51e372b0b4014aad" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ClearChallengeCacheforRecord</a>()
        {
            <b>if</b> (<a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> == <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#62f98a4a2b1d56c3" class="i field">Record</a> || <a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> == <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#bde4663b03b59b85" class="i field">Playback</a>)
            {
                <a href="../Helpers/StorageTestsManagementClientBase.cs.html#9cbc567a8619de48" class="i method">Initialize</a>();
            }
        }
 
        [<span class="i">TearDown</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3b045367d909c58b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CleanupResourceGroup</a>()
        {
            <b>await</b> <a href="../TestShared/ManagementRecordedTestBase.cs.html#e05feca36660f887" class="i method">CleanupResourceGroupsAsync</a>();
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="8fb267f2afdd5301" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateTest</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r2 rd" class="r2 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">accountName1</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r4 rd" class="r4 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r1 r">rgname</span>, <span class="r2 r">accountName</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r4 r">account</span>, <b>true</b>);
 
            <span class="c">//Make sure a second create returns immediately</span>
            <span class="r4 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r1 r">rgname</span>, <span class="r2 r">accountName</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r4 r">account</span>, <b>true</b>);
 
            <span class="c">//Create storage account with only required params</span>
            <span class="r4 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r1 r">rgname</span>, <span class="r3 r">accountName1</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r4 r">account</span>, <b>false</b>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="9644997ca668330f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateWithEncryptionTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r5 rd" class="r5 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">//Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r7 rd" class="r7 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>();
            <span class="r7 r">parameters</span>.<span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
            {
                <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span> { <span class="i">Blob</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> }, <span class="i">File</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> } }
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r8 rd" class="r8 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r5 r">rgname</span>, <span class="r6 r">accountName</span>, <span class="r7 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r8 r">account</span>, <b>true</b>);
 
            <span class="c">//Verify encryption settings</span>
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <b>if</b> (<b>null</b> != <span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>)
            {
                <b>if</b> (<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>.<span class="i">HasValue</span>);
                }
            }
 
            <b>if</b> (<b>null</b> != <span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>)
            {
                <b>if</b> (<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r8 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>.<span class="i">HasValue</span>);
                }
            }
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="8393712c753f00e4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateWithAccessTierTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r11 rd" class="r11 r">accountName1</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">//Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r12 rd" class="r12 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r13 r">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>);
            <span class="r12 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#788aabfefa8de2dd" class="i property">AccessTier</a> = <a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#0db2c9ea7ac9fa9e" class="i field">Hot</a>;
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r14 rd" class="r14 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r9 r">rgname</span>, <span class="r10 r">accountName</span>, <span class="r12 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r14 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#0db2c9ea7ac9fa9e" class="i field">Hot</a>, <span class="r14 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#d7fcbac832785a54" class="i property">AccessTier</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>, <span class="r14 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ca8827b4c95b78a6" class="i property">Kind</a>);
 
            <span class="c">//Create storage account with cool</span>
            <span class="r12 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r13 r">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>);
            <span class="r12 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#788aabfefa8de2dd" class="i property">AccessTier</a> = <a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#faf7989f8ac6a90f" class="i field">Cool</a>;
            <span class="r14 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r9 r">rgname</span>, <span class="r11 r">accountName1</span>, <span class="r12 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r14 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#faf7989f8ac6a90f" class="i field">Cool</a>, <span class="r14 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#d7fcbac832785a54" class="i property">AccessTier</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>, <span class="r14 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ca8827b4c95b78a6" class="i property">Kind</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="15746bfbc8cbeaf9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountBeginCreateTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r15 rd" class="r15 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r16 rd" class="r16 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">//Create storage account</span>
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r15 r">rgname</span>, <span class="r16 r">accountName</span>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="306f40b0e45536c6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountDeleteTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">//Delete an account which does not exist</span>
            <b>await</b> <a href="#e0d6f47a6b24f6ef" class="i method">DeleteStorageAccountAsync</a>(<span class="r17 r">rgname</span>, <span class="s">&quot;missingaccount&quot;</span>);
 
            <span class="c">//Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r18 rd" class="r18 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r17 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">//Delete an account</span>
            <b>await</b> <a href="#e0d6f47a6b24f6ef" class="i method">DeleteStorageAccountAsync</a>(<span class="r17 r">rgname</span>, <span class="r18 r">accountName</span>);
 
            <span class="c">//Delete an account which was just deleted</span>
            <b>await</b> <a href="#e0d6f47a6b24f6ef" class="i method">DeleteStorageAccountAsync</a>(<span class="r17 r">rgname</span>, <span class="r18 r">accountName</span>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="6e1d3505c780628c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountGetStandardTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r19 rd" class="r19 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r21 rd" class="r21 r">accountName1</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r22 rd" class="r22 r">accountName2</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r23 rd" class="r23 r">accountName3</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create and get a LRS storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r24 rd" class="r24 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>));
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r19 r">rgname</span>, <span class="r20 r">accountName</span>, <span class="r24 r">parameters</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r26 rd" class="r26 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r19 r">rgname</span>, <span class="r20 r">accountName</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r26 r">account</span>, <b>false</b>);
 
            <span class="c">// Create and get a GRS storage account</span>
            <span class="r24 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e067bc77001bae0" class="i property">StandardGRS</a>));
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r19 r">rgname</span>, <span class="r21 r">accountName1</span>, <span class="r24 r">parameters</span>);
            <span class="r26 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r19 r">rgname</span>, <span class="r21 r">accountName1</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r26 r">account</span>, <b>true</b>);
 
            <span class="c">// Create and get a RAGRS storage account</span>
            <span class="r24 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#15fd5618a498cdbb" class="i property">StandardRagrs</a>));
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r19 r">rgname</span>, <span class="r22 r">accountName2</span>, <span class="r24 r">parameters</span>);
            <span class="r26 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r19 r">rgname</span>, <span class="r22 r">accountName2</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r26 r">account</span>, <b>false</b>);
 
            <span class="c">// Create and get a ZRS storage account</span>
            <span class="r24 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#fa191a3b6d3415ac" class="i property">StandardZRS</a>));
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r19 r">rgname</span>, <span class="r23 r">accountName3</span>, <span class="r24 r">parameters</span>);
            <span class="r26 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r19 r">rgname</span>, <span class="r23 r">accountName3</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r26 r">account</span>, <b>false</b>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d633859cabd8c18c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountGetBlobTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r27 rd" class="r27 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r28 rd" class="r28 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r29 rd" class="r29 r">accountName1</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r30 rd" class="r30 r">accountName2</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create and get a blob LRS storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r31 rd" class="r31 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>), <span class="r13 r">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>);
            <span class="r31 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#788aabfefa8de2dd" class="i property">AccessTier</a> = <a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#0db2c9ea7ac9fa9e" class="i field">Hot</a>;
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r27 r">rgname</span>, <span class="r28 r">accountName</span>, <span class="r31 r">parameters</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r32 rd" class="r32 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r27 r">rgname</span>, <span class="r28 r">accountName</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r32 r">account</span>, <b>false</b>);
 
            <span class="c">// Create and get a blob GRS storage account</span>
            <span class="r31 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e067bc77001bae0" class="i property">StandardGRS</a>), <span class="r13 r">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>);
            <span class="r31 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#788aabfefa8de2dd" class="i property">AccessTier</a> = <a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#0db2c9ea7ac9fa9e" class="i field">Hot</a>;
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r27 r">rgname</span>, <span class="r29 r">accountName1</span>, <span class="r31 r">parameters</span>);
            <span class="r32 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r27 r">rgname</span>, <span class="r29 r">accountName1</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r32 r">account</span>, <b>false</b>);
 
            <span class="c">// Create and get a blob RAGRS storage account</span>
            <span class="r31 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#15fd5618a498cdbb" class="i property">StandardRagrs</a>), <span class="r13 r">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>);
            <span class="r31 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#788aabfefa8de2dd" class="i property">AccessTier</a> = <a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#0db2c9ea7ac9fa9e" class="i field">Hot</a>;
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r27 r">rgname</span>, <span class="r30 r">accountName2</span>, <span class="r31 r">parameters</span>);
            <span class="r32 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r27 r">rgname</span>, <span class="r30 r">accountName2</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r32 r">account</span>, <b>false</b>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="4187044de9a6614f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountGetPremiumTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r33 rd" class="r33 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r34 rd" class="r34 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create and get a Premium LRS storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r35 rd" class="r35 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>), <span class="r13 r">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>);
            <span class="r35 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#788aabfefa8de2dd" class="i property">AccessTier</a> = <a href="/Azure.ResourceManager.Storage/A.html#9407fd50d2383b84" class="t t">AccessTier</a>.<a href="/Azure.ResourceManager.Storage/A.html#0db2c9ea7ac9fa9e" class="i field">Hot</a>;
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r33 r">rgname</span>, <span class="r34 r">accountName</span>, <span class="r35 r">parameters</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r36 rd" class="r36 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r33 r">rgname</span>, <span class="r34 r">accountName</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r36 r">account</span>, <b>false</b>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="85e815de2cfb8754" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListByResourceGroupTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r37 rd" class="r37 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">//List by resource group</span>
            <span class="i">AsyncPageable</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r38 rd" class="r38 r">accountlistAP</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListByResourceGroupAsync</span>(<span class="r37 r">rgname</span>);
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r39 rd" class="r39 r">accountlist</span> = <b>await</b> <span class="r38 r">accountlistAP</span>.<span class="i">ToEnumerableAsync</span>();
            <span class="i">Assert</span>.<span class="i">False</span>(<span class="r39 r">accountlist</span>.<a href="@0@System.Core/A.html#8788153112b7ffd0" class="i method">Any</a>());
 
            <span class="c">// Create storage accounts</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r40 rd" class="r40 r">accountName1</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r37 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r41 rd" class="r41 r">accountName2</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r37 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
            <span class="r38 r">accountlistAP</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListByResourceGroupAsync</span>(<span class="r37 r">rgname</span>);
            <span class="r39 r">accountlist</span> = <b>await</b> <span class="r38 r">accountlistAP</span>.<span class="i">ToEnumerableAsync</span>();
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(2, <span class="r39 r">accountlist</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
 
            <b>foreach</b> (<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r42 rd" class="r42 r">account</span> <b>in</b> <span class="r39 r">accountlist</span>)
            {
                <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r42 r">account</span>, <b>true</b>);
            }
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5ca3203391e65d91" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListWithEncryptionTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r43 rd" class="r43 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r44 rd" class="r44 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r45 rd" class="r45 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>();
            <span class="r45 r">parameters</span>.<span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
            {
                <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span> { <span class="i">Blob</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> }, <span class="i">File</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> } }
            };
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r43 r">rgname</span>, <span class="r44 r">accountName</span>, <span class="r45 r">parameters</span>);
 
            <span class="c">// List account and verify</span>
            <span class="i">AsyncPageable</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r46 rd" class="r46 r">accounts</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListByResourceGroupAsync</span>(<span class="r43 r">rgname</span>);
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r47 rd" class="r47 r">accountlist</span> = <b>await</b> <span class="r46 r">accounts</span>.<span class="i">ToEnumerableAsync</span>();
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(1, <span class="r47 r">accountlist</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
 
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r48 rd" class="r48 r">account</span> = <span class="r47 r">accountlist</span>.<a href="@0@mscorlib/A.html#d4409b7542728cec" class="i method">ToArray</a>()[0];
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r48 r">account</span>, <b>true</b>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <b>if</b> (<b>null</b> != <span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>)
            {
                <b>if</b> (<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>.<span class="i">HasValue</span>);
                }
            }
 
            <b>if</b> (<b>null</b> != <span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>)
            {
                <b>if</b> (<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r48 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>.<span class="i">HasValue</span>);
                }
            }
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3adc5c42c9f75ce4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListBySubscriptionTest</a>()
        {
            <span class="c">// Create resource group and storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r49 rd" class="r49 r">rgname1</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r50 rd" class="r50 r">accountName1</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r49 r">rgname1</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// Create different resource group and storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r51 rd" class="r51 r">rgname2</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r52 rd" class="r52 r">accountName2</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r51 r">rgname2</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="i">AsyncPageable</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r53 rd" class="r53 r">accountlist</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListAsync</span>();
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r54 rd" class="r54 r">accountlists</span> = <span class="r53 r">accountlist</span>.<span class="i">ToEnumerableAsync</span>().<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>;
 
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r55 rd" class="r55 r">account1</span> = <span class="r54 r">accountlists</span>.<span class="i">First</span>(
                    <span id="r56 rd" class="r56 r">t</span> =&gt; <a href="@0@mscorlib/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@0@mscorlib/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>.<a href="@0@mscorlib/A.html#a534bd7d703fa948" class="i method">Equals</a>(<span class="r56 r">t</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>, <span class="r50 r">accountName1</span>));
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r55 r">account1</span>, <b>true</b>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r57 rd" class="r57 r">account2</span> = <span class="r54 r">accountlists</span>.<span class="i">First</span>(
                    <span id="r58 rd" class="r58 r">t</span> =&gt; <a href="@0@mscorlib/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@0@mscorlib/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>.<a href="@0@mscorlib/A.html#a534bd7d703fa948" class="i method">Equals</a>(<span class="r58 r">t</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>, <span class="r52 r">accountName2</span>));
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r57 r">account2</span>, <b>true</b>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5f0cc375f68e760d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListKeysTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r59 rd" class="r59 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r60 rd" class="r60 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r59 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// List keys</span>
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#7d48b029207c51a5" class="t t">StorageAccountListKeysResult</a>&gt; <span id="r61 rd" class="r61 r">keys</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListKeysAsync</span>(<span class="r59 r">rgname</span>, <span class="r60 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r61 r">keys</span>);
 
            <span class="c">// Validate Key1</span>
            <a href="/Azure.ResourceManager.Storage/A.html#1c1e266e71b0c121" class="t t">StorageAccountKey</a> <span id="r62 rd" class="r62 r">key1</span> = <span class="r61 r">keys</span>.<span class="i">Value</span>.<span class="i">Keys</span>.<span class="i">First</span>(
                <span id="r63 rd" class="r63 r">t</span> =&gt; <a href="@0@mscorlib/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@0@mscorlib/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>.<span class="i">Equals</span>(<span class="r63 r">t</span>.<span class="i">KeyName</span>, <span class="s">&quot;key1&quot;</span>));
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r62 r">key1</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#cb19c19be4a9e038" class="t t">KeyPermission</a>.<a href="/Azure.ResourceManager.Storage/A.html#a99c851832e974da" class="i field">Full</a>, <span class="r62 r">key1</span>.<a href="/Azure.ResourceManager.Storage/A.html#43608f93de48957c" class="i property">Permissions</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r62 r">key1</span>.<a href="/Azure.ResourceManager.Storage/A.html#499d6e2751b003f4" class="i property">Value</a>);
 
            <span class="c">// Validate Key2</span>
            <a href="/Azure.ResourceManager.Storage/A.html#1c1e266e71b0c121" class="t t">StorageAccountKey</a> <span id="r64 rd" class="r64 r">key2</span> = <span class="r61 r">keys</span>.<span class="i">Value</span>.<span class="i">Keys</span>.<span class="i">First</span>(
                <span id="r65 rd" class="r65 r">t</span> =&gt; <a href="@0@mscorlib/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@0@mscorlib/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>.<span class="i">Equals</span>(<span class="r65 r">t</span>.<span class="i">KeyName</span>, <span class="s">&quot;key2&quot;</span>));
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r64 r">key2</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#cb19c19be4a9e038" class="t t">KeyPermission</a>.<a href="/Azure.ResourceManager.Storage/A.html#a99c851832e974da" class="i field">Full</a>, <span class="r64 r">key2</span>.<a href="/Azure.ResourceManager.Storage/A.html#43608f93de48957c" class="i property">Permissions</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r64 r">key2</span>.<a href="/Azure.ResourceManager.Storage/A.html#499d6e2751b003f4" class="i property">Value</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="deab9878c5cf207c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountRegenerateKeyTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r66 rd" class="r66 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r67 rd" class="r67 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r66 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// List keys</span>
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#7d48b029207c51a5" class="t t">StorageAccountListKeysResult</a>&gt; <span id="r68 rd" class="r68 r">keys</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListKeysAsync</span>(<span class="r66 r">rgname</span>, <span class="r67 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r68 r">keys</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#1c1e266e71b0c121" class="t t">StorageAccountKey</a> <span id="r69 rd" class="r69 r">key2</span> = <span class="r68 r">keys</span>.<span class="i">Value</span>.<span class="i">Keys</span>.<span class="i">First</span>(
                <span id="r70 rd" class="r70 r">t</span> =&gt; <a href="@0@mscorlib/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@0@mscorlib/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>.<span class="i">Equals</span>(<span class="r70 r">t</span>.<span class="i">KeyName</span>, <span class="s">&quot;key2&quot;</span>));
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r69 r">key2</span>);
 
            <span class="c">// Regenerate keys and verify that keys change</span>
            <a href="/Azure.ResourceManager.Storage/A.html#8752729e2b8e425f" class="t t">StorageAccountRegenerateKeyParameters</a> <span id="r71 rd" class="r71 r">keyParameters</span> = <b>new</b> <span class="t">StorageAccountRegenerateKeyParameters</span>(<span class="s">&quot;key2&quot;</span>);
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#7d48b029207c51a5" class="t t">StorageAccountListKeysResult</a>&gt; <span id="r72 rd" class="r72 r">regenKeys</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">RegenerateKeyAsync</span>(<span class="r66 r">rgname</span>, <span class="r67 r">accountName</span>, <span class="r71 r">keyParameters</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#1c1e266e71b0c121" class="t t">StorageAccountKey</a> <span id="r73 rd" class="r73 r">key2Regen</span> = <span class="r72 r">regenKeys</span>.<span class="i">Value</span>.<span class="i">Keys</span>.<span class="i">First</span>(
                <span id="r74 rd" class="r74 r">t</span> =&gt; <a href="@0@mscorlib/A.html#a1c3d85bbf4ae20e" class="t t">StringComparer</a>.<a href="@0@mscorlib/A.html#59b9c33842417944" class="i property">OrdinalIgnoreCase</a>.<span class="i">Equals</span>(<span class="r74 r">t</span>.<span class="i">KeyName</span>, <span class="s">&quot;key2&quot;</span>));
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r73 r">key2Regen</span>);
 
            <span class="c">// Validate key was regenerated</span>
            <span class="i">Assert</span>.<span class="i">AreNotEqual</span>(<span class="r69 r">key2</span>.<a href="/Azure.ResourceManager.Storage/A.html#499d6e2751b003f4" class="i property">Value</a>, <span class="r73 r">key2Regen</span>.<a href="/Azure.ResourceManager.Storage/A.html#499d6e2751b003f4" class="i property">Value</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="cdac2dcf0d43f002" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountRevokeUserDelegationKeysTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r75 rd" class="r75 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r76 rd" class="r76 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r75 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// Revoke User DelegationKeys</span>
            <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">RevokeUserDelegationKeysAsync</span>(<span class="r75 r">rgname</span>, <span class="r76 r">accountName</span>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="f118febdc569db44" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCheckNameTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r77 rd" class="r77 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r78 rd" class="r78 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Check valid name</span>
            <a href="/Azure.ResourceManager.Storage/A.html#2fc592c9f1a07267" class="t t">StorageAccountCheckNameAvailabilityParameters</a> <span id="r79 rd" class="r79 r">storageAccountCheckNameAvailabilityParameters</span> = <b>new</b> <span class="t">StorageAccountCheckNameAvailabilityParameters</span>(<span class="r78 r">accountName</span>);
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#eddd6e789b802dbe" class="t t">CheckNameAvailabilityResult</a>&gt; <span id="r80 rd" class="r80 r">checkNameRequest</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">CheckNameAvailabilityAsync</span>(<span class="r79 r">storageAccountCheckNameAvailabilityParameters</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">NameAvailable</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">Reason</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">Message</span>);
 
            <span class="c">// Check invalid name</span>
            <span class="r79 r">storageAccountCheckNameAvailabilityParameters</span> = <b>new</b> <span class="t">StorageAccountCheckNameAvailabilityParameters</span>(<span class="s">&quot;CAPS&quot;</span>);
            <span class="r80 r">checkNameRequest</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">CheckNameAvailabilityAsync</span>(<span class="r79 r">storageAccountCheckNameAvailabilityParameters</span>);
            <span class="i">Assert</span>.<span class="i">False</span>(<span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">NameAvailable</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3aff3b08c4f294e7" class="t t">Reason</a>.<a href="/Azure.ResourceManager.Storage/A.html#816b953efb405783" class="i field">AccountNameInvalid</a>, <span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">Reason</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;CAPS is not a valid storage account name. Storage account name must be between 3 and 24 &quot;</span>
                + <span class="s">&quot;characters in length and use numbers and lower-case letters only.&quot;</span>, <span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">Message</span>);
 
            <span class="c">// Check name of account that already exists</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r81 rd" class="r81 r">accountName1</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r77 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
            <span class="r79 r">storageAccountCheckNameAvailabilityParameters</span> = <b>new</b> <span class="t">StorageAccountCheckNameAvailabilityParameters</span>(<span class="r81 r">accountName1</span>);
            <span class="r80 r">checkNameRequest</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">CheckNameAvailabilityAsync</span>(<span class="r79 r">storageAccountCheckNameAvailabilityParameters</span>);
            <span class="i">Assert</span>.<span class="i">False</span>(<span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">NameAvailable</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3aff3b08c4f294e7" class="t t">Reason</a>.<a href="/Azure.ResourceManager.Storage/A.html#28da2141c066a6a9" class="i field">AlreadyExists</a>, <span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">Reason</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;The storage account named &quot;</span> + <span class="r81 r">accountName1</span> + <span class="s">&quot; is already taken.&quot;</span>, <span class="r80 r">checkNameRequest</span>.<span class="i">Value</span>.<span class="i">Message</span>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="546897bc44f9969f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountUpdateWithCreateTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r82 rd" class="r82 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r83 rd" class="r83 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r82 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// Update storage account type</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r84 rd" class="r84 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>(<span class="r25 r">sku</span>: <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>));
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r85 rd" class="r85 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r82 r">rgname</span>, <span class="r83 r">accountName</span>, <span class="r84 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r85 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
 
            <span class="c">// Validate</span>
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r86 rd" class="r86 r">accountProerties</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r82 r">rgname</span>, <span class="r83 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Sku</span>.<span class="i">Name</span>);
 
            <span class="c">// Update storage tags</span>
            <span class="c">// Update storage tags</span>
            <span class="r84 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#0ca6e3c4073080d0" class="i property">Tags</a>.<span class="i">Clear</span>();
            <span class="r84 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#0ca6e3c4073080d0" class="i property">Tags</a>.<span class="i">Add</span>(<span class="s">&quot;key3&quot;</span>, <span class="s">&quot;value3&quot;</span>);
            <span class="r84 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#0ca6e3c4073080d0" class="i property">Tags</a>.<span class="i">Add</span>(<span class="s">&quot;key4&quot;</span>, <span class="s">&quot;value4&quot;</span>);
            <span class="r84 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#0ca6e3c4073080d0" class="i property">Tags</a>.<span class="i">Add</span>(<span class="s">&quot;key5&quot;</span>, <span class="s">&quot;value6&quot;</span>);
 
            <span class="r85 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r82 r">rgname</span>, <span class="r83 r">accountName</span>, <span class="r84 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r85 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#4c01979f7482f4e5" class="i property">Tags</a>.<span class="i">Count</span>, <span class="r84 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#0ca6e3c4073080d0" class="i property">Tags</a>.<span class="i">Count</span>);
 
            <span class="c">// Validate</span>
            <span class="r86 r">accountProerties</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r82 r">rgname</span>, <span class="r83 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Tags</span>.<span class="i">Count</span>, <span class="r84 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#0ca6e3c4073080d0" class="i property">Tags</a>.<span class="i">Count</span>);
 
            <span class="c">// Update storage encryption</span>
            <span class="r84 r">parameters</span>.<span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
            {
                <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span> { <span class="i">Blob</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> }, <span class="i">File</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> } }
            };
            <span class="r85 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r82 r">rgname</span>, <span class="r83 r">accountName</span>, <span class="r84 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r85 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
 
            <span class="c">// Validate</span>
            <span class="r86 r">accountProerties</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r82 r">rgname</span>, <span class="r83 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Blob</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Blob</span>.<span class="i">Enabled</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Blob</span>.<span class="i">LastEnabledTime</span>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">File</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">File</span>.<span class="i">Enabled</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">File</span>.<span class="i">LastEnabledTime</span>);
 
            <b>if</b> (<b>null</b> != <span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Table</span>)
            {
                <b>if</b> (<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Table</span>.<span class="i">Enabled</span>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Table</span>.<span class="i">LastEnabledTime</span>.<span class="i">HasValue</span>);
                }
            }
 
            <b>if</b> (<b>null</b> != <span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Queue</span>)
            {
                <b>if</b> (<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Queue</span>.<span class="i">Enabled</span>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r86 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Queue</span>.<span class="i">LastEnabledTime</span>.<span class="i">HasValue</span>);
                }
            }
 
            <span class="c">// Update storage custom domains</span>
            <span class="r84 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>();
            <span class="r84 r">parameters</span>.<span class="i">CustomDomain</span> = <b>new</b> <span class="t">CustomDomain</span>(<span class="s">&quot;foo.example.com&quot;</span>) { <a href="/Azure.ResourceManager.Storage/A.html#6bbba4383747a644" class="i property">UseSubDomainName</a> = <b>true</b> };
            <b>try</b>
            {
                <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">StartCreateAsync</span>(<span class="r82 r">rgname</span>, <span class="r83 r">accountName</span>, <span class="r84 r">parameters</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<b>false</b>, <span class="s">&quot;This request should fail with the below code.&quot;</span>);
            }
            <b>catch</b> (<span class="i">RequestFailedException</span> <span id="r87 rd" class="r87 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">AreEqual</span>((<b>int</b>)<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#a387765e716ffb3c" class="i field">Conflict</a>, <span class="r87 r">ex</span>.<span class="i">Status</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r87 r">ex</span>.<span class="i">Message</span> != <b>null</b> &amp;&amp; <span class="r87 r">ex</span>.<span class="i">Message</span>.<span class="i">Contains</span>(<span class="s">&quot;The custom domain name could not be verified. CNAME mapping from foo.example.com to&quot;</span>));
            }
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="83d092a7f27af4db" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountUpdateTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r88 rd" class="r88 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r89 rd" class="r89 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r88 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// Update storage account type</span>
            <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r90 rd" class="r90 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>()
            {
                <span class="i">Sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>),
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r91 rd" class="r91 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r88 r">rgname</span>, <span class="r89 r">accountName</span>, <span class="r90 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r91 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
 
            <span class="c">// Validate</span>
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r92 rd" class="r92 r">accountProerties</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r88 r">rgname</span>, <span class="r89 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Sku</span>.<span class="i">Name</span>);
 
            <span class="c">// Update storage tags</span>
            <span class="r90 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Clear</span>();
            <span class="r90 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Add</span>(<span class="s">&quot;key3&quot;</span>, <span class="s">&quot;value3&quot;</span>);
            <span class="r90 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Add</span>(<span class="s">&quot;key4&quot;</span>, <span class="s">&quot;value4&quot;</span>);
            <span class="r90 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Add</span>(<span class="s">&quot;key5&quot;</span>, <span class="s">&quot;value6&quot;</span>);
 
            <span class="r91 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r88 r">rgname</span>, <span class="r89 r">accountName</span>, <span class="r90 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r91 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#4c01979f7482f4e5" class="i property">Tags</a>.<span class="i">Count</span>, <span class="r90 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Count</span>);
 
            <span class="c">// Validate</span>
            <span class="r92 r">accountProerties</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r88 r">rgname</span>, <span class="r89 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Tags</span>.<span class="i">Count</span>, <span class="r90 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Count</span>);
 
            <span class="c">// Update storage encryption</span>
            <span class="r90 r">parameters</span>.<span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
            {
                <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span> { <span class="i">Blob</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> }, <span class="i">File</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> } }
            };
            <span class="r91 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r88 r">rgname</span>, <span class="r89 r">accountName</span>, <span class="r90 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r91 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
 
            <span class="c">// Validate</span>
            <span class="r92 r">accountProerties</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r88 r">rgname</span>, <span class="r89 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Blob</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Blob</span>.<span class="i">Enabled</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Blob</span>.<span class="i">LastEnabledTime</span>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">File</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">File</span>.<span class="i">Enabled</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">File</span>.<span class="i">LastEnabledTime</span>);
 
            <b>if</b> (<b>null</b> != <span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Table</span>)
            {
                <b>if</b> (<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Table</span>.<span class="i">Enabled</span>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Table</span>.<span class="i">LastEnabledTime</span>.<span class="i">HasValue</span>);
                }
            }
 
            <b>if</b> (<b>null</b> != <span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Queue</span>)
            {
                <b>if</b> (<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Queue</span>.<span class="i">Enabled</span>.<span class="i">HasValue</span>)
                {
                    <span class="i">Assert</span>.<span class="i">False</span>(<span class="r92 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Encryption</span>.<span class="i">Services</span>.<span class="i">Queue</span>.<span class="i">LastEnabledTime</span>.<span class="i">HasValue</span>);
                }
            }
 
            <span class="c">// Update storage custom domains</span>
            <span class="r90 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">CustomDomain</span> = <b>new</b> <span class="t">CustomDomain</span>(<span class="s">&quot;foo.example.com&quot;</span>)
                {
                    <a href="/Azure.ResourceManager.Storage/A.html#6bbba4383747a644" class="i property">UseSubDomainName</a> = <b>true</b>
                }
            };
 
            <b>try</b>
            {
                <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r88 r">rgname</span>, <span class="r89 r">accountName</span>, <span class="r90 r">parameters</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<b>false</b>, <span class="s">&quot;This request should fail with the below code.&quot;</span>);
            }
            <b>catch</b> (<span class="i">RequestFailedException</span> <span id="r93 rd" class="r93 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">AreEqual</span>((<b>int</b>)<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#a387765e716ffb3c" class="i field">Conflict</a>, <span class="r93 r">ex</span>.<span class="i">Status</span>);
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r93 r">ex</span>.<span class="i">Message</span> != <b>null</b> &amp;&amp; <span class="r93 r">ex</span>.<span class="i">Message</span>.<span class="i">Contains</span>(<span class="s">&quot;The custom domain name could not be verified. CNAME mapping from foo.example.com to&quot;</span>));
            }
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d48ac743d9bb92ab" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountUpdateMultipleTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r94 rd" class="r94 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r95 rd" class="r95 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r94 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// Update storage account type</span>
            <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r96 rd" class="r96 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>()
            {
                <span class="i">Sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>),
                <a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a> = { { <span class="s">&quot;key3&quot;</span>, <span class="s">&quot;value3&quot;</span> }, { <span class="s">&quot;key4&quot;</span>, <span class="s">&quot;value4&quot;</span> }, { <span class="s">&quot;key5&quot;</span>, <span class="s">&quot;value6&quot;</span> } }
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r97 rd" class="r97 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r94 r">rgname</span>, <span class="r95 r">accountName</span>, <span class="r96 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r97 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r97 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#4c01979f7482f4e5" class="i property">Tags</a>.<span class="i">Count</span>, <span class="r96 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Count</span>);
 
            <span class="c">// Validate</span>
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r98 rd" class="r98 r">accountProerties</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r94 r">rgname</span>, <span class="r95 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r98 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Sku</span>.<span class="i">Name</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r98 r">accountProerties</span>.<span class="i">Value</span>.<span class="i">Tags</span>.<span class="i">Count</span>, <span class="r96 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Count</span>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="16be04f8724925d4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountLocationUsageTest</a>()
        {
            <span class="c">// Query usage</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r99 rd" class="r99 r">Location</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#eea49042c36ee951" class="i field">DefaultLocation</a>;
            <span class="i">AsyncPageable</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#b3add06c3975fc6b" class="t t">Usage</a>&gt; <span id="r100 rd" class="r100 r">usages</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#6b30e1a418255073" class="i property">UsagesClient</a>.<span class="i">ListByLocationAsync</span>(<span class="r99 r">Location</span>);
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#b3add06c3975fc6b" class="t t">Usage</a>&gt; <span id="r101 rd" class="r101 r">usagelist</span> = <b>await</b> <span class="r100 r">usages</span>.<span class="i">ToEnumerableAsync</span>();
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(1, <span class="r101 r">usagelist</span>.<a href="@0@System.Core/A.html#41ef9e39e54d0d0b" class="i method">Count</a>());
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#e4fa684e85dd2719" class="t t">UsageUnit</a>.<a href="/Azure.ResourceManager.Storage/A.html#7ef34541460f0ceb" class="i field">Count</a>, <span class="r101 r">usagelist</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="/Azure.ResourceManager.Storage/A.html#d54780b0c426716d" class="i property">Unit</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">usagelist</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="/Azure.ResourceManager.Storage/A.html#0d0f6e1db7429097" class="i property">CurrentValue</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(250, <span class="r101 r">usagelist</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="/Azure.ResourceManager.Storage/A.html#fe33ad5dc2c2f710" class="i property">Limit</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r101 r">usagelist</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="/Azure.ResourceManager.Storage/A.html#3109c31158cbdd6e" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;StorageAccounts&quot;</span>, <span class="r101 r">usagelist</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="/Azure.ResourceManager.Storage/A.html#3109c31158cbdd6e" class="i property">Name</a>.<a href="/Azure.ResourceManager.Storage/A.html#e6a9e1d8f4c495a4" class="i property">Value</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;Storage Accounts&quot;</span>, <span class="r101 r">usagelist</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="/Azure.ResourceManager.Storage/A.html#3109c31158cbdd6e" class="i property">Name</a>.<a href="/Azure.ResourceManager.Storage/A.html#079c5d2ea6d7d0dc" class="i property">LocalizedValue</a>);
        }
 
        [<span class="i">Test</span>]
        [<span class="i">Ignore</span>(<span class="s">&quot;Track2: The function of &#39;ResourceProviderOperationDetails&#39; is not found in trach2 Management.Resource&quot;</span>)]
        <b>public void</b> <a id="f7890d4c3b26d0cb" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountGetOperationsTest</a>()
        {
            <span class="c">//var handler = new RecordedDelegatingHandler { StatusCodeToReturn = HttpStatusCode.OK };</span>
 
            <span class="c">//using (MockContext context = MockContext.Start(this.GetType()))</span>
            <span class="c">//{</span>
            <span class="c">//    var resourcesClient = GetResourceManagementClient(context, handler);</span>
            <span class="c">//    var ops = resourcesClient.ResourceProviderOperationDetails.List(&quot;Microsoft.Storage&quot;, &quot;2015-06-15&quot;);</span>
 
            <span class="c">//    Assert.True(ops.Count() &gt; 1);</span>
            <span class="c">//}</span>
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="4782aa6f4a6c1e22" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListAccountSASTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r102 rd" class="r102 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r103 rd" class="r103 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r102 r">rgname</span>, <span class="r103 r">accountName</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#d2a76e71b2688807" class="t t">AccountSasParameters</a> <span id="r104 rd" class="r104 r">accountSasParameters</span> = <b>new</b> <span class="t">AccountSasParameters</span>(<span class="i">services</span>: <span class="s">&quot;bftq&quot;</span>, <span class="i">resourceTypes</span>: <span class="s">&quot;sco&quot;</span>, <span class="i">permissions</span>: <span class="s">&quot;rdwlacup&quot;</span>, <span class="i">sharedAccessExpiryTime</span>: <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(1))
            {
                <a href="/Azure.ResourceManager.Storage/A.html#329dd7936e26407f" class="i property">Protocols</a> = <a href="/Azure.ResourceManager.Storage/A.html#f075c53502337ec5" class="t t">HttpProtocol</a>.<a href="/Azure.ResourceManager.Storage/A.html#1771925fe8810332" class="i field">HttpsHttp</a>,
                <a href="/Azure.ResourceManager.Storage/A.html#fdf35bd1ab56480c" class="i property">SharedAccessStartTime</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>,
                <a href="/Azure.ResourceManager.Storage/A.html#6814c2976befc751" class="i property">KeyToSign</a> = <span class="s">&quot;key1&quot;</span>
            };
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#d192c12932bd6a44" class="t t">ListAccountSasResponse</a>&gt; <span id="r105 rd" class="r105 r">result</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListAccountSASAsync</span>(<span class="r102 r">rgname</span>, <span class="r103 r">accountName</span>, <span class="r104 r">accountSasParameters</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#d2a76e71b2688807" class="t t">AccountSasParameters</a> <span id="r106 rd" class="r106 r">resultCredentials</span> = <span class="i">ParseAccountSASToken</span>(<span class="r105 r">result</span>.<span class="i">Value</span>.<span class="i">AccountSasToken</span>);
 
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r104 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#25afa0b174611acd" class="i property">Services</a>, <span class="r106 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#25afa0b174611acd" class="i property">Services</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r104 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#9ca119d4511349fa" class="i property">ResourceTypes</a>, <span class="r106 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#9ca119d4511349fa" class="i property">ResourceTypes</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r104 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#4d87982bea02776f" class="i property">Permissions</a>, <span class="r106 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#4d87982bea02776f" class="i property">Permissions</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r104 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#329dd7936e26407f" class="i property">Protocols</a>, <span class="r106 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#329dd7936e26407f" class="i property">Protocols</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r104 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#fdf35bd1ab56480c" class="i property">SharedAccessStartTime</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r104 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#cf35f75fa8dad2f0" class="i property">SharedAccessExpiryTime</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="1ebc37ebe1454a6f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListAccountSASWithDefaultProperties</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r107 rd" class="r107 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r108 rd" class="r108 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r107 r">rgname</span>, <span class="r108 r">accountName</span>);
 
            <span class="c">// Test for default values of sas credentials.</span>
            <a href="/Azure.ResourceManager.Storage/A.html#d2a76e71b2688807" class="t t">AccountSasParameters</a> <span id="r109 rd" class="r109 r">accountSasParameters</span> = <b>new</b> <span class="t">AccountSasParameters</span>(<span class="i">services</span>: <span class="s">&quot;b&quot;</span>, <span class="i">resourceTypes</span>: <span class="s">&quot;sco&quot;</span>, <span class="i">permissions</span>: <span class="s">&quot;rl&quot;</span>, <span class="i">sharedAccessExpiryTime</span>: <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(1));
 
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#d192c12932bd6a44" class="t t">ListAccountSasResponse</a>&gt; <span id="r110 rd" class="r110 r">result</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListAccountSASAsync</span>(<span class="r107 r">rgname</span>, <span class="r108 r">accountName</span>, <span class="r109 r">accountSasParameters</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#d2a76e71b2688807" class="t t">AccountSasParameters</a> <span id="r111 rd" class="r111 r">resultCredentials</span> = <span class="i">ParseAccountSASToken</span>(<span class="r110 r">result</span>.<span class="i">Value</span>.<span class="i">AccountSasToken</span>);
 
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r109 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#25afa0b174611acd" class="i property">Services</a>, <span class="r111 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#25afa0b174611acd" class="i property">Services</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r109 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#9ca119d4511349fa" class="i property">ResourceTypes</a>, <span class="r111 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#9ca119d4511349fa" class="i property">ResourceTypes</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r109 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#4d87982bea02776f" class="i property">Permissions</a>, <span class="r111 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#4d87982bea02776f" class="i property">Permissions</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r109 r">accountSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#cf35f75fa8dad2f0" class="i property">SharedAccessExpiryTime</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c8f70d2c7aa5f7c5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListAccountSASWithMissingProperties</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r112 rd" class="r112 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r113 rd" class="r113 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r112 r">rgname</span>, <span class="r113 r">accountName</span>);
 
            <span class="c">// Test for default values of sas credentials.</span>
            <a href="/Azure.ResourceManager.Storage/A.html#d2a76e71b2688807" class="t t">AccountSasParameters</a> <span id="r114 rd" class="r114 r">accountSasParameters</span> =
                <b>new</b> <span class="t">AccountSasParameters</span>(<span class="i">services</span>: <span class="s">&quot;b&quot;</span>, <span class="i">resourceTypes</span>: <span class="s">&quot;sco&quot;</span>, <span class="i">permissions</span>: <span class="s">&quot;rl&quot;</span>, <span class="i">sharedAccessExpiryTime</span>: <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(-1));
            <b>try</b>
            {
                <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#d192c12932bd6a44" class="t t">ListAccountSasResponse</a>&gt; <span id="r115 rd" class="r115 r">result</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListAccountSASAsync</span>(<span class="r112 r">rgname</span>, <span class="r113 r">accountName</span>, <span class="r114 r">accountSasParameters</span>);
                <a href="/Azure.ResourceManager.Storage/A.html#d2a76e71b2688807" class="t t">AccountSasParameters</a> <span id="r116 rd" class="r116 r">resultCredentials</span> = <span class="i">ParseAccountSASToken</span>(<span class="r115 r">result</span>.<span class="i">Value</span>.<span class="i">AccountSasToken</span>);
            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r117 rd" class="r117 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r117 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a> != <b>null</b> &amp;&amp; <span class="r117 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;Values for request parameters are invalid: signedExpiry.&quot;</span>));
                <b>return</b>;
            }
            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#df2d82d91ca29e40" class="t constructor">Exception</a>(<span class="s">&quot;AccountSasToken shouldn&#39;t be returned without SharedAccessExpiryTime&quot;</span>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="96c6dc7c999fb790" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListServiceSASTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r118 rd" class="r118 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r119 rd" class="r119 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r118 r">rgname</span>, <span class="r119 r">accountName</span>);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r120 rd" class="r120 r">canonicalizedResourceParameter</span> = <span class="s">&quot;/blob/&quot;</span> + <span class="r119 r">accountName</span> + <span class="s">&quot;/music&quot;</span>;
            <a href="/Azure.ResourceManager.Storage/A.html#9547ace3fc95b862" class="t t">ServiceSasParameters</a> <span id="r121 rd" class="r121 r">serviceSasParameters</span> = <b>new</b> <span class="t">ServiceSasParameters</span>(<span class="i">canonicalizedResource</span>: <span class="r120 r">canonicalizedResourceParameter</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#add65e2548f565ab" class="i property">Resource</a> = <span class="s">&quot;c&quot;</span>,
                <a href="/Azure.ResourceManager.Storage/A.html#f58776c657a21a01" class="i property">Permissions</a> = <span class="s">&quot;rdwlacup&quot;</span>,
                <a href="/Azure.ResourceManager.Storage/A.html#60bb1e65bd607caf" class="i property">Protocols</a> = <a href="/Azure.ResourceManager.Storage/A.html#f075c53502337ec5" class="t t">HttpProtocol</a>.<a href="/Azure.ResourceManager.Storage/A.html#1771925fe8810332" class="i field">HttpsHttp</a>,
                <a href="/Azure.ResourceManager.Storage/A.html#7d163a197ce01ae8" class="i property">SharedAccessStartTime</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>,
                <a href="/Azure.ResourceManager.Storage/A.html#2e51a7c7a3815450" class="i property">SharedAccessExpiryTime</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(1),
                <a href="/Azure.ResourceManager.Storage/A.html#348aaf1ee29635a6" class="i property">KeyToSign</a> = <span class="s">&quot;key1&quot;</span>
            };
 
            <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#b7111bc83ee51fc9" class="t t">ListServiceSasResponse</a>&gt;&gt; <span id="r122 rd" class="r122 r">result</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListServiceSASAsync</span>(<span class="r118 r">rgname</span>, <span class="r119 r">accountName</span>, <span class="r121 r">serviceSasParameters</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#9547ace3fc95b862" class="t t">ServiceSasParameters</a> <span id="r123 rd" class="r123 r">resultCredentials</span> = <span class="i">ParseServiceSASToken</span>(<span class="r122 r">result</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<span class="i">Value</span>.<span class="i">ServiceSasToken</span>, <span class="r120 r">canonicalizedResourceParameter</span>);
 
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r121 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#add65e2548f565ab" class="i property">Resource</a>, <span class="r123 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#add65e2548f565ab" class="i property">Resource</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r121 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#f58776c657a21a01" class="i property">Permissions</a>, <span class="r123 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#f58776c657a21a01" class="i property">Permissions</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r121 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#60bb1e65bd607caf" class="i property">Protocols</a>, <span class="r123 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#60bb1e65bd607caf" class="i property">Protocols</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r121 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#7d163a197ce01ae8" class="i property">SharedAccessStartTime</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r121 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#2e51a7c7a3815450" class="i property">SharedAccessExpiryTime</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="b332f7870c1048f5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListServiceSASWithDefaultProperties</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r124 rd" class="r124 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r125 rd" class="r125 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r124 r">rgname</span>, <span class="r125 r">accountName</span>);
 
            <span class="c">// Test for default values of sas credentials.</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r126 rd" class="r126 r">canonicalizedResourceParameter</span> = <span class="s">&quot;/blob/&quot;</span> + <span class="r125 r">accountName</span> + <span class="s">&quot;/music&quot;</span>;
            <a href="/Azure.ResourceManager.Storage/A.html#9547ace3fc95b862" class="t t">ServiceSasParameters</a> <span id="r127 rd" class="r127 r">serviceSasParameters</span> = <b>new</b> <span class="t">ServiceSasParameters</span>(<span class="i">canonicalizedResource</span>: <span class="r126 r">canonicalizedResourceParameter</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#add65e2548f565ab" class="i property">Resource</a> = <span class="s">&quot;c&quot;</span>,
                <a href="/Azure.ResourceManager.Storage/A.html#f58776c657a21a01" class="i property">Permissions</a> = <span class="s">&quot;rl&quot;</span>,
                <a href="/Azure.ResourceManager.Storage/A.html#2e51a7c7a3815450" class="i property">SharedAccessExpiryTime</a> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#121ddf7990f13459" class="i property">UtcNow</a>.<a href="@0@mscorlib/A.html#f349aa0ae92c3ec6" class="i method">AddHours</a>(1),
            };
 
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#b7111bc83ee51fc9" class="t t">ListServiceSasResponse</a>&gt; <span id="r128 rd" class="r128 r">result</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListServiceSASAsync</span>(<span class="r124 r">rgname</span>, <span class="r125 r">accountName</span>, <span class="r127 r">serviceSasParameters</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#9547ace3fc95b862" class="t t">ServiceSasParameters</a> <span id="r129 rd" class="r129 r">resultCredentials</span> = <span class="i">ParseServiceSASToken</span>(<span class="r128 r">result</span>.<span class="i">Value</span>.<span class="i">ServiceSasToken</span>, <span class="r126 r">canonicalizedResourceParameter</span>);
 
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r127 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#add65e2548f565ab" class="i property">Resource</a>, <span class="r129 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#add65e2548f565ab" class="i property">Resource</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r127 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#f58776c657a21a01" class="i property">Permissions</a>, <span class="r129 r">resultCredentials</span>.<a href="/Azure.ResourceManager.Storage/A.html#f58776c657a21a01" class="i property">Permissions</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r127 r">serviceSasParameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#2e51a7c7a3815450" class="i property">SharedAccessExpiryTime</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="74ca12b441832ca0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountListServiceSASWithMissingProperties</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r130 rd" class="r130 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r131 rd" class="r131 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r130 r">rgname</span>, <span class="r131 r">accountName</span>);
 
            <span class="c">// Test for default values of sas credentials.</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r132 rd" class="r132 r">canonicalizedResourceParameter</span> = <span class="s">&quot;/blob/&quot;</span> + <span class="r131 r">accountName</span> + <span class="s">&quot;/music&quot;</span>;
            <a href="/Azure.ResourceManager.Storage/A.html#9547ace3fc95b862" class="t t">ServiceSasParameters</a> <span id="r133 rd" class="r133 r">serviceSasParameters</span> = <b>new</b> <span class="t">ServiceSasParameters</span>(<span class="i">canonicalizedResource</span>: <span class="r132 r">canonicalizedResourceParameter</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#add65e2548f565ab" class="i property">Resource</a> = <span class="s">&quot;b&quot;</span>,
                <a href="/Azure.ResourceManager.Storage/A.html#f58776c657a21a01" class="i property">Permissions</a> = <span class="s">&quot;rl&quot;</span>
            };
            <b>try</b>
            {
                <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#b7111bc83ee51fc9" class="t t">ListServiceSasResponse</a>&gt; <span id="r134 rd" class="r134 r">result</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">ListServiceSASAsync</span>(<span class="r130 r">rgname</span>, <span class="r131 r">accountName</span>, <span class="r133 r">serviceSasParameters</span>);
                <a href="/Azure.ResourceManager.Storage/A.html#9547ace3fc95b862" class="t t">ServiceSasParameters</a> <span id="r135 rd" class="r135 r">resultCredentials</span> = <span class="i">ParseServiceSASToken</span>(<span class="r134 r">result</span>.<span class="i">Value</span>.<span class="i">ServiceSasToken</span>, <span class="r132 r">canonicalizedResourceParameter</span>);
            }
            <b>catch</b> (<span class="i">RequestFailedException</span> <span id="r136 rd" class="r136 r">ex</span>)
            {
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r136 r">ex</span>.<span class="i">Message</span> != <b>null</b> &amp;&amp; <span class="r136 r">ex</span>.<span class="i">Message</span>.<span class="i">Contains</span>(<span class="s">&quot;Values for request parameters are invalid: signedExpiry.&quot;</span>));
                <b>return</b>;
            }
            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#df2d82d91ca29e40" class="t constructor">Exception</a>(<span class="s">&quot;AccountSasToken shouldn&#39;t be returned without SharedAccessExpiryTime&quot;</span>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="62acea714effce3a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountUpdateEncryptionTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r137 rd" class="r137 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r138 rd" class="r138 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r137 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// Update storage account type</span>
            <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r139 rd" class="r139 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">Sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>)
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r140 rd" class="r140 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>, <span class="r139 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
 
            <span class="c">// Validate</span>
            <span class="r140 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
 
            <span class="c">// Update storage tags</span>
            <span class="r139 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a> =
                    {
                        {<span class="s">&quot;key3&quot;</span>,<span class="s">&quot;value3&quot;</span>},
                        {<span class="s">&quot;key4&quot;</span>,<span class="s">&quot;value4&quot;</span>},
                        {<span class="s">&quot;key5&quot;</span>,<span class="s">&quot;value6&quot;</span>}
                    }
            };
            <span class="r140 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>, <span class="r139 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#4c01979f7482f4e5" class="i property">Tags</a>.<span class="i">Count</span>, <span class="r139 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Count</span>);
 
            <span class="c">// Validate</span>
            <span class="r140 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#4c01979f7482f4e5" class="i property">Tags</a>.<span class="i">Count</span>, <span class="r139 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#130c30ac6b180c61" class="i property">Tags</a>.<span class="i">Count</span>);
 
            <span class="c">// 1. Update storage encryption</span>
            <span class="r139 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<span class="i">keySource</span>: <a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
                {
                    <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span> { <span class="i">Blob</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> }, <span class="i">File</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> } }
                }
            };
            <span class="r140 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>, <span class="r139 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
 
            <span class="c">// Validate</span>
            <span class="r140 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="c">// 2. Restore storage encryption</span>
            <span class="r139 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<span class="i">keySource</span>: <a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
                {
                    <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span> { <span class="i">Blob</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> }, <span class="i">File</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> } }
                }
            };
            <span class="r140 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>, <span class="r139 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
 
            <span class="c">// Validate</span>
            <span class="r140 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="c">// 3. Remove file encryption service field.</span>
            <span class="r139 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<span class="i">keySource</span>: <a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
                {
                    <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span> { <span class="i">Blob</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a> = <b>true</b> } }
                }
            };
            <span class="r140 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>, <span class="r139 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
 
            <span class="c">// Validate</span>
            <span class="r140 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r137 r">rgname</span>, <span class="r138 r">accountName</span>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r140 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="48b5cde875e34006" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountUpdateWithHttpsOnlyTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r141 rd" class="r141 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r142 rd" class="r142 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account with hot</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r143 rd" class="r143 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>();
            <span class="r143 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#44b8a786e0d08ce0" class="i property">EnableHttpsTrafficOnly</a> = <b>false</b>;
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r144 rd" class="r144 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r141 r">rgname</span>, <span class="r142 r">accountName</span>, <span class="r143 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r144 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">False</span>(<span class="r144 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#cfeb0a35eb4f5885" class="i property">EnableHttpsTrafficOnly</a>);
 
            <span class="c">//Update storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r145 rd" class="r145 r">parameter</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <a href="/Azure.ResourceManager.Storage/A.html#c4508e488f0e6e33" class="i property">EnableHttpsTrafficOnly</a> = <b>true</b>
            };
            <span class="r144 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r141 r">rgname</span>, <span class="r142 r">accountName</span>, <span class="r145 r">parameter</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r144 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r144 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#cfeb0a35eb4f5885" class="i property">EnableHttpsTrafficOnly</a>);
 
            <span class="c">//Update storage account</span>
            <span class="r145 r">parameter</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <a href="/Azure.ResourceManager.Storage/A.html#c4508e488f0e6e33" class="i property">EnableHttpsTrafficOnly</a> = <b>false</b>
            };
            <span class="r144 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r141 r">rgname</span>, <span class="r142 r">accountName</span>, <span class="r145 r">parameter</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r144 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">False</span>(<span class="r144 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#cfeb0a35eb4f5885" class="i property">EnableHttpsTrafficOnly</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="50b832c152d73964" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateWithHttpsOnlyTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r146 rd" class="r146 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r147 rd" class="r147 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r148 rd" class="r148 r">accountName1</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account with hot</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r149 rd" class="r149 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>();
            <span class="r149 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#44b8a786e0d08ce0" class="i property">EnableHttpsTrafficOnly</a> = <b>true</b>;
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r150 rd" class="r150 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r146 r">rgname</span>, <span class="r147 r">accountName</span>, <span class="r149 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r150 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r150 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#cfeb0a35eb4f5885" class="i property">EnableHttpsTrafficOnly</a>);
 
            <span class="c">// Create storage account with cool</span>
            <span class="r149 r">parameters</span>.<a href="/Azure.ResourceManager.Storage/A.html#44b8a786e0d08ce0" class="i property">EnableHttpsTrafficOnly</a> = <b>false</b>;
            <span class="r150 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r146 r">rgname</span>, <span class="r148 r">accountName1</span>, <span class="r149 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r150 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">False</span>(<span class="r150 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#cfeb0a35eb4f5885" class="i property">EnableHttpsTrafficOnly</a>);
        }
 
        [<span class="i">Test</span>]
        [<span class="i">Ignore</span>(<span class="s">&quot;Track2: Need KeyVaultManagementClient&quot;</span>)]
        <b>public void</b> <a id="e39dbfa92baf654b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCMKTest</a>()
        {
            <span class="c">//var handler = new RecordedDelegatingHandler { StatusCodeToReturn = HttpStatusCode.OK };</span>
 
            <span class="c">//using (MockContext context = MockContext.Start(this.GetType()))</span>
            <span class="c">//{</span>
            <span class="c">//    var resourcesClient = GetResourceManagementClient(context, handler);</span>
            <span class="c">//    var storageMgmtClient = GetStorageManagementClient(context, handler);</span>
            <span class="c">//    var keyVaultMgmtClient = GetKeyVaultManagementClient(context, handler);</span>
            <span class="c">//    var keyVaultClient = CreateKeyVaultClient();</span>
 
            <span class="c">//    string accountName = TestUtilities.GenerateName(&quot;sto&quot;);</span>
            <span class="c">//    var rgname = CreateResourceGroup(resourcesClient);</span>
            <span class="c">//    string vaultName = TestUtilities.GenerateName(&quot;keyvault&quot;);</span>
            <span class="c">//    string keyName = TestUtilities.GenerateName(&quot;keyvaultkey&quot;);</span>
 
            <span class="c">//    var parameters = GetDefaultStorageAccountParameters();</span>
            <span class="c">//    parameters.Location = &quot;centraluseuap&quot;;</span>
            <span class="c">//    parameters.Identity = new Identity { };</span>
            <span class="c">//    var account = storageMgmtClient.StorageAccounts.Create(rgname, accountName, parameters);</span>
 
            <span class="c">//    VerifyAccountProperties(account, false);</span>
            <span class="c">//    Assert.NotNull(account.Identity);</span>
 
            <span class="c">//    var accessPolicies = new List&lt;Microsoft.Azure.Management.KeyVault.Models.AccessPolicyEntry&gt;();</span>
            <span class="c">//    accessPolicies.Add(new Microsoft.Azure.Management.KeyVault.Models.AccessPolicyEntry</span>
            <span class="c">//    {</span>
            <span class="c">//        TenantId = System.Guid.Parse(account.Identity.TenantId),</span>
            <span class="c">//        ObjectId = account.Identity.PrincipalId,</span>
            <span class="c">//        Permissions = new Microsoft.Azure.Management.KeyVault.Models.Permissions(new List&lt;string&gt; { &quot;wrapkey&quot;, &quot;unwrapkey&quot; })</span>
            <span class="c">//    });</span>
 
            <span class="c">//    string servicePrincipalObjectId = GetServicePrincipalObjectId();</span>
            <span class="c">//    accessPolicies.Add(new Microsoft.Azure.Management.KeyVault.Models.AccessPolicyEntry</span>
            <span class="c">//    {</span>
            <span class="c">//        TenantId = System.Guid.Parse(account.Identity.TenantId),</span>
            <span class="c">//        ObjectId = servicePrincipalObjectId,</span>
            <span class="c">//        Permissions = new Microsoft.Azure.Management.KeyVault.Models.Permissions(new List&lt;string&gt; { &quot;all&quot; })</span>
            <span class="c">//    });</span>
 
            <span class="c">//    var keyVault = keyVaultMgmtClient.Vaults.CreateOrUpdate(rgname, vaultName, new Microsoft.Azure.Management.KeyVault.Models.VaultCreateOrUpdateParameters</span>
            <span class="c">//    {</span>
            <span class="c">//        Location = account.Location,</span>
            <span class="c">//        Properties = new Microsoft.Azure.Management.KeyVault.Models.VaultProperties</span>
            <span class="c">//        {</span>
            <span class="c">//            TenantId = System.Guid.Parse(account.Identity.TenantId),</span>
            <span class="c">//            AccessPolicies = accessPolicies,</span>
            <span class="c">//            Sku = new Microsoft.Azure.Management.KeyVault.Models.Sku(Microsoft.Azure.Management.KeyVault.Models.SkuName.Standard),</span>
            <span class="c">//            EnabledForDiskEncryption = false,</span>
            <span class="c">//            EnabledForDeployment = false,</span>
            <span class="c">//            EnabledForTemplateDeployment = false</span>
            <span class="c">//        }</span>
            <span class="c">//    });</span>
 
            <span class="c">//    var keyVaultKey = keyVaultClient.CreateKeyAsync(keyVault.Properties.VaultUri, keyName, JsonWebKeyType.Rsa, 2048,</span>
            <span class="c">//        JsonWebKeyOperation.AllOperations, new Microsoft.Azure.KeyVault.Models.KeyAttributes()).GetAwaiter().GetResult();</span>
 
            <span class="c">//    // Enable encryption.</span>
            <span class="c">//    var updateParameters = new StorageAccountUpdateParameters</span>
            <span class="c">//    {</span>
            <span class="c">//        Encryption = new Encryption</span>
            <span class="c">//        {</span>
            <span class="c">//            Services = new EncryptionServices { Blob = new EncryptionService { Enabled = true }, File = new EncryptionService { Enabled = true } },</span>
            <span class="c">//            KeySource = &quot;Microsoft.Keyvault&quot;,</span>
            <span class="c">//            KeyVaultProperties =</span>
            <span class="c">//                new KeyVaultProperties</span>
            <span class="c">//                {</span>
            <span class="c">//                    KeyName = keyVaultKey.KeyIdentifier.Name,</span>
            <span class="c">//                    KeyVaultUri = keyVault.Properties.VaultUri,</span>
            <span class="c">//                    KeyVersion = keyVaultKey.KeyIdentifier.Version</span>
            <span class="c">//                }</span>
            <span class="c">//        }</span>
            <span class="c">//    };</span>
 
            <span class="c">//    account = storageMgmtClient.StorageAccounts.Update(rgname, accountName, updateParameters);</span>
            <span class="c">//    VerifyAccountProperties(account, false);</span>
            <span class="c">//    Assert.NotNull(account.Encryption);</span>
            <span class="c">//    Assert.True(account.Encryption.Services.Blob.Enabled);</span>
            <span class="c">//    Assert.True(account.Encryption.Services.File.Enabled);</span>
            <span class="c">//    Assert.Equal(&quot;Microsoft.Keyvault&quot;, account.Encryption.KeySource);</span>
 
            <span class="c">//    // Disable Encryption.</span>
            <span class="c">//    updateParameters = new StorageAccountUpdateParameters</span>
            <span class="c">//    {</span>
            <span class="c">//        Encryption = new Encryption</span>
            <span class="c">//        {</span>
            <span class="c">//            Services = new EncryptionServices { Blob = new EncryptionService { Enabled = true }, File = new EncryptionService { Enabled = true } },</span>
            <span class="c">//            KeySource = &quot;Microsoft.Storage&quot;</span>
            <span class="c">//        }</span>
            <span class="c">//    };</span>
            <span class="c">//    account = storageMgmtClient.StorageAccounts.Update(rgname, accountName, updateParameters);</span>
            <span class="c">//    VerifyAccountProperties(account, false);</span>
            <span class="c">//    Assert.NotNull(account.Encryption);</span>
            <span class="c">//    Assert.True(account.Encryption.Services.Blob.Enabled);</span>
            <span class="c">//    Assert.True(account.Encryption.Services.File.Enabled);</span>
            <span class="c">//    Assert.Equal(&quot;Microsoft.Storage&quot;, account.Encryption.KeySource);</span>
 
            <span class="c">//    updateParameters = new StorageAccountUpdateParameters</span>
            <span class="c">//    {</span>
            <span class="c">//        Encryption = new Encryption</span>
            <span class="c">//        {</span>
            <span class="c">//            Services = new EncryptionServices { Blob = new EncryptionService { Enabled = false }, File = new EncryptionService { Enabled = false } },</span>
            <span class="c">//            KeySource = KeySource.MicrosoftStorage</span>
            <span class="c">//        }</span>
            <span class="c">//    };</span>
            <span class="c">//    account = storageMgmtClient.StorageAccounts.Update(rgname, accountName, updateParameters);</span>
            <span class="c">//    VerifyAccountProperties(account, false);</span>
            <span class="c">//    Assert.Null(account.Encryption);</span>
            <span class="c">//}</span>
        }
 
        [<span class="i">Test</span>]
        [<span class="i">Ignore</span>(<span class="s">&quot;Track2: The constructor of OperationDisplay is internal&quot;</span>)]
        <b>public void</b> <a id="9919d4a83b95a153" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountOperationsTest</a>()
        {
            <span class="c">//var handler = new RecordedDelegatingHandler { StatusCodeToReturn = HttpStatusCode.OK };</span>
 
            <span class="c">//using (MockContext context = MockContext.Start(this.GetType()))</span>
            <span class="c">//{</span>
            <span class="c">//    var resourcesClient = GetResourceManagementClient(context, handler);</span>
            <span class="c">//    var storageMgmtClient = GetStorageManagementClient(context, handler);</span>
            <span class="c">//    var keyVaultMgmtClient = GetKeyVaultManagementClient(context, handler);</span>
 
            <span class="c">//    // Create storage account with hot</span>
            <span class="c">//    string accountName = TestUtilities.GenerateName(&quot;sto&quot;);</span>
            <span class="c">//    var rgname = CreateResourceGroup(resourcesClient);</span>
 
            <span class="c">//    var ops = storageMgmtClient.Operations.List();</span>
            <span class="c">//    var op1 = new Operation</span>
            <span class="c">//    {</span>
            <span class="c">//        Name = &quot;Microsoft.Storage/storageAccounts/write&quot;,</span>
            <span class="c">//        Display = new OperationDisplay</span>
            <span class="c">//        {</span>
            <span class="c">//            Provider = &quot;Microsoft Storage&quot;,</span>
            <span class="c">//            Resource = &quot;Storage Accounts&quot;,</span>
            <span class="c">//            Operation = &quot;Create/Update Storage Account&quot;</span>
            <span class="c">//        }</span>
            <span class="c">//    };</span>
            <span class="c">//    var op2 = new Operation</span>
            <span class="c">//    {</span>
            <span class="c">//        Name = &quot;Microsoft.Storage/storageAccounts/delete&quot;,</span>
            <span class="c">//        Display = new OperationDisplay</span>
            <span class="c">//        {</span>
            <span class="c">//            Provider = &quot;Microsoft Storage&quot;,</span>
            <span class="c">//            Resource = &quot;Storage Accounts&quot;,</span>
            <span class="c">//            Operation = &quot;Delete Storage Account&quot;</span>
            <span class="c">//        }</span>
            <span class="c">//    };</span>
            <span class="c">//    bool exists1 = false;</span>
            <span class="c">//    bool exists2 = false;</span>
            <span class="c">//    Assert.NotNull(ops);</span>
            <span class="c">//    Assert.NotNull(ops.GetEnumerator());</span>
            <span class="c">//    var operation = ops.GetEnumerator();</span>
 
            <span class="c">//    while (operation.MoveNext())</span>
            <span class="c">//    {</span>
            <span class="c">//        if (operation.Current.ToString().Equals(op1.ToString()))</span>
            <span class="c">//        {</span>
            <span class="c">//            exists1 = true;</span>
            <span class="c">//        }</span>
            <span class="c">//        if (operation.Current.ToString().Equals(op2.ToString()))</span>
            <span class="c">//        {</span>
            <span class="c">//            exists2 = true;</span>
            <span class="c">//        }</span>
            <span class="c">//    }</span>
            <span class="c">//    Assert.True(exists1);</span>
            <span class="c">//    Assert.True(exists2);</span>
            <span class="c">//}</span>
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3f83baaed034ed51" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountVnetACLTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r151 rd" class="r151 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r152 rd" class="r152 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account with Vnet</span>
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r153 rd" class="r153 r">parameters</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>();
            <span class="r153 r">parameters</span>.<span class="i">NetworkRuleSet</span> = <b>new</b> <span class="t">NetworkRuleSet</span>(<span class="i">defaultAction</span>: <a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#40d53c7b1a483dda" class="i field">Deny</a>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#e87dc9b70b6d256b" class="i property">Bypass</a> = <span class="s">@&quot;Logging,AzureServices&quot;</span>,
               <a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a> ={ <b>new</b> <span class="t">IPRule</span>(<span class="i">iPAddressOrRange</span>: <span class="s">&quot;23.45.67.90&quot;</span>) }
            };
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r151 r">rgname</span>, <span class="r152 r">accountName</span>, <span class="r153 r">parameters</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r154 rd" class="r154 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r151 r">rgname</span>, <span class="r152 r">accountName</span>);
 
            <span class="c">// Verify the vnet rule properties.</span>
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">@&quot;Logging, AzureServices&quot;</span>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#e87dc9b70b6d256b" class="i property">Bypass</a>.<span class="i">ToString</span>());
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#40d53c7b1a483dda" class="i field">Deny</a>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#c428e260a86f6352" class="i property">DefaultAction</a>);
            <span class="i">Assert</span>.<span class="i">IsEmpty</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#60f7d80066607ef0" class="i property">VirtualNetworkRules</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>);
            <span class="i">Assert</span>.<span class="i">IsNotEmpty</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;23.45.67.90&quot;</span>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>[0].<span class="i">IPAddressOrRange</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#6ecb3f9442640a50" class="i field">Allow</a>.<a href="@0@mscorlib/A.html#ff31a6bf27c58f89" class="i method">ToString</a>(), <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>[0].<span class="i">Action</span>);
 
            <span class="c">// Update Vnet</span>
            <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r155 rd" class="r155 r">updateParameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">NetworkRuleSet</span> = <b>new</b> <span class="t">NetworkRuleSet</span>(<span class="i">defaultAction</span>: <a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#40d53c7b1a483dda" class="i field">Deny</a>)
                {
                    <a href="/Azure.ResourceManager.Storage/A.html#e87dc9b70b6d256b" class="i property">Bypass</a> = <span class="s">@&quot;Logging, Metrics&quot;</span>,
                   <a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a> ={
                            <b>new</b> <span class="t">IPRule</span>(<span class="i">iPAddressOrRange</span>:<span class="s">&quot;23.45.67.91&quot;</span>) { <a href="/Azure.ResourceManager.Storage/A.html#5133e5a2eedc7c5c" class="i property">Action</a> = <a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#6ecb3f9442640a50" class="i field">Allow</a>.<a href="@0@mscorlib/A.html#ff31a6bf27c58f89" class="i method">ToString</a>() },
                            <b>new</b> <span class="t">IPRule</span>(<span class="i">iPAddressOrRange</span>:<span class="s">&quot;23.45.67.92&quot;</span>)
                        },
                }
            };
            <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r151 r">rgname</span>, <span class="r152 r">accountName</span>, <span class="r155 r">updateParameters</span>);
            <span class="r154 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r151 r">rgname</span>, <span class="r152 r">accountName</span>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">@&quot;Logging, Metrics&quot;</span>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#e87dc9b70b6d256b" class="i property">Bypass</a>.<span class="i">ToString</span>());
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#40d53c7b1a483dda" class="i field">Deny</a>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#c428e260a86f6352" class="i property">DefaultAction</a>);
            <span class="i">Assert</span>.<span class="i">IsEmpty</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#60f7d80066607ef0" class="i property">VirtualNetworkRules</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>);
            <span class="i">Assert</span>.<span class="i">IsNotEmpty</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;23.45.67.91&quot;</span>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>[0].<span class="i">IPAddressOrRange</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#6ecb3f9442640a50" class="i field">Allow</a>.<a href="@0@mscorlib/A.html#ff31a6bf27c58f89" class="i method">ToString</a>(), <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>[0].<span class="i">Action</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;23.45.67.92&quot;</span>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>[1].<span class="i">IPAddressOrRange</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#6ecb3f9442640a50" class="i field">Allow</a>.<a href="@0@mscorlib/A.html#ff31a6bf27c58f89" class="i method">ToString</a>(), <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#39a9609eaa8b5afe" class="i property">IpRules</a>[1].<span class="i">Action</span>);
 
            <span class="c">// Delete vnet.</span>
            <span class="r155 r">updateParameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">NetworkRuleSet</span> = <b>new</b> <span class="t">NetworkRuleSet</span>(<a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#6ecb3f9442640a50" class="i field">Allow</a>)
            };
            <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r151 r">rgname</span>, <span class="r152 r">accountName</span>, <span class="r155 r">updateParameters</span>);
            <span class="r154 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r151 r">rgname</span>, <span class="r152 r">accountName</span>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">@&quot;Logging, Metrics&quot;</span>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#e87dc9b70b6d256b" class="i property">Bypass</a>.<span class="i">ToString</span>());
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#12de07ed1cae3225" class="t t">DefaultAction</a>.<a href="/Azure.ResourceManager.Storage/A.html#6ecb3f9442640a50" class="i field">Allow</a>, <span class="r154 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#8c010b8926ed0861" class="i property">NetworkRuleSet</a>.<a href="/Azure.ResourceManager.Storage/A.html#c428e260a86f6352" class="i property">DefaultAction</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public void</b> <a id="a8d9907ab54e802a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageSKUListTest</a>()
        {
            <span class="i">AsyncPageable</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#87ce0f816eb7628b" class="t t">SkuInformation</a>&gt; <span id="r156 rd" class="r156 r">skulist</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#055070df5893a063" class="i property">SkusClient</a>.<span class="i">ListAsync</span>();
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r156 r">skulist</span>);
            <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#87ce0f816eb7628b" class="t t">SkuInformation</a>&gt;&gt; <span id="r157 rd" class="r157 r">skuListTask</span> = <span class="r156 r">skulist</span>.<span class="i">ToEnumerableAsync</span>();
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">@&quot;storageAccounts&quot;</span>, <span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#dab3e0dfa316dc28" class="i property">ResourceType</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#99a8febb231e2366" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#99a8febb231e2366" class="i property">Name</a>.<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>() == <a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#efdfb5cafd6d704b" class="i property">PremiumLRS</a>.<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>());
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#99a8febb231e2366" class="i property">Name</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#efdfb5cafd6d704b" class="i property">PremiumLRS</a>)
                || <span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#99a8febb231e2366" class="i property">Name</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e067bc77001bae0" class="i property">StandardGRS</a>)
                || <span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#99a8febb231e2366" class="i property">Name</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>)
                || <span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#99a8febb231e2366" class="i property">Name</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#15fd5618a498cdbb" class="i property">StandardRagrs</a>)
                || <span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#99a8febb231e2366" class="i property">Name</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#fa191a3b6d3415ac" class="i property">StandardZRS</a>));
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#4a5a121d5e9b5c97" class="i property">Kind</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#4a5a121d5e9b5c97" class="i property">Kind</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#9192360c0e6efe14" class="i property">BlobStorage</a>) || <span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#4a5a121d5e9b5c97" class="i property">Kind</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#b341787ab26e7499" class="i property">Storage</a>) || <span class="r157 r">skuListTask</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#7db56d44563d8761" class="i method">ElementAt</a>(0).<a href="/Azure.ResourceManager.Storage/A.html#4a5a121d5e9b5c97" class="i property">Kind</a>.<span class="i">Equals</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>));
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d0f9c644673aeec5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateWithStorageV2</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r158 rd" class="r158 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r159 rd" class="r159 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account with StorageV2</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r160 rd" class="r160 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e067bc77001bae0" class="i property">StandardGRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r161 rd" class="r161 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r160 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <a href="../Helpers/StorageTestsManagementClientBase.cs.html#eea49042c36ee951" class="i field">DefaultLocation</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r162 rd" class="r162 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r158 r">rgname</span>, <span class="r159 r">accountName</span>, <span class="r161 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r162 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r162 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ed6395340fcb6647" class="i property">PrimaryEndpoints</a>.<a href="/Azure.ResourceManager.Storage/A.html#f4eba1d2f3f1157b" class="i property">Web</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="r162 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ca8827b4c95b78a6" class="i property">Kind</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="3fc5da6793baa2f2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountUpdateKindStorageV2</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r163 rd" class="r163 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
 
            <span class="c">// Create storage account</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r164 rd" class="r164 r">accountName</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#0fa7a76b488abeb9" class="i method">CreateStorageAccount</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>, <span class="r163 r">rgname</span>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
 
            <span class="c">// Update storage account type</span>
            <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r165 rd" class="r165 r">parameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <a href="/Azure.ResourceManager.Storage/A.html#86f03c726ebb0238" class="i property">Kind</a> = <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>,
                <a href="/Azure.ResourceManager.Storage/A.html#c4508e488f0e6e33" class="i property">EnableHttpsTrafficOnly</a> = <b>true</b>
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r166 rd" class="r166 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r163 r">rgname</span>, <span class="r164 r">accountName</span>, <span class="r165 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="r166 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ca8827b4c95b78a6" class="i property">Kind</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r166 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#cfeb0a35eb4f5885" class="i property">EnableHttpsTrafficOnly</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r166 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ed6395340fcb6647" class="i property">PrimaryEndpoints</a>.<a href="/Azure.ResourceManager.Storage/A.html#f4eba1d2f3f1157b" class="i property">Web</a>);
 
            <span class="c">// Validate</span>
            <span class="r166 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r163 r">rgname</span>, <span class="r164 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="r166 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ca8827b4c95b78a6" class="i property">Kind</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r166 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#cfeb0a35eb4f5885" class="i property">EnableHttpsTrafficOnly</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r166 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ed6395340fcb6647" class="i property">PrimaryEndpoints</a>.<a href="/Azure.ResourceManager.Storage/A.html#f4eba1d2f3f1157b" class="i property">Web</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="412ab254c5842a62" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountSetGetDeleteManagementPolicy</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r167 rd" class="r167 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r168 rd" class="r168 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r169 rd" class="r169 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e067bc77001bae0" class="i property">StandardGRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r170 rd" class="r170 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r169 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <span class="s">&quot;westus&quot;</span>);
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r167 r">rgname</span>, <span class="r168 r">accountName</span>, <span class="r170 r">parameters</span>);
 
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#aba8a59cf80689cf" class="t t">ManagementPolicyRule</a>&gt; <span id="r171 rd" class="r171 r">rules</span> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#aba8a59cf80689cf" class="t t">ManagementPolicyRule</a>&gt;();
            <a href="/Azure.ResourceManager.Storage/A.html#060da954f1c66618" class="t t">ManagementPolicyAction</a> <span id="r172 rd" class="r172 r">Actions</span> = <b>new</b> <span class="t">ManagementPolicyAction</span>()
            {
                <span class="i">BaseBlob</span> = <b>new</b> <span class="t">ManagementPolicyBaseBlob</span>()
                {
                    <span class="i">Delete</span> = <b>new</b> <span class="t">DateAfterModification</span>(300),
                    <span class="i">TierToArchive</span> = <b>new</b> <span class="t">DateAfterModification</span>(90),
                    <span class="i">TierToCool</span> = <b>new</b> <span class="t">DateAfterModification</span>(1000),
                },
                <span class="i">Snapshot</span> = <b>new</b> <span class="t">ManagementPolicySnapShot</span>()
                {
                    <span class="i">Delete</span> = <b>new</b> <span class="t">DateAfterCreation</span>(100)
                }
            };
            <a href="/Azure.ResourceManager.Storage/A.html#0811cca4769ef935" class="t t">ManagementPolicyDefinition</a> <span id="r173 rd" class="r173 r">Definition</span> = <b>new</b> <span class="t">ManagementPolicyDefinition</span>(<span class="r172 r">Actions</span>)
            {
                <span class="i">Filters</span> = <b>new</b> <span class="t">ManagementPolicyFilter</span>(<b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;() { <span class="s">&quot;blockBlob&quot;</span> })
                {
                   <a href="/Azure.ResourceManager.Storage/A.html#b99f7dcbacac0a49" class="i property">PrefixMatch</a> = { <span class="s">&quot;olcmtestcontainer&quot;</span>, <span class="s">&quot;testblob&quot;</span> }
                }
            };
            <a href="/Azure.ResourceManager.Storage/A.html#aba8a59cf80689cf" class="t t">ManagementPolicyRule</a> <span id="r174 rd" class="r174 r">rule1</span> = <b>new</b> <span class="t">ManagementPolicyRule</span>(<span class="s">&quot;olcmtest&quot;</span>, <a href="/Azure.ResourceManager.Storage/A.html#401e17f5af92b7bd" class="t t">RuleType</a>.<a href="/Azure.ResourceManager.Storage/A.html#65621bdd4270f9d7" class="i property">Lifecycle</a>, <span class="r173 r">Definition</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#c51dc220dd845aa4" class="i property">Enabled</a> = <b>true</b>
            };
            <span class="r171 r">rules</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r174 r">rule1</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#060da954f1c66618" class="t t">ManagementPolicyAction</a> <span id="r175 rd" class="r175 r">Actions2</span> = <b>new</b> <span class="t">ManagementPolicyAction</span>()
            {
                <span class="i">BaseBlob</span> = <b>new</b> <span class="t">ManagementPolicyBaseBlob</span>()
                {
                    <span class="i">Delete</span> = <b>new</b> <span class="t">DateAfterModification</span>(1000),
                },
            };
            <a href="/Azure.ResourceManager.Storage/A.html#0811cca4769ef935" class="t t">ManagementPolicyDefinition</a> <span id="r176 rd" class="r176 r">Definition2</span> = <b>new</b> <span class="t">ManagementPolicyDefinition</span>(<span class="r175 r">Actions2</span>)
            {
                <span class="i">Filters</span> = <b>new</b> <span class="t">ManagementPolicyFilter</span>(<b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;() { <span class="s">&quot;blockBlob&quot;</span> })
            };
            <a href="/Azure.ResourceManager.Storage/A.html#aba8a59cf80689cf" class="t t">ManagementPolicyRule</a> <span id="r177 rd" class="r177 r">rule2</span> = <b>new</b> <span class="t">ManagementPolicyRule</span>(<span class="s">&quot;olcmtest2&quot;</span>, <a href="/Azure.ResourceManager.Storage/A.html#401e17f5af92b7bd" class="t t">RuleType</a>.<a href="/Azure.ResourceManager.Storage/A.html#65621bdd4270f9d7" class="i property">Lifecycle</a>, <span class="r176 r">Definition2</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#c51dc220dd845aa4" class="i property">Enabled</a> = <b>false</b>
            };
            <span class="r171 r">rules</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r177 r">rule2</span>);
 
            <a href="/Azure.ResourceManager.Storage/A.html#060da954f1c66618" class="t t">ManagementPolicyAction</a> <span id="r178 rd" class="r178 r">Actions3</span> = <b>new</b> <span class="t">ManagementPolicyAction</span>()
            {
                <span class="i">Snapshot</span> = <b>new</b> <span class="t">ManagementPolicySnapShot</span>()
                {
                    <span class="i">Delete</span> = <b>new</b> <span class="t">DateAfterCreation</span>(200)
                }
            };
            <a href="/Azure.ResourceManager.Storage/A.html#0811cca4769ef935" class="t t">ManagementPolicyDefinition</a> <span id="r179 rd" class="r179 r">Definition3</span> = <b>new</b> <span class="t">ManagementPolicyDefinition</span>(<span class="r178 r">Actions3</span>)
            {
                <span class="i">Filters</span> = <b>new</b> <span class="t">ManagementPolicyFilter</span>(<b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt;() { <span class="s">&quot;blockBlob&quot;</span> })
            };
            <a href="/Azure.ResourceManager.Storage/A.html#aba8a59cf80689cf" class="t t">ManagementPolicyRule</a> <span id="r180 rd" class="r180 r">rule3</span> = <b>new</b> <span class="t">ManagementPolicyRule</span>(<span class="s">&quot;olcmtest3&quot;</span>, <a href="/Azure.ResourceManager.Storage/A.html#401e17f5af92b7bd" class="t t">RuleType</a>.<a href="/Azure.ResourceManager.Storage/A.html#65621bdd4270f9d7" class="i property">Lifecycle</a>, <span class="r179 r">Definition3</span>);
            <span class="r171 r">rules</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r180 r">rule3</span>);
 
            <span class="c">//Set Management Policies</span>
            <a href="/Azure.ResourceManager.Storage/A.html#47b2e5bbfe3bb712" class="t t">ManagementPolicySchema</a> <span id="r181 rd" class="r181 r">policyToSet</span> = <b>new</b> <span class="t">ManagementPolicySchema</span>(<span class="r171 r">rules</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#d75e371e2560df27" class="t t">ManagementPolicy</a> <span id="r182 rd" class="r182 r">managementPolicy</span> = <b>new</b> <span class="t">ManagementPolicy</span>()
            {
                <span class="i">Policy</span> = <span class="r181 r">policyToSet</span>
            };
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#d75e371e2560df27" class="t t">ManagementPolicy</a>&gt; <span id="r183 rd" class="r183 r">policy</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#87a21f99f843d428" class="i property">ManagementPoliciesClient</a>.<span class="i">CreateOrUpdateAsync</span>(<span class="r167 r">rgname</span>, <span class="r168 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#90163c9115954d39" class="t t">ManagementPolicyName</a>.<a href="/Azure.ResourceManager.Storage/A.html#86aa7914e0382b28" class="i property">Default</a>, <span class="r182 r">managementPolicy</span>);
            <span class="i">CompareStorageAccountManagementPolicyProperty</span>(<span class="r181 r">policyToSet</span>, <span class="r183 r">policy</span>.<span class="i">Value</span>.<span class="i">Policy</span>);
 
            <span class="c">//Get Management Policies</span>
            <span class="r183 r">policy</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#87a21f99f843d428" class="i property">ManagementPoliciesClient</a>.<span class="i">GetAsync</span>(<span class="r167 r">rgname</span>, <span class="r168 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#90163c9115954d39" class="t t">ManagementPolicyName</a>.<a href="/Azure.ResourceManager.Storage/A.html#86aa7914e0382b28" class="i property">Default</a>);
            <span class="i">CompareStorageAccountManagementPolicyProperty</span>(<span class="r181 r">policyToSet</span>, <span class="r183 r">policy</span>.<span class="i">Value</span>.<span class="i">Policy</span>);
 
            <span class="c">//Delete Management Policies, and check policy not exist</span>
            <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#87a21f99f843d428" class="i property">ManagementPoliciesClient</a>.<span class="i">DeleteAsync</span>(<span class="r167 r">rgname</span>, <span class="r168 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#90163c9115954d39" class="t t">ManagementPolicyName</a>.<a href="/Azure.ResourceManager.Storage/A.html#86aa7914e0382b28" class="i property">Default</a>);
            <b>bool</b> <span id="r184 rd" class="r184 r">dataPolicyExist</span> = <b>true</b>;
            <b>try</b>
            {
                <span class="r183 r">policy</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#87a21f99f843d428" class="i property">ManagementPoliciesClient</a>.<span class="i">GetAsync</span>(<span class="r167 r">rgname</span>, <span class="r168 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#90163c9115954d39" class="t t">ManagementPolicyName</a>.<a href="/Azure.ResourceManager.Storage/A.html#86aa7914e0382b28" class="i property">Default</a>);
            }
            <b>catch</b> (<span class="i">RequestFailedException</span> <span id="r185 rd" class="r185 r">cloudException</span>)
            {
                <span class="i">Assert</span>.<span class="i">AreEqual</span>((<b>int</b>)<a href="@0@System/A.html#9b95c882b40ef96e" class="t t">HttpStatusCode</a>.<a href="@0@System/A.html#35e0ca1b70dbcf0d" class="i field">NotFound</a>, <span class="r185 r">cloudException</span>.<span class="i">Status</span>);
                <span class="r184 r">dataPolicyExist</span> = <b>false</b>;
            }
            <span class="i">Assert</span>.<span class="i">False</span>(<span class="r184 r">dataPolicyExist</span>);
 
            <span class="c">//Delete not exist Management Policies will not fail</span>
            <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#87a21f99f843d428" class="i property">ManagementPoliciesClient</a>.<span class="i">DeleteAsync</span>(<span class="r167 r">rgname</span>, <span class="r168 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#90163c9115954d39" class="t t">ManagementPolicyName</a>.<a href="/Azure.ResourceManager.Storage/A.html#86aa7914e0382b28" class="i property">Default</a>);
        }
 
        <b>private static void</b> <a id="c980c3445a7d1bb8" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompareStorageAccountManagementPolicyProperty</a>(<a href="/Azure.ResourceManager.Storage/A.html#47b2e5bbfe3bb712" class="t t">ManagementPolicySchema</a> <span id="r186 rd" class="r186 r">policy1</span>, <a href="/Azure.ResourceManager.Storage/A.html#47b2e5bbfe3bb712" class="t t">ManagementPolicySchema</a> <span id="r187 rd" class="r187 r">policy2</span>)
        {
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r186 r">policy1</span>.<a href="/Azure.ResourceManager.Storage/A.html#2e892ecb3c3e9bb3" class="i property">Rules</a>.<span class="i">Count</span>, <span class="r187 r">policy2</span>.<a href="/Azure.ResourceManager.Storage/A.html#2e892ecb3c3e9bb3" class="i property">Rules</a>.<span class="i">Count</span>);
            <b>foreach</b> (<a href="/Azure.ResourceManager.Storage/A.html#aba8a59cf80689cf" class="t t">ManagementPolicyRule</a> <span id="r188 rd" class="r188 r">rule1</span> <b>in</b> <span class="r186 r">policy1</span>.<a href="/Azure.ResourceManager.Storage/A.html#2e892ecb3c3e9bb3" class="i property">Rules</a>)
            {
                <b>bool</b> <span id="r189 rd" class="r189 r">ruleFound</span> = <b>false</b>;
                <b>foreach</b> (<a href="/Azure.ResourceManager.Storage/A.html#aba8a59cf80689cf" class="t t">ManagementPolicyRule</a> <span id="r190 rd" class="r190 r">rule2</span> <b>in</b> <span class="r187 r">policy2</span>.<a href="/Azure.ResourceManager.Storage/A.html#2e892ecb3c3e9bb3" class="i property">Rules</a>)
                {
                    <b>if</b> (<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#af95db1f68864421" class="i property">Name</a> == <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#af95db1f68864421" class="i property">Name</a>)
                    {
                        <span class="r189 r">ruleFound</span> = <b>true</b>;
                        <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#c51dc220dd845aa4" class="i property">Enabled</a> <b>is null</b> ? <b>true</b> : <span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#c51dc220dd845aa4" class="i property">Enabled</a>, <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#c51dc220dd845aa4" class="i property">Enabled</a>);
                        <b>if</b> (<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#59c15d814c092bc5" class="i property">Filters</a> != <b>null</b> || <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#59c15d814c092bc5" class="i property">Filters</a> != <b>null</b>)
                        {
                            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#59c15d814c092bc5" class="i property">Filters</a>.<a href="/Azure.ResourceManager.Storage/A.html#8cbbbc2d23c9baa6" class="i property">BlobTypes</a>, <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#59c15d814c092bc5" class="i property">Filters</a>.<a href="/Azure.ResourceManager.Storage/A.html#8cbbbc2d23c9baa6" class="i property">BlobTypes</a>);
                            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#59c15d814c092bc5" class="i property">Filters</a>.<a href="/Azure.ResourceManager.Storage/A.html#b99f7dcbacac0a49" class="i property">PrefixMatch</a>, <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#59c15d814c092bc5" class="i property">Filters</a>.<a href="/Azure.ResourceManager.Storage/A.html#b99f7dcbacac0a49" class="i property">PrefixMatch</a>);
                        }
                        <b>if</b> (<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a> != <b>null</b> || <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a> != <b>null</b>)
                        {
                            <a href="#a87d2226e78f3815" class="i method">CompareDateAfterModification</a>(<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a>.<a href="/Azure.ResourceManager.Storage/A.html#21e1773e55e163ae" class="i property">TierToCool</a>, <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a>.<a href="/Azure.ResourceManager.Storage/A.html#21e1773e55e163ae" class="i property">TierToCool</a>);
                            <a href="#a87d2226e78f3815" class="i method">CompareDateAfterModification</a>(<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a>.<a href="/Azure.ResourceManager.Storage/A.html#c34f9c9f6b78e52d" class="i property">TierToArchive</a>, <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a>.<a href="/Azure.ResourceManager.Storage/A.html#c34f9c9f6b78e52d" class="i property">TierToArchive</a>);
                            <a href="#a87d2226e78f3815" class="i method">CompareDateAfterModification</a>(<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a>.<a href="/Azure.ResourceManager.Storage/A.html#01e5d58e6de549b6" class="i property">Delete</a>, <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#29b9edf0fe37203e" class="i property">BaseBlob</a>.<a href="/Azure.ResourceManager.Storage/A.html#01e5d58e6de549b6" class="i property">Delete</a>);
                        }
 
                        <b>if</b> (<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#c0fcdabcb624d2e5" class="i property">Snapshot</a> != <b>null</b> || <span class="r190 r">rule2</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#c0fcdabcb624d2e5" class="i property">Snapshot</a> != <b>null</b>)
                        {
                            <a href="#fe9103d3addb6225" class="i method">CompareDateAfterCreation</a>(<span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#c0fcdabcb624d2e5" class="i property">Snapshot</a>.<a href="/Azure.ResourceManager.Storage/A.html#e1ccaae6f291c2c7" class="i property">Delete</a>, <span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#eeb8c1ba23975375" class="i property">Definition</a>.<a href="/Azure.ResourceManager.Storage/A.html#e52d05b6a2ba7773" class="i property">Actions</a>.<a href="/Azure.ResourceManager.Storage/A.html#c0fcdabcb624d2e5" class="i property">Snapshot</a>.<a href="/Azure.ResourceManager.Storage/A.html#e1ccaae6f291c2c7" class="i property">Delete</a>);
                        }
                        <b>break</b>;
                    }
                }
                <span class="i">Assert</span>.<span class="i">True</span>(<span class="r189 r">ruleFound</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#9d5604d4425b216f" class="i method">Format</a>(<span class="s">&quot;The set rule {0} should be found in the output.&quot;</span>, <span class="r188 r">rule1</span>.<a href="/Azure.ResourceManager.Storage/A.html#af95db1f68864421" class="i property">Name</a>));
            }
        }
 
        <b>private static void</b> <a id="a87d2226e78f3815" href="../R/a87d2226e78f3815.html" target="n" data-glyph="76,1" class="i method">CompareDateAfterModification</a>(<a href="/Azure.ResourceManager.Storage/A.html#49b9fd10c694461b" class="t t">DateAfterModification</a> <span id="r191 rd" class="r191 r">date1</span>, <a href="/Azure.ResourceManager.Storage/A.html#49b9fd10c694461b" class="t t">DateAfterModification</a> <span id="r192 rd" class="r192 r">date2</span>)
        {
            <b>if</b> ((<span class="r191 r">date1</span> <b>is null</b>) &amp;&amp; (<span class="r192 r">date2</span> <b>is null</b>))
            {
                <b>return</b>;
            }
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r191 r">date1</span>.<a href="/Azure.ResourceManager.Storage/A.html#65eca26115e3f3c7" class="i property">DaysAfterModificationGreaterThan</a>, <span class="r192 r">date2</span>.<a href="/Azure.ResourceManager.Storage/A.html#65eca26115e3f3c7" class="i property">DaysAfterModificationGreaterThan</a>);
        }
 
        <b>private static void</b> <a id="fe9103d3addb6225" href="../R/fe9103d3addb6225.html" target="n" data-glyph="76,1" class="i method">CompareDateAfterCreation</a>(<a href="/Azure.ResourceManager.Storage/A.html#7d49f2856ab1a425" class="t t">DateAfterCreation</a> <span id="r193 rd" class="r193 r">date1</span>, <a href="/Azure.ResourceManager.Storage/A.html#7d49f2856ab1a425" class="t t">DateAfterCreation</a> <span id="r194 rd" class="r194 r">date2</span>)
        {
            <b>if</b> ((<span class="r193 r">date1</span> <b>is null</b>) &amp;&amp; (<span class="r194 r">date2</span> <b>is null</b>))
            {
                <b>return</b>;
            }
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r193 r">date1</span>.<a href="/Azure.ResourceManager.Storage/A.html#b888939314f85f5d" class="i property">DaysAfterCreationGreaterThan</a>, <span class="r194 r">date2</span>.<a href="/Azure.ResourceManager.Storage/A.html#b888939314f85f5d" class="i property">DaysAfterCreationGreaterThan</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="11fe5356f1af5a28" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateGetdfs</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r195 rd" class="r195 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r196 rd" class="r196 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r197 rd" class="r197 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e067bc77001bae0" class="i property">StandardGRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r198 rd" class="r198 r">parameters</span> =
                <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r197 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <a href="../Helpers/StorageTestsManagementClientBase.cs.html#683eb53b7df916d0" class="i field">DefaultRGLocation</a>) { <a href="/Azure.ResourceManager.Storage/A.html#5ed9d64852cfcff2" class="i property">IsHnsEnabled</a> = <b>true</b> };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r199 rd" class="r199 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r195 r">rgname</span>, <span class="r196 r">accountName</span>, <span class="r198 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r199 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#22aa5e86e88f69e9" class="i property">IsHnsEnabled</a> = <b>true</b>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r199 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ed6395340fcb6647" class="i property">PrimaryEndpoints</a>.<a href="/Azure.ResourceManager.Storage/A.html#0e645dd3dfd5f246" class="i property">Dfs</a>);
 
            <span class="c">// Validate</span>
            <span class="r199 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r195 r">rgname</span>, <span class="r196 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r199 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#22aa5e86e88f69e9" class="i property">IsHnsEnabled</a> = <b>true</b>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r199 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ed6395340fcb6647" class="i property">PrimaryEndpoints</a>.<a href="/Azure.ResourceManager.Storage/A.html#0e645dd3dfd5f246" class="i property">Dfs</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="e86189920d8ec133" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateWithFileStorage</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r200 rd" class="r200 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r201 rd" class="r201 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account with StorageV2</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r202 rd" class="r202 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#efdfb5cafd6d704b" class="i property">PremiumLRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r203 rd" class="r203 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r202 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#f60a2673cb2730ce" class="i property">FileStorage</a>, <span class="i">location</span>: <span class="s">&quot;centraluseuap&quot;</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r204 rd" class="r204 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r200 r">rgname</span>, <span class="r201 r">accountName</span>, <span class="r203 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r204 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#f60a2673cb2730ce" class="i property">FileStorage</a>, <span class="r204 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ca8827b4c95b78a6" class="i property">Kind</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#efdfb5cafd6d704b" class="i property">PremiumLRS</a>, <span class="r204 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="b41ae4764e95e0b9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateWithBlockBlobStorage</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r205 rd" class="r205 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r206 rd" class="r206 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account with StorageV2</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r207 rd" class="r207 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#efdfb5cafd6d704b" class="i property">PremiumLRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r208 rd" class="r208 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r207 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#97f4e763d4cb8448" class="i property">BlockBlobStorage</a>, <span class="i">location</span>: <span class="s">&quot;centraluseuap&quot;</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r209 rd" class="r209 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r205 r">rgname</span>, <span class="r206 r">accountName</span>, <span class="r208 r">parameters</span>);
            <a href="../Helpers/StorageTestsManagementClientBase.cs.html#3ed9a3d7fdd90ddd" class="i method">VerifyAccountProperties</a>(<span class="r209 r">account</span>, <b>false</b>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#97f4e763d4cb8448" class="i property">BlockBlobStorage</a>, <span class="r209 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ca8827b4c95b78a6" class="i property">Kind</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#efdfb5cafd6d704b" class="i property">PremiumLRS</a>, <span class="r209 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
        }
 
        [<span class="i">Test</span>]
        [<span class="i">Ignore</span>(<span class="s">&quot;Track2: Unable to locate active AAD DS for AAD tenant Id *************** associated with the storage account.&quot;</span>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="53bf60bee8dc9943" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateSetGetFileAadIntegration</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r210 rd" class="r210 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r211 rd" class="r211 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r212 rd" class="r212 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e067bc77001bae0" class="i property">StandardGRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r213 rd" class="r213 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r212 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <a href="../Helpers/StorageTestsManagementClientBase.cs.html#eea49042c36ee951" class="i field">DefaultLocation</a>)
            {
                <span class="i">AzureFilesIdentityBasedAuthentication</span> = <b>new</b> <span class="t">AzureFilesIdentityBasedAuthentication</span>(<a href="/Azure.ResourceManager.Storage/A.html#063431957e8ad658" class="t t">DirectoryServiceOptions</a>.<a href="/Azure.ResourceManager.Storage/A.html#65fed6c0bc5358d0" class="i property">Aadds</a>)
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r214 rd" class="r214 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r210 r">rgname</span>, <span class="r211 r">accountName</span>, <span class="r213 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#063431957e8ad658" class="t t">DirectoryServiceOptions</a>.<a href="/Azure.ResourceManager.Storage/A.html#65fed6c0bc5358d0" class="i property">Aadds</a>, <span class="r214 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#0c8b9e649ea955a3" class="i property">AzureFilesIdentityBasedAuthentication</a>.<a href="/Azure.ResourceManager.Storage/A.html#7da9209f303469bc" class="i property">DirectoryServiceOptions</a>);
 
            <span class="c">// Validate</span>
            <span class="r214 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r210 r">rgname</span>, <span class="r211 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#063431957e8ad658" class="t t">DirectoryServiceOptions</a>.<a href="/Azure.ResourceManager.Storage/A.html#65fed6c0bc5358d0" class="i property">Aadds</a>, <span class="r214 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#0c8b9e649ea955a3" class="i property">AzureFilesIdentityBasedAuthentication</a>.<a href="/Azure.ResourceManager.Storage/A.html#7da9209f303469bc" class="i property">DirectoryServiceOptions</a>);
 
            <span class="c">// Update storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r215 rd" class="r215 r">updateParameters</span> = <b>new</b> <span class="t">StorageAccountUpdateParameters</span>
            {
                <span class="i">AzureFilesIdentityBasedAuthentication</span> = <b>new</b> <span class="t">AzureFilesIdentityBasedAuthentication</span>(<a href="/Azure.ResourceManager.Storage/A.html#063431957e8ad658" class="t t">DirectoryServiceOptions</a>.<a href="/Azure.ResourceManager.Storage/A.html#742d7e646395f310" class="i property">None</a>),
                <a href="/Azure.ResourceManager.Storage/A.html#c4508e488f0e6e33" class="i property">EnableHttpsTrafficOnly</a> = <b>true</b>
            };
            <span class="r214 r">account</span> = <b>await</b> <a href="#d9c26608bf2a3e0d" class="i method">UpdateStorageAccountAsync</a>(<span class="r210 r">rgname</span>, <span class="r211 r">accountName</span>, <span class="r215 r">updateParameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#063431957e8ad658" class="t t">DirectoryServiceOptions</a>.<a href="/Azure.ResourceManager.Storage/A.html#742d7e646395f310" class="i property">None</a>, <span class="r214 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#0c8b9e649ea955a3" class="i property">AzureFilesIdentityBasedAuthentication</a>.<a href="/Azure.ResourceManager.Storage/A.html#7da9209f303469bc" class="i property">DirectoryServiceOptions</a>);
 
            <span class="c">// Validate</span>
            <span class="r214 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r210 r">rgname</span>, <span class="r211 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#063431957e8ad658" class="t t">DirectoryServiceOptions</a>.<a href="/Azure.ResourceManager.Storage/A.html#742d7e646395f310" class="i property">None</a>, <span class="r214 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#0c8b9e649ea955a3" class="i property">AzureFilesIdentityBasedAuthentication</a>.<a href="/Azure.ResourceManager.Storage/A.html#7da9209f303469bc" class="i property">DirectoryServiceOptions</a>);
        }
 
        [<span class="i">Test</span>]
        [<span class="i">Ignore</span>(<span class="s">&quot;Track2: Last sync time is unavailable for account sto218&quot;</span>)]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5e595c5f90072d46" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountFailOver</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r216 rd" class="r216 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r217 rd" class="r217 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r218 rd" class="r218 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#15fd5618a498cdbb" class="i property">StandardRagrs</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r219 rd" class="r219 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r218 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <a href="../Helpers/StorageTestsManagementClientBase.cs.html#eea49042c36ee951" class="i field">DefaultLocation</a>);
            <b>_</b> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r216 r">rgname</span>, <span class="r217 r">accountName</span>, <span class="r219 r">parameters</span>);
 
            <span class="c">// Wait for account ready to failover and Validate</span>
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r220 rd" class="r220 r">account</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r221 rd" class="r221 r">location</span>;
            <b>int</b> <span id="r222 rd" class="r222 r">i</span> = 100;
            <b>do</b>
            {
                <span class="r220 r">account</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">GetPropertiesAsync</span>(<span class="r216 r">rgname</span>, <span class="r217 r">accountName</span>, <span class="i">expand</span>: <a href="/Azure.ResourceManager.Storage/A.html#eaa9d3ccda2eedd0" class="t t">StorageAccountExpand</a>.<a href="/Azure.ResourceManager.Storage/A.html#48ca2a8691beca58" class="i field">GeoReplicationStats</a>);
                <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#15fd5618a498cdbb" class="i property">StandardRagrs</a>, <span class="r220 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
                <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r220 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#dd89e22a7195aa3b" class="i property">FailoverInProgress</a>);
                <span class="r221 r">location</span> = <span class="r220 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#1abfbc305026d99d" class="i property">SecondaryLocation</a>;
 
                <span class="c">//Don&#39;t need sleep when playback, or Unit test will be very slow. Need sleep when record.</span>
                <b>if</b> (<a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> == <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#62f98a4a2b1d56c3" class="i field">Record</a>)
                {
                    <span class="i n">System</span>.<span class="i n">Threading</span>.<a href="@0@mscorlib/A.html#3980e012bae82e96" class="t t">Thread</a>.<a href="@0@mscorlib/A.html#5f1072b92dae1dd8" class="i method">Sleep</a>(10000);
                }
            } <b>while</b> ((<span class="r220 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#e191993e93331c9a" class="i property">GeoReplicationStats</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e80ba4643485c95" class="i property">CanFailover</a> != <b>true</b>) &amp;&amp; (<span class="r222 r">i</span>-- &gt; 0));
 
            <span class="c">// Failover storage account</span>
            <span class="i">Operation</span>&lt;<span class="i">Response</span>&gt; <span id="r223 rd" class="r223 r">failoverWait</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">StartFailoverAsync</span>(<span class="r216 r">rgname</span>, <span class="r217 r">accountName</span>);
            <b>await</b> <span class="i">WaitForCompletionAsync</span>(<span class="r223 r">failoverWait</span>);
            <span class="c">// Validate</span>
            <span class="r220 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r216 r">rgname</span>, <span class="r217 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r220 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="r221 r">location</span>, <span class="r220 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#46097ab2c3cb063c" class="i property">PrimaryLocation</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="804caaeb98e82656" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountGetLastSyncTime</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r224 rd" class="r224 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r225 rd" class="r225 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r226 rd" class="r226 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#15fd5618a498cdbb" class="i property">StandardRagrs</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r227 rd" class="r227 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r226 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <span class="s">&quot;eastus2&quot;</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r228 rd" class="r228 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r224 r">rgname</span>, <span class="r225 r">accountName</span>, <span class="r227 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#15fd5618a498cdbb" class="i property">StandardRagrs</a>, <span class="r228 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r228 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#e191993e93331c9a" class="i property">GeoReplicationStats</a>);
            <span class="r228 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r224 r">rgname</span>, <span class="r225 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">Null</span>(<span class="r228 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#e191993e93331c9a" class="i property">GeoReplicationStats</a>);
            <span class="r228 r">account</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">GetPropertiesAsync</span>(<span class="r224 r">rgname</span>, <span class="r225 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#eaa9d3ccda2eedd0" class="t t">StorageAccountExpand</a>.<a href="/Azure.ResourceManager.Storage/A.html#48ca2a8691beca58" class="i field">GeoReplicationStats</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r228 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#e191993e93331c9a" class="i property">GeoReplicationStats</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r228 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#e191993e93331c9a" class="i property">GeoReplicationStats</a>.<a href="/Azure.ResourceManager.Storage/A.html#58b63c073658d0f0" class="i property">Status</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r228 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#e191993e93331c9a" class="i property">GeoReplicationStats</a>.<a href="/Azure.ResourceManager.Storage/A.html#88e3e98c695ee4db" class="i property">LastSyncTime</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r228 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#e191993e93331c9a" class="i property">GeoReplicationStats</a>.<a href="/Azure.ResourceManager.Storage/A.html#2e80ba4643485c95" class="i property">CanFailover</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="1d76054c049863ed" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountLargeFileSharesStateTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r229 rd" class="r229 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r230 rd" class="r230 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r231 rd" class="r231 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r232 rd" class="r232 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r231 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <span class="s">&quot;westeurope&quot;</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#c966e36f9648add5" class="i property">LargeFileSharesState</a> = <a href="/Azure.ResourceManager.Storage/A.html#79dbbc3986098616" class="t t">LargeFileSharesState</a>.<a href="/Azure.ResourceManager.Storage/A.html#e60911029444ca81" class="i property">Enabled</a>
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r233 rd" class="r233 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r229 r">rgname</span>, <span class="r230 r">accountName</span>, <span class="r232 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r233 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#79dbbc3986098616" class="t t">LargeFileSharesState</a>.<a href="/Azure.ResourceManager.Storage/A.html#e60911029444ca81" class="i property">Enabled</a>, <span class="r233 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#9db341448ce1833a" class="i property">LargeFileSharesState</a>);
 
            <span class="c">// Validate</span>
            <span class="r233 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r229 r">rgname</span>, <span class="r230 r">accountName</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r233 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#79dbbc3986098616" class="t t">LargeFileSharesState</a>.<a href="/Azure.ResourceManager.Storage/A.html#e60911029444ca81" class="i property">Enabled</a>, <span class="r233 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#9db341448ce1833a" class="i property">LargeFileSharesState</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="9e017fe6e95c8959" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountPrivateEndpointTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r234 rd" class="r234 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r235 rd" class="r235 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r236 rd" class="r236 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r237 rd" class="r237 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r236 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <span class="s">&quot;westeurope&quot;</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#c966e36f9648add5" class="i property">LargeFileSharesState</a> = <a href="/Azure.ResourceManager.Storage/A.html#79dbbc3986098616" class="t t">LargeFileSharesState</a>.<a href="/Azure.ResourceManager.Storage/A.html#e60911029444ca81" class="i property">Enabled</a>
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r238 rd" class="r238 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r234 r">rgname</span>, <span class="r235 r">accountName</span>, <span class="r237 r">parameters</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>, <span class="r238 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#81fae696e27e87d9" class="i property">Sku</a>.<a href="/Azure.ResourceManager.Storage/A.html#f97ebe98aae42a0d" class="i property">Name</a>);
 
            <span class="r238 r">account</span> = <b>await</b> <a href="#f38bb51cbe9bf18a" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<span class="r234 r">rgname</span>, <span class="r235 r">accountName</span>);
            <a href="@0@mscorlib/A.html#b040fb780bdd59f4" class="t t">IReadOnlyList</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#ab0cc8f802f0b26e" class="t t">PrivateEndpointConnection</a>&gt; <span id="r239 rd" class="r239 r">pes</span> = <span class="r238 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#1c101f04483ffcdc" class="i property">PrivateEndpointConnections</a>;
            <b>foreach</b> (<a href="/Azure.ResourceManager.Storage/A.html#ab0cc8f802f0b26e" class="t t">PrivateEndpointConnection</a> <span id="r240 rd" class="r240 r">pe</span> <b>in</b> <span class="r239 r">pes</span>)
            {
                <span class="c">//Get from account</span>
                <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#1db50ffcf19364f7" class="i property">PrivateEndpointConnectionsClient</a>.<span class="i">GetAsync</span>(<span class="r234 r">rgname</span>, <span class="r235 r">accountName</span>, <span class="r240 r">pe</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>);
 
                <span class="c">// Prepare data for set</span>
                <a href="/Azure.ResourceManager.Storage/A.html#e95643d67121a9eb" class="t t">PrivateEndpoint</a> <span id="r241 rd" class="r241 r">endpoint</span> = <b>new</b> <span class="t">PrivateEndpoint</span>();
                <a href="/Azure.ResourceManager.Storage/A.html#ab0cc8f802f0b26e" class="t t">PrivateEndpointConnection</a> <span id="r242 rd" class="r242 r">connection</span> = <b>new</b> <span class="t">PrivateEndpointConnection</span>()
                {
                    <span class="i">PrivateEndpoint</span> = <span class="r241 r">endpoint</span>,
                    <span class="i">PrivateLinkServiceConnectionState</span> = <b>new</b> <span class="t">PrivateLinkServiceConnectionState</span>()
                    {
                        <a href="/Azure.ResourceManager.Storage/A.html#19f25c9dc42c540d" class="i property">ActionRequired</a> = <span class="s">&quot;None&quot;</span>,
                        <a href="/Azure.ResourceManager.Storage/A.html#ba2d520b75300b2e" class="i property">Description</a> = <span class="s">&quot;123&quot;</span>,
                        <a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a> = <span class="s">&quot;Approved&quot;</span>
                    }
                };
 
                <b>if</b> (<span class="r240 r">pe</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a> != <span class="s">&quot;Rejected&quot;</span>)
                {
                    <span class="c">//Set approve</span>
                    <span class="r242 r">connection</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a> = <span class="s">&quot;Approved&quot;</span>;
                    <a href="/Azure.ResourceManager.Storage/A.html#ab0cc8f802f0b26e" class="t t">PrivateEndpointConnection</a> <span id="r243 rd" class="r243 r">pe3</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#1db50ffcf19364f7" class="i property">PrivateEndpointConnectionsClient</a>.<span class="i">PutAsync</span>(<span class="r234 r">rgname</span>, <span class="r235 r">accountName</span>, <span class="r240 r">pe</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>, <span class="r240 r">pe</span>);
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;Approved&quot;</span>, <span class="r243 r">pe3</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a>);
 
                    <span class="c">//Validate approve by get</span>
                    <span class="r243 r">pe3</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#1db50ffcf19364f7" class="i property">PrivateEndpointConnectionsClient</a>.<span class="i">GetAsync</span>(<span class="r234 r">rgname</span>, <span class="r235 r">accountName</span>, <span class="r240 r">pe</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>);
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;Approved&quot;</span>, <span class="r243 r">pe3</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a>);
                }
 
                <b>if</b> (<span class="r240 r">pe</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a> == <span class="s">&quot;Rejected&quot;</span>)
                {
                    <span class="c">//Set reject</span>
                    <span class="r242 r">connection</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a> = <span class="s">&quot;Rejected&quot;</span>;
                    <a href="/Azure.ResourceManager.Storage/A.html#ab0cc8f802f0b26e" class="t t">PrivateEndpointConnection</a> <span id="r244 rd" class="r244 r">pe4</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#1db50ffcf19364f7" class="i property">PrivateEndpointConnectionsClient</a>.<span class="i">PutAsync</span>(<span class="r234 r">rgname</span>, <span class="r235 r">accountName</span>, <span class="r240 r">pe</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>, <span class="r240 r">pe</span>);
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;Rejected&quot;</span>, <span class="r244 r">pe4</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a>);
 
                    <span class="c">//Validate reject by get</span>
                    <span class="r244 r">pe4</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#1db50ffcf19364f7" class="i property">PrivateEndpointConnectionsClient</a>.<span class="i">GetAsync</span>(<span class="r234 r">rgname</span>, <span class="r235 r">accountName</span>, <span class="r240 r">pe</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>);
                    <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;Rejected&quot;</span>, <span class="r244 r">pe4</span>.<a href="/Azure.ResourceManager.Storage/A.html#2df68b54f01de329" class="i property">PrivateLinkServiceConnectionState</a>.<a href="/Azure.ResourceManager.Storage/A.html#9e8b5addade1a9ad" class="i property">Status</a>);
                }
            }
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="26e8c6453e96fc13" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountPrivateLinkTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r245 rd" class="r245 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r246 rd" class="r246 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r247 rd" class="r247 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r248 rd" class="r248 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r247 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <span class="s">&quot;westus&quot;</span>)
            {
                <a href="/Azure.ResourceManager.Storage/A.html#c966e36f9648add5" class="i property">LargeFileSharesState</a> = <a href="/Azure.ResourceManager.Storage/A.html#79dbbc3986098616" class="t t">LargeFileSharesState</a>.<a href="/Azure.ResourceManager.Storage/A.html#e60911029444ca81" class="i property">Enabled</a>
            };
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r245 r">rgname</span>, <span class="r246 r">accountName</span>, <span class="r248 r">parameters</span>);
 
            <span class="c">// Get private link resource</span>
            <span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#4c976afe4a79d803" class="t t">PrivateLinkResourceListResult</a>&gt; <span id="r249 rd" class="r249 r">result</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#e97292932be6cc73" class="i property">PrivateLinkResourcesClient</a>.<span class="i">ListByStorageAccountAsync</span>(<span class="r245 r">rgname</span>, <span class="r246 r">accountName</span>);
 
            <span class="c">// Validate</span>
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r249 r">result</span>.<span class="i">Value</span>.<span class="i">Value</span>.<span class="i">Count</span> &gt; 0);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="a7f9d15993f7763f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StorageAccountCreateWithTableQueueEcryptionKeyTypeTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r250 rd" class="r250 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r251 rd" class="r251 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r252 rd" class="r252 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r253 rd" class="r253 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r252 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <span class="s">&quot;East US 2 EUAP&quot;</span>)
            {
                <span class="i">Encryption</span> = <b>new</b> <span class="t">Encryption</span>(<span class="i">keySource</span>: <a href="/Azure.ResourceManager.Storage/A.html#90055f28025ac8d1" class="t t">KeySource</a>.<a href="/Azure.ResourceManager.Storage/A.html#c6f2c458becdeaf2" class="i property">MicrosoftStorage</a>)
                {
                    <span class="i">Services</span> = <b>new</b> <span class="t">EncryptionServices</span>
                    {
                        <span class="i">Queue</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#f7916905155f5d61" class="i property">KeyType</a> = <a href="/Azure.ResourceManager.Storage/A.html#ea4b9d19bbff14ee" class="t t">KeyType</a>.<a href="/Azure.ResourceManager.Storage/A.html#474003ff223ef7fe" class="i property">Account</a> },
                        <span class="i">Table</span> = <b>new</b> <span class="t">EncryptionService</span> { <a href="/Azure.ResourceManager.Storage/A.html#f7916905155f5d61" class="i property">KeyType</a> = <a href="/Azure.ResourceManager.Storage/A.html#ea4b9d19bbff14ee" class="t t">KeyType</a>.<a href="/Azure.ResourceManager.Storage/A.html#474003ff223ef7fe" class="i property">Account</a> },
                    }
                }
            };
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r254 rd" class="r254 r">account</span> = <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r250 r">rgname</span>, <span class="r251 r">accountName</span>, <span class="r253 r">parameters</span>);
 
            <span class="c">// Verify encryption settings</span>
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#ea4b9d19bbff14ee" class="t t">KeyType</a>.<a href="/Azure.ResourceManager.Storage/A.html#474003ff223ef7fe" class="i property">Account</a>, <span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#f7916905155f5d61" class="i property">KeyType</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#ea4b9d19bbff14ee" class="t t">KeyType</a>.<a href="/Azure.ResourceManager.Storage/A.html#474003ff223ef7fe" class="i property">Account</a>, <span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#b15ad0b13563764e" class="i property">Blob</a>.<a href="/Azure.ResourceManager.Storage/A.html#f7916905155f5d61" class="i property">KeyType</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#947ed9c35c46677e" class="i property">File</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#ea4b9d19bbff14ee" class="t t">KeyType</a>.<a href="/Azure.ResourceManager.Storage/A.html#474003ff223ef7fe" class="i property">Account</a>, <span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>.<a href="/Azure.ResourceManager.Storage/A.html#f7916905155f5d61" class="i property">KeyType</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#45d0469edfab1d4b" class="i property">Queue</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
 
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#ea4b9d19bbff14ee" class="t t">KeyType</a>.<a href="/Azure.ResourceManager.Storage/A.html#474003ff223ef7fe" class="i property">Account</a>, <span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>.<a href="/Azure.ResourceManager.Storage/A.html#f7916905155f5d61" class="i property">KeyType</a>);
            <span class="i">Assert</span>.<span class="i">True</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>.<a href="/Azure.ResourceManager.Storage/A.html#d085661170ad31f3" class="i property">Enabled</a>);
            <span class="i">Assert</span>.<span class="i">NotNull</span>(<span class="r254 r">account</span>.<a href="/Azure.ResourceManager.Storage/A.html#ada47c207deaef2d" class="i property">Encryption</a>.<a href="/Azure.ResourceManager.Storage/A.html#2f570fadc3ed4a56" class="i property">Services</a>.<a href="/Azure.ResourceManager.Storage/A.html#813b154ca506b03f" class="i property">Table</a>.<a href="/Azure.ResourceManager.Storage/A.html#957019dff77a3860" class="i property">LastEnabledTime</a>);
        }
 
        [<span class="i">Test</span>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="5ea869510b7c5e26" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EcryptionScopeTest</a>()
        {
            <span class="c">//Create resource group</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r255 rd" class="r255 r">rgname</span> = <b>await</b> <a href="#a9ea4d2c4b0c8eff" class="i method">CreateResourceGroupAsync</a>();
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r256 rd" class="r256 r">accountName</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#ebd53467ba4df734" class="i method">GenerateAssetName</a>(<span class="s">&quot;sto&quot;</span>);
 
            <span class="c">// Create storage account</span>
            <a href="/Azure.ResourceManager.Storage/A.html#82cc792f7177f36f" class="t t">Sku</a> <span id="r257 rd" class="r257 r">sku</span> = <b>new</b> <span class="t">Sku</span>(<a href="/Azure.ResourceManager.Storage/A.html#351bd7a5c3f0ff27" class="t t">SkuName</a>.<a href="/Azure.ResourceManager.Storage/A.html#6a802c715712c3fc" class="i property">StandardLRS</a>);
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r258 rd" class="r258 r">parameters</span> = <b>new</b> <span class="t">StorageAccountCreateParameters</span>(<span class="i">sku</span>: <span class="r257 r">sku</span>, <span class="i">kind</span>: <a href="/Azure.ResourceManager.Storage/A.html#3736c88f72d7e338" class="t t">Kind</a>.<a href="/Azure.ResourceManager.Storage/A.html#71b54f259467dce5" class="i property">StorageV2</a>, <span class="i">location</span>: <span class="s">&quot;East US 2 EUAP&quot;</span>);
            <b>await</b> <a href="#6cce5c682bde467c" class="i method">_CreateStorageAccountAsync</a>(<span class="r255 r">rgname</span>, <span class="r256 r">accountName</span>, <span class="r258 r">parameters</span>);
 
            <span class="c">//Create EcryptionScope</span>
            <a href="/Azure.ResourceManager.Storage/A.html#9f2bde7ee0f976f6" class="t t">EncryptionScope</a> <span id="r259 rd" class="r259 r">EncryptionScope</span> = <b>new</b> <span class="t">EncryptionScope</span>()
            {
                <a href="/Azure.ResourceManager.Storage/A.html#28ffc69a2bc3fcd5" class="i property">Source</a> = <a href="/Azure.ResourceManager.Storage/A.html#4976e38d258d9c89" class="t t">EncryptionScopeSource</a>.<a href="/Azure.ResourceManager.Storage/A.html#5a04cb7058d2e93a" class="i property">MicrosoftStorage</a>,
                <a href="/Azure.ResourceManager.Storage/A.html#70265c891d9b45e0" class="i property">State</a> = <a href="/Azure.ResourceManager.Storage/A.html#b7cd74f58011b3ec" class="t t">EncryptionScopeState</a>.<a href="/Azure.ResourceManager.Storage/A.html#04f452d23efe095a" class="i property">Disabled</a>
            };
            <a href="/Azure.ResourceManager.Storage/A.html#9f2bde7ee0f976f6" class="t t">EncryptionScope</a> <span id="r260 rd" class="r260 r">es</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#b9020d5e25edbbb6" class="i property">EncryptionScopesClient</a>.<span class="i">PutAsync</span>(<span class="r255 r">rgname</span>, <span class="r256 r">accountName</span>, <span class="s">&quot;testscope&quot;</span>, <span class="r259 r">EncryptionScope</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;testscope&quot;</span>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#b7cd74f58011b3ec" class="t t">EncryptionScopeState</a>.<a href="/Azure.ResourceManager.Storage/A.html#04f452d23efe095a" class="i property">Disabled</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#70265c891d9b45e0" class="i property">State</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#4976e38d258d9c89" class="t t">EncryptionScopeSource</a>.<a href="/Azure.ResourceManager.Storage/A.html#5a04cb7058d2e93a" class="i property">MicrosoftStorage</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#28ffc69a2bc3fcd5" class="i property">Source</a>);
 
            <span class="c">// Get EcryptionScope</span>
            <span class="r260 r">es</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#b9020d5e25edbbb6" class="i property">EncryptionScopesClient</a>.<span class="i">GetAsync</span>(<span class="r255 r">rgname</span>, <span class="r256 r">accountName</span>, <span class="s">&quot;testscope&quot;</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;testscope&quot;</span>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#b7cd74f58011b3ec" class="t t">EncryptionScopeState</a>.<a href="/Azure.ResourceManager.Storage/A.html#04f452d23efe095a" class="i property">Disabled</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#70265c891d9b45e0" class="i property">State</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#4976e38d258d9c89" class="t t">EncryptionScopeSource</a>.<a href="/Azure.ResourceManager.Storage/A.html#5a04cb7058d2e93a" class="i property">MicrosoftStorage</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#28ffc69a2bc3fcd5" class="i property">Source</a>);
 
            <span class="c">// Patch EcryptionScope</span>
            <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#70265c891d9b45e0" class="i property">State</a> = <a href="/Azure.ResourceManager.Storage/A.html#b7cd74f58011b3ec" class="t t">EncryptionScopeState</a>.<a href="/Azure.ResourceManager.Storage/A.html#d50975be2570b60f" class="i property">Enabled</a>;
            <span class="r260 r">es</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#b9020d5e25edbbb6" class="i property">EncryptionScopesClient</a>.<span class="i">PatchAsync</span>(<span class="r255 r">rgname</span>, <span class="r256 r">accountName</span>, <span class="s">&quot;testscope&quot;</span>, <span class="r260 r">es</span>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;testscope&quot;</span>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#b7cd74f58011b3ec" class="t t">EncryptionScopeState</a>.<a href="/Azure.ResourceManager.Storage/A.html#d50975be2570b60f" class="i property">Enabled</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#70265c891d9b45e0" class="i property">State</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#4976e38d258d9c89" class="t t">EncryptionScopeSource</a>.<a href="/Azure.ResourceManager.Storage/A.html#5a04cb7058d2e93a" class="i property">MicrosoftStorage</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#28ffc69a2bc3fcd5" class="i property">Source</a>);
 
            <span class="c">//List EcryptionScope</span>
            <span class="i">AsyncPageable</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#9f2bde7ee0f976f6" class="t t">EncryptionScope</a>&gt; <span id="r261 rd" class="r261 r">ess</span> = <a href="../Helpers/StorageTestsManagementClientBase.cs.html#b9020d5e25edbbb6" class="i property">EncryptionScopesClient</a>.<span class="i">ListAsync</span>(<span class="r255 r">rgname</span>, <span class="r256 r">accountName</span>);
            <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#9f2bde7ee0f976f6" class="t t">EncryptionScope</a>&gt;&gt; <span id="r262 rd" class="r262 r">essList</span> = <span class="r261 r">ess</span>.<span class="i">ToEnumerableAsync</span>();
            <span class="r260 r">es</span> = <span class="r262 r">essList</span>.<a href="@0@mscorlib/A.html#826690b09f24e719" class="i property">Result</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<span class="s">&quot;testscope&quot;</span>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#98f82df26bc82663" class="i property">Name</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#b7cd74f58011b3ec" class="t t">EncryptionScopeState</a>.<a href="/Azure.ResourceManager.Storage/A.html#d50975be2570b60f" class="i property">Enabled</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#70265c891d9b45e0" class="i property">State</a>);
            <span class="i">Assert</span>.<span class="i">AreEqual</span>(<a href="/Azure.ResourceManager.Storage/A.html#4976e38d258d9c89" class="t t">EncryptionScopeSource</a>.<a href="/Azure.ResourceManager.Storage/A.html#5a04cb7058d2e93a" class="i property">MicrosoftStorage</a>, <span class="r260 r">es</span>.<a href="/Azure.ResourceManager.Storage/A.html#28ffc69a2bc3fcd5" class="i property">Source</a>);
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="a9ea4d2c4b0c8eff" href="../R/a9ea4d2c4b0c8eff.html" target="n" data-glyph="76,1" class="i method">CreateResourceGroupAsync</a>()
        {
            <b>return</b> <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#c3b135d4017b41bc" class="i method">CreateResourceGroup</a>(<a href="../Helpers/StorageTestsManagementClientBase.cs.html#7c96d42be68c3d0b" class="i property">ResourceGroupsClient</a>, <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>);
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <a id="6cce5c682bde467c" href="../R/6cce5c682bde467c.html" target="n" data-glyph="76,1" class="i method">_CreateStorageAccountAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r263 rd" class="r263 r">resourceGroupName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r264 rd" class="r264 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r265 rd" class="r265 r">parameters</span> = <b>null</b>)
        {
            <a href="/Azure.ResourceManager.Storage/A.html#40d62a3de28bc346" class="t t">StorageAccountCreateParameters</a> <span id="r266 rd" class="r266 r">saParameters</span> = <span class="r265 r">parameters</span> ?? <a href="../Helpers/StorageTestsManagementClientBase.cs.html#dfd768fe829e1c69" class="i method">GetDefaultStorageAccountParameters</a>();
            <span class="i">Operation</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt; <span id="r267 rd" class="r267 r">accountsResponse</span> = <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">StartCreateAsync</span>(<span class="r263 r">resourceGroupName</span>, <span class="r264 r">accountName</span>, <span class="r266 r">saParameters</span>);
            <a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a> <span id="r268 rd" class="r268 r">account</span> = (<b>await</b> <span class="i">WaitForCompletionAsync</span>(<span class="r267 r">accountsResponse</span>)).<span class="i">Value</span>;
            <b>return</b> <span class="r268 r">account</span>;
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt;&gt; <a id="f38bb51cbe9bf18a" href="../R/f38bb51cbe9bf18a.html" target="n" data-glyph="76,1" class="i method">WaitToGetAccountSuccessfullyAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r269 rd" class="r269 r">resourceGroupName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r270 rd" class="r270 r">accountName</span>)
        {
            <b>return</b> <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">GetPropertiesAsync</span>(<span class="r269 r">resourceGroupName</span>, <span class="r270 r">accountName</span>);
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="i">Response</span>&lt;<a href="/Azure.ResourceManager.Storage/A.html#e8c0cc28589411d3" class="t t">StorageAccount</a>&gt;&gt; <a id="d9c26608bf2a3e0d" href="../R/d9c26608bf2a3e0d.html" target="n" data-glyph="76,1" class="i method">UpdateStorageAccountAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r271 rd" class="r271 r">resourceGroupName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r272 rd" class="r272 r">accountName</span>, <a href="/Azure.ResourceManager.Storage/A.html#26fbd866a69f1bf5" class="t t">StorageAccountUpdateParameters</a> <span id="r273 rd" class="r273 r">parameters</span>)
        {
            <b>return</b> <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">UpdateAsync</span>(<span class="r271 r">resourceGroupName</span>, <span class="r272 r">accountName</span>, <span class="r273 r">parameters</span>);
        }
 
        <b>private async</b> <a href="@0@mscorlib/A.html#5ca7b77f3df89fc6" class="t t">Task</a>&lt;<span class="i">Response</span>&gt; <a id="e0d6f47a6b24f6ef" href="../R/e0d6f47a6b24f6ef.html" target="n" data-glyph="76,1" class="i method">DeleteStorageAccountAsync</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r274 rd" class="r274 r">resourceGroupName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r275 rd" class="r275 r">accountName</span>)
        {
            <b>return</b> <b>await</b> <a href="../Helpers/StorageTestsManagementClientBase.cs.html#bb79ab035e50c287" class="i property">AccountsClient</a>.<span class="i">DeleteAsync</span>(<span class="r274 r">resourceGroupName</span>, <span class="r275 r">accountName</span>);
        }
    }
}
</pre></td></tr></table></div></body></html>
