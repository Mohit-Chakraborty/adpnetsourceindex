<!DOCTYPE html>
<html><head><title>DeploymentWhatIfTests.InMemory.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(764);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Resource.Tests/InMemoryTests/DeploymentWhatIfTests.InMemory.cs" target="_top">InMemoryTests\DeploymentWhatIfTests.InMemory.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Resource.Tests" target="_top">Microsoft.Azure.Management.Resource.Tests.csproj</a> (Resource.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>namespace</b> <span class="i n">ResourceGroups</span>.<span class="i n">Tests</span>
{
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">ResourceManager</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Azure</span>.<span class="i n">Management</span>.<span class="i n">ResourceManager</span>.<span class="i n">Models</span>;
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Rest</span>;
    <b>using</b> <span class="i n">Newtonsoft</span>.<span class="i n">Json</span>.<span class="i n">Linq</span>;
    <b>using</b> <span class="i n">System</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>.<span class="i n">Http</span>;
    <b>using</b> <span class="i n">Xunit</span>;
 
    <b>public class</b> <a id="7af7219d7d1c7e23" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="95ab4050a04e5eed">InMemoryDeploymentWhatIfTests</span></a>
    {
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="e192c0ac7acabbf6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIf_SendingRequest_SetsHeaders</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r0 rd" class="r0 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r1 rd" class="r1 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4f7e521567b6d8b3" class="t constructor">DeploymentWhatIf</a>(<b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r2 rd" class="r2 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r0 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r2 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#dc0f04a409569b74" class="i method">WhatIf</a>(<span class="s">&quot;test-rg&quot;</span>, <span class="s">&quot;test-deploy&quot;</span>, <span class="r1 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;application/json; charset=utf-8&quot;</span>, <span class="r0 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#5cc5f40712d3911c" class="i property">ContentHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Content-Type&quot;</span>).<span class="i method">First</span>());
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">HttpMethod</span>.<span class="i property">Post</span>, <span class="r0 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#afdd38f25a2eac7b" class="i property">Method</a>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r0 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#bbe0bb5f41324b5b" class="i property">RequestHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Authorization&quot;</span>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="498df898e75e92ec" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIf_SendingRequest_SerializesPayload</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r3 rd" class="r3 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r4 rd" class="r4 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#f6bfa07ccb51a320" class="t constructor">DeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#25eb714f4778694d" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#170ae2c492003bcb" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#04fd4cef81222467" class="i field">Complete</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#49f23205b8aaa864" class="i property">TemplateLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4570ebf5d9bc5627" class="t constructor">TemplateLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#440d28eff5217f2d" class="i property">Uri</a> = <span class="s">&quot;https://example.com&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#29135be1045cf49f" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#873a9e9f6e9fabfc" class="i property">ParametersLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#692a4cd1e5161f9c" class="t constructor">ParametersLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8dc5df1cc844bd02" class="i property">Uri</a> = <span class="s">&quot;https://example.com/parameters&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#905567690f8fefcf" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>),
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                    {
                        [<span class="s">&quot;param1&quot;</span>] = <span class="s">&quot;foo&quot;</span>,
                        [<span class="s">&quot;param2&quot;</span>] = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                        {
                            [<span class="s">&quot;param2_1&quot;</span>] = 123,
                            [<span class="s">&quot;param2_2&quot;</span>] = <span class="s">&quot;bar&quot;</span>
                        }
                    }
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r5 rd" class="r5 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r3 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r5 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#dc0f04a409569b74" class="i method">WhatIf</a>(<span class="s">&quot;test-rg&quot;</span>, <span class="s">&quot;test-deploy&quot;</span>, <span class="r4 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r6 rd" class="r6 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r3 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;westus&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;location&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Complete&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com/parameters&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>), <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;foo&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(123, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;bar&quot;</span>, <span class="r6 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_2&quot;</span>]);
        }
 
        [<span class="t constructor">Theory</span>]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#&#39;,
            &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
            &#39;parameters&#39;: {
                &#39;storageAccountName&#39;: {
                    &#39;value&#39;: &#39;lsfjlasf9urw&#39;
                }
            }
        }&quot;</span>)]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;storageAccountName&#39;: {
                &#39;value&#39;: &#39;lsfjlasf9urw&#39;
            }
        }&quot;</span>)]
        <b>public void</b> <a id="c443c58abaa4b603" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIf_SendingRequestWithStrings_SerializesPayload</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r7 rd" class="r7 r">parameterContent</span>)
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r8 rd" class="r8 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <b>const string</b> <span id="r9 rd" class="r9 r">templateContent</span> = <span class="s">@&quot;{
                &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&#39;,
                &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
                &#39;parameters&#39;: {
                    &#39;storageAccountName&#39;: {
		                &#39;type&#39;: &#39;string&#39;
	                }
                },
                &#39;resources&#39;: [
                ],
                &#39;outputs&#39;: {}
            }&quot;</span>;
 
        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r10 rd" class="r10 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#f6bfa07ccb51a320" class="t constructor">DeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#25eb714f4778694d" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#170ae2c492003bcb" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#2567cbf88c46485d" class="i field">Incremental</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="r9 r">templateContent</span>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <span class="r7 r">parameterContent</span>
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r11 rd" class="r11 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r8 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r11 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#dc0f04a409569b74" class="i method">WhatIf</a>(<span class="s">&quot;test-rg&quot;</span>, <span class="s">&quot;test-deploy&quot;</span>, <span class="r10 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r12 rd" class="r12 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r8 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Incremental&quot;</span>, <span class="r12 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r12 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;lsfjlasf9urw&quot;</span>, <span class="r12 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;storageAccountName&quot;</span>][<span class="s">&quot;value&quot;</span>]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="5d15d49cd2cc5443" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIf_ReceivingResponse_DeserializesResult</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r13 rd" class="r13 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4f7e521567b6d8b3" class="t constructor">DeploymentWhatIf</a>(<b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
            <b>var</b> <span id="r14 rd" class="r14 r">response</span> = <b>new</b> <span class="t constructor">HttpResponseMessage</span>(<span class="t t">HttpStatusCode</span>.<span class="i field">OK</span>)
            {
                <span class="i property">Content</span> = <b>new</b> <span class="t constructor">StringContent</span>(<span class="s">@&quot;{
                    &#39;status&#39;: &#39;Succeeded&#39;,
                    &#39;properties&#39;: {
                        &#39;changes&#39;: [
                            {
                                &#39;resourceId&#39;: &#39;/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/myResourceGroup/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myExistingIdentity&#39;,
                                &#39;changeType&#39;: &#39;Modify&#39;,
                                &#39;before&#39;: {
                                    &#39;apiVersion&#39;: &#39;2018-11-30&#39;,
                                    &#39;id&#39;: &#39;/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/myResourceGroup/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myExistingIdentity&#39;,
                                    &#39;type&#39;: &#39;Microsoft.ManagedIdentity/userAssignedIdentities&#39;,
                                    &#39;name&#39;: &#39;myExistingIdentity&#39;,
                                    &#39;location&#39;: &#39;westus2&#39;
                                },
                                &#39;after&#39;: {
                                    &#39;apiVersion&#39;: &#39;2018-11-30&#39;,
                                    &#39;id&#39;: &#39;/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/myResourceGroup/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myExistingIdentity&#39;,
                                    &#39;type&#39;: &#39;Microsoft.ManagedIdentity/userAssignedIdentities&#39;,
                                    &#39;name&#39;: &#39;myExistingIdentity&#39;,
                                    &#39;location&#39;: &#39;westus2&#39;,
                                    &#39;tags&#39;: {
                                        &#39;myNewTag&#39;: &#39;my tag value&#39;
                                    }
                                },
                                &#39;delta&#39;: [
                                    {
                                        &#39;path&#39;: &#39;tags.myNewTag&#39;,
                                        &#39;propertyChangeType&#39;: &#39;Create&#39;,
                                        &#39;after&#39;: &#39;my tag value&#39;
                                    }
                                ]
                            }
                        ]
                    }
                }&quot;</span>)
            };
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r15 rd" class="r15 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#87add478f2e737f3" class="t constructor">RecordedDelegatingHandler</a>(<span class="r14 r">response</span>) { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r16 rd" class="r16 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r15 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#5419b0429bf98f59" class="t t">WhatIfOperationResult</a> <span id="r17 rd" class="r17 r">result</span> = <span class="r16 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#dc0f04a409569b74" class="i method">WhatIf</a>(<span class="s">&quot;test-rg&quot;</span>, <span class="s">&quot;test-deploy&quot;</span>, <span class="r13 r">deploymentWhatIf</span>);
 
                <span class="c">// Assert.</span>
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Succeeded&quot;</span>, <span class="r17 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#4efc7861b37e87f2" class="i property">Status</a>);
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r17 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(1, <span class="r17 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>.<a href="@1@System.Runtime/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>);
 
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#2524e7781c468c68" class="t t">WhatIfChange</a> <span id="r18 rd" class="r18 r">change</span> = <span class="r17 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>[0];
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Management.ResourceManager/A.html#011cb66035a63a16" class="t t">ChangeType</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#b07b000891b960a3" class="i field">Modify</a>, <span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#458eb08a66b5e37a" class="i property">ChangeType</a>);
 
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#73d29faec050629b" class="i property">Before</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;myExistingIdentity&quot;</span>, <span class="t t">JToken</span>.<span class="i method">FromObject</span>(<span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#73d29faec050629b" class="i property">Before</a>)[<span class="s">&quot;name&quot;</span>]);
 
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;myExistingIdentity&quot;</span>, <span class="t t">JToken</span>.<span class="i method">FromObject</span>(<span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>)[<span class="s">&quot;name&quot;</span>]);
 
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(1, <span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>.<a href="@1@System.Runtime/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;tags.myNewTag&quot;</span>, <span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>[0].<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cd84ea0a652603a1" class="i property">Path</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Management.ResourceManager/A.html#d1fe4536e9f6c0c2" class="t t">PropertyChangeType</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#0e6b4c6d2e2bf64d" class="i field">Create</a>, <span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>[0].<a href="/Microsoft.Azure.Management.ResourceManager/A.html#dac78aa03b11645a" class="i property">PropertyChangeType</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;my tag value&quot;</span>, <span class="r18 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>[0].<a href="/Microsoft.Azure.Management.ResourceManager/A.html#15e4a2fffe09894e" class="i property">After</a>);
            }
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="e6e2e695f5e31429" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtSubscriptionScope_SendingRequest_SetsHeaders</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r19 rd" class="r19 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r20 rd" class="r20 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4f7e521567b6d8b3" class="t constructor">DeploymentWhatIf</a>(<b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r21 rd" class="r21 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r19 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r21 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#b7dcab2d8b2a50a6" class="i method">WhatIfAtSubscriptionScope</a>(<span class="s">&quot;test-subscription-deploy&quot;</span>, <span class="r20 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;application/json; charset=utf-8&quot;</span>, <span class="r19 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#5cc5f40712d3911c" class="i property">ContentHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Content-Type&quot;</span>).<span class="i method">First</span>());
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">HttpMethod</span>.<span class="i property">Post</span>, <span class="r19 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#afdd38f25a2eac7b" class="i property">Method</a>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r19 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#bbe0bb5f41324b5b" class="i property">RequestHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Authorization&quot;</span>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="db3d5701ce86c90d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtSubscriptionScope_SendingRequest_SerializesPayload</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r22 rd" class="r22 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r23 rd" class="r23 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#f6bfa07ccb51a320" class="t constructor">DeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#25eb714f4778694d" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#170ae2c492003bcb" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#04fd4cef81222467" class="i field">Complete</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#49f23205b8aaa864" class="i property">TemplateLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4570ebf5d9bc5627" class="t constructor">TemplateLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#440d28eff5217f2d" class="i property">Uri</a> = <span class="s">&quot;https://example.com&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#29135be1045cf49f" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#873a9e9f6e9fabfc" class="i property">ParametersLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#692a4cd1e5161f9c" class="t constructor">ParametersLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8dc5df1cc844bd02" class="i property">Uri</a> = <span class="s">&quot;https://example.com/parameters&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#905567690f8fefcf" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>),
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                    {
                        [<span class="s">&quot;param1&quot;</span>] = <span class="s">&quot;foo&quot;</span>,
                        [<span class="s">&quot;param2&quot;</span>] = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                        {
                            [<span class="s">&quot;param2_1&quot;</span>] = 123,
                            [<span class="s">&quot;param2_2&quot;</span>] = <span class="s">&quot;bar&quot;</span>
                        }
                    }
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r24 rd" class="r24 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r22 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r24 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#b7dcab2d8b2a50a6" class="i method">WhatIfAtSubscriptionScope</a>(<span class="s">&quot;test-subscription-deploy&quot;</span>, <span class="r23 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r25 rd" class="r25 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r22 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;westus&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;location&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Complete&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com/parameters&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>), <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;foo&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(123, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;bar&quot;</span>, <span class="r25 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_2&quot;</span>]);
        }
 
        [<span class="t constructor">Theory</span>]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#&#39;,
            &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
            &#39;parameters&#39;: {
                &#39;roleDefName&#39;: {
                   &#39;value&#39;: &#39;myCustomRole&#39;
                }
            }
        }&quot;</span>)]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;roleDefName&#39;: {
                &#39;value&#39;: &#39;myCustomRole&#39;
            }
        }&quot;</span>)]
        <b>public void</b> <a id="705aa7f8d1703b0e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtSubscriptionScope_SendingRequestWithStrings_SerializesPayload</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r26 rd" class="r26 r">parameterContent</span>)
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r27 rd" class="r27 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r28 rd" class="r28 r">templateContent</span> = <span class="s">@&quot;{
                &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&#39;,
                &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
                &#39;parameters&#39;: {
                    &#39;roleDefName&#39;: {
		                &#39;type&#39;: &#39;string&#39;
	                }
                },
                &#39;resources&#39;: [
                ],
                &#39;outputs&#39;: {}
            }&quot;</span>;
 
        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r29 rd" class="r29 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#f6bfa07ccb51a320" class="t constructor">DeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#25eb714f4778694d" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#170ae2c492003bcb" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#2567cbf88c46485d" class="i field">Incremental</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="r28 r">templateContent</span>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <span class="r26 r">parameterContent</span>
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r30 rd" class="r30 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r27 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r30 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#b7dcab2d8b2a50a6" class="i method">WhatIfAtSubscriptionScope</a>(<span class="s">&quot;test-subscription-deploy&quot;</span>, <span class="r29 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r31 rd" class="r31 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r27 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Incremental&quot;</span>, <span class="r31 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r31 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;myCustomRole&quot;</span>, <span class="r31 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;roleDefName&quot;</span>][<span class="s">&quot;value&quot;</span>]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="01de5eec367b3482" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtSubscriptionScope_ReceivingResponse_DeserializesResult</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e31457edca86ae5e" class="k">var</a> <span id="r32 rd" class="r32 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4f7e521567b6d8b3" class="t constructor">DeploymentWhatIf</a>(<b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
            <b>var</b> <span id="r33 rd" class="r33 r">response</span> = <b>new</b> <span class="t constructor">HttpResponseMessage</span>(<span class="t t">HttpStatusCode</span>.<span class="i field">OK</span>)
            {
                <span class="i property">Content</span> = <b>new</b> <span class="t constructor">StringContent</span>(<span class="s">@&quot;{
                    &#39;status&#39;: &#39;Succeeded&#39;,
                    &#39;properties&#39;: {
                        &#39;changes&#39;: [
                            {
                                &#39;resourceId&#39;: &#39;/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/myResourceGroup&#39;,
                                &#39;changeType&#39;: &#39;Create&#39;,
                                &#39;after&#39;: {
                                    &#39;apiVersion&#39;: &#39;2019-05-01&#39;,
                                    &#39;id&#39;: &#39;/subscriptions/00000000-0000-0000-0000-000000000001/resourceGroups/myResourceGroup&#39;,
                                    &#39;type&#39;: &#39;Microsoft.Resources/resourceGroups&#39;,
                                    &#39;name&#39;: &#39;myResourceGroup&#39;,
                                    &#39;location&#39;: &#39;eastus&#39;,
                                }
                            }
                        ]
                    }
                }&quot;</span>)
            };
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r34 rd" class="r34 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#87add478f2e737f3" class="t constructor">RecordedDelegatingHandler</a>(<span class="r33 r">response</span>) { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r35 rd" class="r35 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r34 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#5419b0429bf98f59" class="t t">WhatIfOperationResult</a> <span id="r36 rd" class="r36 r">result</span> =
                    <span class="r35 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#b7dcab2d8b2a50a6" class="i method">WhatIfAtSubscriptionScope</a>(<span class="s">&quot;test-subscription-deploy&quot;</span>, <span class="r32 r">deploymentWhatIf</span>);
 
                <span class="c">// Assert.</span>
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Succeeded&quot;</span>, <span class="r36 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#4efc7861b37e87f2" class="i property">Status</a>);
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r36 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(1, <span class="r36 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>.<a href="@1@System.Runtime/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>);
 
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#2524e7781c468c68" class="t t">WhatIfChange</a> <span id="r37 rd" class="r37 r">change</span> = <span class="r36 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>[0];
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Management.ResourceManager/A.html#011cb66035a63a16" class="t t">ChangeType</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#092ae8910df57683" class="i field">Create</a>, <span class="r37 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#458eb08a66b5e37a" class="i property">ChangeType</a>);
 
                <span class="t t">Assert</span>.<span class="i method">Null</span>(<span class="r37 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#73d29faec050629b" class="i property">Before</a>);
                <span class="t t">Assert</span>.<span class="i method">Null</span>(<span class="r37 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>);
 
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r37 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;myResourceGroup&quot;</span>, <span class="t t">JToken</span>.<span class="i method">FromObject</span>(<span class="r37 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>)[<span class="s">&quot;name&quot;</span>]);
            }
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="26f2f7d00729e64a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtManagementGroupScope_SendingRequest_SetsHeaders</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r38 rd" class="r38 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r39 rd" class="r39 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c36228825c52b703" class="t constructor">ScopedDeploymentWhatIf</a>(<span class="s">&quot;westus&quot;</span>, <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r40 rd" class="r40 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r38 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r40 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#85ca2308100a8dee" class="i method">WhatIfAtManagementGroupScope</a>(<span class="s">&quot;test-mg&quot;</span>, <span class="s">&quot;test-mg-deploy&quot;</span>, <span class="r39 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;application/json; charset=utf-8&quot;</span>, <span class="r38 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#5cc5f40712d3911c" class="i property">ContentHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Content-Type&quot;</span>).<span class="i method">First</span>());
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">HttpMethod</span>.<span class="i property">Post</span>, <span class="r38 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#afdd38f25a2eac7b" class="i property">Method</a>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r38 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#bbe0bb5f41324b5b" class="i property">RequestHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Authorization&quot;</span>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="2492e2e57d2cdcd8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtManagementGroupScope_SendingRequest_SerializesPayload</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r41 rd" class="r41 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r42 rd" class="r42 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#738515c5a5e96598" class="t constructor">ScopedDeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#b608b3669cf41427" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#cd209e2cb7977688" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#04fd4cef81222467" class="i field">Complete</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#49f23205b8aaa864" class="i property">TemplateLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4570ebf5d9bc5627" class="t constructor">TemplateLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#440d28eff5217f2d" class="i property">Uri</a> = <span class="s">&quot;https://example.com&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#29135be1045cf49f" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#873a9e9f6e9fabfc" class="i property">ParametersLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#692a4cd1e5161f9c" class="t constructor">ParametersLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8dc5df1cc844bd02" class="i property">Uri</a> = <span class="s">&quot;https://example.com/parameters&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#905567690f8fefcf" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>),
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                    {
                        [<span class="s">&quot;param1&quot;</span>] = <span class="s">&quot;foo&quot;</span>,
                        [<span class="s">&quot;param2&quot;</span>] = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                        {
                            [<span class="s">&quot;param2_1&quot;</span>] = 123,
                            [<span class="s">&quot;param2_2&quot;</span>] = <span class="s">&quot;bar&quot;</span>
                        }
                    }
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r43 rd" class="r43 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r41 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r43 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#85ca2308100a8dee" class="i method">WhatIfAtManagementGroupScope</a>(<span class="s">&quot;test-mg&quot;</span>, <span class="s">&quot;test-mg-deploy&quot;</span>, <span class="r42 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r44 rd" class="r44 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r41 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;westus&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;location&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Complete&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com/parameters&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>), <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;foo&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(123, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;bar&quot;</span>, <span class="r44 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_2&quot;</span>]);
        }
 
        [<span class="t constructor">Theory</span>]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#&#39;,
            &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
            &#39;parameters&#39;: {
                &#39;roleDefName&#39;: {
                   &#39;value&#39;: &#39;myCustomRole&#39;
                }
            }
        }&quot;</span>)]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;roleDefName&#39;: {
                &#39;value&#39;: &#39;myCustomRole&#39;
            }
        }&quot;</span>)]
        <b>public void</b> <a id="a29e902cbc9666e5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtManagementGroupScope_SendingRequestWithStrings_SerializesPayload</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r45 rd" class="r45 r">parameterContent</span>)
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r46 rd" class="r46 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r47 rd" class="r47 r">templateContent</span> = <span class="s">@&quot;{
                &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&#39;,
                &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
                &#39;parameters&#39;: {
                    &#39;roleDefName&#39;: {
		                &#39;type&#39;: &#39;string&#39;
	                }
                },
                &#39;resources&#39;: [
                ],
                &#39;outputs&#39;: {}
            }&quot;</span>;
 
        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r48 rd" class="r48 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#738515c5a5e96598" class="t constructor">ScopedDeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#b608b3669cf41427" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#cd209e2cb7977688" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#2567cbf88c46485d" class="i field">Incremental</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="r47 r">templateContent</span>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <span class="r45 r">parameterContent</span>
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r49 rd" class="r49 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r46 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r49 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#85ca2308100a8dee" class="i method">WhatIfAtManagementGroupScope</a>(<span class="s">&quot;test-mg&quot;</span>, <span class="s">&quot;test-mg-deploy&quot;</span>, <span class="r48 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r50 rd" class="r50 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r46 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Incremental&quot;</span>, <span class="r50 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r50 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;myCustomRole&quot;</span>, <span class="r50 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;roleDefName&quot;</span>][<span class="s">&quot;value&quot;</span>]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="37f568a94e5bc842" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtManagementGroupScope_ReceivingResponse_DeserializesResult</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r51 rd" class="r51 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c36228825c52b703" class="t constructor">ScopedDeploymentWhatIf</a>(<span class="s">&quot;westus&quot;</span>, <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
            <b>var</b> <span id="r52 rd" class="r52 r">response</span> = <b>new</b> <span class="t constructor">HttpResponseMessage</span>(<span class="t t">HttpStatusCode</span>.<span class="i field">OK</span>)
            {
                <span class="i property">Content</span> = <b>new</b> <span class="t constructor">StringContent</span>(<span class="s">@&quot;{
                    &#39;status&#39;: &#39;Succeeded&#39;,
                    &#39;properties&#39;: {
                        &#39;changes&#39;: [
                            {
                                &#39;resourceId&#39;: &#39;/providers/Microsoft.Management/managementGroups/myManagementGroup/providers/Microsoft.Authorization/policyDefinitions/testDef&#39;,
                                &#39;changeType&#39;: &#39;Create&#39;,
                                &#39;after&#39;: {
                                    &#39;apiVersion&#39;: &#39;2018-03-01&#39;,
                                    &#39;id&#39;: &#39;/providers/Microsoft.Management/managementGroups/myManagementGroup/providers/Microsoft.Authorization/policyDefinitions/testDef&#39;,
                                    &#39;type&#39;: &#39;Microsoft.Authorization/policyDefinitions&#39;,
                                    &#39;name&#39;: &#39;testDef&#39;
                                }
                            }
                        ]
                    }
                }&quot;</span>)
            };
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r53 rd" class="r53 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#87add478f2e737f3" class="t constructor">RecordedDelegatingHandler</a>(<span class="r52 r">response</span>) { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r54 rd" class="r54 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r53 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#5419b0429bf98f59" class="t t">WhatIfOperationResult</a> <span id="r55 rd" class="r55 r">result</span> =
                    <span class="r54 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#85ca2308100a8dee" class="i method">WhatIfAtManagementGroupScope</a>(<span class="s">&quot;test-mg&quot;</span>, <span class="s">&quot;test-mg-deploy&quot;</span>, <span class="r51 r">deploymentWhatIf</span>);
 
                <span class="c">// Assert.</span>
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Succeeded&quot;</span>, <span class="r55 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#4efc7861b37e87f2" class="i property">Status</a>);
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r55 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(1, <span class="r55 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>.<a href="@1@System.Runtime/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>);
 
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#2524e7781c468c68" class="t t">WhatIfChange</a> <span id="r56 rd" class="r56 r">change</span> = <span class="r55 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>[0];
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Management.ResourceManager/A.html#011cb66035a63a16" class="t t">ChangeType</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#092ae8910df57683" class="i field">Create</a>, <span class="r56 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#458eb08a66b5e37a" class="i property">ChangeType</a>);
 
                <span class="t t">Assert</span>.<span class="i method">Null</span>(<span class="r56 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#73d29faec050629b" class="i property">Before</a>);
                <span class="t t">Assert</span>.<span class="i method">Null</span>(<span class="r56 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>);
 
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r56 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;testDef&quot;</span>, <span class="t t">JToken</span>.<span class="i method">FromObject</span>(<span class="r56 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>)[<span class="s">&quot;name&quot;</span>]);
            }
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="234202452ea9a6dd" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtTenantScope_SendingRequest_SetsHeaders</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r57 rd" class="r57 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r58 rd" class="r58 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c36228825c52b703" class="t constructor">ScopedDeploymentWhatIf</a>(<span class="s">&quot;westus&quot;</span>, <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r59 rd" class="r59 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r57 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r59 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cab4834d5ddcce21" class="i method">WhatIfAtTenantScope</a>(<span class="s">&quot;test-tenant-deploy&quot;</span>, <span class="r58 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;application/json; charset=utf-8&quot;</span>, <span class="r57 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#5cc5f40712d3911c" class="i property">ContentHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Content-Type&quot;</span>).<span class="i method">First</span>());
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">HttpMethod</span>.<span class="i property">Post</span>, <span class="r57 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#afdd38f25a2eac7b" class="i property">Method</a>);
            <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r57 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#bbe0bb5f41324b5b" class="i property">RequestHeaders</a>.<span class="i method">GetValues</span>(<span class="s">&quot;Authorization&quot;</span>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="c16a6e51d656a54a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtTenantScope_SendingRequest_SerializesPayload</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r60 rd" class="r60 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r61 rd" class="r61 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#738515c5a5e96598" class="t constructor">ScopedDeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#b608b3669cf41427" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#cd209e2cb7977688" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#04fd4cef81222467" class="i field">Complete</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#49f23205b8aaa864" class="i property">TemplateLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#4570ebf5d9bc5627" class="t constructor">TemplateLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#440d28eff5217f2d" class="i property">Uri</a> = <span class="s">&quot;https://example.com&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#29135be1045cf49f" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#873a9e9f6e9fabfc" class="i property">ParametersLink</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#692a4cd1e5161f9c" class="t constructor">ParametersLink</a>
                    {
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8dc5df1cc844bd02" class="i property">Uri</a> = <span class="s">&quot;https://example.com/parameters&quot;</span>,
                        <a href="/Microsoft.Azure.Management.ResourceManager/A.html#905567690f8fefcf" class="i property">ContentVersion</a> = <span class="s">&quot;1.0.0.0&quot;</span>
                    },
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>),
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                    {
                        [<span class="s">&quot;param1&quot;</span>] = <span class="s">&quot;foo&quot;</span>,
                        [<span class="s">&quot;param2&quot;</span>] = <b>new</b> <span class="t constructor">Dictionary</span>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <b>object</b>&gt;
                        {
                            [<span class="s">&quot;param2_1&quot;</span>] = 123,
                            [<span class="s">&quot;param2_2&quot;</span>] = <span class="s">&quot;bar&quot;</span>
                        }
                    }
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r62 rd" class="r62 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r60 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r62 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cab4834d5ddcce21" class="i method">WhatIfAtTenantScope</a>(<span class="s">&quot;test-tenant-deploy&quot;</span>, <span class="r61 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r63 rd" class="r63 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r60 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;westus&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;location&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Complete&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;templateLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;https://example.com/parameters&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;uri&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parametersLink&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="s">&quot;{ &#39;$schema&#39;: &#39;fake&#39; }&quot;</span>), <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;foo&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(123, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_1&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;bar&quot;</span>, <span class="r63 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;param2&quot;</span>][<span class="s">&quot;param2_2&quot;</span>]);
        }
 
        [<span class="t constructor">Theory</span>]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#&#39;,
            &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
            &#39;parameters&#39;: {
                &#39;roleDefName&#39;: {
                   &#39;value&#39;: &#39;myCustomRole&#39;
                }
            }
        }&quot;</span>)]
        [<span class="t constructor">InlineData</span>(<span class="s">@&quot;{
            &#39;roleDefName&#39;: {
                &#39;value&#39;: &#39;myCustomRole&#39;
            }
        }&quot;</span>)]
        <b>public void</b> <a id="89cf24145b7c8b9e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtTenantScope_SendingRequestWithStrings_SerializesPayload</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r64 rd" class="r64 r">parameterContent</span>)
        {
            <span class="c">// Arrange.</span>
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r65 rd" class="r65 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#0d72efaa95240bdb" class="t constructor">RecordedDelegatingHandler</a> { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r66 rd" class="r66 r">templateContent</span> = <span class="s">@&quot;{
                &#39;$schema&#39;: &#39;http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&#39;,
                &#39;contentVersion&#39;: &#39;1.0.0.0&#39;,
                &#39;parameters&#39;: {
                    &#39;roleDefName&#39;: {
                  &#39;type&#39;: &#39;string&#39;
                 }
                },
                &#39;resources&#39;: [
                ],
                &#39;outputs&#39;: {}
            }&quot;</span>;
 
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r67 rd" class="r67 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#738515c5a5e96598" class="t constructor">ScopedDeploymentWhatIf</a>
            {
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#b608b3669cf41427" class="i property">Location</a> = <span class="s">&quot;westus&quot;</span>,
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#cd209e2cb7977688" class="i property">Properties</a> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>
                {
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#90ec6272f2bbcf70" class="i property">Mode</a> = <a href="/Microsoft.Azure.Management.ResourceManager/A.html#8f74dc1d60ba973e" class="t t">DeploymentMode</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#2567cbf88c46485d" class="i field">Incremental</a>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c4705ae33e998bf8" class="i property">Template</a> = <span class="r66 r">templateContent</span>,
                    <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c6645e347ccad0df" class="i property">Parameters</a> = <span class="r64 r">parameterContent</span>
                }
            };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r68 rd" class="r68 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r65 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <span class="r68 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cab4834d5ddcce21" class="i method">WhatIfAtTenantScope</a>(<span class="s">&quot;test-tenant-deploy&quot;</span>, <span class="r67 r">deploymentWhatIf</span>);
            }
 
            <span class="c">// Assert.</span>
            <span class="t t">JObject</span> <span id="r69 rd" class="r69 r">resultJson</span> = <span class="t t">JObject</span>.<span class="i method">Parse</span>(<span class="r65 r">handler</span>.<a href="../Helpers/RecordedDelegatingHandler.cs.html#aefc7cadc6a33c4a" class="i property">Request</a>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Incremental&quot;</span>, <span class="r69 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;mode&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;1.0.0.0&quot;</span>, <span class="r69 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;template&quot;</span>][<span class="s">&quot;contentVersion&quot;</span>]);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;myCustomRole&quot;</span>, <span class="r69 r">resultJson</span>[<span class="s">&quot;properties&quot;</span>][<span class="s">&quot;parameters&quot;</span>][<span class="s">&quot;roleDefName&quot;</span>][<span class="s">&quot;value&quot;</span>]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="5a594d5cae878a30" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WhatIfAtTenantScope_ReceivingResponse_DeserializesResult</a>()
        {
            <span class="c">// Arrange.</span>
            <a href="/Microsoft.Azure.Management.ResourceManager/A.html#77d3fdbdcdd9a2d2" class="k">var</a> <span id="r70 rd" class="r70 r">deploymentWhatIf</span> = <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#c36228825c52b703" class="t constructor">ScopedDeploymentWhatIf</a>(<span class="s">&quot;westus&quot;</span>, <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#e22e4816aca4af80" class="t constructor">DeploymentWhatIfProperties</a>());
            <b>var</b> <span id="r71 rd" class="r71 r">response</span> = <b>new</b> <span class="t constructor">HttpResponseMessage</span>(<span class="t t">HttpStatusCode</span>.<span class="i field">OK</span>)
            {
                <span class="i property">Content</span> = <b>new</b> <span class="t constructor">StringContent</span>(<span class="s">@&quot;{
                    &#39;status&#39;: &#39;Succeeded&#39;,
                    &#39;properties&#39;: {
                        &#39;changes&#39;: [
                            {
                                &#39;resourceId&#39;: &#39;/providers/Microsoft.Management/managementGroups/myManagementGroup&#39;,
                                &#39;changeType&#39;: &#39;Create&#39;,
                                &#39;after&#39;: {
                                    &#39;apiVersion&#39;: &#39;2018-03-01&#39;,
                                    &#39;id&#39;: &#39;/providers/Microsoft.Management/managementGroups/myManagementGroup&#39;,
                                    &#39;type&#39;: &#39;Microsoft.Management/managementGroup&#39;,
                                    &#39;name&#39;: &#39;myManagementGroup&#39;
                                }
                            }
                        ]
                    }
                }&quot;</span>)
            };
            <a href="../Helpers/RecordedDelegatingHandler.cs.html#d20edd2100a9d835" class="k">var</a> <span id="r72 rd" class="r72 r">handler</span> = <b>new</b> <a href="../Helpers/RecordedDelegatingHandler.cs.html#87add478f2e737f3" class="t constructor">RecordedDelegatingHandler</a>(<span class="r71 r">response</span>) { <a href="../Helpers/RecordedDelegatingHandler.cs.html#8f6d95c7414acc80" class="i property">StatusCodeToReturn</a> = <span class="t t">HttpStatusCode</span>.<span class="i field">OK</span> };
 
            <b>using</b> (<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <span id="r73 rd" class="r73 r">client</span> = <a href="#55ced5f827f4d54b" class="i method">CreateResourceManagementClient</a>(<span class="r72 r">handler</span>))
            {
                <span class="c">// Act.</span>
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#5419b0429bf98f59" class="t t">WhatIfOperationResult</a> <span id="r74 rd" class="r74 r">result</span> =
                    <span class="r73 r">client</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#122023d9ed69cf1e" class="i property">Deployments</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#cab4834d5ddcce21" class="i method">WhatIfAtTenantScope</a>(<span class="s">&quot;test-tenent-deploy&quot;</span>, <span class="r70 r">deploymentWhatIf</span>);
 
                <span class="c">// Assert.</span>
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;Succeeded&quot;</span>, <span class="r74 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#4efc7861b37e87f2" class="i property">Status</a>);
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r74 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(1, <span class="r74 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>.<a href="@1@System.Runtime/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>);
 
                <a href="/Microsoft.Azure.Management.ResourceManager/A.html#2524e7781c468c68" class="t t">WhatIfChange</a> <span id="r75 rd" class="r75 r">change</span> = <span class="r74 r">result</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#714ba14e526653f5" class="i property">Changes</a>[0];
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="/Microsoft.Azure.Management.ResourceManager/A.html#011cb66035a63a16" class="t t">ChangeType</a>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#092ae8910df57683" class="i field">Create</a>, <span class="r75 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#458eb08a66b5e37a" class="i property">ChangeType</a>);
 
                <span class="t t">Assert</span>.<span class="i method">Null</span>(<span class="r75 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#73d29faec050629b" class="i property">Before</a>);
                <span class="t t">Assert</span>.<span class="i method">Null</span>(<span class="r75 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#c0bb52f8697308bd" class="i property">Delta</a>);
 
                <span class="t t">Assert</span>.<span class="i method">NotNull</span>(<span class="r75 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>);
                <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;myManagementGroup&quot;</span>, <span class="t t">JToken</span>.<span class="i method">FromObject</span>(<span class="r75 r">change</span>.<a href="/Microsoft.Azure.Management.ResourceManager/A.html#27945041fd36b6df" class="i property">After</a>)[<span class="s">&quot;name&quot;</span>]);
            }
        }
 
        <b>private static</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#cea218319900f974" class="t t">ResourceManagementClient</a> <a id="55ced5f827f4d54b" href="../R/55ced5f827f4d54b.html" target="n" data-glyph="76,1" class="i method">CreateResourceManagementClient</a>(<span class="t t">DelegatingHandler</span> <span id="r76 rd" class="r76 r">handler</span>)
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r77 rd" class="r77 r">subscriptionId</span> = <a href="@1@System.Runtime/A.html#b622ef5f6b76c10a" class="t t">Guid</a>.<a href="@1@System.Runtime/A.html#b7fae6994c22c22e" class="i method">NewGuid</a>().<a href="@1@System.Runtime/A.html#a6547a472def7796" class="i method">ToString</a>();
            <a href="/Microsoft.Rest.ClientRuntime/A.html#c4acaa66018e3f32" class="k">var</a> <span id="r78 rd" class="r78 r">token</span> = <b>new</b> <a href="/Microsoft.Rest.ClientRuntime/A.html#6ef42849cc965e0b" class="t constructor">TokenCredentials</a>(<span class="r77 r">subscriptionId</span>, <span class="s">&quot;foo&quot;</span>);
 
            <b>return</b> <b>new</b> <a href="/Microsoft.Azure.Management.ResourceManager/A.html#64b5f0c8d12992c5" class="t constructor">ResourceManagementClient</a>(<span class="r78 r">token</span>, <span class="r76 r">handler</span>) { <a href="/Microsoft.Azure.Management.ResourceManager/A.html#9513606a748b3701" class="i property">SubscriptionId</a> = <span class="r77 r">subscriptionId</span> };
        }
    }
}
</pre></td></tr></table></div></body></html>
