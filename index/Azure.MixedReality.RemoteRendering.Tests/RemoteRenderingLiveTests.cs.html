<!DOCTYPE html>
<html><head><title>RemoteRenderingLiveTests.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(213);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.MixedReality.RemoteRendering.Tests/RemoteRenderingLiveTests.cs" target="_top">RemoteRenderingLiveTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.MixedReality.RemoteRendering.Tests" target="_top">Azure.MixedReality.RemoteRendering.Tests.csproj</a> (Azure.MixedReality.RemoteRendering.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
<b>using</b> <span class="i n">NUnit</span>.<span class="i n">Framework</span>;
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">MixedReality</span>.<span class="i n">RemoteRendering</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="1df399c568978dbf" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">RemoteRenderingLiveTests</a> : <a href="/Azure.Core.TestFramework/A.html#2d2d9cc2c3882f17" class="t t">RecordedTestBase</a>&lt;<a href="RemoteRenderingTestEnvironment.cs.html#08321d42eb75e197" class="t t">RemoteRenderingTestEnvironment</a>&gt;
    {
        <b>public</b> <a id="a7d7cdf9ce5a5a5c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">RemoteRenderingLiveTests</a>(<b>bool</b> <span id="r0 rd" class="r0 r">isAsync</span>) :
            <a href="/Azure.Core.TestFramework/A.html#526634b4af6d52de" class="k">base</a>(<span class="r0 r">isAsync</span><span class="c">/*, RecordedTestMode.Record*/</span>)
        {
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="7f731a1afc917c0f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestSimpleConversion</a>()
        {
            <a href="/Azure.MixedReality.RemoteRendering/A.html#53a2922372d51fac" class="k">var</a> <span id="r1 rd" class="r1 r">client</span> = <a href="#dc7d02ce898c3f89" class="i method">GetClient</a>();
 
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r2 rd" class="r2 r">storageUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#05011279724abdb5" class="i property">StorageAccountName</a>}<span class="s">.blob.core.windows.net/</span>{<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#c5deba253638bf70" class="i property">BlobContainerName</a>}<span class="s">&quot;</span>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#8377fd4b77757777" class="t t">AssetConversionInputOptions</a> <span id="r3 rd" class="r3 r">input</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#32ec7a0a5d2e765d" class="t constructor">AssetConversionInputOptions</a>(<span class="r2 r">storageUri</span>, <span class="s">&quot;testBox.fbx&quot;</span>)
            {
                <span class="c">// We use SAS for live testing, as there can be a delay before DRAM-based access is available for new accounts.</span>
                <a href="/Azure.MixedReality.RemoteRendering/A.html#59263d1a0714972e" class="i property">StorageContainerReadListSas</a> = <a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#4360b944168bd939" class="i property">SasToken</a>,
                <a href="/Azure.MixedReality.RemoteRendering/A.html#b159906fd3cb7be2" class="i property">BlobPrefix</a> = <span class="s">&quot;Input&quot;</span>
            };
            <a href="/Azure.MixedReality.RemoteRendering/A.html#3cdbbf5ae8dc1989" class="t t">AssetConversionOutputOptions</a> <span id="r4 rd" class="r4 r">output</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#e374bb1424ecb8cb" class="t constructor">AssetConversionOutputOptions</a>(<span class="r2 r">storageUri</span>)
            {
                <a href="/Azure.MixedReality.RemoteRendering/A.html#a71a7c0c010ece3a" class="i property">StorageContainerWriteSas</a> = <a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#4360b944168bd939" class="i property">SasToken</a>,
                <a href="/Azure.MixedReality.RemoteRendering/A.html#bb58b7d1834b39b5" class="i property">BlobPrefix</a> = <span class="s">&quot;Output&quot;</span>
            };
            <a href="/Azure.MixedReality.RemoteRendering/A.html#7611dbfbfaaafcc8" class="t t">AssetConversionOptions</a> <span id="r5 rd" class="r5 r">conversionOptions</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#6e73c24fe05ae7a2" class="t constructor">AssetConversionOptions</a>(<span class="r3 r">input</span>, <span class="r4 r">output</span>);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">conversionId</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#b9828ff8817e7824" class="i property">Random</a>.<a href="/Azure.Core.TestFramework/A.html#d4b1f5d1badb844e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#cfd5674261ee8ba5" class="t t">AssetConversionOperation</a> <span id="r7 rd" class="r7 r">conversionOperation</span> = <b>await</b> <span class="r1 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#2e083a4715594f00" class="i method">StartConversionAsync</a>(<span class="r6 r">conversionId</span>, <span class="r5 r">conversionOptions</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r6 r">conversionId</span>, <span class="r7 r">conversionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#63d28749db929a6d" class="i property">Id</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r5 r">conversionOptions</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#23b3bb4bfe4ff2ca" class="i property">InputOptions</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#e8d4507c64ee8c77" class="i property">RelativeInputAssetPath</a>, <span class="r7 r">conversionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#11543e7530361894" class="i property">Value</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#8e2c2fafc146640c" class="i property">Options</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#23b3bb4bfe4ff2ca" class="i property">InputOptions</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#e8d4507c64ee8c77" class="i property">RelativeInputAssetPath</a>);
            <span class="t t">Assert</span>.<span class="i method">AreNotEqual</span>(<a href="/Azure.MixedReality.RemoteRendering/A.html#86060b778962659a" class="t t">AssetConversionStatus</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#435cfe29e5c27332" class="i property">Failed</a>, <span class="r7 r">conversionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#11543e7530361894" class="i property">Value</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#be732adf704e2e4f" class="i property">Status</a>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#a02fd41d59708ab6" class="t t">AssetConversion</a> <span id="r8 rd" class="r8 r">conversion</span> = <b>await</b> <span class="r1 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#c011adb8585c6e09" class="i method">GetConversionAsync</a>(<span class="r6 r">conversionId</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r8 r">conversion</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#0988ae7950e18e01" class="i property">ConversionId</a>, <span class="r6 r">conversionId</span>);
            <span class="t t">Assert</span>.<span class="i method">AreNotEqual</span>(<a href="/Azure.MixedReality.RemoteRendering/A.html#86060b778962659a" class="t t">AssetConversionStatus</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#435cfe29e5c27332" class="i property">Failed</a>, <span class="r8 r">conversion</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#be732adf704e2e4f" class="i property">Status</a>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#a02fd41d59708ab6" class="t t">AssetConversion</a> <span id="r9 rd" class="r9 r">conversion2</span> = <b>await</b> <span class="r7 r">conversionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#9cd1e4fa610b7dd8" class="i method">WaitForCompletionAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r6 r">conversionId</span>, <span class="r9 r">conversion2</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#0988ae7950e18e01" class="i property">ConversionId</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="/Azure.MixedReality.RemoteRendering/A.html#86060b778962659a" class="t t">AssetConversionStatus</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#e818381bfd9adc38" class="i property">Succeeded</a>, <span class="r9 r">conversion2</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#be732adf704e2e4f" class="i property">Status</a>);
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r7 r">conversionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#11543e7530361894" class="i property">Value</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#3b0d8ae7a16c239f" class="i property">Output</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#e2bf2814d74ad934" class="i property">OutputAssetUri</a>.<a href="@0@mscorlib/A.html#cb74053b3f2d03f4" class="i method">EndsWith</a>(<span class="s">&quot;Output/testBox.arrAsset&quot;</span>));
 
            <b>bool</b> <span id="r10 rd" class="r10 r">foundConversion</span> = <b>false</b>;
            <b>await</b> <b>foreach</b> (<a href="/Azure.MixedReality.RemoteRendering/A.html#a02fd41d59708ab6" class="k">var</a> <span id="r11 rd" class="r11 r">s</span> <b>in</b> <span class="r1 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#47774d6bf1626da6" class="i method">GetConversionsAync</a>())
            {
                <b>if</b> (<span class="r11 r">s</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#0988ae7950e18e01" class="i property">ConversionId</a> == <span class="r6 r">conversionId</span>)
                {
                    <span class="r10 r">foundConversion</span> = <b>true</b>;
                }
            }
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r10 r">foundConversion</span>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="90d7b1cc775d188f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestFailedConversionsNoAccess</a>()
        {
            <a href="/Azure.MixedReality.RemoteRendering/A.html#53a2922372d51fac" class="k">var</a> <span id="r12 rd" class="r12 r">client</span> = <a href="#dc7d02ce898c3f89" class="i method">GetClient</a>();
 
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r13 rd" class="r13 r">storageUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#05011279724abdb5" class="i property">StorageAccountName</a>}<span class="s">.blob.core.windows.net/</span>{<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#c5deba253638bf70" class="i property">BlobContainerName</a>}<span class="s">&quot;</span>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#8377fd4b77757777" class="t t">AssetConversionInputOptions</a> <span id="r14 rd" class="r14 r">input</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#32ec7a0a5d2e765d" class="t constructor">AssetConversionInputOptions</a>(<span class="r13 r">storageUri</span>, <span class="s">&quot;testBox.fbx&quot;</span>)
            {
                <span class="c">// Do not provide SAS access to the container, and assume the test account is not linked to the storage.</span>
                <a href="/Azure.MixedReality.RemoteRendering/A.html#b159906fd3cb7be2" class="i property">BlobPrefix</a> = <span class="s">&quot;Input&quot;</span>
            };
            <a href="/Azure.MixedReality.RemoteRendering/A.html#3cdbbf5ae8dc1989" class="t t">AssetConversionOutputOptions</a> <span id="r15 rd" class="r15 r">output</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#e374bb1424ecb8cb" class="t constructor">AssetConversionOutputOptions</a>(<span class="r13 r">storageUri</span>)
            {
                <a href="/Azure.MixedReality.RemoteRendering/A.html#bb58b7d1834b39b5" class="i property">BlobPrefix</a> = <span class="s">&quot;Output&quot;</span>
            };
            <a href="/Azure.MixedReality.RemoteRendering/A.html#7611dbfbfaaafcc8" class="t t">AssetConversionOptions</a> <span id="r16 rd" class="r16 r">conversionOptions</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#6e73c24fe05ae7a2" class="t constructor">AssetConversionOptions</a>(<span class="r14 r">input</span>, <span class="r15 r">output</span>);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">conversionId</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#b9828ff8817e7824" class="i property">Random</a>.<a href="/Azure.Core.TestFramework/A.html#d4b1f5d1badb844e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
 
            <a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a> <span id="r18 rd" class="r18 r">ex</span> = <span class="t t">Assert</span>.<span class="i method">ThrowsAsync</span>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(() =&gt; <span class="r12 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#2e083a4715594f00" class="i method">StartConversionAsync</a>(<span class="r17 r">conversionId</span>, <span class="r16 r">conversionOptions</span>));
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r18 r">ex</span>.<a href="/Azure.Core/A.html#2e95914e1b156417" class="i property">Status</a>, 400);
            <span class="c">// Error accessing connected storage account due to insufficient permissions. Check if the Mixed Reality resource has correct permissions assigned</span>
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r18 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;storage&quot;</span>));
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r18 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;permissions&quot;</span>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d45d227e4a0d8e51" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestFailedConversionsMissingAsset</a>()
        {
            <a href="/Azure.MixedReality.RemoteRendering/A.html#53a2922372d51fac" class="k">var</a> <span id="r19 rd" class="r19 r">client</span> = <a href="#dc7d02ce898c3f89" class="i method">GetClient</a>();
 
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r20 rd" class="r20 r">storageUri</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="s">$&quot;</span><span class="s">https://</span>{<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#05011279724abdb5" class="i property">StorageAccountName</a>}<span class="s">.blob.core.windows.net/</span>{<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#c5deba253638bf70" class="i property">BlobContainerName</a>}<span class="s">&quot;</span>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#8377fd4b77757777" class="t t">AssetConversionInputOptions</a> <span id="r21 rd" class="r21 r">input</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#32ec7a0a5d2e765d" class="t constructor">AssetConversionInputOptions</a>(<span class="r20 r">storageUri</span>, <span class="s">&quot;boxWhichDoesNotExist.fbx&quot;</span>)
            {
                <span class="c">// We use SAS for live testing, as there can be a delay before DRAM-based access is available for new accounts.</span>
                <a href="/Azure.MixedReality.RemoteRendering/A.html#59263d1a0714972e" class="i property">StorageContainerReadListSas</a> = <a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#4360b944168bd939" class="i property">SasToken</a>,
                <a href="/Azure.MixedReality.RemoteRendering/A.html#b159906fd3cb7be2" class="i property">BlobPrefix</a> = <span class="s">&quot;Input&quot;</span>
            };
            <a href="/Azure.MixedReality.RemoteRendering/A.html#3cdbbf5ae8dc1989" class="t t">AssetConversionOutputOptions</a> <span id="r22 rd" class="r22 r">output</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#e374bb1424ecb8cb" class="t constructor">AssetConversionOutputOptions</a>(<span class="r20 r">storageUri</span>)
            {
                <a href="/Azure.MixedReality.RemoteRendering/A.html#a71a7c0c010ece3a" class="i property">StorageContainerWriteSas</a> = <a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#4360b944168bd939" class="i property">SasToken</a>,
                <a href="/Azure.MixedReality.RemoteRendering/A.html#bb58b7d1834b39b5" class="i property">BlobPrefix</a> = <span class="s">&quot;Output&quot;</span>
            };
            <a href="/Azure.MixedReality.RemoteRendering/A.html#7611dbfbfaaafcc8" class="t t">AssetConversionOptions</a> <span id="r23 rd" class="r23 r">conversionOptions</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#6e73c24fe05ae7a2" class="t constructor">AssetConversionOptions</a>(<span class="r21 r">input</span>, <span class="r22 r">output</span>);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r24 rd" class="r24 r">conversionId</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#b9828ff8817e7824" class="i property">Random</a>.<a href="/Azure.Core.TestFramework/A.html#d4b1f5d1badb844e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#cfd5674261ee8ba5" class="t t">AssetConversionOperation</a> <span id="r25 rd" class="r25 r">conversionOperation</span> = <b>await</b> <span class="r19 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#2e083a4715594f00" class="i method">StartConversionAsync</a>(<span class="r24 r">conversionId</span>, <span class="r23 r">conversionOptions</span>);
            <a href="/Azure.MixedReality.RemoteRendering/A.html#a02fd41d59708ab6" class="t t">AssetConversion</a> <span id="r26 rd" class="r26 r">conversion</span> = <b>await</b> <span class="r25 r">conversionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#9cd1e4fa610b7dd8" class="i method">WaitForCompletionAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="/Azure.MixedReality.RemoteRendering/A.html#86060b778962659a" class="t t">AssetConversionStatus</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#435cfe29e5c27332" class="i property">Failed</a>, <span class="r26 r">conversion</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#be732adf704e2e4f" class="i property">Status</a>);
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r26 r">conversion</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#8c117dc344a1d554" class="i property">Error</a>);
            <span class="c">// Invalid input provided. Check logs in output container for details.</span>
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r26 r">conversion</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#8c117dc344a1d554" class="i property">Error</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#85d7c723df17fc5c" class="i property">Message</a>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;invalid input&quot;</span>));
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r26 r">conversion</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#8c117dc344a1d554" class="i property">Error</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#85d7c723df17fc5c" class="i property">Message</a>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;logs&quot;</span>));
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public async</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="457cd6b8f726bad0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestSimpleSession</a>()
        {
            <a href="/Azure.MixedReality.RemoteRendering/A.html#53a2922372d51fac" class="k">var</a> <span id="r27 rd" class="r27 r">client</span> = <a href="#dc7d02ce898c3f89" class="i method">GetClient</a>();
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#73587504fe8a2ab7" class="t t">RenderingSessionOptions</a> <span id="r28 rd" class="r28 r">options</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#695a31dc127a0334" class="t constructor">RenderingSessionOptions</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(4), <a href="/Azure.MixedReality.RemoteRendering/A.html#7921a1aded4e4318" class="t t">RenderingServerSize</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#ddff7aa0567ca100" class="i property">Standard</a>);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r29 rd" class="r29 r">sessionId</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#b9828ff8817e7824" class="i property">Random</a>.<a href="/Azure.Core.TestFramework/A.html#d4b1f5d1badb844e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#df6ba729e1d34bba" class="t t">StartRenderingSessionOperation</a> <span id="r30 rd" class="r30 r">startSessionOperation</span> = <b>await</b> <span class="r27 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#1b1f205c2203b5ae" class="i method">StartSessionAsync</a>(<span class="r29 r">sessionId</span>, <span class="r28 r">options</span>);
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r30 r">startSessionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#c8d2277e6861b9f2" class="i property">HasValue</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r28 r">options</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#fd2e7f8e1af8d38b" class="i property">Size</a>, <span class="r30 r">startSessionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#0514cc1ea355754b" class="i property">Value</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#28b4f4c84456bd91" class="i property">Size</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r29 r">sessionId</span>, <span class="r30 r">startSessionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#0514cc1ea355754b" class="i property">Value</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#28026ad48637af7e" class="i property">SessionId</a>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#0bdd6de089c0e832" class="t t">RenderingSession</a> <span id="r31 rd" class="r31 r">sessionProperties</span> = <b>await</b> <span class="r27 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#4baac473904a22e8" class="i method">GetSessionAsync</a>(<span class="r29 r">sessionId</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r30 r">startSessionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#0514cc1ea355754b" class="i property">Value</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#255df11d391b8368" class="i property">CreatedOn</a>, <span class="r31 r">sessionProperties</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#255df11d391b8368" class="i property">CreatedOn</a>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#5ac519f251937d06" class="t t">UpdateSessionOptions</a> <span id="r32 rd" class="r32 r">updateOptions</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#f4ae0cb44a4d5a1b" class="t constructor">UpdateSessionOptions</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(5));
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#0bdd6de089c0e832" class="t t">RenderingSession</a> <span id="r33 rd" class="r33 r">updatedSession</span> = <b>await</b> <span class="r27 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#06de7100811815f2" class="i method">UpdateSessionAsync</a>(<span class="r29 r">sessionId</span>, <span class="r32 r">updateOptions</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r33 r">updatedSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#42c2b266fe448422" class="i property">MaxLeaseTime</a>, <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(5));
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#0bdd6de089c0e832" class="t t">RenderingSession</a> <span id="r34 rd" class="r34 r">readyRenderingSession</span> = <b>await</b> <span class="r30 r">startSessionOperation</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#7263b32e5fff0b8f" class="i method">WaitForCompletionAsync</a>();
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>((<span class="r34 r">readyRenderingSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#42c2b266fe448422" class="i property">MaxLeaseTime</a> == <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(4)) || (<span class="r34 r">readyRenderingSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#42c2b266fe448422" class="i property">MaxLeaseTime</a> == <a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(5)));
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r34 r">readyRenderingSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#c00a04aa9d4daa9e" class="i property">Host</a>);
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r34 r">readyRenderingSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#abac87ebfe7cfb42" class="i property">ArrInspectorPort</a>);
            <span class="t t">Assert</span>.<span class="i method">IsNotNull</span>(<span class="r34 r">readyRenderingSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#6a8eb4b6cb81f738" class="i property">HandshakePort</a>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r34 r">readyRenderingSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#28b4f4c84456bd91" class="i property">Size</a>, <span class="r28 r">options</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#fd2e7f8e1af8d38b" class="i property">Size</a>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#5ac519f251937d06" class="t t">UpdateSessionOptions</a> <span id="r35 rd" class="r35 r">updateOptions2</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#f4ae0cb44a4d5a1b" class="t constructor">UpdateSessionOptions</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(6));
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(6), <span class="r35 r">updateOptions2</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#997d2435c739336f" class="i property">MaxLeaseTime</a>);
 
            <b>bool</b> <span id="r36 rd" class="r36 r">foundSession</span> = <b>false</b>;
            <b>await</b> <b>foreach</b> (<a href="/Azure.MixedReality.RemoteRendering/A.html#0bdd6de089c0e832" class="k">var</a> <span id="r37 rd" class="r37 r">s</span> <b>in</b> <span class="r27 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#149970c9d3e3e902" class="i method">GetSessionsAsync</a>())
            {
                <b>if</b> (<span class="r37 r">s</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#28026ad48637af7e" class="i property">SessionId</a> == <span class="r29 r">sessionId</span>)
                {
                    <span class="r36 r">foundSession</span> = <b>true</b>;
                }
            }
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r36 r">foundSession</span>);
            <b>await</b> <span class="r27 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#48a0df825ba178b3" class="i method">StopSessionAsync</a>(<span class="r29 r">sessionId</span>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#0bdd6de089c0e832" class="t t">RenderingSession</a> <span id="r38 rd" class="r38 r">stoppedRenderingSession</span> = <b>await</b> <span class="r27 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#4baac473904a22e8" class="i method">GetSessionAsync</a>(<span class="r29 r">sessionId</span>);
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<a href="/Azure.MixedReality.RemoteRendering/A.html#b39080ea203790c4" class="t t">RenderingSessionStatus</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#9a9db400e3c378e7" class="i property">Stopped</a>, <span class="r38 r">stoppedRenderingSession</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#46e15bc28835cb6f" class="i property">Status</a>);
        }
 
        [<a href="/Azure.Core.TestFramework/A.html#6f14c3950ca7dafb" class="t constructor">RecordedTest</a>]
        <b>public void</b> <a id="fcf20cfbc4987eb0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TestFailedSessionRequest</a>()
        {
            <a href="/Azure.MixedReality.RemoteRendering/A.html#53a2922372d51fac" class="k">var</a> <span id="r39 rd" class="r39 r">client</span> = <a href="#dc7d02ce898c3f89" class="i method">GetClient</a>();
 
            <span class="c">// Make an invalid request (negative lease time).</span>
            <a href="/Azure.MixedReality.RemoteRendering/A.html#73587504fe8a2ab7" class="t t">RenderingSessionOptions</a> <span id="r40 rd" class="r40 r">options</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#695a31dc127a0334" class="t constructor">RenderingSessionOptions</a>(<a href="@0@mscorlib/A.html#865ef7b89f41b632" class="t t">TimeSpan</a>.<a href="@0@mscorlib/A.html#ae74be5264df78d8" class="i method">FromMinutes</a>(-4), <a href="/Azure.MixedReality.RemoteRendering/A.html#7921a1aded4e4318" class="t t">RenderingServerSize</a>.<a href="/Azure.MixedReality.RemoteRendering/A.html#ddff7aa0567ca100" class="i property">Standard</a>);
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r41 rd" class="r41 r">sessionId</span> = <a href="/Azure.Core.TestFramework/A.html#9fc34d8f596ca70c" class="i property">Recording</a>.<a href="/Azure.Core.TestFramework/A.html#b9828ff8817e7824" class="i property">Random</a>.<a href="/Azure.Core.TestFramework/A.html#d4b1f5d1badb844e" class="i method">NewGuid</a>().<a href="@0@mscorlib/A.html#a6547a472def7796" class="i method">ToString</a>();
 
            <a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a> <span id="r42 rd" class="r42 r">ex</span> = <span class="t t">Assert</span>.<span class="i method">ThrowsAsync</span>&lt;<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a>&gt;(() =&gt; <span class="r39 r">client</span>.<a href="/Azure.MixedReality.RemoteRendering/A.html#1b1f205c2203b5ae" class="i method">StartSessionAsync</a>(<span class="r41 r">sessionId</span>, <span class="r40 r">options</span>));
            <span class="t t">Assert</span>.<span class="i method">AreEqual</span>(<span class="r42 r">ex</span>.<a href="/Azure.Core/A.html#2e95914e1b156417" class="i property">Status</a>, 400);
 
            <span class="c">// The maxLeaseTimeMinutes value cannot be negative</span>
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r42 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;lease&quot;</span>));
            <span class="t t">Assert</span>.<span class="i method">IsTrue</span>(<span class="r42 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;negative&quot;</span>));
        }
 
        <b>private</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#53a2922372d51fac" class="t t">RemoteRenderingClient</a> <a id="dc7d02ce898c3f89" href="R/dc7d02ce898c3f89.html" target="n" data-glyph="76,1" class="i method">GetClient</a>()
        {
            <a href="/Azure.MixedReality.RemoteRendering/A.html#e5f64a9f3c34fe7b" class="t t">RemoteRenderingAccount</a> <span id="r43 rd" class="r43 r">account</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#76388c9af609aa72" class="t constructor">RemoteRenderingAccount</a>(<b>new</b> <a href="@0@mscorlib/A.html#4329442fa037af5c" class="t constructor">Guid</a>(<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#b0c229667ef2249b" class="i property">AccountId</a>), <a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#a11335708d0e44b2" class="i property">AccountDomain</a>);
            <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r44 rd" class="r44 r">serviceEndpoint</span> = <b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#b051174256c1893d" class="i property">ServiceEndpoint</a>);
 
            <a href="/Azure.MixedReality.RemoteRendering/A.html#94ca9bac0eac3c26" class="k">var</a> <span id="r45 rd" class="r45 r">options</span> = <a href="/Azure.Core.TestFramework/A.html#53f8a36b77464500" class="i method">InstrumentClientOptions</a>(<b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#f94889707af3119b" class="t constructor">RemoteRenderingClientOptions</a>());
 
            <span class="c">// We don&#39;t need to test communication with the STS Authentication Library, so in playback</span>
            <span class="c">// we use a code-path which does not attempt to contact that service.</span>
            <a href="/Azure.MixedReality.RemoteRendering/A.html#53a2922372d51fac" class="t t">RemoteRenderingClient</a> <span id="r46 rd" class="r46 r">client</span>;
            <b>if</b> (<a href="/Azure.Core.TestFramework/A.html#eb077c11a09b6b1e" class="i property">Mode</a> != <a href="/Azure.Core.TestFramework/A.html#d7d5cc97dd76217f" class="t t">RecordedTestMode</a>.<a href="/Azure.Core.TestFramework/A.html#bde4663b03b59b85" class="i field">Playback</a>)
            {
                <a href="/Azure.Core/A.html#9f81356c54b28bf8" class="t t">AzureKeyCredential</a> <span id="r47 rd" class="r47 r">accountKeyCredential</span> = <b>new</b> <a href="/Azure.Core/A.html#015df0c4993644fe" class="t constructor">AzureKeyCredential</a>(<a href="/Azure.Core.TestFramework/A.html#9185092834304053" class="i property">TestEnvironment</a>.<a href="RemoteRenderingTestEnvironment.cs.html#2b163699aeb56172" class="i property">AccountKey</a>);
                <span class="r46 r">client</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#5ee7a41c41933ab7" class="t constructor">RemoteRenderingClient</a>(<span class="r44 r">serviceEndpoint</span>, <span class="r43 r">account</span>, <span class="r47 r">accountKeyCredential</span>, <span class="r45 r">options</span>);
            }
            <b>else</b>
            {
                <a href="/Azure.Core/A.html#b9cb398886850745" class="t t">AccessToken</a> <span id="r48 rd" class="r48 r">artificialToken</span> = <b>new</b> <a href="/Azure.Core/A.html#68b2c442cd1f3537" class="t constructor">AccessToken</a>(<span class="s">&quot;TestToken&quot;</span>, <a href="@0@mscorlib/A.html#68b4bb83ce8d1c31" class="t t">DateTimeOffset</a>.<a href="@0@mscorlib/A.html#371fa431c6a3a817" class="i field">MaxValue</a>);
                <span class="r46 r">client</span> = <b>new</b> <a href="/Azure.MixedReality.RemoteRendering/A.html#afc62c126932cb57" class="t constructor">RemoteRenderingClient</a>(<span class="r44 r">serviceEndpoint</span>, <span class="r43 r">account</span>, <span class="r48 r">artificialToken</span>, <span class="r45 r">options</span>);
            }
            <b>return</b> <a href="/Azure.Core.TestFramework/A.html#11829fdeef1b6d51" class="i method">InstrumentClient</a>(<span class="r46 r">client</span>);
        }
    }
}
</pre></td></tr></table></div></body></html>
