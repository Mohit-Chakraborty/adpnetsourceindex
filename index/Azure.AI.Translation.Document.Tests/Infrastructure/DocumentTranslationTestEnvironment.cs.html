<!DOCTYPE html>
<html><head><title>DocumentTranslationTestEnvironment.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(52);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Azure.AI.Translation.Document.Tests/Infrastructure/DocumentTranslationTestEnvironment.cs" target="_top">Infrastructure\DocumentTranslationTestEnvironment.cs</a><br/></td><td><a class="blueLink" href="https://github.com/Azure/azure-sdk-for-net/tree/main/sdk/translation/Azure.AI.Translation.Document/tests/Infrastructure/DocumentTranslationTestEnvironment.cs" target="_blank">View on GitHub</a></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Azure.AI.Translation.Document.Tests" target="_top">Azure.AI.Translation.Document.Tests.csproj</a> (Azure.AI.Translation.Document.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Azure</span>.<span class="i n">Core</span>.<span class="i n">TestFramework</span>;
 
<b>namespace</b> <span class="i n">Azure</span>.<span class="i n">AI</span>.<span class="i n">Translation</span>.<span class="i n">Document</span>.<span class="i n">Tests</span>
{
    <b>public class</b> <a id="22ae0d8f2f9be18c" href="../R/22ae0d8f2f9be18c.html" target="n" data-glyph="0,0" class="t t">DocumentTranslationTestEnvironment</a> : <a href="/Azure.Core.TestFramework/A.html#e657e3c675f27c43" class="t t">TestEnvironment</a>
    {
        <b>public</b> <a id="e7e681bc0cd3e6b8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">DocumentTranslationTestEnvironment</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The name of the environment variable from which the Document Translator resource&#39;s endpoint will be extracted for the live tests.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="c4521e1b05e76174" href="../R/c4521e1b05e76174.html" target="n" data-glyph="10,1" class="i field">EndpointEnvironmentVariableName</a> = <span class="s">&quot;DOCUMENT_TRANSLATION_ENDPOINT&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The name of the environment variable from which the Document Translator resource&#39;s API key will be extracted for the live tests.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="1b0708626853ea54" href="../R/1b0708626853ea54.html" target="n" data-glyph="10,1" class="i field">ApiKeyEnvironmentVariableName</a> = <span class="s">&quot;DOCUMENT_TRANSLATION_API_KEY&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The name of the environment variable from which the Document Translator Storage Account Name will be extracted for the live tests.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="2de006a134ce9ec5" href="../R/2de006a134ce9ec5.html" target="n" data-glyph="10,1" class="i field">StorageAccountNameEnvironmentVariableName</a> = <span class="s">&quot;DOCUMENT_TRANSLATION_STORAGE_NAME&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The name of the environment variable from which the Document Translator Storage Primary key will be extracted for the live tests.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="3315b8e06a41ac77" href="../R/3315b8e06a41ac77.html" target="n" data-glyph="10,1" class="i field">StorageConnectionStringEnvironmentVariableName</a> = <span class="s">&quot;DOCUMENT_TRANSLATION_CONNECTION_STRING&quot;</span>;
 
        <b>public string</b> <a id="8296bb27789aa194" href="../R/8296bb27789aa194.html" target="n" data-glyph="102,1" class="i property">ApiKey</a> =&gt; <a href="/Azure.Core.TestFramework/A.html#f752a1fc118706ed" class="i method">GetRecordedVariable</a>(<a href="#1b0708626853ea54" class="i field">ApiKeyEnvironmentVariableName</a>, <span id="r0 rd" class="r0 r">options</span> =&gt; <span class="r0 r">options</span>.<a href="/Azure.Core.TestFramework/A.html#b536418e942d52ff" class="i method">IsSecret</a>());
        <b>public string</b> <a id="5fccdca1766c3990" href="../R/5fccdca1766c3990.html" target="n" data-glyph="102,1" class="i property">Endpoint</a> =&gt; <a href="/Azure.Core.TestFramework/A.html#0fcf50ca07a3f617" class="i method">GetRecordedVariable</a>(<a href="#c4521e1b05e76174" class="i field">EndpointEnvironmentVariableName</a>);
        <b>public string</b> <a id="676a70108ec31e06" href="../R/676a70108ec31e06.html" target="n" data-glyph="102,1" class="i property">StorageConnectionString</a> =&gt; <a href="/Azure.Core.TestFramework/A.html#f752a1fc118706ed" class="i method">GetRecordedVariable</a>(<a href="#3315b8e06a41ac77" class="i field">StorageConnectionStringEnvironmentVariableName</a>, <span id="r1 rd" class="r1 r">options</span> =&gt; <span class="r1 r">options</span>.<a href="/Azure.Core.TestFramework/A.html#3c9f62e7154b596e" class="i method">HasSecretConnectionStringParameter</a>(<span class="s">&quot;AccountKey&quot;</span>, <a href="/Azure.Core.TestFramework/A.html#ed920daa4463005a" class="t t">SanitizedValue</a>.<a href="/Azure.Core.TestFramework/A.html#306738696c0df787" class="i field">Base64</a>));
        <b>public string</b> <a id="5c29687422eb2041" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">StorageAccountName</a> =&gt; <a href="/Azure.Core.TestFramework/A.html#0fcf50ca07a3f617" class="i method">GetRecordedVariable</a>(<a href="#2de006a134ce9ec5" class="i field">StorageAccountNameEnvironmentVariableName</a>);
 
        <b>protected override async</b> <span class="t t">ValueTask</span>&lt;<b>bool</b>&gt; <a id="f42ccc4de3a26f47" href="../R/f42ccc4de3a26f47.html" target="n" data-glyph="75,1" class="i method">IsEnvironmentReadyAsync</a>()
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r2 rd" class="r2 r">endpoint</span> = <a href="/Azure.Core.TestFramework/A.html#5e67cd82ce2a842d" class="i method">GetOptionalVariable</a>(<a href="#c4521e1b05e76174" class="i field">EndpointEnvironmentVariableName</a>);
            <a href="/Azure.AI.Translation.Document/A.html#929c3ff0f9e622d6" class="k">var</a> <span id="r3 rd" class="r3 r">client</span> = <b>new</b> <a href="/Azure.AI.Translation.Document/A.html#0251a47362bb5c98" class="t constructor">DocumentTranslationClient</a>(<b>new</b> <a href="@0@System/A.html#9e1bb2fef0d1159b" class="t constructor">Uri</a>(<span class="r2 r">endpoint</span>), <a href="/Azure.Core.TestFramework/A.html#7a52cec375a4970c" class="i property">Credential</a>);
            <b>try</b>
            {
                <b>await</b> <span class="r3 r">client</span>.<a href="/Azure.AI.Translation.Document/A.html#ce122eecf550b164" class="i method">GetSupportedDocumentFormatsAsync</a>();
                <b>await</b> <span class="r3 r">client</span>.<a href="/Azure.AI.Translation.Document/A.html#7571add3e2314405" class="i method">GetSupportedGlossaryFormatsAsync</a>();
                <span class="r3 r">client</span>.<a href="/Azure.AI.Translation.Document/A.html#c3088d1bb9ab057d" class="i method">GetAllTranslationStatuses</a>().<a href="@0@System.Core/A.html#aae92b018fa12b39" class="i method">Take</a>(2);
            }
            <b>catch</b> (<a href="/Azure.Core/A.html#253c51f73f5cd67d" class="t t">RequestFailedException</a> <span id="r4 rd" class="r4 r">e</span>) <b>when</b> (<span class="r4 r">e</span>.<a href="/Azure.Core/A.html#2e95914e1b156417" class="i property">Status</a> == 401)
            {
                <b>return</b> <b>false</b>;
            }
            <b>return</b> <b>true</b>;
        }
    }
}
</pre></td></tr></table></div></body></html>
