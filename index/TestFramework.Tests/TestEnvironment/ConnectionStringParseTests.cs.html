<!DOCTYPE html>
<html><head><title>ConnectionStringParseTests.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(179);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#TestFramework.Tests/TestEnvironment/ConnectionStringParseTests.cs" target="_top">TestEnvironment\ConnectionStringParseTests.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#TestFramework.Tests" target="_top">TestFramework.Tests.csproj</a> (TestFramework.Tests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation. All rights reserved.</span>
<span class="c">// Licensed under the MIT License. See License.txt in the project root for license information.</span>
 
<b>namespace</b> <span class="i n">TestFramework</span>.<span class="i n">Tests</span>.<span class="i n">TestEnvironment</span>
{
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Rest</span>.<span class="i n">ClientRuntime</span>.<span class="i n">Azure</span>.<span class="i n">TestFramework</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i n">CodeAnalysis</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
    <b>using</b> <span class="i n">Xunit</span>;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Tests for ConnectionString parsing</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="aa15ed5b38dfeb9f" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">ConnectionStringParseTests</a>
    {
        <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#449a79f9a08981be" class="t t">ConnectionString</a> <a id="bd7c330f95dcc213" href="../R/bd7c330f95dcc213.html" target="n" data-glyph="46,1" class="i field">connStr</a>;
        <b>public</b> <a id="47ab028c02538a9d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ConnectionStringParseTests</a>()
        {
            <a href="#bd7c330f95dcc213" class="i field">connStr</a> = <b>new</b> <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7103c105db55e2c8" class="t constructor">ConnectionString</a>();
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="4fb9dd47cfca1c6d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AllPossibleValueString</a>()
        {
            <span class="c">//Legal Connection string</span>
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">legalStr</span> = <a href="#5ed61e37a2f12e23" class="i method">CreateConnStrWithAllPossibleValues</a>();
            <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#449a79f9a08981be" class="t t">ConnectionString</a> <span id="r1 rd" class="r1 r">cs</span> = <b>new</b> <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#68c8d0430010092a" class="t constructor">ConnectionString</a>(<span class="r0 r">legalStr</span>);
            <span class="r1 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r0 r">legalStr</span>);
            <b>foreach</b>(<a href="@1@System.Runtime/A.html#8585965bb176a426" class="t t">KeyValuePair</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r2 rd" class="r2 r">kv</span> <b>in</b> <span class="r1 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>)
            {
                <span class="t t">Assert</span>.<span class="i method">NotEmpty</span>(<span class="r2 r">kv</span>.<a href="@1@System.Runtime/A.html#38c0e86cc4b30170" class="i property">Value</a>);
            }
 
            <span class="t t">Assert</span>.<span class="i method">True</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r1 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="e2a62bf5769210ea" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EmptyString</a>()
        {
            <span class="c">// empty Connection string</span>
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">emptyStr</span> = <span class="s">@&quot;&quot;</span>;
            <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r3 r">emptyStr</span>);
            <span class="t t">Assert</span>.<span class="i method">False</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="507e812f5c91786b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OptimizeRecordedFileKVPair</a>()
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">emptyStr</span> = <a href="#5ed61e37a2f12e23" class="i method">CreateConnStrWithAllPossibleValues</a>();
            <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#449a79f9a08981be" class="t t">ConnectionString</a> <span id="r5 rd" class="r5 r">cs</span> = <b>new</b> <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#7103c105db55e2c8" class="t constructor">ConnectionString</a>();
            <span class="r5 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r4 r">emptyStr</span>);
            <span class="t t">Assert</span>.<span class="i method">False</span>(<span class="r5 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#350363c1869bfe0c" class="i method">GetValue</a>&lt;<b>bool</b>&gt;(<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e1e10fb6c593516c" class="t t">ConnectionStringKeys</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e2806984cdd09f0a" class="i field">OptimizeRecordedFileKey</a>));
 
            <span class="r5 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e1e10fb6c593516c" class="t t">ConnectionStringKeys</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e2806984cdd09f0a" class="i field">OptimizeRecordedFileKey</a>] = <span class="s">&quot;true&quot;</span>;
            <span class="t t">Assert</span>.<span class="i method">True</span>(<span class="r5 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#350363c1869bfe0c" class="i method">GetValue</a>&lt;<b>bool</b>&gt;(<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e1e10fb6c593516c" class="t t">ConnectionStringKeys</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e2806984cdd09f0a" class="i field">OptimizeRecordedFileKey</a>));
        }
 
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="7cddc763a56239e1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">NullString</a>()
        {
            <span class="c">// null Connection string            </span>
            <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<b>null</b>);
            <span class="t t">Assert</span>.<span class="i method">False</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="0d647038bae79a77" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">NoKeyValueString</a>()
        {
            <span class="c">// missingKeyValue Connection string</span>
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">missingKeyValue</span> = <span class="s">@&quot;;;;;;;;;;;;&quot;</span>;
            <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r6 r">missingKeyValue</span>);            
            <span class="t t">Assert</span>.<span class="i method">True</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>));
        }
        
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="17aa063ad85779af" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">MalformedString</a>()
        {
            <span class="c">// malformed Connection string</span>
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r7 rd" class="r7 r">malformedStr</span> = <span class="s">@&quot;ServicePrincipal=helloworld;AADTenant=;=;userid=foo@foo.com&quot;</span>;
            <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r7 r">malformedStr</span>);
            <span class="t t">Assert</span>.<span class="i method">False</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>));
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="d9eee48980da1d86" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">KeyValueWithEqualSignString</a>()
        {
            <span class="c">//[SuppressMessage(&quot;Microsoft.Security&quot;, &quot;CS002:SecretInNextLine&quot;)]</span>
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r8 rd" class="r8 r">keyValWithEqualSign</span> = <span class="s">@&quot;ServicePrincipal=Hello;ServicePrincipalSecret=234ghyu=;Password=He====;UserId===========&quot;</span>;
            <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#449a79f9a08981be" class="t t">ConnectionString</a> <span id="r9 rd" class="r9 r">cs</span> = <b>new</b> <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#68c8d0430010092a" class="t constructor">ConnectionString</a>(<span class="r8 r">keyValWithEqualSign</span>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>);
 
            <span class="c">//We parse and store all keys lowercase to avoid casing issues</span>
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <span class="r9 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;ServicePrincipal&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <span class="r9 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;ServicePrincipalSecret&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <span class="r9 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;Password&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <span class="r9 r">cs</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;UserId&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="6a0bbfabc4f7dd73" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ClientIdButNotSPN</a>()
        {
            <span class="c">//[SuppressMessage(&quot;Microsoft.Security&quot;, &quot;CS002:SecretInNextLine&quot;)]</span>
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">clientIdButNoSPN</span> = <span class="s">@&quot;AADClientId=alsdkfjalakdsjflasdj;AADTenant=asdlkfjalsdkjflaksdj;Password=laksdjlfsd00980980=&quot;</span>;
            <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r10 r">clientIdButNoSPN</span>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>);
 
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;ServicePrincipal&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;ServicePrincipalSecret&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="6a6bb45f4d0aedac" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UserIdAndPasswordButNoSPNSecret</a>()
        {
            <span class="c">//[SuppressMessage(&quot;Microsoft.Security&quot;, &quot;CS002:SecretInNextLine&quot;)]</span>
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r11 rd" class="r11 r">clientIdButNoSPN</span> = <span class="s">@&quot;AADClientId=alsdkfjalakdsjflasdj;UserId=Hello@world.com;Password=laksdjlfsd00980980=&quot;</span>;
            <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r11 r">clientIdButNoSPN</span>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>);
 
            <span class="c">//ServicePrincipal will be updated with AADClientId</span>
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;ServicePrincipal&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
 
            <span class="c">//As userId is non-empty, we cannot assume password is ServicePrincipalSecretKey and so will not be updated</span>
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;ServicePrincipalSecret&quot;</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>()]);
        }
 
        [<span class="t constructor">Fact</span>]
        <b>public void</b> <a id="9f6bfc7b45ad096b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CustomKeyValuesInConnStr</a>()
        {
            <span class="c">// This test will test if custome Key-Value pairs are honored.</span>
            <span class="c">// Also if there are duplicate keys, it will pick the last occurance of the key, </span>
            <span class="c">// and will overwrite earlier instances of the same key</span>
 
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r12 rd" class="r12 r">clientIdButNoSPN</span> = <span class="s">@&quot;MyKey=MyValue;MyKey=NewValue;CustomKey=CustomValue;AADClientId=alsdkfjalakdsjflasdj;UserId=Hello@world.com&quot;</span>;
            <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#e3c8aad3ec064bdd" class="i method">Parse</a>(<span class="r12 r">clientIdButNoSPN</span>);
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#c590d46bfff381c2" class="i property">ParseErrors</a>);
 
            <span class="c">//ServicePrincipal will be updated with AADClientId</span>
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;ServicePrincipal&quot;</span>]);
 
            <span class="c">// Earlier instance of the same key will be overwritten</span>
            <span class="t t">Assert</span>.<span class="i method">NotEqual</span>(<span class="s">&quot;MyValue&quot;</span>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;MyKey&quot;</span>]);
 
            <span class="c">// last instance of the same key is retained</span>
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;NewValue&quot;</span>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;MyKey&quot;</span>]);
            
            <span class="t t">Assert</span>.<span class="i method">Equal</span>(<span class="s">&quot;CustomValue&quot;</span>, <a href="#bd7c330f95dcc213" class="i field">connStr</a>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>[<span class="s">&quot;CustomKey&quot;</span>]);
        }
 
        <b>private string</b> <a id="5ed61e37a2f12e23" href="../R/5ed61e37a2f12e23.html" target="n" data-glyph="76,1" class="i method">CreateConnStrWithAllPossibleValues</a>()
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r13 rd" class="r13 r">sampleUrl</span> = <span class="s">&quot;http://www.somefoo.com&quot;</span>;
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">sampleStrValue</span> = <span class="s">&quot;34rghytukbnju7HelloWorld!!lkjdfuhgghj&quot;</span>;
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r15 rd" class="r15 r">sampleNumericValue</span> = <span class="s">&quot;3476834rghh9876&quot;</span>;
 
            <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#449a79f9a08981be" class="t t">ConnectionString</a> <span id="r16 rd" class="r16 r">cnnStr</span> = <b>new</b> <a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#68c8d0430010092a" class="t constructor">ConnectionString</a>(<span class="s">&quot;&quot;</span>);
            <a href="@1@System.Runtime/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r17 rd" class="r17 r">sb</span> = <b>new</b> <a href="@1@System.Runtime/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
            <b>foreach</b>(<a href="@1@System.Runtime/A.html#8585965bb176a426" class="t t">KeyValuePair</a>&lt;<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <span id="r18 rd" class="r18 r">kv</span> <b>in</b> <span class="r16 r">cnnStr</span>.<a href="/Microsoft.Rest.ClientRuntime.Azure.TestFramework/A.html#d3264062f06cd223" class="i property">KeyValuePairs</a>)
            {
                <b>if</b> (<span class="r18 r">kv</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@1@System.Runtime/A.html#cb74053b3f2d03f4" class="i method">EndsWith</a>(<span class="s">&quot;uri&quot;</span>))
                {
                    <span class="r17 r">sb</span>.<a href="@1@System.Runtime/A.html#48e3f30ad3b0dfe5" class="i method">AppendFormat</a>(<span class="s">&quot;{0}={1};&quot;</span>, <span class="r18 r">kv</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>, <span class="r13 r">sampleUrl</span>);
                }
                <b>else</b> <b>if</b> (<span class="r18 r">kv</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>().<a href="@1@System.Runtime/A.html#cb74053b3f2d03f4" class="i method">EndsWith</a>(<span class="s">&quot;id&quot;</span>))
                {
                    <span class="r17 r">sb</span>.<a href="@1@System.Runtime/A.html#48e3f30ad3b0dfe5" class="i method">AppendFormat</a>(<span class="s">&quot;{0}={1};&quot;</span>, <span class="r18 r">kv</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>, <span class="r15 r">sampleNumericValue</span>);
                }
                <b>else</b>
                {
                    <span class="r17 r">sb</span>.<a href="@1@System.Runtime/A.html#48e3f30ad3b0dfe5" class="i method">AppendFormat</a>(<span class="s">&quot;{0}={1};&quot;</span>, <span class="r18 r">kv</span>.<a href="@1@System.Runtime/A.html#f9d1c04feb1af032" class="i property">Key</a>, <span class="r14 r">sampleStrValue</span>);
                }
            }
 
            <b>return</b> <span class="r17 r">sb</span>.<a href="@1@System.Runtime/A.html#5a97da49a158a3c9" class="i method">ToString</a>();
        }
    }
}
</pre></td></tr></table></div></body></html>
